/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={1924:(e,t,i)=>{"use strict";var r=i(210),o=i(5559),s=o(r("String.prototype.indexOf"));e.exports=function(e,t){var i=r(e,!!t);return"function"==typeof i&&s(e,".prototype.")>-1?o(i):i}},5559:(e,t,i)=>{"use strict";var r=i(8612),o=i(210),s=o("%Function.prototype.apply%"),n=o("%Function.prototype.call%"),l=o("%Reflect.apply%",!0)||r.call(n,s),a=o("%Object.getOwnPropertyDescriptor%",!0),h=o("%Object.defineProperty%",!0),d=o("%Math.max%");if(h)try{h({},"a",{value:1})}catch(e){h=null}e.exports=function(e){var t=l(r,n,arguments);return a&&h&&a(t,"length").configurable&&h(t,"length",{value:1+d(0,e.length-(arguments.length-1))}),t};var c=function(){return l(r,s,arguments)};h?h(e.exports,"apply",{value:c}):e.exports.apply=c},9187:e=>{"use strict";function t(e,t,r){r=r||2;var s,n,l,a,c,u,p,b=t&&t.length,f=b?t[0]*r:e.length,g=i(e,0,f,r,!0),F=[];if(!g||g.next===g.prev)return F;if(b&&(g=function(e,t,r,o){var s,n,l,a=[];for(s=0,n=t.length;s<n;s++)(l=i(e,t[s]*o,s<n-1?t[s+1]*o:e.length,o,!1))===l.next&&(l.steiner=!0),a.push(m(l));for(a.sort(h),s=0;s<a.length;s++)r=d(a[s],r);return r}(e,t,g,r)),e.length>80*r){s=l=e[0],n=a=e[1];for(var y=r;y<f;y+=r)(c=e[y])<s&&(s=c),(u=e[y+1])<n&&(n=u),c>l&&(l=c),u>a&&(a=u);p=0!==(p=Math.max(l-s,a-n))?32767/p:0}return o(g,F,r,s,n,p,0),F}function i(e,t,i,r,o){var s,n;if(o===E(e,t,i,r)>0)for(s=t;s<i;s+=r)n=w(s,e[s],e[s+1],n);else for(s=i-r;s>=t;s-=r)n=w(s,e[s],e[s+1],n);return n&&g(n,n.next)&&(S(n),n=n.next),n}function r(e,t){if(!e)return e;t||(t=e);var i,r=e;do{if(i=!1,r.steiner||!g(r,r.next)&&0!==f(r.prev,r,r.next))r=r.next;else{if(S(r),(r=t=r.prev)===r.next)break;i=!0}}while(i||r!==t);return t}function o(e,t,i,h,d,c,m){if(e){!m&&c&&function(e,t,i,r){var o=e;do{0===o.z&&(o.z=u(o.x,o.y,t,i,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,i,r,o,s,n,l,a,h=1;do{for(i=e,e=null,s=null,n=0;i;){for(n++,r=i,l=0,t=0;t<h&&(l++,r=r.nextZ);t++);for(a=h;l>0||a>0&&r;)0!==l&&(0===a||!r||i.z<=r.z)?(o=i,i=i.nextZ,l--):(o=r,r=r.nextZ,a--),s?s.nextZ=o:e=o,o.prevZ=s,s=o;i=r}s.nextZ=null,h*=2}while(n>1)}(o)}(e,h,d,c);for(var p,b,f=e;e.prev!==e.next;)if(p=e.prev,b=e.next,c?n(e,h,d,c):s(e))t.push(p.i/i|0),t.push(e.i/i|0),t.push(b.i/i|0),S(e),e=b.next,f=b.next;else if((e=b)===f){m?1===m?o(e=l(r(e),t,i),t,i,h,d,c,2):2===m&&a(e,t,i,h,d,c):o(r(e),t,i,h,d,c,1);break}}}function s(e){var t=e.prev,i=e,r=e.next;if(f(t,i,r)>=0)return!1;for(var o=t.x,s=i.x,n=r.x,l=t.y,a=i.y,h=r.y,d=o<s?o<n?o:n:s<n?s:n,c=l<a?l<h?l:h:a<h?a:h,u=o>s?o>n?o:n:s>n?s:n,m=l>a?l>h?l:h:a>h?a:h,b=r.next;b!==t;){if(b.x>=d&&b.x<=u&&b.y>=c&&b.y<=m&&p(o,l,s,a,n,h,b.x,b.y)&&f(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function n(e,t,i,r){var o=e.prev,s=e,n=e.next;if(f(o,s,n)>=0)return!1;for(var l=o.x,a=s.x,h=n.x,d=o.y,c=s.y,m=n.y,b=l<a?l<h?l:h:a<h?a:h,g=d<c?d<m?d:m:c<m?c:m,F=l>a?l>h?l:h:a>h?a:h,y=d>c?d>m?d:m:c>m?c:m,v=u(b,g,t,i,r),x=u(F,y,t,i,r),_=e.prevZ,w=e.nextZ;_&&_.z>=v&&w&&w.z<=x;){if(_.x>=b&&_.x<=F&&_.y>=g&&_.y<=y&&_!==o&&_!==n&&p(l,d,a,c,h,m,_.x,_.y)&&f(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,w.x>=b&&w.x<=F&&w.y>=g&&w.y<=y&&w!==o&&w!==n&&p(l,d,a,c,h,m,w.x,w.y)&&f(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;_&&_.z>=v;){if(_.x>=b&&_.x<=F&&_.y>=g&&_.y<=y&&_!==o&&_!==n&&p(l,d,a,c,h,m,_.x,_.y)&&f(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;w&&w.z<=x;){if(w.x>=b&&w.x<=F&&w.y>=g&&w.y<=y&&w!==o&&w!==n&&p(l,d,a,c,h,m,w.x,w.y)&&f(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function l(e,t,i){var o=e;do{var s=o.prev,n=o.next.next;!g(s,n)&&F(s,o,o.next,n)&&x(s,n)&&x(n,s)&&(t.push(s.i/i|0),t.push(o.i/i|0),t.push(n.i/i|0),S(o),S(o.next),o=e=n),o=o.next}while(o!==e);return r(o)}function a(e,t,i,s,n,l){var a=e;do{for(var h=a.next.next;h!==a.prev;){if(a.i!==h.i&&b(a,h)){var d=_(a,h);return a=r(a,a.next),d=r(d,d.next),o(a,t,i,s,n,l,0),void o(d,t,i,s,n,l,0)}h=h.next}a=a.next}while(a!==e)}function h(e,t){return e.x-t.x}function d(e,t){var i=function(e,t){var i,r=t,o=e.x,s=e.y,n=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var l=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(l<=o&&l>n&&(n=l,i=r.x<r.next.x?r:r.next,l===o))return i}r=r.next}while(r!==t);if(!i)return null;var a,h=i,d=i.x,u=i.y,m=1/0;r=i;do{o>=r.x&&r.x>=d&&o!==r.x&&p(s<u?o:n,s,d,u,s<u?n:o,s,r.x,r.y)&&(a=Math.abs(s-r.y)/(o-r.x),x(r,e)&&(a<m||a===m&&(r.x>i.x||r.x===i.x&&c(i,r)))&&(i=r,m=a)),r=r.next}while(r!==h);return i}(e,t);if(!i)return t;var o=_(i,e);return r(o,o.next),r(i,i.next)}function c(e,t){return f(e.prev,e,t.prev)<0&&f(t.next,e,e.next)<0}function u(e,t,i,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function p(e,t,i,r,o,s,n,l){return(o-n)*(t-l)>=(e-n)*(s-l)&&(e-n)*(r-l)>=(i-n)*(t-l)&&(i-n)*(s-l)>=(o-n)*(r-l)}function b(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&F(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(x(e,t)&&x(t,e)&&function(e,t){var i=e,r=!1,o=(e.x+t.x)/2,s=(e.y+t.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&o<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==e);return r}(e,t)&&(f(e.prev,e,t.prev)||f(e,t.prev,t))||g(e,t)&&f(e.prev,e,e.next)>0&&f(t.prev,t,t.next)>0)}function f(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function g(e,t){return e.x===t.x&&e.y===t.y}function F(e,t,i,r){var o=v(f(e,t,i)),s=v(f(e,t,r)),n=v(f(i,r,e)),l=v(f(i,r,t));return o!==s&&n!==l||!(0!==o||!y(e,i,t))||!(0!==s||!y(e,r,t))||!(0!==n||!y(i,e,r))||!(0!==l||!y(i,t,r))}function y(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function v(e){return e>0?1:e<0?-1:0}function x(e,t){return f(e.prev,e,e.next)<0?f(e,t,e.next)>=0&&f(e,e.prev,t)>=0:f(e,t,e.prev)<0||f(e,e.next,t)<0}function _(e,t){var i=new T(e.i,e.x,e.y),r=new T(t.i,t.x,t.y),o=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=o,o.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function w(e,t,i,r){var o=new T(e,t,i);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function S(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(e,t,i,r){for(var o=0,s=t,n=i-r;s<i;s+=r)o+=(e[n]-e[s])*(e[s+1]+e[n+1]),n=s;return o}e.exports=t,e.exports.default=t,t.deviation=function(e,t,i,r){var o=t&&t.length,s=o?t[0]*i:e.length,n=Math.abs(E(e,0,s,i));if(o)for(var l=0,a=t.length;l<a;l++){var h=t[l]*i,d=l<a-1?t[l+1]*i:e.length;n-=Math.abs(E(e,h,d,i))}var c=0;for(l=0;l<r.length;l+=3){var u=r[l]*i,m=r[l+1]*i,p=r[l+2]*i;c+=Math.abs((e[u]-e[p])*(e[m+1]-e[u+1])-(e[u]-e[m])*(e[p+1]-e[u+1]))}return 0===n&&0===c?0:Math.abs((c-n)/n)},t.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var s=0;s<e[o].length;s++)for(var n=0;n<t;n++)i.vertices.push(e[o][s][n]);o>0&&(r+=e[o-1].length,i.holes.push(r))}return i}},6729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,i="~";function r(){}function o(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function s(e,t,r,s,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var l=new o(r,s||e,n),a=i?i+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],l]:e._events[a].push(l):(e._events[a]=l,e._eventsCount++),e}function n(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function l(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),l.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},l.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,s=r.length,n=new Array(s);o<s;o++)n[o]=r[o].fn;return n},l.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},l.prototype.emit=function(e,t,r,o,s,n){var l=i?i+e:e;if(!this._events[l])return!1;var a,h,d=this._events[l],c=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),c){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,o),!0;case 5:return d.fn.call(d.context,t,r,o,s),!0;case 6:return d.fn.call(d.context,t,r,o,s,n),!0}for(h=1,a=new Array(c-1);h<c;h++)a[h-1]=arguments[h];d.fn.apply(d.context,a)}else{var u,m=d.length;for(h=0;h<m;h++)switch(d[h].once&&this.removeListener(e,d[h].fn,void 0,!0),c){case 1:d[h].fn.call(d[h].context);break;case 2:d[h].fn.call(d[h].context,t);break;case 3:d[h].fn.call(d[h].context,t,r);break;case 4:d[h].fn.call(d[h].context,t,r,o);break;default:if(!a)for(u=1,a=new Array(c-1);u<c;u++)a[u-1]=arguments[u];d[h].fn.apply(d[h].context,a)}}return!0},l.prototype.on=function(e,t,i){return s(this,e,t,i,!1)},l.prototype.once=function(e,t,i){return s(this,e,t,i,!0)},l.prototype.removeListener=function(e,t,r,o){var s=i?i+e:e;if(!this._events[s])return this;if(!t)return n(this,s),this;var l=this._events[s];if(l.fn)l.fn!==t||o&&!l.once||r&&l.context!==r||n(this,s);else{for(var a=0,h=[],d=l.length;a<d;a++)(l[a].fn!==t||o&&!l[a].once||r&&l[a].context!==r)&&h.push(l[a]);h.length?this._events[s]=1===h.length?h[0]:h:n(this,s)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&n(this,t)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=i,l.EventEmitter=l,e.exports=l},7648:e=>{"use strict";var t=Array.prototype.slice,i=Object.prototype.toString;e.exports=function(e){var r=this;if("function"!=typeof r||"[object Function]"!==i.call(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var o,s=t.call(arguments,1),n=Math.max(0,r.length-s.length),l=[],a=0;a<n;a++)l.push("$"+a);if(o=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var i=r.apply(this,s.concat(t.call(arguments)));return Object(i)===i?i:this}return r.apply(e,s.concat(t.call(arguments)))})),r.prototype){var h=function(){};h.prototype=r.prototype,o.prototype=new h,h.prototype=null}return o}},8612:(e,t,i)=>{"use strict";var r=i(7648);e.exports=Function.prototype.bind||r},210:(e,t,i)=>{"use strict";var r,o=SyntaxError,s=Function,n=TypeError,l=function(e){try{return s('"use strict"; return ('+e+").constructor;")()}catch(e){}},a=Object.getOwnPropertyDescriptor;if(a)try{a({},"")}catch(e){a=null}var h=function(){throw new n},d=a?function(){try{return h}catch(e){try{return a(arguments,"callee").get}catch(e){return h}}}():h,c=i(1405)(),u=i(8185)(),m=Object.getPrototypeOf||(u?function(e){return e.__proto__}:null),p={},b="undefined"!=typeof Uint8Array&&m?m(Uint8Array):r,f={"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":c&&m?m([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":p,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c&&m?m(m([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&c&&m?m((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&c&&m?m((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c&&m?m(""[Symbol.iterator]()):r,"%Symbol%":c?Symbol:r,"%SyntaxError%":o,"%ThrowTypeError%":d,"%TypedArray%":b,"%TypeError%":n,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(m)try{null.error}catch(e){var g=m(m(e));f["%Error.prototype%"]=g}var F=function e(t){var i;if("%AsyncFunction%"===t)i=l("async function () {}");else if("%GeneratorFunction%"===t)i=l("function* () {}");else if("%AsyncGeneratorFunction%"===t)i=l("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(i=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&m&&(i=m(o.prototype))}return f[t]=i,i},y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=i(8612),x=i(7642),_=v.call(Function.call,Array.prototype.concat),w=v.call(Function.apply,Array.prototype.splice),S=v.call(Function.call,String.prototype.replace),T=v.call(Function.call,String.prototype.slice),E=v.call(Function.call,RegExp.prototype.exec),A=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,P=/\\(\\)?/g,C=function(e,t){var i,r=e;if(x(y,r)&&(r="%"+(i=y[r])[0]+"%"),x(f,r)){var s=f[r];if(s===p&&(s=F(r)),void 0===s&&!t)throw new n("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new o("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new n("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new n('"allowMissing" argument must be a boolean');if(null===E(/^%?[^%]*%?$/,e))throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=function(e){var t=T(e,0,1),i=T(e,-1);if("%"===t&&"%"!==i)throw new o("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==t)throw new o("invalid intrinsic syntax, expected opening `%`");var r=[];return S(e,A,(function(e,t,i,o){r[r.length]=i?S(o,P,"$1"):t||e})),r}(e),r=i.length>0?i[0]:"",s=C("%"+r+"%",t),l=s.name,h=s.value,d=!1,c=s.alias;c&&(r=c[0],w(i,_([0,1],c)));for(var u=1,m=!0;u<i.length;u+=1){var p=i[u],b=T(p,0,1),g=T(p,-1);if(('"'===b||"'"===b||"`"===b||'"'===g||"'"===g||"`"===g)&&b!==g)throw new o("property names with quotes must have matching quotes");if("constructor"!==p&&m||(d=!0),x(f,l="%"+(r+="."+p)+"%"))h=f[l];else if(null!=h){if(!(p in h)){if(!t)throw new n("base intrinsic for "+e+" exists, but the property is not available.");return}if(a&&u+1>=i.length){var F=a(h,p);h=(m=!!F)&&"get"in F&&!("originalValue"in F.get)?F.get:h[p]}else m=x(h,p),h=h[p];m&&!d&&(f[l]=h)}}return h}},8185:e=>{"use strict";var t={foo:{}},i=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof i)}},1405:(e,t,i)=>{"use strict";var r="undefined"!=typeof Symbol&&Symbol,o=i(5419);e.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&o()}},5419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),i=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},7642:(e,t,i)=>{"use strict";var r=i(8612);e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},631:(e,t,i)=>{var r="function"==typeof Map&&Map.prototype,o=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,s=r&&o&&"function"==typeof o.get?o.get:null,n=r&&Map.prototype.forEach,l="function"==typeof Set&&Set.prototype,a=Object.getOwnPropertyDescriptor&&l?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,h=l&&a&&"function"==typeof a.get?a.get:null,d=l&&Set.prototype.forEach,c="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,u="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,m="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,b=Object.prototype.toString,f=Function.prototype.toString,g=String.prototype.match,F=String.prototype.slice,y=String.prototype.replace,v=String.prototype.toUpperCase,x=String.prototype.toLowerCase,_=RegExp.prototype.test,w=Array.prototype.concat,S=Array.prototype.join,T=Array.prototype.slice,E=Math.floor,A="function"==typeof BigInt?BigInt.prototype.valueOf:null,P=Object.getOwnPropertySymbols,C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,k="function"==typeof Symbol&&"object"==typeof Symbol.iterator,B="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,M=Object.prototype.propertyIsEnumerable,R=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function I(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var i=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var r=e<0?-E(-e):E(e);if(r!==e){var o=String(r),s=F.call(t,o.length+1);return y.call(o,i,"$&_")+"."+y.call(y.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return y.call(t,i,"$&_")}var D=i(4654),O=D.custom,N=H(O)?O:null;function L(e,t,i){var r="double"===(i.quoteStyle||t)?'"':"'";return r+e+r}function z(e){return y.call(String(e),/"/g,"&quot;")}function G(e){return!("[object Array]"!==W(e)||B&&"object"==typeof e&&B in e)}function U(e){return!("[object RegExp]"!==W(e)||B&&"object"==typeof e&&B in e)}function H(e){if(k)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!C)return!1;try{return C.call(e),!0}catch(e){}return!1}e.exports=function e(t,i,r,o){var l=i||{};if(j(l,"quoteStyle")&&"single"!==l.quoteStyle&&"double"!==l.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(j(l,"maxStringLength")&&("number"==typeof l.maxStringLength?l.maxStringLength<0&&l.maxStringLength!==1/0:null!==l.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=!j(l,"customInspect")||l.customInspect;if("boolean"!=typeof a&&"symbol"!==a)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(j(l,"indent")&&null!==l.indent&&"\t"!==l.indent&&!(parseInt(l.indent,10)===l.indent&&l.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(j(l,"numericSeparator")&&"boolean"!=typeof l.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var b=l.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return $(t,l);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var v=String(t);return b?I(t,v):v}if("bigint"==typeof t){var _=String(t)+"n";return b?I(t,_):_}var E=void 0===l.depth?5:l.depth;if(void 0===r&&(r=0),r>=E&&E>0&&"object"==typeof t)return G(t)?"[Array]":"[Object]";var P,O=function(e,t){var i;if("\t"===e.indent)i="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;i=S.call(Array(e.indent+1)," ")}return{base:i,prev:S.call(Array(t+1),i)}}(l,r);if(void 0===o)o=[];else if(X(o,t)>=0)return"[Circular]";function V(t,i,s){if(i&&(o=T.call(o)).push(i),s){var n={depth:l.depth};return j(l,"quoteStyle")&&(n.quoteStyle=l.quoteStyle),e(t,n,r+1,o)}return e(t,l,r+1,o)}if("function"==typeof t&&!U(t)){var Y=function(e){if(e.name)return e.name;var t=g.call(f.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}(t),ee=Q(t,V);return"[Function"+(Y?": "+Y:" (anonymous)")+"]"+(ee.length>0?" { "+S.call(ee,", ")+" }":"")}if(H(t)){var te=k?y.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):C.call(t);return"object"!=typeof t||k?te:q(te)}if((P=t)&&"object"==typeof P&&("undefined"!=typeof HTMLElement&&P instanceof HTMLElement||"string"==typeof P.nodeName&&"function"==typeof P.getAttribute)){for(var ie="<"+x.call(String(t.nodeName)),re=t.attributes||[],oe=0;oe<re.length;oe++)ie+=" "+re[oe].name+"="+L(z(re[oe].value),"double",l);return ie+=">",t.childNodes&&t.childNodes.length&&(ie+="..."),ie+"</"+x.call(String(t.nodeName))+">"}if(G(t)){if(0===t.length)return"[]";var se=Q(t,V);return O&&!function(e){for(var t=0;t<e.length;t++)if(X(e[t],"\n")>=0)return!1;return!0}(se)?"["+J(se,O)+"]":"[ "+S.call(se,", ")+" ]"}if(function(e){return!("[object Error]"!==W(e)||B&&"object"==typeof e&&B in e)}(t)){var ne=Q(t,V);return"cause"in Error.prototype||!("cause"in t)||M.call(t,"cause")?0===ne.length?"["+String(t)+"]":"{ ["+String(t)+"] "+S.call(ne,", ")+" }":"{ ["+String(t)+"] "+S.call(w.call("[cause]: "+V(t.cause),ne),", ")+" }"}if("object"==typeof t&&a){if(N&&"function"==typeof t[N]&&D)return D(t,{depth:E-r});if("symbol"!==a&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!s||!e||"object"!=typeof e)return!1;try{s.call(e);try{h.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var le=[];return n&&n.call(t,(function(e,i){le.push(V(i,t,!0)+" => "+V(e,t))})),K("Map",s.call(t),le,O)}if(function(e){if(!h||!e||"object"!=typeof e)return!1;try{h.call(e);try{s.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var ae=[];return d&&d.call(t,(function(e){ae.push(V(e,t))})),K("Set",h.call(t),ae,O)}if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e,c);try{u.call(e,u)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Z("WeakMap");if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{u.call(e,u);try{c.call(e,c)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Z("WeakSet");if(function(e){if(!m||!e||"object"!=typeof e)return!1;try{return m.call(e),!0}catch(e){}return!1}(t))return Z("WeakRef");if(function(e){return!("[object Number]"!==W(e)||B&&"object"==typeof e&&B in e)}(t))return q(V(Number(t)));if(function(e){if(!e||"object"!=typeof e||!A)return!1;try{return A.call(e),!0}catch(e){}return!1}(t))return q(V(A.call(t)));if(function(e){return!("[object Boolean]"!==W(e)||B&&"object"==typeof e&&B in e)}(t))return q(p.call(t));if(function(e){return!("[object String]"!==W(e)||B&&"object"==typeof e&&B in e)}(t))return q(V(String(t)));if(!function(e){return!("[object Date]"!==W(e)||B&&"object"==typeof e&&B in e)}(t)&&!U(t)){var he=Q(t,V),de=R?R(t)===Object.prototype:t instanceof Object||t.constructor===Object,ce=t instanceof Object?"":"null prototype",ue=!de&&B&&Object(t)===t&&B in t?F.call(W(t),8,-1):ce?"Object":"",me=(de||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(ue||ce?"["+S.call(w.call([],ue||[],ce||[]),": ")+"] ":"");return 0===he.length?me+"{}":O?me+"{"+J(he,O)+"}":me+"{ "+S.call(he,", ")+" }"}return String(t)};var V=Object.prototype.hasOwnProperty||function(e){return e in this};function j(e,t){return V.call(e,t)}function W(e){return b.call(e)}function X(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}function $(e,t){if(e.length>t.maxStringLength){var i=e.length-t.maxStringLength,r="... "+i+" more character"+(i>1?"s":"");return $(F.call(e,0,t.maxStringLength),t)+r}return L(y.call(y.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Y),"single",t)}function Y(e){var t=e.charCodeAt(0),i={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return i?"\\"+i:"\\x"+(t<16?"0":"")+v.call(t.toString(16))}function q(e){return"Object("+e+")"}function Z(e){return e+" { ? }"}function K(e,t,i,r){return e+" ("+t+") {"+(r?J(i,r):S.call(i,", "))+"}"}function J(e,t){if(0===e.length)return"";var i="\n"+t.prev+t.base;return i+S.call(e,","+i)+"\n"+t.prev}function Q(e,t){var i=G(e),r=[];if(i){r.length=e.length;for(var o=0;o<e.length;o++)r[o]=j(e,o)?t(e[o],e):""}var s,n="function"==typeof P?P(e):[];if(k){s={};for(var l=0;l<n.length;l++)s["$"+n[l]]=n[l]}for(var a in e)j(e,a)&&(i&&String(Number(a))===a&&a<e.length||k&&s["$"+a]instanceof Symbol||(_.call(/[^\w$]/,a)?r.push(t(a,e)+": "+t(e[a],e)):r.push(a+": "+t(e[a],e))));if("function"==typeof P)for(var h=0;h<n.length;h++)M.call(e,n[h])&&r.push("["+t(n[h])+"]: "+t(e[n[h]],e));return r}},5798:e=>{"use strict";var t=String.prototype.replace,i=/%20/g,r="RFC3986";e.exports={default:r,formatters:{RFC1738:function(e){return t.call(e,i,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:r}},129:(e,t,i)=>{"use strict";var r=i(8261),o=i(5235),s=i(5798);e.exports={formats:s,parse:o,stringify:r}},5235:(e,t,i)=>{"use strict";var r=i(2769),o=Object.prototype.hasOwnProperty,s=Array.isArray,n={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:r.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},l=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},a=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},h=function(e,t,i,r){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,n=/(\[[^[\]]*])/g,l=i.depth>0&&/(\[[^[\]]*])/.exec(s),h=l?s.slice(0,l.index):s,d=[];if(h){if(!i.plainObjects&&o.call(Object.prototype,h)&&!i.allowPrototypes)return;d.push(h)}for(var c=0;i.depth>0&&null!==(l=n.exec(s))&&c<i.depth;){if(c+=1,!i.plainObjects&&o.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;d.push(l[1])}return l&&d.push("["+s.slice(l.index)+"]"),function(e,t,i,r){for(var o=r?t:a(t,i),s=e.length-1;s>=0;--s){var n,l=e[s];if("[]"===l&&i.parseArrays)n=[].concat(o);else{n=i.plainObjects?Object.create(null):{};var h="["===l.charAt(0)&&"]"===l.charAt(l.length-1)?l.slice(1,-1):l,d=parseInt(h,10);i.parseArrays||""!==h?!isNaN(d)&&l!==h&&String(d)===h&&d>=0&&i.parseArrays&&d<=i.arrayLimit?(n=[])[d]=o:"__proto__"!==h&&(n[h]=o):n={0:o}}o=n}return o}(d,t,i,r)}};e.exports=function(e,t){var i=function(e){if(!e)return n;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?n.charset:e.charset;return{allowDots:void 0===e.allowDots?n.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:n.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:n.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:n.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:n.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:n.comma,decoder:"function"==typeof e.decoder?e.decoder:n.decoder,delimiter:"string"==typeof e.delimiter||r.isRegExp(e.delimiter)?e.delimiter:n.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:n.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:n.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:n.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:n.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:n.strictNullHandling}}(t);if(""===e||null==e)return i.plainObjects?Object.create(null):{};for(var d="string"==typeof e?function(e,t){var i,h={},d=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,c=t.parameterLimit===1/0?void 0:t.parameterLimit,u=d.split(t.delimiter,c),m=-1,p=t.charset;if(t.charsetSentinel)for(i=0;i<u.length;++i)0===u[i].indexOf("utf8=")&&("utf8=%E2%9C%93"===u[i]?p="utf-8":"utf8=%26%2310003%3B"===u[i]&&(p="iso-8859-1"),m=i,i=u.length);for(i=0;i<u.length;++i)if(i!==m){var b,f,g=u[i],F=g.indexOf("]="),y=-1===F?g.indexOf("="):F+1;-1===y?(b=t.decoder(g,n.decoder,p,"key"),f=t.strictNullHandling?null:""):(b=t.decoder(g.slice(0,y),n.decoder,p,"key"),f=r.maybeMap(a(g.slice(y+1),t),(function(e){return t.decoder(e,n.decoder,p,"value")}))),f&&t.interpretNumericEntities&&"iso-8859-1"===p&&(f=l(f)),g.indexOf("[]=")>-1&&(f=s(f)?[f]:f),o.call(h,b)?h[b]=r.combine(h[b],f):h[b]=f}return h}(e,i):e,c=i.plainObjects?Object.create(null):{},u=Object.keys(d),m=0;m<u.length;++m){var p=u[m],b=h(p,d[p],i,"string"==typeof e);c=r.merge(c,b,i)}return!0===i.allowSparse?c:r.compact(c)}},8261:(e,t,i)=>{"use strict";var r=i(7478),o=i(2769),s=i(5798),n=Object.prototype.hasOwnProperty,l={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},a=Array.isArray,h=String.prototype.split,d=Array.prototype.push,c=function(e,t){d.apply(e,a(t)?t:[t])},u=Date.prototype.toISOString,m=s.default,p={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:o.encode,encodeValuesOnly:!1,format:m,formatter:s.formatters[m],indices:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},b={},f=function e(t,i,s,n,l,d,u,m,f,g,F,y,v,x,_,w){for(var S,T=t,E=w,A=0,P=!1;void 0!==(E=E.get(b))&&!P;){var C=E.get(t);if(A+=1,void 0!==C){if(C===A)throw new RangeError("Cyclic object value");P=!0}void 0===E.get(b)&&(A=0)}if("function"==typeof m?T=m(i,T):T instanceof Date?T=F(T):"comma"===s&&a(T)&&(T=o.maybeMap(T,(function(e){return e instanceof Date?F(e):e}))),null===T){if(l)return u&&!x?u(i,p.encoder,_,"key",y):i;T=""}if("string"==typeof(S=T)||"number"==typeof S||"boolean"==typeof S||"symbol"==typeof S||"bigint"==typeof S||o.isBuffer(T)){if(u){var k=x?i:u(i,p.encoder,_,"key",y);if("comma"===s&&x){for(var B=h.call(String(T),","),M="",R=0;R<B.length;++R)M+=(0===R?"":",")+v(u(B[R],p.encoder,_,"value",y));return[v(k)+(n&&a(T)&&1===B.length?"[]":"")+"="+M]}return[v(k)+"="+v(u(T,p.encoder,_,"value",y))]}return[v(i)+"="+v(String(T))]}var I,D=[];if(void 0===T)return D;if("comma"===s&&a(T))I=[{value:T.length>0?T.join(",")||null:void 0}];else if(a(m))I=m;else{var O=Object.keys(T);I=f?O.sort(f):O}for(var N=n&&a(T)&&1===T.length?i+"[]":i,L=0;L<I.length;++L){var z=I[L],G="object"==typeof z&&void 0!==z.value?z.value:T[z];if(!d||null!==G){var U=a(T)?"function"==typeof s?s(N,z):N:N+(g?"."+z:"["+z+"]");w.set(t,A);var H=r();H.set(b,w),c(D,e(G,U,s,n,l,d,u,m,f,g,F,y,v,x,_,H))}}return D};e.exports=function(e,t){var i,o=e,h=function(e){if(!e)return p;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||p.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=s.default;if(void 0!==e.format){if(!n.call(s.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=s.formatters[i],o=p.filter;return("function"==typeof e.filter||a(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:p.addQueryPrefix,allowDots:void 0===e.allowDots?p.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:p.charsetSentinel,delimiter:void 0===e.delimiter?p.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:p.encode,encoder:"function"==typeof e.encoder?e.encoder:p.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:p.encodeValuesOnly,filter:o,format:i,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:p.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:p.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:p.strictNullHandling}}(t);"function"==typeof h.filter?o=(0,h.filter)("",o):a(h.filter)&&(i=h.filter);var d,u=[];if("object"!=typeof o||null===o)return"";d=t&&t.arrayFormat in l?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var m=l[d];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var b="comma"===m&&t&&t.commaRoundTrip;i||(i=Object.keys(o)),h.sort&&i.sort(h.sort);for(var g=r(),F=0;F<i.length;++F){var y=i[F];h.skipNulls&&null===o[y]||c(u,f(o[y],y,m,b,h.strictNullHandling,h.skipNulls,h.encode?h.encoder:null,h.filter,h.sort,h.allowDots,h.serializeDate,h.format,h.formatter,h.encodeValuesOnly,h.charset,g))}var v=u.join(h.delimiter),x=!0===h.addQueryPrefix?"?":"";return h.charsetSentinel&&("iso-8859-1"===h.charset?x+="utf8=%26%2310003%3B&":x+="utf8=%E2%9C%93&"),v.length>0?x+v:""}},2769:(e,t,i)=>{"use strict";var r=i(5798),o=Object.prototype.hasOwnProperty,s=Array.isArray,n=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),l=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(i[r]=e[r]);return i};e.exports={arrayToObject:l,assign:function(e,t){return Object.keys(t).reduce((function(e,i){return e[i]=t[i],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],r=0;r<t.length;++r)for(var o=t[r],n=o.obj[o.prop],l=Object.keys(n),a=0;a<l.length;++a){var h=l[a],d=n[h];"object"==typeof d&&null!==d&&-1===i.indexOf(d)&&(t.push({obj:n,prop:h}),i.push(d))}return function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(s(i)){for(var r=[],o=0;o<i.length;++o)void 0!==i[o]&&r.push(i[o]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,i){var r=e.replace(/\+/g," ");if("iso-8859-1"===i)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,i,o,s){if(0===e.length)return e;var l=e;if("symbol"==typeof e?l=Symbol.prototype.toString.call(e):"string"!=typeof e&&(l=String(e)),"iso-8859-1"===i)return escape(l).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var a="",h=0;h<l.length;++h){var d=l.charCodeAt(h);45===d||46===d||95===d||126===d||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===r.RFC1738&&(40===d||41===d)?a+=l.charAt(h):d<128?a+=n[d]:d<2048?a+=n[192|d>>6]+n[128|63&d]:d<55296||d>=57344?a+=n[224|d>>12]+n[128|d>>6&63]+n[128|63&d]:(h+=1,d=65536+((1023&d)<<10|1023&l.charCodeAt(h)),a+=n[240|d>>18]+n[128|d>>12&63]+n[128|d>>6&63]+n[128|63&d])}return a},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(s(e)){for(var i=[],r=0;r<e.length;r+=1)i.push(t(e[r]));return i}return t(e)},merge:function e(t,i,r){if(!i)return t;if("object"!=typeof i){if(s(t))t.push(i);else{if(!t||"object"!=typeof t)return[t,i];(r&&(r.plainObjects||r.allowPrototypes)||!o.call(Object.prototype,i))&&(t[i]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(i);var n=t;return s(t)&&!s(i)&&(n=l(t,r)),s(t)&&s(i)?(i.forEach((function(i,s){if(o.call(t,s)){var n=t[s];n&&"object"==typeof n&&i&&"object"==typeof i?t[s]=e(n,i,r):t.push(i)}else t[s]=i})),t):Object.keys(i).reduce((function(t,s){var n=i[s];return o.call(t,s)?t[s]=e(t[s],n,r):t[s]=n,t}),n)}}},7478:(e,t,i)=>{"use strict";var r=i(210),o=i(1924),s=i(631),n=r("%TypeError%"),l=r("%WeakMap%",!0),a=r("%Map%",!0),h=o("WeakMap.prototype.get",!0),d=o("WeakMap.prototype.set",!0),c=o("WeakMap.prototype.has",!0),u=o("Map.prototype.get",!0),m=o("Map.prototype.set",!0),p=o("Map.prototype.has",!0),b=function(e,t){for(var i,r=e;null!==(i=r.next);r=i)if(i.key===t)return r.next=i.next,i.next=e.next,e.next=i,i};e.exports=function(){var e,t,i,r={assert:function(e){if(!r.has(e))throw new n("Side channel does not contain "+s(e))},get:function(r){if(l&&r&&("object"==typeof r||"function"==typeof r)){if(e)return h(e,r)}else if(a){if(t)return u(t,r)}else if(i)return function(e,t){var i=b(e,t);return i&&i.value}(i,r)},has:function(r){if(l&&r&&("object"==typeof r||"function"==typeof r)){if(e)return c(e,r)}else if(a){if(t)return p(t,r)}else if(i)return function(e,t){return!!b(e,t)}(i,r);return!1},set:function(r,o){l&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new l),d(e,r,o)):a?(t||(t=new a),m(t,r,o)):(i||(i={key:{},next:null}),function(e,t,i){var r=b(e,t);r?r.value=i:e.next={key:t,next:e.next,value:i}}(i,r,o))}};return r}},2511:function(e,t,i){var r;e=i.nmd(e),function(o){t&&t.nodeType,e&&e.nodeType;var s="object"==typeof i.g&&i.g;s.global!==s&&s.window!==s&&s.self;var n,l=2147483647,a=36,h=26,d=38,c=700,u=/^xn--/,m=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=a-1,g=Math.floor,F=String.fromCharCode;function y(e){throw new RangeError(b[e])}function v(e,t){for(var i=e.length,r=[];i--;)r[i]=t(e[i]);return r}function x(e,t){var i=e.split("@"),r="";return i.length>1&&(r=i[0]+"@",e=i[1]),r+v((e=e.replace(p,".")).split("."),t).join(".")}function _(e){for(var t,i,r=[],o=0,s=e.length;o<s;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<s?56320==(64512&(i=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&i)+65536):(r.push(t),o--):r.push(t);return r}function w(e){return v(e,(function(e){var t="";return e>65535&&(t+=F((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+F(e)})).join("")}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function T(e,t,i){var r=0;for(e=i?g(e/c):e>>1,e+=g(e/t);e>f*h>>1;r+=a)e=g(e/f);return g(r+(f+1)*e/(e+d))}function E(e){var t,i,r,o,s,n,d,c,u,m,p,b=[],f=e.length,F=0,v=128,x=72;for((i=e.lastIndexOf("-"))<0&&(i=0),r=0;r<i;++r)e.charCodeAt(r)>=128&&y("not-basic"),b.push(e.charCodeAt(r));for(o=i>0?i+1:0;o<f;){for(s=F,n=1,d=a;o>=f&&y("invalid-input"),((c=(p=e.charCodeAt(o++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:a)>=a||c>g((l-F)/n))&&y("overflow"),F+=c*n,!(c<(u=d<=x?1:d>=x+h?h:d-x));d+=a)n>g(l/(m=a-u))&&y("overflow"),n*=m;x=T(F-s,t=b.length+1,0==s),g(F/t)>l-v&&y("overflow"),v+=g(F/t),F%=t,b.splice(F++,0,v)}return w(b)}function A(e){var t,i,r,o,s,n,d,c,u,m,p,b,f,v,x,w=[];for(b=(e=_(e)).length,t=128,i=0,s=72,n=0;n<b;++n)(p=e[n])<128&&w.push(F(p));for(r=o=w.length,o&&w.push("-");r<b;){for(d=l,n=0;n<b;++n)(p=e[n])>=t&&p<d&&(d=p);for(d-t>g((l-i)/(f=r+1))&&y("overflow"),i+=(d-t)*f,t=d,n=0;n<b;++n)if((p=e[n])<t&&++i>l&&y("overflow"),p==t){for(c=i,u=a;!(c<(m=u<=s?1:u>=s+h?h:u-s));u+=a)x=c-m,v=a-m,w.push(F(S(m+x%v,0))),c=g(x/v);w.push(F(S(c,0))),s=T(i,f,r==o),i=0,++r}++i,++t}return w.join("")}n={version:"1.4.1",ucs2:{decode:_,encode:w},decode:E,encode:A,toASCII:function(e){return x(e,(function(e){return m.test(e)?"xn--"+A(e):e}))},toUnicode:function(e){return x(e,(function(e){return u.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(r=function(){return n}.call(t,i,t,e))||(e.exports=r)}()},8575:(e,t,i)=>{"use strict";var r=i(2511);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var s=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,a=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(a),d=["%","/","?",";","#"].concat(h),c=["/","?","#"],u=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},f={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=i(129);function F(e,t,i){if(e&&"object"==typeof e&&e instanceof o)return e;var r=new o;return r.parse(e,t,i),r}o.prototype.parse=function(e,t,i){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),n=-1!==o&&o<e.indexOf("#")?"?":"#",a=e.split(n);a[0]=a[0].replace(/\\/g,"/");var F=e=a.join(n);if(F=F.trim(),!i&&1===e.split("#").length){var y=l.exec(F);if(y)return this.path=F,this.href=F,this.pathname=y[1],y[2]?(this.search=y[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var v=s.exec(F);if(v){var x=(v=v[0]).toLowerCase();this.protocol=x,F=F.substr(v.length)}if(i||v||F.match(/^\/\/[^@/]+@[^@/]+/)){var _="//"===F.substr(0,2);!_||v&&b[v]||(F=F.substr(2),this.slashes=!0)}if(!b[v]&&(_||v&&!f[v])){for(var w,S,T=-1,E=0;E<c.length;E++)-1!==(A=F.indexOf(c[E]))&&(-1===T||A<T)&&(T=A);for(-1!==(S=-1===T?F.lastIndexOf("@"):F.lastIndexOf("@",T))&&(w=F.slice(0,S),F=F.slice(S+1),this.auth=decodeURIComponent(w)),T=-1,E=0;E<d.length;E++){var A;-1!==(A=F.indexOf(d[E]))&&(-1===T||A<T)&&(T=A)}-1===T&&(T=F.length),this.host=F.slice(0,T),F=F.slice(T),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var C=this.hostname.split(/\./),k=(E=0,C.length);E<k;E++){var B=C[E];if(B&&!B.match(u)){for(var M="",R=0,I=B.length;R<I;R++)B.charCodeAt(R)>127?M+="x":M+=B[R];if(!M.match(u)){var D=C.slice(0,E),O=C.slice(E+1),N=B.match(m);N&&(D.push(N[1]),O.unshift(N[2])),O.length&&(F="/"+O.join(".")+F),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=r.toASCII(this.hostname));var L=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+L,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==F[0]&&(F="/"+F))}if(!p[x])for(E=0,k=h.length;E<k;E++){var G=h[E];if(-1!==F.indexOf(G)){var U=encodeURIComponent(G);U===G&&(U=escape(G)),F=F.split(G).join(U)}}var H=F.indexOf("#");-1!==H&&(this.hash=F.substr(H),F=F.slice(0,H));var V=F.indexOf("?");if(-1!==V?(this.search=F.substr(V),this.query=F.substr(V+1),t&&(this.query=g.parse(this.query)),F=F.slice(0,V)):t&&(this.search="",this.query={}),F&&(this.pathname=F),f[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){L=this.pathname||"";var j=this.search||"";this.path=L+j}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(s=g.stringify(this.query));var n=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||f[t])&&!1!==o?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),n&&"?"!==n.charAt(0)&&(n="?"+n),t+o+(i=i.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(n=n.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(F(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if("string"==typeof e){var t=new o;t.parse(e,!1,!0),e=t}for(var i=new o,r=Object.keys(this),s=0;s<r.length;s++){var n=r[s];i[n]=this[n]}if(i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),a=0;a<l.length;a++){var h=l[a];"protocol"!==h&&(i[h]=e[h])}return f[i.protocol]&&i.hostname&&!i.pathname&&(i.pathname="/",i.path=i.pathname),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!f[e.protocol]){for(var d=Object.keys(e),c=0;c<d.length;c++){var u=d[c];i[u]=e[u]}return i.href=i.format(),i}if(i.protocol=e.protocol,e.host||b[e.protocol])i.pathname=e.pathname;else{for(var m=(e.pathname||"").split("/");m.length&&!(e.host=m.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),i.pathname=m.join("/")}if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var p=i.pathname||"",g=i.search||"";i.path=p+g}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var F=i.pathname&&"/"===i.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),v=y||F||i.host&&e.pathname,x=v,_=i.pathname&&i.pathname.split("/")||[],w=(m=e.pathname&&e.pathname.split("/")||[],i.protocol&&!f[i.protocol]);if(w&&(i.hostname="",i.port=null,i.host&&(""===_[0]?_[0]=i.host:_.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host=null),v=v&&(""===m[0]||""===_[0])),y)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,_=m;else if(m.length)_||(_=[]),_.pop(),_=_.concat(m),i.search=e.search,i.query=e.query;else if(null!=e.search)return w&&(i.host=_.shift(),i.hostname=i.host,(P=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=P.shift(),i.hostname=P.shift(),i.host=i.hostname)),i.search=e.search,i.query=e.query,null===i.pathname&&null===i.search||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!_.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var S=_.slice(-1)[0],T=(i.host||e.host||_.length>1)&&("."===S||".."===S)||""===S,E=0,A=_.length;A>=0;A--)"."===(S=_[A])?_.splice(A,1):".."===S?(_.splice(A,1),E++):E&&(_.splice(A,1),E--);if(!v&&!x)for(;E--;E)_.unshift("..");!v||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),T&&"/"!==_.join("/").substr(-1)&&_.push("");var P,C=""===_[0]||_[0]&&"/"===_[0].charAt(0);return w&&(i.hostname=C?"":_.length?_.shift():"",i.host=i.hostname,(P=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=P.shift(),i.hostname=P.shift(),i.host=i.hostname)),(v=v||i.host&&_.length)&&!C&&_.unshift(""),_.length>0?i.pathname=_.join("/"):(i.pathname=null,i.path=null),null===i.pathname&&null===i.search||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},o.prototype.parseHost=function(){var e=this.host,t=n.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.Qc=F,t.DB=function(e,t){return F(e,!1,!0).resolve(t)},t.WU=function(e){return"string"==typeof e&&(e=F(e)),e instanceof o?e.format():o.prototype.format.call(e)}},4654:()=>{}},t={};function i(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&!e;)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{"use strict";var e=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(e||{}),t=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(t||{}),r=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(r||{}),o=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(o||{}),s=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(s||{}),n=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(n||{}),l=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(l||{}),a=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(a||{}),h=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(h||{}),d=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(d||{}),c=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(c||{}),u=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(u||{}),m=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(m||{}),p=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(p||{}),b=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(b||{}),f=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(f||{}),g=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(g||{}),F=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(F||{}),y=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(y||{});const v={createCanvas:(e,t)=>{const i=document.createElement("canvas");return i.width=e,i.height=t,i},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>(new DOMParser).parseFromString(e,"text/xml")},x={ADAPTER:v,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var _=/iPhone/i,w=/iPod/i,S=/iPad/i,T=/\biOS-universal(?:.+)Mac\b/i,E=/\bAndroid(?:.+)Mobile\b/i,A=/Android/i,P=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,C=/Silk/i,k=/Windows Phone/i,B=/\bWindows(?:.+)ARM\b/i,M=/BlackBerry/i,R=/BB10/i,I=/Opera Mini/i,D=/\b(CriOS|Chrome)(?:.+)Mobile/i,O=/Mobile(?:.+)Firefox\b/i,N=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function L(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var i=t.userAgent,r=i.split("[FBAN");void 0!==r[1]&&(i=r[0]),void 0!==(r=i.split("Twitter"))[1]&&(i=r[0]);var o=function(e){return function(t){return t.test(e)}}(i),s={apple:{phone:o(_)&&!o(k),ipod:o(w),tablet:!o(_)&&(o(S)||N(t))&&!o(k),universal:o(T),device:(o(_)||o(w)||o(S)||o(T)||N(t))&&!o(k)},amazon:{phone:o(P),tablet:!o(P)&&o(C),device:o(P)||o(C)},android:{phone:!o(k)&&o(P)||!o(k)&&o(E),tablet:!o(k)&&!o(P)&&!o(E)&&(o(C)||o(A)),device:!o(k)&&(o(P)||o(C)||o(E)||o(A))||o(/\bokhttp\b/i)},windows:{phone:o(k),tablet:o(B),device:o(k)||o(B)},other:{blackberry:o(M),blackberry10:o(R),opera:o(I),firefox:o(O),chrome:o(D),device:o(M)||o(R)||o(I)||o(O)||o(D)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const z=(L.default??L)(globalThis.navigator);x.RETINA_PREFIX=/@([0-9\.]+)x/,x.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var G=i(6729),U=i(9187),H=i(8575);const V={parse:H.Qc,format:H.WU,resolve:H.DB};function j(e){if("string"!=typeof e)throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function W(e){return e.split("?")[0].split("#")[0]}const X={toPosix:e=>("\\","/",e.replace(new RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")),isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl:e=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e),hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){j(e),e=this.toPosix(e);let t="";const i=/^file:\/\/\//.exec(e),r=/^[^/:]+:\/\//.exec(e),o=/^[^/:]+:\//.exec(e);if(i||r||o){const s=i?.[0]||r?.[0]||o?.[0];t=s,e=e.slice(s.length)}return t},toAbsolute(e,t,i){if(this.isDataUrl(e))return e;const r=W(this.toPosix(t??x.ADAPTER.getBaseUrl())),o=W(this.toPosix(i??this.rootname(r)));return j(e),(e=this.toPosix(e)).startsWith("/")?X.join(o,e.slice(1)):this.isAbsolute(e)?e:this.join(r,e)},normalize(e){if(j(e=this.toPosix(e)),0===e.length)return".";let t="";const i=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const r=e.endsWith("/");return(e=function(e,t){let i="",r=0,o=-1,s=0,n=-1;for(let t=0;t<=e.length;++t){if(t<e.length)n=e.charCodeAt(t);else{if(47===n)break;n=47}if(47===n){if(o===t-1||1===s);else if(o!==t-1&&2===s){if(i.length<2||2!==r||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){const e=i.lastIndexOf("/");if(e!==i.length-1){-1===e?(i="",r=0):(i=i.slice(0,e),r=i.length-1-i.lastIndexOf("/")),o=t,s=0;continue}}else if(2===i.length||1===i.length){i="",r=0,o=t,s=0;continue}}else i.length>0?i+=`/${e.slice(o+1,t)}`:i=e.slice(o+1,t),r=t-o-1;o=t,s=0}else 46===n&&-1!==s?++s:s=-1}return i}(e)).length>0&&r&&(e+="/"),i?`/${e}`:t+e},isAbsolute(e){return j(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join(...e){if(0===e.length)return".";let t;for(let i=0;i<e.length;++i){const r=e[i];if(j(r),r.length>0)if(void 0===t)t=r;else{const o=e[i-1]??"";this.extname(o)?t+=`/../${r}`:t+=`/${r}`}}return void 0===t?".":this.normalize(t)},dirname(e){if(j(e),0===e.length)return".";let t=(e=this.toPosix(e)).charCodeAt(0);const i=47===t;let r=-1,o=!0;const s=this.getProtocol(e),n=e;for(let i=(e=e.slice(s.length)).length-1;i>=1;--i)if(t=e.charCodeAt(i),47===t){if(!o){r=i;break}}else o=!1;return-1===r?i?"/":this.isUrl(n)?s+e:s:i&&1===r?"//":s+e.slice(0,r)},rootname(e){j(e);let t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){const i=e.indexOf("/",t.length);t=-1!==i?e.slice(0,i):e,t.endsWith("/")||(t+="/")}return t},basename(e,t){j(e),t&&j(t),e=W(this.toPosix(e));let i,r=0,o=-1,s=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let n=t.length-1,l=-1;for(i=e.length-1;i>=0;--i){const a=e.charCodeAt(i);if(47===a){if(!s){r=i+1;break}}else-1===l&&(s=!1,l=i+1),n>=0&&(a===t.charCodeAt(n)?-1==--n&&(o=i):(n=-1,o=l))}return r===o?o=l:-1===o&&(o=e.length),e.slice(r,o)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!s){r=i+1;break}}else-1===o&&(s=!1,o=i+1);return-1===o?"":e.slice(r,o)},extname(e){j(e);let t=-1,i=0,r=-1,o=!0,s=0;for(let n=(e=W(this.toPosix(e))).length-1;n>=0;--n){const l=e.charCodeAt(n);if(47!==l)-1===r&&(o=!1,r=n+1),46===l?-1===t?t=n:1!==s&&(s=1):-1!==t&&(s=-1);else if(!o){i=n+1;break}}return-1===t||-1===r||0===s||1===s&&t===r-1&&t===i+1?"":e.slice(t,r)},parse(e){j(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;let i=(e=W(this.toPosix(e))).charCodeAt(0);const r=this.isAbsolute(e);let o;t.root=this.rootname(e),o=r||this.hasProtocol(e)?1:0;let s=-1,n=0,l=-1,a=!0,h=e.length-1,d=0;for(;h>=o;--h)if(i=e.charCodeAt(h),47!==i)-1===l&&(a=!1,l=h+1),46===i?-1===s?s=h:1!==d&&(d=1):-1!==s&&(d=-1);else if(!a){n=h+1;break}return-1===s||-1===l||0===d||1===d&&s===l-1&&s===n+1?-1!==l&&(t.base=t.name=0===n&&r?e.slice(1,l):e.slice(n,l)):(0===n&&r?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(n,s),t.base=e.slice(n,l)),t.ext=e.slice(s,l)),t.dir=this.dirname(e),t},sep:"/",delimiter:":"},$={};function Y(e,t,i=3){if($[t])return;let r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",`${t}\nDeprecated since v${e}`):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}\nDeprecated since v${e}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}\nDeprecated since v${e}`),console.warn(r))),$[t]=!0}let q;var Z,K={grad:.9,turn:360,rad:360/(2*Math.PI)},J=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},Q=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=Math.pow(10,t)),Math.round(i*e)/i+0},ee=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),e>i?i:e>t?e:t},te=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},ie=function(e){return{r:ee(e.r,0,255),g:ee(e.g,0,255),b:ee(e.b,0,255),a:ee(e.a)}},re=function(e){return{r:Q(e.r),g:Q(e.g),b:Q(e.b),a:Q(e.a,3)}},oe=/^#([0-9a-f]{3,8})$/i,se=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},ne=function(e){var t=e.r,i=e.g,r=e.b,o=e.a,s=Math.max(t,i,r),n=s-Math.min(t,i,r),l=n?s===t?(i-r)/n:s===i?2+(r-t)/n:4+(t-i)/n:0;return{h:60*(l<0?l+6:l),s:s?n/s*100:0,v:s/255*100,a:o}},le=function(e){var t=e.h,i=e.s,r=e.v,o=e.a;t=t/360*6,i/=100,r/=100;var s=Math.floor(t),n=r*(1-i),l=r*(1-(t-s)*i),a=r*(1-(1-t+s)*i),h=s%6;return{r:255*[r,l,n,n,a,r][h],g:255*[a,r,r,l,n,n][h],b:255*[n,n,a,r,r,l][h],a:o}},ae=function(e){return{h:te(e.h),s:ee(e.s,0,100),l:ee(e.l,0,100),a:ee(e.a)}},he=function(e){return{h:Q(e.h),s:Q(e.s),l:Q(e.l),a:Q(e.a,3)}},de=function(e){return le((i=(t=e).s,{h:t.h,s:(i*=((r=t.l)<50?r:100-r)/100)>0?2*i/(r+i)*100:0,v:r+i,a:t.a}));var t,i,r},ce=function(e){return{h:(t=ne(e)).h,s:(o=(200-(i=t.s))*(r=t.v)/100)>0&&o<200?i*r/100/(o<=100?o:200-o)*100:0,l:o/2,a:t.a};var t,i,r,o},ue=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,me=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,pe=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,be=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,fe={string:[[function(e){var t=oe.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?Q(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?Q(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=pe.exec(e)||be.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:ie({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=ue.exec(e)||me.exec(e);if(!t)return null;var i,r,o=ae({h:(i=t[1],r=t[2],void 0===r&&(r="deg"),Number(i)*(K[r]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return de(o)},"hsl"]],object:[[function(e){var t=e.r,i=e.g,r=e.b,o=e.a,s=void 0===o?1:o;return J(t)&&J(i)&&J(r)?ie({r:Number(t),g:Number(i),b:Number(r),a:Number(s)}):null},"rgb"],[function(e){var t=e.h,i=e.s,r=e.l,o=e.a,s=void 0===o?1:o;if(!J(t)||!J(i)||!J(r))return null;var n=ae({h:Number(t),s:Number(i),l:Number(r),a:Number(s)});return de(n)},"hsl"],[function(e){var t=e.h,i=e.s,r=e.v,o=e.a,s=void 0===o?1:o;if(!J(t)||!J(i)||!J(r))return null;var n=function(e){return{h:te(e.h),s:ee(e.s,0,100),v:ee(e.v,0,100),a:ee(e.a)}}({h:Number(t),s:Number(i),v:Number(r),a:Number(s)});return le(n)},"hsv"]]},ge=function(e,t){for(var i=0;i<t.length;i++){var r=t[i][0](e);if(r)return[r,t[i][1]]}return[null,void 0]},Fe=function(e,t){var i=ce(e);return{h:i.h,s:ee(i.s+100*t,0,100),l:i.l,a:i.a}},ye=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},ve=function(e,t){var i=ce(e);return{h:i.h,s:i.s,l:ee(i.l+100*t,0,100),a:i.a}},xe=function(){function e(e){this.parsed=function(e){return"string"==typeof e?ge(e.trim(),fe.string):"object"==typeof e&&null!==e?ge(e,fe.object):[null,void 0]}(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return Q(ye(this.rgba),2)},e.prototype.isDark=function(){return ye(this.rgba)<.5},e.prototype.isLight=function(){return ye(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=re(this.rgba)).r,i=e.g,r=e.b,s=(o=e.a)<1?se(Q(255*o)):"","#"+se(t)+se(i)+se(r)+s;var e,t,i,r,o,s},e.prototype.toRgb=function(){return re(this.rgba)},e.prototype.toRgbString=function(){return t=(e=re(this.rgba)).r,i=e.g,r=e.b,(o=e.a)<1?"rgba("+t+", "+i+", "+r+", "+o+")":"rgb("+t+", "+i+", "+r+")";var e,t,i,r,o},e.prototype.toHsl=function(){return he(ce(this.rgba))},e.prototype.toHslString=function(){return t=(e=he(ce(this.rgba))).h,i=e.s,r=e.l,(o=e.a)<1?"hsla("+t+", "+i+"%, "+r+"%, "+o+")":"hsl("+t+", "+i+"%, "+r+"%)";var e,t,i,r,o},e.prototype.toHsv=function(){return e=ne(this.rgba),{h:Q(e.h),s:Q(e.s),v:Q(e.v),a:Q(e.a,3)};var e},e.prototype.invert=function(){return _e({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),_e(Fe(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),_e(Fe(this.rgba,-e))},e.prototype.grayscale=function(){return _e(Fe(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),_e(ve(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),_e(ve(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?_e({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):Q(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=ce(this.rgba);return"number"==typeof e?_e({h:e,s:t.s,l:t.l,a:t.a}):Q(t.h)},e.prototype.isEqual=function(e){return this.toHex()===_e(e).toHex()},e}(),_e=function(e){return e instanceof xe?e:new xe(e)},we=[];Z=[function(e,t){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var o in i)r[i[o]]=o;var s={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,n,l=r[this.toHex()];if(l)return l;if(null==t?void 0:t.closest){var a=this.toRgb(),h=1/0,d="black";if(!s.length)for(var c in i)s[c]=new e(i[c]).toRgb();for(var u in i){var m=(o=a,n=s[u],Math.pow(o.r-n.r,2)+Math.pow(o.g-n.g,2)+Math.pow(o.b-n.b,2));m<h&&(h=m,d=u)}return d}},t.string.push([function(t){var r=t.toLowerCase(),o="transparent"===r?"#0000":i[r];return o?new e(o).toRgb():null},"name"])}],Z.forEach((function(e){we.indexOf(e)<0&&(e(xe,fe),we.push(e))}));const Se=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Se)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(null===e)throw new Error("Cannot set PIXI.Color#value to null");null!==this._value&&this.isSourceEqual(this._value,e)||(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"==typeof e&&null!==e?{...e}:e}isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if("number"===i||"string"===i||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length&&e.every(((e,i)=>e===t[i]));if(null!==e&&null!==t){const i=Object.keys(e),r=Object.keys(t);return i.length===r.length&&i.every((i=>e[i]===t[i]))}return e===t}toRgba(){const[e,t,i,r]=this._components;return{r:e,g:t,b:i,a:r}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,r]=this._components;return(e=e??[])[0]=Math.round(255*t),e[1]=Math.round(255*i),e[2]=Math.round(255*r),e}toRgbArray(e){e=e??[];const[t,i,r]=this._components;return e[0]=t,e[1]=i,e[2]=r,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}multiply(e){const[t,i,r,o]=Se.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=r,this._components[3]*=o,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(1===e)return(255<<24)+this._int;if(0===e)return t?0:this._int;let i=this._int>>16&255,r=this._int>>8&255,o=255&this._int;return t&&(i=i*e+.5|0,r=r*e+.5|0,o=o*e+.5|0),(255*e<<24)+(i<<16)+(r<<8)+o}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,i,r]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(i*e)/e,this._components[2]=Math.round(r*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,i,r,o]=this._components;return e[0]=t,e[1]=i,e[2]=r,e[3]=o,e}normalize(e){let t,i,r,o;if(("number"==typeof e||e instanceof Number)&&e>=0&&e<=16777215)t=(e>>16&255)/255,i=(e>>8&255)/255,r=(255&e)/255,o=1;else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,r,o=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,r,o=255]=e,t/=255,i/=255,r/=255,o/=255;else if("string"==typeof e||"object"==typeof e){if("string"==typeof e){const t=Se.HEX_PATTERN.exec(e);t&&(e=`#${t[2]}`)}const s=_e(e);s.isValid()&&(({r:t,g:i,b:r,a:o}=s.rgba),t/=255,i/=255,r/=255)}if(void 0===t)throw new Error(`Unable to convert color ${e}`);this._components[0]=t,this._components[1]=i,this._components[2]=r,this._components[3]=o,this.refreshInt()}refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(255*e<<16)+(255*t<<8)+(255*i|0)}_clamp(e,t=0,i=1){return"number"==typeof e?Math.min(Math.max(e,t),i):(e.forEach(((r,o)=>{e[o]=Math.min(Math.max(r,t),i)})),e)}};let Te=Se;function Ee(e,t=[]){return Y("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),Te.shared.setValue(e).toRgbArray(t)}function Ae(e){return Y("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Te.shared.setValue(e).toNumber()}Te.shared=new Se,Te.temp=new Se,Te.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;const Pe=function(){const e=[],t=[];for(let i=0;i<32;i++)e[i]=i,t[i]=i;e[o.NORMAL_NPM]=o.NORMAL,e[o.ADD_NPM]=o.ADD,e[o.SCREEN_NPM]=o.SCREEN,t[o.NORMAL]=o.NORMAL_NPM,t[o.ADD]=o.ADD_NPM,t[o.SCREEN]=o.SCREEN_NPM;const i=[];return i.push(t),i.push(e),i}();function Ce(e,t){return Pe[t?1:0][e]}function ke(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}function Be(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,1+(e|=e>>>16)}function Me(e){return!(e&e-1||!e)}function Re(e){let t=(e>65535?1:0)<<4,i=((e>>>=t)>255?1:0)<<3;return t|=i,i=((e>>>=i)>15?1:0)<<2,t|=i,i=((e>>>=i)>3?1:0)<<1,t|=i,t|(e>>>=i)>>1}function Ie(e,t,i){const r=e.length;let o;if(t>=r||0===i)return;const s=r-(i=t+i>r?r-t:i);for(o=t;o<s;++o)e[o]=e[o+i];e.length=s}function De(e){return 0===e?0:e<0?-1:1}Float32Array,Uint32Array,Int32Array,Uint8Array;let Oe=0;function Ne(){return++Oe}const Le=class{constructor(e,t,i,r){this.left=e,this.top=t,this.right=i,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let ze=Le;ze.EMPTY=new Le(0,0,0,0);const Ge={},Ue=Object.create(null),He=Object.create(null);function Ve(){let e;for(e in Ue)delete Ue[e];for(e in He)delete He[e]}class je{constructor(e,t,i){this._canvas=x.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||x.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function We(e,t,i){for(let r=0,o=4*i*t;r<t;++r,o+=4)if(0!==e[o+3])return!1;return!0}function Xe(e,t,i,r,o){const s=4*t;for(let t=r,n=r*s+4*i;t<=o;++t,n+=s)if(0!==e[n+3])return!1;return!0}let $e;function Ye(e,t=1){const i=x.RETINA_PREFIX?.exec(e);return i?parseFloat(i[1]):t}var qe=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(qe||{});const Ze=e=>{if("function"==typeof e||"object"==typeof e&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={..."object"!=typeof e.extension?{type:e.extension}:e.extension,ref:e}}if("object"!=typeof e)throw new Error("Invalid extension type");return"string"==typeof(e={...e}).type&&(e.type=[e.type]),e},Ke=(e,t)=>Ze(e).priority??t,Je={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Ze).forEach((e=>{e.type.forEach((t=>this._removeHandlers[t]?.(e)))})),this},add(...e){return e.map(Ze).forEach((e=>{e.type.forEach((t=>{const i=this._addHandlers,r=this._queue;i[t]?i[t](e):(r[t]=r[t]||[],r[t].push(e))}))})),this},handle(e,t,i){const r=this._addHandlers,o=this._removeHandlers;if(r[e]||o[e])throw new Error(`Extension type ${e} already has a handler`);r[e]=t,o[e]=i;const s=this._queue;return s[e]&&(s[e].forEach((e=>t(e))),delete s[e]),this},handleByMap(e,t){return this.handle(e,(e=>{t[e.name]=e.ref}),(e=>{delete t[e.name]}))},handleByList(e,t,i=-1){return this.handle(e,(e=>{t.includes(e.ref)||(t.push(e.ref),t.sort(((e,t)=>Ke(t,i)-Ke(e,i))))}),(e=>{const i=t.indexOf(e.ref);-1!==i&&t.splice(i,1)}))}};class Qe{constructor(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const et=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function tt(e){let t="";for(let i=0;i<e;++i)i>0&&(t+="\nelse "),i<e-1&&(t+=`if(test == ${i}.0){}`);return t}class it{constructor(){this.data=0,this.blendMode=o.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(e){!!(1&this.data)!==e&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(e){!!(2&this.data)!==e&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(e){!!(4&this.data)!==e&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(e){!!(8&this.data)!==e&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(e){!!(32&this.data)!==e&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(e){!!(16&this.data)!==e&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==o.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new it;return e.depthTest=!1,e.blend=!0,e}}const rt=[];function ot(e,t){if(!e)return null;let i="";if("string"==typeof e){const t=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);t&&(i=t[1].toLowerCase())}for(let r=rt.length-1;r>=0;--r){const o=rt[r];if(o.test&&o.test(e,i))return new o(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class st{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,i,r,o,s,n,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:a,items:h}=this;this._aliasCount++;for(let d=0,c=h.length;d<c;d++)h[d][a](e,t,i,r,o,s,n,l);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(st.prototype,{dispatch:{value:st.prototype.emit},run:{value:st.prototype.emit}});class nt{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new st("setRealSize"),this.onUpdate=new st("update"),this.onError=new st("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class lt extends nt{constructor(e,t){const{width:i,height:r}=t||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=e}upload(e,t,i){const r=e.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===m.UNPACK);const o=t.realWidth,s=t.realHeight;return i.width===o&&i.height===s?r.texSubImage2D(t.target,0,0,0,o,s,t.format,i.type,this.data):(i.width=o,i.height=s,r.texImage2D(t.target,0,i.internalFormat,o,s,0,t.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array}}const at={scaleMode:d.NEAREST,format:n.RGBA,alphaMode:m.NPM},ht=class extends G{constructor(e=null,t=null){super(),t=Object.assign({},ht.defaultOptions,t);const{alphaMode:i,mipmap:r,anisotropicLevel:o,scaleMode:s,width:n,height:l,wrapMode:a,format:h,type:d,target:c,resolution:u,resourceOptions:m}=t;!e||e instanceof nt||((e=ot(e,m)).internal=!0),this.resolution=u||x.RESOLUTION,this.width=Math.round((n||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=o,this._wrapMode=a,this._scaleMode=s,this.format=h,this.type=d,this.target=c,this.alphaMode=i,this.uid=Ne(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=n>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let i;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,i=!0),i&&this.dirtyStyleId++,this}setSize(e,t,i){return i=i||this.resolution,this.setRealSize(e*i,t*i,i)}setRealSize(e,t,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Me(this.realWidth)&&Me(this.realHeight)}setResolution(e){const t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT()),this}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete He[this.cacheId],delete Ue[this.cacheId],this.cacheId=null),this.dispose(),ht.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,i=x.STRICT_TEXTURE_CACHE){const r="string"==typeof e;let o=null;if(r)o=e;else{if(!e._pixiId){const i=t?.pixiIdPrefix||"pixiid";e._pixiId=`${i}_${Ne()}`}o=e._pixiId}let s=He[o];if(r&&i&&!s)throw new Error(`The cacheId "${o}" does not exist in BaseTextureCache.`);return s||(s=new ht(e,t),s.cacheId=o,ht.addToCache(s,o)),s}static fromBuffer(e,t,i,r){e=e||new Float32Array(t*i*4);const o=new lt(e,{width:t,height:i}),s=e instanceof Float32Array?a.FLOAT:a.UNSIGNED_BYTE;return new ht(o,Object.assign({},at,{type:s},r))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),He[t]&&He[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),He[t]=e)}static removeFromCache(e){if("string"==typeof e){const t=He[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete He[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete He[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};let dt=ht;dt.defaultOptions={mipmap:u.POW2,anisotropicLevel:0,scaleMode:d.LINEAR,wrapMode:c.CLAMP,alphaMode:m.UNPACK,target:l.TEXTURE_2D,format:n.RGBA,type:a.UNSIGNED_BYTE},dt._globalBatch=0;class ct{constructor(){this.texArray=null,this.blend=0,this.type=s.TRIANGLES,this.start=0,this.size=0,this.data=null}}let ut=0;class mt{constructor(e,t=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=t,this.id=ut++,this.disposeRunner=new st("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?y.ELEMENT_ARRAY_BUFFER:y.ARRAY_BUFFER}get index(){return this.type===y.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new mt(e)}}class pt{constructor(e,t=0,i=!1,r=a.FLOAT,o,s,n,l=1){this.buffer=e,this.size=t,this.normalized=i,this.type=r,this.stride=o,this.start=s,this.instance=n,this.divisor=l}destroy(){this.buffer=null}static from(e,t,i,r,o){return new pt(e,t,i,r,o)}}const bt={Float32Array,Uint32Array,Int32Array,Uint8Array},ft={5126:4,5123:2,5121:1};let gt=0;const Ft={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class yt{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=gt++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new st("disposeGeometry"),this.refCount=0}addAttribute(e,t,i=0,r=!1,o,s,n,l=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof mt||(t instanceof Array&&(t=new Float32Array(t)),t=new mt(t));const a=e.split("|");if(a.length>1){for(let e=0;e<a.length;e++)this.addAttribute(a[e],t,i,r,o);return this}let h=this.buffers.indexOf(t);return-1===h&&(this.buffers.push(t),h=this.buffers.length-1),this.attributes[e]=new pt(h,i,r,o,s,n,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof mt||(e instanceof Array&&(e=new Uint16Array(e)),e=new mt(e)),e.type=y.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const e=[],t=[],i=new mt;let r;for(r in this.attributes){const i=this.attributes[r],o=this.buffers[i.buffer];e.push(o.data),t.push(i.size*ft[i.type]/4),i.buffer=0}for(i.data=function(e,t){let i=0,r=0;const o={};for(let o=0;o<e.length;o++)r+=t[o],i+=e[o].length;const s=new ArrayBuffer(4*i);let n=null,l=0;for(let i=0;i<e.length;i++){const a=t[i],h=e[i],d=ke(h);o[d]||(o[d]=new bt[d](s)),n=o[d];for(let e=0;e<h.length;e++)n[(e/a|0)*r+l+e%a]=h[e];l+=a}return new Float32Array(s)}(e,t),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new yt;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new mt(this.buffers[t].data.slice(0));for(const t in this.attributes){const i=this.attributes[t];e.attributes[t]=new pt(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=y.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new yt,i=[],r=[],o=[];let s;for(let t=0;t<e.length;t++){s=e[t];for(let e=0;e<s.buffers.length;e++)r[e]=r[e]||0,r[e]+=s.buffers[e].data.length,o[e]=0}for(let e=0;e<s.buffers.length;e++)i[e]=new(Ft[ke(s.buffers[e].data)])(r[e]),t.buffers[e]=new mt(i[e]);for(let t=0;t<e.length;t++){s=e[t];for(let e=0;e<s.buffers.length;e++)i[e].set(s.buffers[e].data,o[e]),o[e]+=s.buffers[e].data.length}if(t.attributes=s.attributes,s.indexBuffer){t.indexBuffer=t.buffers[s.buffers.indexOf(s.indexBuffer)],t.indexBuffer.type=y.ELEMENT_ARRAY_BUFFER;let i=0,r=0,o=0,n=0;for(let e=0;e<s.buffers.length;e++)if(s.buffers[e]!==s.indexBuffer){n=e;break}for(const e in s.attributes){const t=s.attributes[e];(0|t.buffer)===n&&(r+=t.size*ft[t.type]/4)}for(let s=0;s<e.length;s++){const l=e[s].indexBuffer.data;for(let e=0;e<l.length;e++)t.indexBuffer.data[e+o]+=i;i+=e[s].buffers[n].data.length/r,o+=l.length}}return t}}class vt extends yt{constructor(e=!1){super(),this._buffer=new mt(null,e,!1),this._indexBuffer=new mt(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,a.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,a.FLOAT).addAttribute("aColor",this._buffer,4,!0,a.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,a.FLOAT).addIndex(this._indexBuffer)}}const xt=2*Math.PI,_t=180/Math.PI,wt=Math.PI/180;var St=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(St||{});class Tt{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Tt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Et=[new Tt,new Tt,new Tt,new Tt];class At{constructor(e=0,t=0,i=0,r=0){this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(r),this.type=St.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new At(0,0,0,0)}clone(){return new At(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t){const t=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=t)return!1;const i=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>i}const i=this.left,r=this.right,o=this.top,s=this.bottom;if(r<=i||s<=o)return!1;const n=Et[0].set(e.left,e.top),l=Et[1].set(e.left,e.bottom),a=Et[2].set(e.right,e.top),h=Et[3].set(e.right,e.bottom);if(a.x<=n.x||l.y<=n.y)return!1;const d=Math.sign(t.a*t.d-t.b*t.c);if(0===d)return!1;if(t.apply(n,n),t.apply(l,l),t.apply(a,a),t.apply(h,h),Math.max(n.x,l.x,a.x,h.x)<=i||Math.min(n.x,l.x,a.x,h.x)>=r||Math.max(n.y,l.y,a.y,h.y)<=o||Math.min(n.y,l.y,a.y,h.y)>=s)return!1;const c=d*(l.y-n.y),u=d*(n.x-l.x),m=c*i+u*o,p=c*r+u*o,b=c*i+u*s,f=c*r+u*s;if(Math.max(m,p,b,f)<=c*n.x+u*n.y||Math.min(m,p,b,f)>=c*h.x+u*h.y)return!1;const g=d*(n.y-a.y),F=d*(a.x-n.x),y=g*i+F*o,v=g*r+F*o,x=g*i+F*s,_=g*r+F*s;return!(Math.max(y,v,x,_)<=g*n.x+F*n.y||Math.min(y,v,x,_)>=g*h.x+F*h.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),o=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=r,this.height=Math.max(o-r,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=r-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),o=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=r,this.height=o-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Pt{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.radius=i,this.type=St.CIRC}clone(){return new Pt(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-e,o=this.y-t;return r*=r,o*=o,r+o<=i}getBounds(){return new At(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ct{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r,this.type=St.ELIP}clone(){return new Ct(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,r=(t-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new At(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class kt{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if("number"!=typeof t[0]){const e=[];for(let i=0,r=t.length;i<r;i++)e.push(t[i].x,t[i].y);t=e}this.points=t,this.type=St.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new kt(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let i=!1;const r=this.points.length/2;for(let o=0,s=r-1;o<r;s=o++){const r=this.points[2*o],n=this.points[2*o+1],l=this.points[2*s],a=this.points[2*s+1];n>t!=a>t&&e<(t-n)/(a-n)*(l-r)+r&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce(((e,t)=>`${e}, ${t}`),"")}]`}}class Bt{constructor(e=0,t=0,i=0,r=0,o=20){this.x=e,this.y=t,this.width=i,this.height=r,this.radius=o,this.type=St.RREC}clone(){return new Bt(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let r=e-(this.x+i),o=t-(this.y+i);const s=i*i;if(r*r+o*o<=s)return!0;if(r=e-(this.x+this.width-i),r*r+o*o<=s)return!0;if(o=t-(this.y+this.height-i),r*r+o*o<=s)return!0;if(r=e-(this.x+i),r*r+o*o<=s)return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Mt{constructor(e=1,t=0,i=0,r=1,o=0,s=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=r,this.tx=o,this.ty=s}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,r,o,s){return this.a=e,this.b=t,this.c=i,this.d=r,this.tx=o,this.ty=s,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new Tt;const i=e.x,r=e.y;return t.x=this.a*i+this.c*r+this.tx,t.y=this.b*i+this.d*r+this.ty,t}applyInverse(e,t){t=t||new Tt;const i=1/(this.a*this.d+this.c*-this.b),r=e.x,o=e.y;return t.x=this.d*i*r+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,t.y=this.a*i*o+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.a,o=this.c,s=this.tx;return this.a=r*t-this.b*i,this.b=r*i+this.b*t,this.c=o*t-this.d*i,this.d=o*i+this.d*t,this.tx=s*t-this.ty*i,this.ty=s*i+this.ty*t,this}append(e){const t=this.a,i=this.b,r=this.c,o=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*i+e.b*o,this.c=e.c*t+e.d*r,this.d=e.c*i+e.d*o,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*i+e.ty*o+this.ty,this}setTransform(e,t,i,r,o,s,n,l,a){return this.a=Math.cos(n+a)*o,this.b=Math.sin(n+a)*o,this.c=-Math.sin(n-l)*s,this.d=Math.cos(n-l)*s,this.tx=e-(i*this.a+r*this.c),this.ty=t-(i*this.b+r*this.d),this}prepend(e){const t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const t=this.a,i=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,r=this.c,o=this.d,s=e.pivot,n=-Math.atan2(-r,o),l=Math.atan2(i,t),a=Math.abs(n+l);return a<1e-5||Math.abs(xt-a)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=n,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(r*r+o*o),e.position.x=this.tx+(s.x*t+s.y*r),e.position.y=this.ty+(s.x*i+s.y*o),e}invert(){const e=this.a,t=this.b,i=this.c,r=this.d,o=this.tx,s=e*r-t*i;return this.a=r/s,this.b=-t/s,this.c=-i/s,this.d=e/s,this.tx=(i*this.ty-r*o)/s,this.ty=-(e*this.ty-t*o)/s,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Mt;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Mt}static get TEMP_MATRIX(){return new Mt}}const Rt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],It=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Dt=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ot=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Nt=[],Lt=[],zt=Math.sign;!function(){for(let e=0;e<16;e++){const t=[];Nt.push(t);for(let i=0;i<16;i++){const r=zt(Rt[e]*Rt[i]+Dt[e]*It[i]),o=zt(It[e]*Rt[i]+Ot[e]*It[i]),s=zt(Rt[e]*Dt[i]+Dt[e]*Ot[i]),n=zt(It[e]*Dt[i]+Ot[e]*Ot[i]);for(let e=0;e<16;e++)if(Rt[e]===r&&It[e]===o&&Dt[e]===s&&Ot[e]===n){t.push(e);break}}}for(let e=0;e<16;e++){const t=new Mt;t.set(Rt[e],It[e],Dt[e],Ot[e],0,0),Lt.push(t)}}();const Gt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Rt[e],uY:e=>It[e],vX:e=>Dt[e],vY:e=>Ot[e],inv:e=>8&e?15&e:7&-e,add:(e,t)=>Nt[e][t],sub:(e,t)=>Nt[e][Gt.inv(t)],rotate180:e=>4^e,isVertical:e=>2==(3&e),byDirection:(e,t)=>2*Math.abs(e)<=Math.abs(t)?t>=0?Gt.S:Gt.N:2*Math.abs(t)<=Math.abs(e)?e>0?Gt.E:Gt.W:t>0?e>0?Gt.SE:Gt.SW:e>0?Gt.NE:Gt.NW,matrixAppendRotationInv:(e,t,i=0,r=0)=>{const o=Lt[Gt.inv(t)];o.tx=i,o.ty=r,e.append(o)}};class Ut{constructor(e,t,i=0,r=0){this._x=i,this._y=r,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new Ut(e,t,this._x,this._y)}set(e=0,t=e){return this._x===e&&this._y===t||(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}const Ht=class{constructor(){this.worldTransform=new Mt,this.localTransform=new Mt,this.position=new Ut(this.onChange,this,0,0),this.scale=new Ut(this.onChange,this,1,1),this.pivot=new Ut(this.onChange,this,0,0),this.skew=new Ut(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const i=e.worldTransform,r=this.worldTransform;r.a=t.a*i.a+t.b*i.c,r.b=t.a*i.b+t.b*i.d,r.c=t.c*i.a+t.d*i.c,r.d=t.c*i.b+t.d*i.d,r.tx=t.tx*i.a+t.ty*i.c+i.tx,r.ty=t.tx*i.b+t.ty*i.d+i.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};let Vt=Ht;Vt.IDENTITY=new Ht;const jt=[{test:e=>"float"===e.type&&1===e.size&&!e.isArray,code:e=>`\n            if(uv["${e}"] !== ud["${e}"].value)\n            {\n                ud["${e}"].value = uv["${e}"]\n                gl.uniform1f(ud["${e}"].location, uv["${e}"])\n            }\n            `},{test:(e,t)=>!("sampler2D"!==e.type&&"samplerCube"!==e.type&&"sampler2DArray"!==e.type||1!==e.size||e.isArray||null!=t&&void 0===t.castToBaseTexture),code:e=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${e}"], t);\n\n            if(ud["${e}"].value !== t)\n            {\n                ud["${e}"].value = t;\n                gl.uniform1i(ud["${e}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(e,t)=>"mat3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.a,code:e=>`\n            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));\n            `,codeUbo:e=>`\n                var ${e}_matrix = uv.${e}.toArray(true);\n\n                data[offset] = ${e}_matrix[0];\n                data[offset+1] = ${e}_matrix[1];\n                data[offset+2] = ${e}_matrix[2];\n        \n                data[offset + 4] = ${e}_matrix[3];\n                data[offset + 5] = ${e}_matrix[4];\n                data[offset + 6] = ${e}_matrix[5];\n        \n                data[offset + 8] = ${e}_matrix[6];\n                data[offset + 9] = ${e}_matrix[7];\n                data[offset + 10] = ${e}_matrix[8];\n            `},{test:(e,t)=>"vec2"===e.type&&1===e.size&&!e.isArray&&void 0!==t.x,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${e}"].location, v.x, v.y);\n                }`,codeUbo:e=>`\n                v = uv.${e};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:e=>"vec2"===e.type&&1===e.size&&!e.isArray,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);\n                }\n            `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.width,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(e,t)=>"vec3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:e=>`\n                    v = uv.${e};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:e=>"vec4"===e.type&&1===e.size&&!e.isArray,code:e=>`\n                cv = ud["${e}"].value;\n                v = uv["${e}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])\n                }`}],Wt={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},Xt={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},$t={};let Yt,qt=$t;const Zt={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Kt(e){return Zt[e]}let Jt=null;const Qt={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ei(e,t){if(!Jt){const t=Object.keys(Qt);Jt={};for(let i=0;i<t.length;++i){const r=t[i];Jt[e[r]]=Qt[r]}}return Jt[t]}function ti(e,t,i){if("precision"!==e.substring(0,9)){let r=t;return t===f.HIGH&&i!==f.HIGH&&(r=f.MEDIUM),`precision ${r} float;\n${e}`}return i!==f.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}let ii=0;const ri={},oi=class{constructor(t,i,r="pixi-shader",o={}){this.extra={},this.id=ii++,this.vertexSrc=t||oi.defaultVertexSrc,this.fragmentSrc=i||oi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=o,"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),ri[r]?(ri[r]++,r+=`-${ri[r]}`):ri[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${r}\n${this.fragmentSrc}`,this.vertexSrc=ti(this.vertexSrc,oi.defaultVertexPrecision,f.HIGH),this.fragmentSrc=ti(this.fragmentSrc,oi.defaultFragmentPrecision,function(){if(!Yt){Yt=f.MEDIUM;const t=function(){if(qt===$t||qt?.isContextLost()){const t=x.ADAPTER.createCanvas();let i;x.PREFER_ENV>=e.WEBGL2&&(i=t.getContext("webgl2",{})),i||(i=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),i?i.getExtension("WEBGL_draw_buffers"):i=null),qt=i}return qt}();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Yt=e.precision?f.HIGH:f.MEDIUM}}return Yt}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(e,t,i){const r=e+t;let o=Ge[r];return o||(Ge[r]=o=new oi(e,t,i)),o}};let si=oi;si.defaultVertexPrecision=f.HIGH,si.defaultFragmentPrecision=z.apple.device?f.HIGH:f.MEDIUM;let ni=0;class li{constructor(e,t,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ni++,this.static=!!t,this.ubo=!!i,e instanceof mt?(this.buffer=e,this.buffer.type=y.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new mt(new Float32Array(1)),this.buffer.type=y.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,i){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new li(t,i)}static from(e,t,i){return new li(e,t,i)}static uboFrom(e,t){return new li(e,t??!0,!0)}}class ai{constructor(e,t){this.uniformBindCount=0,this.program=e,this.uniformGroup=t?t instanceof li?t:new li(t):new li({}),this.disposeRunner=new st("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const i in t.uniforms){const r=t.uniforms[i];if(r.group&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,i){const r=si.from(e,t);return new ai(r,i)}}class hi{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=i;this.defaultGroupCache[e]=li.from({uSamplers:t},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new si(this.vertexSrc,i)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new Mt,default:this.defaultGroupCache[e]};return new ai(this.programCache[e],t)}generateSampleSrc(e){let t="";t+="\n",t+="\n";for(let i=0;i<e;i++)i>0&&(t+="\nelse "),i<e-1&&(t+=`if(vTextureId < ${i}.5)`),t+="\n{",t+=`\n\tcolor = texture2D(uSamplers[${i}], vTextureCoord);`,t+="\n}";return t+="\n",t+="\n",t}}class di{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}class ci{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}const ui=class extends ci{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=vt,this.vertexSize=6,this.state=it.for2d(),this.size=4*ui.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??function(e){let t=!0;const i=x.ADAPTER.getNavigator();if(z.tablet||z.phone){if(z.apple.device){const e=i.userAgent.match(/OS (\d+)_(\d+)?/);e&&parseInt(e[1],10)<11&&(t=!1)}if(z.android.device){const e=i.userAgent.match(/Android\s([0-9.]*)/);e&&parseInt(e[1],10)<7&&(t=!1)}}return t?32:4}(),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??!z.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Y("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:e=ui.defaultVertexSrc,fragment:t=ui.defaultFragmentTemplate}={}){this.shaderGenerator=new hi(e,t)}contextChange(){const t=this.renderer.gl;x.PREFER_ENV===e.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ui.defaultMaxTextures),this.maxTextures=function(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=t.createShader(t.FRAGMENT_SHADER);for(;;){const r=et.replace(/%forloop%/gi,tt(e));if(t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))break;e=e/2|0}return e}(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=ui,i=this.size/4,r=Math.floor(i/this.maxTextures)+1;for(;e.length<i;)e.push(new ct);for(;t.length<r;)t.push(new di);for(let e=0;e<this.maxTextures;e++)this._tempBoundTextures[e]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,i=ui._textureArrayPool,r=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count;let n=++dt._globalBatch,l=0,a=i[0],h=0;r.copyBoundTextures(o,t);for(let d=0;d<this._bufferSize;++d){const c=e[d];e[d]=null,c._batchEnabled!==n&&(a.count>=t&&(r.boundArray(a,o,n,t),this.buildDrawCalls(a,h,d),h=d,a=i[++l],++n),c._batchEnabled=n,c.touched=s,a.elements[a.count++]=c)}a.count>0&&(r.boundArray(a,o,n,t),this.buildDrawCalls(a,h,this._bufferSize),++l,++n);for(let e=0;e<o.length;e++)o[e]=null;dt._globalBatch=n}buildDrawCalls(e,t,i){const{_bufferedElements:r,_attributeBuffer:o,_indexBuffer:s,vertexSize:n}=this,l=ui._drawCallPool;let a=this._dcIndex,h=this._aIndex,d=this._iIndex,c=l[a];c.start=this._iIndex,c.texArray=e;for(let u=t;u<i;++u){const i=r[u],m=i._texture.baseTexture,p=Pe[m.alphaMode?1:0][i.blendMode];r[u]=null,t<u&&c.blend!==p&&(c.size=d-c.start,t=u,c=l[++a],c.texArray=e,c.start=d),this.packInterleavedGeometry(i,o,s,h,d),h+=i.vertexData.length/2*n,d+=i.indices.length,c.blend=p}t<i&&(c.size=d-c.start,++a),this._dcIndex=a,this._aIndex=h,this._iIndex=d}bindAndClearTexArray(e){const t=this.renderer.texture;for(let i=0;i<e.count;i++)t.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:i}=this;ui.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:i}=this.renderer,r=ui._drawCallPool;let o=null;for(let s=0;s<e;s++){const{texArray:e,type:n,size:l,start:a,blend:h}=r[s];o!==e&&(o=e,this.bindAndClearTexArray(e)),this.state.blendMode=h,i.set(this.state),t.drawElements(n,l,t.UNSIGNED_SHORT,2*a)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),ui.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=Be(Math.ceil(e/8)),i=Re(t),r=8*t;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let o=this._aBuffers[r];return o||(this._aBuffers[r]=o=new Qe(r*this.vertexSize*4)),o}getIndexBuffer(e){const t=Be(Math.ceil(e/12)),i=Re(t),r=12*t;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let o=this._iBuffers[i];return o||(this._iBuffers[i]=o=new Uint16Array(r)),o}packInterleavedGeometry(e,t,i,r,o){const{uint32View:s,float32View:n}=t,l=r/this.vertexSize,a=e.uvs,h=e.indices,d=e.vertexData,c=e._texture.baseTexture._batchLocation,u=Math.min(e.worldAlpha,1),m=Te.shared.setValue(e._tintRGB).toPremultiplied(u,e._texture.baseTexture.alphaMode>0);for(let e=0;e<d.length;e+=2)n[r++]=d[e],n[r++]=d[e+1],n[r++]=a[e],n[r++]=a[e+1],s[r++]=m,n[r++]=c;for(let e=0;e<h.length;e++)i[o++]=l+h[e]}};let mi=ui;mi.defaultBatchSize=4096,mi.extension={name:"batch",type:qe.RendererPlugin},mi._drawCallPool=[],mi._textureArrayPool=[],Je.add(mi);const pi=class extends ai{constructor(e,t,i){super(si.from(e||pi.defaultVertexSrc,t||pi.defaultFragmentSrc),i),this.padding=0,this.resolution=pi.defaultResolution,this.multisample=pi.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new it}apply(e,t,i,r,o){e.applyFilter(this,t,i,r)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};let bi=pi;bi.defaultResolution=1,bi.defaultMultisample=F.NONE;class fi{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Te(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:t,background:i,backgroundAlpha:r}=e,o=i??t;void 0!==o&&(this.color=o),this.alpha=r}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}fi.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},fi.extension={type:[qe.RendererSystem,qe.CanvasRendererSystem],name:"background"},Je.add(fi);class gi{constructor(e){this.renderer=e,this.emptyRenderer=new ci(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:i}=this.renderer.texture;for(let r=t-1;r>=0;--r)e[r]=i[r]||null,e[r]&&(e[r]._batchLocation=r)}boundArray(e,t,i,r){const{elements:o,ids:s,count:n}=e;let l=0;for(let e=0;e<n;e++){const n=o[e],a=n._batchLocation;if(a>=0&&a<r&&t[a]===n)s[e]=a;else for(;l<r;){const r=t[l];if(!r||r._batchEnabled!==i||r._batchLocation!==l){s[e]=l,n._batchLocation=l,t[l]=n;break}l++}}}destroy(){this.renderer=null}}gi.extension={type:qe.RendererSystem,name:"batch"},Je.add(gi);let Fi=0;class yi{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=Fi++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=Fi++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;void 0!==t.addEventListener&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(t,i){let r;if(x.PREFER_ENV>=e.WEBGL2&&(r=t.getContext("webgl2",i)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=t.getContext("webgl",i)||t.getContext("experimental-webgl",i),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout((()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()}),0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}yi.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},yi.extension={type:qe.RendererSystem,name:"context"},Je.add(yi);class vi extends lt{upload(e,t,i){const r=e.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===m.UNPACK);const o=t.realWidth,s=t.realHeight;return i.width===o&&i.height===s?r.texSubImage2D(t.target,0,0,0,o,s,t.format,i.type,this.data):(i.width=o,i.height=s,r.texImage2D(t.target,0,i.internalFormat,o,s,0,t.format,i.type,this.data)),!0}}class xi{constructor(e,t){this.width=Math.round(e||100),this.height=Math.round(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new st("disposeFramebuffer"),this.multisample=F.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new dt(null,{scaleMode:d.NEAREST,resolution:1,mipmap:u.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new dt(new vi(null,{width:this.width,height:this.height}),{scaleMode:d.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:u.OFF,format:n.DEPTH_COMPONENT,type:a.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const r=this.colorTextures[i],o=r.resolution;r.setSize(e/o,t/o)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,t/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class _i extends dt{constructor(e={}){"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),e.width=e.width||100,e.height=e.height||100,e.multisample??(e.multisample=F.NONE),super(null,e),this.mipmap=u.OFF,this.valid=!0,this._clear=new Te([0,0,0,0]),this.framebuffer=new xi(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class wi extends nt{constructor(e){const t=e;super(t.naturalWidth||t.videoWidth||t.width,t.naturalHeight||t.videoHeight||t.height),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,i){void 0!==i||t.startsWith("data:")?!1!==i&&(e.crossOrigin="string"==typeof i?i:"anonymous"):e.crossOrigin=function(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,$e||($e=document.createElement("a")),$e.href=e;const i=V.parse($e.href),r=!i.port&&""===t.port||i.port===t.port;return i.hostname===t.hostname&&r&&i.protocol===t.protocol?"":"anonymous"}(t)}upload(e,t,i,r){const o=e.gl,s=t.realWidth,n=t.realHeight;if(r=r||this.source,"undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement){if(!r.complete||0===r.naturalWidth)return!1}else if("undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement&&r.readyState<=1&&0===r.buffered.length)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===m.UNPACK),this.noSubImage||t.target!==o.TEXTURE_2D||i.width!==s||i.height!==n?(i.width=s,i.height=n,o.texImage2D(t.target,0,i.internalFormat,t.format,i.type,r)):o.texSubImage2D(o.TEXTURE_2D,0,0,0,t.format,i.type,r),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(t,i),super.update()}dispose(){this.source=null}}class Si extends wi{constructor(e,t){if(t=t||{},"string"==typeof e){const i=new Image;wi.crossOrigin(i,e,t.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??x.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.bitmap=null,this._load=null,!1!==t.autoLoad&&this.load()}load(e){return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise(((e,t)=>{const i=this.source;this.url=i.src;const r=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,this.createBitmap?e(this.process()):e(this))};i.complete&&i.src?r():(i.onload=r,i.onerror=e=>{t(e),this.onError.emit(e)})}))),this._load}process(){const e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,i=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then((e=>e.blob())).then((i=>t(i,0,0,e.width,e.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===m.UNPACK?"premultiply":"none"}))).then((e=>this.destroyed?Promise.reject():(this.bitmap=e,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(e,t,i){if("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,i,this.bitmap),!this.preserveBitmap){let e=!0;const r=t._glTextures;for(const o in r){const s=r[o];if(s!==i&&s.dirtyId!==t.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return"undefined"!=typeof HTMLImageElement&&("string"==typeof e||e instanceof HTMLImageElement)}}class Ti{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,i){const r=t.width,o=t.height;if(i){const t=e.width/2/r,s=e.height/2/o,n=e.x/r+t,l=e.y/o+s;i=Gt.add(i,Gt.NW),this.x0=n+t*Gt.uX(i),this.y0=l+s*Gt.uY(i),i=Gt.add(i,2),this.x1=n+t*Gt.uX(i),this.y1=l+s*Gt.uY(i),i=Gt.add(i,2),this.x2=n+t*Gt.uX(i),this.y2=l+s*Gt.uY(i),i=Gt.add(i,2),this.x3=n+t*Gt.uX(i),this.y3=l+s*Gt.uY(i)}else this.x0=e.x/r,this.y0=e.y/o,this.x1=(e.x+e.width)/r,this.y1=e.y/o,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/o,this.x3=e.x/r,this.y3=(e.y+e.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const Ei=new Ti;function Ai(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class Pi extends G{constructor(e,t,i,r,o,s,n){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new At(0,0,1,1)),e instanceof Pi&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=r,this.valid=!1,this._uvs=Ei,this.uvMatrix=null,this.orig=i||t,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new Tt(s.x,s.y):new Tt(0,0),this.defaultBorders=n,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:e}=this.baseTexture;e?.url&&Ue[e.url]&&Pi.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Pi.removeFromCache(this),this.textureCacheIds=null}clone(){const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),i=new Pi(this.baseTexture,!this.noFrame&&e,t,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===Ei&&(this._uvs=new Ti),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},i=x.STRICT_TEXTURE_CACHE){const r="string"==typeof e;let o=null;if(r)o=e;else if(e instanceof dt){if(!e.cacheId){const i=t?.pixiIdPrefix||"pixiid";e.cacheId=`${i}-${Ne()}`,dt.addToCache(e,e.cacheId)}o=e.cacheId}else{if(!e._pixiId){const i=t?.pixiIdPrefix||"pixiid";e._pixiId=`${i}_${Ne()}`}o=e._pixiId}let s=Ue[o];if(r&&i&&!s)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return s||e instanceof dt?!s&&e instanceof dt&&(s=new Pi(e),Pi.addToCache(s,o)):(t.resolution||(t.resolution=Ye(e)),s=new Pi(new dt(e,t)),s.baseTexture.cacheId=o,dt.addToCache(s.baseTexture,o),Pi.addToCache(s,o)),s}static fromURL(e,t){const i=Object.assign({autoLoad:!1},t?.resourceOptions),r=Pi.from(e,Object.assign({resourceOptions:i},t),!1),o=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):o.load().then((()=>Promise.resolve(r)))}static fromBuffer(e,t,i,r){return new Pi(dt.fromBuffer(e,t,i,r))}static fromLoader(e,t,i,r){const o=new dt(e,Object.assign({scaleMode:dt.defaultOptions.scaleMode,resolution:Ye(t)},r)),{resource:s}=o;s instanceof Si&&(s.url=t);const n=new Pi(o);return i||(i=t),dt.addToCache(n.baseTexture,i),Pi.addToCache(n,i),i!==t&&(dt.addToCache(n.baseTexture,t),Pi.addToCache(n,t)),n.baseTexture.valid?Promise.resolve(n):new Promise((e=>{n.baseTexture.once("loaded",(()=>e(n)))}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Ue[t]&&Ue[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),Ue[t]=e)}static removeFromCache(e){if("string"==typeof e){const t=Ue[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete Ue[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)Ue[e.textureCacheIds[t]]===e&&delete Ue[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:i,width:r,height:o}=e,s=t+r>this.baseTexture.width,n=i+o>this.baseTexture.height;if(s||n){const e=s&&n?"and":"or",l=`X: ${t} + ${r} = ${t+r} > ${this.baseTexture.width}`,a=`Y: ${i} + ${o} = ${i+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${e} ${a}`)}this.valid=r&&o&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Pi._EMPTY||(Pi._EMPTY=new Pi(new dt),Ai(Pi._EMPTY),Ai(Pi._EMPTY.baseTexture)),Pi._EMPTY}static get WHITE(){if(!Pi._WHITE){const e=x.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),Pi._WHITE=new Pi(dt.from(e)),Ai(Pi._WHITE),Ai(Pi._WHITE.baseTexture)}return Pi._WHITE}}class Ci extends Pi{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,i=!0){const r=this.baseTexture.resolution,o=Math.round(e*r)/r,s=Math.round(t*r)/r;this.valid=o>0&&s>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=s,i&&this.baseTexture.resize(o,s),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new Ci(new _i(e))}}class ki{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,i=F.NONE){const r=new _i(Object.assign({width:e,height:t,resolution:1,multisample:i},this.textureOptions));return new Ci(r)}getOptimalTexture(e,t,i=1,r=F.NONE){let o;e=Math.ceil(e*i-1e-6),t=Math.ceil(t*i-1e-6),this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight?o=r>1?-r:-1:(o=((65535&(e=Be(e)))<<16|65535&(t=Be(t)))>>>0,r>1&&(o+=4294967296*r)),this.texturePool[o]||(this.texturePool[o]=[]);let s=this.texturePool[o].pop();return s||(s=this.createTexture(e,t,r)),s.filterPoolKey=o,s.setResolution(i),s}getFilterTexture(e,t,i){const r=this.getOptimalTexture(e.width,e.height,t||e.resolution,i||F.NONE);return r.filterFrame=e.filterFrame,r}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=!1!==e)for(const e in this.texturePool){const t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0)}this.texturePool={}}setScreenSize(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){this.enableFullScreen=e.width>0&&e.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}ki.SCREEN_KEY=-1;class Bi extends yt{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Mi extends yt{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new mt(this.vertices),this.uvBuffer=new mt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+t.width/e.width,this.uvs[3]=r,this.uvs[4]=i+t.width/e.width,this.uvs[5]=r+t.height/e.height,this.uvs[6]=i,this.uvs[7]=r+t.height/e.height,i=t.x,r=t.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+t.width,this.vertices[3]=r,this.vertices[4]=i+t.width,this.vertices[5]=r+t.height,this.vertices[6]=i,this.vertices[7]=r+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Ri{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=F.NONE,this.sourceFrame=new At,this.destinationFrame=new At,this.bindingSourceFrame=new At,this.bindingDestinationFrame=new At,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Ii=[new Tt,new Tt,new Tt,new Tt],Di=new Mt;class Oi{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new ki,this.statePool=[],this.quad=new Bi,this.quadUv=new Mi,this.tempRect=new At,this.activeState={},this.globalUniforms=new li({outputFrame:new At,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const i=this.renderer,r=this.defaultFilterStack,o=this.statePool.pop()||new Ri,s=this.renderer.renderTexture;let n=t[0].resolution,l=t[0].multisample,a=t[0].padding,h=t[0].autoFit,d=t[0].legacy??!0;for(let e=1;e<t.length;e++){const i=t[e];n=Math.min(n,i.resolution),l=Math.min(l,i.multisample),a=this.useMaxPadding?Math.max(a,i.padding):a+i.padding,h=h&&i.autoFit,d=d||(i.legacy??!0)}1===r.length&&(this.defaultFilterStack[0].renderTexture=s.current),r.push(o),o.resolution=n,o.multisample=l,o.legacy=d,o.target=e,o.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),o.sourceFrame.pad(a);const c=this.tempRect.copyFrom(s.sourceFrame);i.projection.transform&&this.transformAABB(Di.copyFrom(i.projection.transform).invert(),c),h?(o.sourceFrame.fit(c),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(c)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,n,l),o.filters=t,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;const u=this.tempRect;u.x=0,u.y=0,u.width=o.sourceFrame.width,u.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(s.sourceFrame),o.bindingDestinationFrame.copyFrom(s.destinationFrame),o.transform=i.projection.transform,i.projection.transform=null,s.bind(o.renderTexture,o.sourceFrame,u),i.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),i=t.filters;this.activeState=t;const r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;const o=r.inputSize,s=r.inputPixel,n=r.inputClamp;if(o[0]=t.destinationFrame.width,o[1]=t.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],s[0]=Math.round(o[0]*t.resolution),s[1]=Math.round(o[1]*t.resolution),s[2]=1/s[0],s[3]=1/s[1],n[0]=.5*s[2],n[1]=.5*s[3],n[2]=t.sourceFrame.width*o[2]-.5*s[2],n[3]=t.sourceFrame.height*o[3]-.5*s[3],t.legacy){const e=r.filterArea;e[0]=t.destinationFrame.width,e[1]=t.destinationFrame.height,e[2]=t.sourceFrame.x,e[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,t.renderTexture,l.renderTexture,p.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let e=t.renderTexture,r=this.getOptimalFilterTexture(e.width,e.height,t.resolution);r.filterFrame=e.filterFrame;let o=0;for(o=0;o<i.length-1;++o){1===o&&t.multisample>1&&(r=this.getOptimalFilterTexture(e.width,e.height,t.resolution),r.filterFrame=e.filterFrame),i[o].apply(this,e,r,p.CLEAR,t);const s=e;e=r,r=s}i[o].apply(this,e,l.renderTexture,p.BLEND,t),o>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(e),this.returnFilterTexture(r)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=p.CLEAR){const{renderTexture:i,state:r}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e?.filterFrame){const t=this.tempRect;t.x=0,t.y=0,t.width=e.filterFrame.width,t.height=e.filterFrame.height,i.bind(e,e.filterFrame,t)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const o=1&r.stateId||this.forceClear;(t===p.CLEAR||t===p.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,i,r){const o=this.renderer;o.state.set(e.state),this.bindAndClear(i,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(s.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(s.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:o}=t._texture,s=e.set(r.width,0,0,r.height,i.x,i.y),n=t.worldTransform.copyTo(Mt.TEMP_MATRIX);return n.invert(),s.prepend(n),s.scale(1/o.width,1/o.height),s.translate(t.anchor.x,t.anchor.y),s}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,i=1,r=F.NONE){return this.texturePool.getOptimalTexture(e,t,i,r)}getFilterTexture(e,t,i){if("number"==typeof e){const i=e;e=t,t=i}e=e||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,i||F.NONE);return r.filterFrame=e.filterFrame,r}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const i=Ii[0],r=Ii[1],o=Ii[2],s=Ii[3];i.set(t.left,t.top),r.set(t.left,t.bottom),o.set(t.right,t.top),s.set(t.right,t.bottom),e.apply(i,i),e.apply(r,r),e.apply(o,o),e.apply(s,s);const n=Math.min(i.x,r.x,o.x,s.x),l=Math.min(i.y,r.y,o.y,s.y),a=Math.max(i.x,r.x,o.x,s.x),h=Math.max(i.y,r.y,o.y,s.y);t.x=n,t.y=l,t.width=a-n,t.height=h-l}roundFrame(e,t,i,r,o){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(o){const{a:e,b:t,c:i,d:r}=o;if((Math.abs(t)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4))return}(o=o?Di.copyFrom(o):Di.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(o,e),e.ceil(t),this.transformAABB(o.invert(),e)}}}Oi.extension={type:qe.RendererSystem,name:"filter"},Je.add(Oi);class Ni{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=F.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Li=new At;class zi{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new xi(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new At,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let i=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;x.PREFER_ENV===e.WEBGL_LEGACY&&(i=null,r=null),i?t.drawBuffers=e=>i.drawBuffersWEBGL(e):(this.hasMRT=!1,t.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(e,t,i=0){const{gl:r}=this;if(e){const o=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,o.mipLevel=i),o.dirtyId!==e.dirtyId&&(o.dirtyId=e.dirtyId,o.dirtyFormat!==e.dirtyFormat?(o.dirtyFormat=e.dirtyFormat,o.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):o.dirtySize!==e.dirtySize&&(o.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let t=0;t<e.colorTextures.length;t++){const i=e.colorTextures[t];this.renderer.texture.unbind(i.parentTextureArray||i)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const e=t.width>>i,r=t.height>>i,o=e/t.width;this.setViewport(t.x*o,t.y*o,e,r)}else{const t=e.width>>i,r=e.height>>i;this.setViewport(0,0,t,r)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,i,r){const o=this.viewport;e=Math.round(e),t=Math.round(t),i=Math.round(i),r=Math.round(r),o.width===i&&o.height===r&&o.x===e&&o.y===t||(o.x=e,o.y=t,o.width=i,o.height=r,this.gl.viewport(e,t,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,i,o,s=r.COLOR|r.DEPTH){const{gl:n}=this;n.clearColor(e,t,i,o),n.clear(s)}initFramebuffer(e){const{gl:t}=this,i=new Ni(t.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){const{gl:t}=this,i=e.glFramebuffers[this.CONTEXT_UID];i.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,i.stencil),i.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));const r=e.colorTextures;let o=r.length;t.drawBuffers||(o=Math.min(o,1));for(let s=0;s<o;s++){const o=r[s],n=o.parentTextureArray||o;this.renderer.texture.bind(n,0),0===s&&i.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,i.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,n._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:i}=this,r=e.glFramebuffers[this.CONTEXT_UID],o=e.colorTextures;let s=o.length;i.drawBuffers||(s=Math.min(s,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const n=[];for(let l=0;l<s;l++){const s=o[l],a=s.parentTextureArray||s;this.renderer.texture.bind(a,0),0===l&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,s.target,a._glTextures[this.CONTEXT_UID].texture,t),n.push(i.COLOR_ATTACHMENT0+l))}if(n.length>1&&i.drawBuffers(n),e.depthTexture&&this.writeDepthTexture){const r=e.depthTexture;this.renderer.texture.bind(r,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,r._glTextures[this.CONTEXT_UID].texture,t)}!e.stencil&&!e.depth||e.depthTexture&&this.writeDepthTexture?r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null):(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil))}canMultisampleFramebuffer(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let i=F.NONE;if(e<=1||null===t)return i;for(let r=0;r<t.length;r++)if(t[r]<=e){i=t[r];break}return 1===i&&(i=F.NONE),i}blit(e,t,i){const{current:r,renderer:o,gl:s,CONTEXT_UID:n}=this;if(2!==o.context.webGLVersion)return;if(!r)return;const l=r.glFramebuffers[n];if(!l)return;if(!e){if(!l.msaaBuffer)return;const t=r.colorTextures[0];if(!t)return;l.blitFramebuffer||(l.blitFramebuffer=new xi(r.width,r.height),l.blitFramebuffer.addColorTexture(0,t)),(e=l.blitFramebuffer).colorTextures[0]!==t&&(e.colorTextures[0]=t,e.dirtyId++,e.dirtyFormat++),e.width===r.width&&e.height===r.height||(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}t||((t=Li).width=r.width,t.height=r.height),i||(i=t);const a=t.width===i.width&&t.height===i.height;this.bind(e),s.bindFramebuffer(s.READ_FRAMEBUFFER,l.framebuffer),s.blitFramebuffer(t.left,t.top,t.right,t.bottom,i.left,i.top,i.right,i.bottom,s.COLOR_BUFFER_BIT,a?s.NEAREST:s.LINEAR),s.bindFramebuffer(s.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){const i=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];const o=this.managedFramebuffers.indexOf(e);o>=0&&this.managedFramebuffers.splice(o,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,t)}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil)return;e.stencil=!0;const i=e.width,r=e.height,o=this.gl,s=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,s),t.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,t.multisample,o.DEPTH24_STENCIL8,i,r):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,i,r),t.stencil=s,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,s)}reset(){this.current=this.unknownFramebuffer,this.viewport=new At}destroy(){this.renderer=null}}zi.extension={type:qe.RendererSystem,name:"framebuffer"},Je.add(zi);const Gi={5126:4,5123:2,5121:1};class Ui{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,i=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==i.webGLVersion){let i=this.renderer.context.extensions.vertexArrayObject;x.PREFER_ENV===e.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=e=>i.bindVertexArrayOES(e),t.deleteVertexArray=e=>i.deleteVertexArrayOES(e)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(2!==i.webGLVersion){const e=t.getExtension("ANGLE_instanced_arrays");e?(t.vertexAttribDivisor=(t,i)=>e.vertexAttribDivisorANGLE(t,i),t.drawElementsInstanced=(t,i,r,o,s)=>e.drawElementsInstancedANGLE(t,i,r,o,s),t.drawArraysInstanced=(t,i,r,o)=>e.drawArraysInstancedANGLE(t,i,r,o)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===i.webGLVersion||!!i.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:i}=this;let r=e.glVertexArrayObjects[this.CONTEXT_UID],o=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},o=!0);const s=r[t.program.id]||this.initGeometryVao(e,t,o);this._activeGeometry=e,this._activeVao!==s&&(this._activeVao=s,this.hasVao?i.bindVertexArray(s):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){const r=e.buffers[i];t.update(r)}}checkCompatibility(e,t){const i=e.attributes,r=t.attributeData;for(const e in r)if(!i[e])throw new Error(`shader and geometry incompatible, geometry missing the "${e}" attribute`)}getSignature(e,t){const i=e.attributes,r=t.attributeData,o=["g",e.id];for(const e in i)r[e]&&o.push(e,r[e].location);return o.join("-")}initGeometryVao(e,t,i=!0){const r=this.gl,o=this.CONTEXT_UID,s=this.renderer.buffer,n=t.program;n.glPrograms[o]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,n);const l=this.getSignature(e,n),a=e.glVertexArrayObjects[this.CONTEXT_UID];let h=a[l];if(h)return a[n.id]=h,h;const d=e.buffers,c=e.attributes,u={},m={};for(const e in d)u[e]=0,m[e]=0;for(const e in c)!c[e].size&&n.attributeData[e]?c[e].size=n.attributeData[e].size:c[e].size||console.warn(`PIXI Geometry attribute '${e}' size cannot be determined (likely the bound shader does not have the attribute)`),u[c[e].buffer]+=c[e].size*Gi[c[e].type];for(const e in c){const t=c[e],i=t.size;void 0===t.stride&&(u[t.buffer]===i*Gi[t.type]?t.stride=0:t.stride=u[t.buffer]),void 0===t.start&&(t.start=m[t.buffer],m[t.buffer]+=i*Gi[t.type])}h=r.createVertexArray(),r.bindVertexArray(h);for(let e=0;e<d.length;e++){const t=d[e];s.bind(t),i&&t._glBuffers[o].refCount++}return this.activateVao(e,n),a[n.id]=h,a[l]=h,r.bindVertexArray(null),s.unbind(y.ARRAY_BUFFER),h}disposeGeometry(e,t){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const i=e.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,o=e.buffers,s=this.renderer?.buffer;if(e.disposeRunner.remove(this),i){if(s)for(let e=0;e<o.length;e++){const i=o[e]._glBuffers[this.CONTEXT_UID];i&&(i.refCount--,0!==i.refCount||t||s.dispose(o[e],t))}if(!t)for(const e in i)if("g"===e[0]){const t=i[e];this._activeVao===t&&this.unbind(),r.deleteVertexArray(t)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e)}activateVao(e,t){const i=this.gl,r=this.CONTEXT_UID,o=this.renderer.buffer,s=e.buffers,n=e.attributes;e.indexBuffer&&o.bind(e.indexBuffer);let l=null;for(const e in n){const a=n[e],h=s[a.buffer],d=h._glBuffers[r];if(t.attributeData[e]){l!==d&&(o.bind(h),l=d);const r=t.attributeData[e].location;if(i.enableVertexAttribArray(r),i.vertexAttribPointer(r,a.size,a.type||i.FLOAT,a.normalized,a.stride,a.start),a.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(r,a.divisor)}}}}draw(e,t,i,r){const{gl:o}=this,s=this._activeGeometry;if(s.indexBuffer){const n=s.indexBuffer.data.BYTES_PER_ELEMENT,l=2===n?o.UNSIGNED_SHORT:o.UNSIGNED_INT;2===n||4===n&&this.canUseUInt32ElementIndex?s.instanced?o.drawElementsInstanced(e,t||s.indexBuffer.data.length,l,(i||0)*n,r||1):o.drawElements(e,t||s.indexBuffer.data.length,l,(i||0)*n):console.warn("unsupported index buffer type: uint32")}else s.instanced?o.drawArraysInstanced(e,i,t||s.getSize(),r||1):o.drawArrays(e,i,t||s.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Ui.extension={type:qe.RendererSystem,name:"geometry"},Je.add(Ui);const Hi=new Mt;class Vi{constructor(e,t){this._texture=e,this.mapCoord=new Mt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){void 0===t&&(t=e);const i=this.mapCoord;for(let r=0;r<e.length;r+=2){const o=e[r],s=e[r+1];t[r]=o*i.a+s*i.c+i.tx,t[r+1]=o*i.b+s*i.d+i.ty}return t}update(e){const t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const i=t._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const r=t.orig,o=t.trim;o&&(Hi.set(r.width/o.width,0,0,r.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(Hi));const s=t.baseTexture,n=this.uClampFrame,l=this.clampMargin/s.resolution,a=this.clampOffset;return n[0]=(t._frame.x+l+a)/s.width,n[1]=(t._frame.y+l+a)/s.height,n[2]=(t._frame.x+t._frame.width-l+a)/s.width,n[3]=(t._frame.y+t._frame.height-l+a)/s.height,this.uClampOffset[0]=a/s.realWidth,this.uClampOffset[1]=a/s.realHeight,this.isSimple=t._frame.width===s.width&&t._frame.height===s.height&&0===t.rotate,!0}}class ji extends bi{constructor(e,t,i){let r=null;"string"!=typeof e&&void 0===t&&void 0===i&&(r=e,e=void 0,t=void 0,i=void 0),super(e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",t||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",i),this.maskSprite=r,this.maskMatrix=new Mt}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,i,r){const o=this._maskSprite,s=o._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new Vi(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,o).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,e.applyFilter(this,t,i,r))}}class Wi{constructor(e=null){this.type=g.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=bi.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=g.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Xi{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let i=t;if(!i.isMaskData){const e=this.maskDataPool.pop()||new Wi;e.pooled=!0,e.maskObject=t,i=e}const r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(r),i._colorMask=r?r._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==g.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case g.SCISSOR:this.renderer.scissor.push(i);break;case g.STENCIL:this.renderer.stencil.push(i);break;case g.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case g.COLOR:this.pushColorMask(i)}i.type===g.SPRITE&&this.maskStack.push(i)}pop(e){const t=this.maskStack.pop();if(t&&t._target===e){if(t.enabled)switch(t.type){case g.SCISSOR:this.renderer.scissor.pop(t);break;case g.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case g.SPRITE:this.popSpriteMask(t);break;case g.COLOR:this.popColorMask(t)}if(t.reset(),t.pooled&&this.maskDataPool.push(t),0!==this.maskStack.length){const e=this.maskStack[this.maskStack.length-1];e.type===g.SPRITE&&e._filters&&(e._filters[0].maskSprite=e.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=g.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=g.SCISSOR:e.type=g.STENCIL:e.type=g.COLOR}pushSpriteMask(e){const{maskObject:t}=e,i=e._target;let r=e._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new ji]));const o=this.renderer,s=o.renderTexture;let n,l;if(s.current){const t=s.current;n=e.resolution||t.resolution,l=e.multisample??t.multisample}else n=e.resolution||o.resolution,l=e.multisample??o.multisample;r[0].resolution=n,r[0].multisample=l,r[0].maskSprite=t;const a=i.filterArea;i.filterArea=t.getBounds(!0),o.filter.push(i,r),i.filterArea=a,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,i=e._colorMask=t&e.colorMask;i!==t&&this.renderer.gl.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))}popColorMask(e){const t=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==t&&this.renderer.gl.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))}destroy(){this.renderer=null}}Xi.extension={type:qe.RendererSystem,name:"mask"},Je.add(Xi);class $i{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,i=this.getStackLength();this.maskStack=e;const r=this.getStackLength();r!==i&&(0===r?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Yi=new Mt,qi=[],Zi=class extends $i{constructor(e){super(e),this.glConst=x.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:i}=e,{renderer:r}=this,o=r.renderTexture,s=i.getBounds(!0,qi.pop()??new At);this.roundFrameToPixels(s,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),t&&s.fit(t),e._scissorRectLocal=s}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:i,c:r,d:o}=e;return(Math.abs(i)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(o)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect())return!1;if(Zi.isMatrixRotated(t.worldTransform))return!1;if(Zi.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const i=e._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(e,t,i,r,o){Zi.isMatrixRotated(o)||((o=o?Yi.copyFrom(o):Yi.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(o,e),e.fit(r),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&qi.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};let Ki=Zi;Ki.extension={type:qe.RendererSystem,name:"scissor"},Je.add(Ki);class Ji extends $i{constructor(e){super(e),this.glConst=x.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:i}=this.renderer,r=e._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;const o=e._colorMask;0!==o&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==o&&(e._colorMask=o,i.colorMask(0!=(1&o),0!=(2&o),0!=(4&o),0!=(8&o))),this._useCurrent()}pop(e){const t=this.renderer.gl;if(0===this.getStackLength())t.disable(t.STENCIL_TEST);else{const i=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;0!==r&&(i._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==r&&(i._colorMask=r,t.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}Ji.extension={type:qe.RendererSystem,name:"stencil"},Je.add(Ji);class Qi{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(Y("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract)},prepare:{enumerable:!1,get:()=>(Y("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare)},interaction:{enumerable:!1,get:()=>(Y("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events)}})}init(){const e=this.rendererPlugins;for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}Qi.extension={type:[qe.RendererSystem,qe.CanvasRendererSystem],name:"_plugin"},Je.add(Qi);class er{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Mt,this.transform=null}update(e,t,i,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);const o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(e,t,i,r){const o=this.projectionMatrix,s=r?-1:1;o.identity(),o.a=1/t.width*2,o.d=s*(1/t.height*2),o.tx=-1-t.x*o.a,o.ty=-s-t.y*o.d}setTransform(e){}destroy(){this.renderer=null}}er.extension={type:qe.RendererSystem,name:"projection"},Je.add(er);const tr=new Vt;class ir{constructor(e){this.renderer=e,this._tempMatrix=new Mt}generateTexture(e,t){const{region:i,...r}=t||{},o=i||e.getLocalBounds(null,!0);0===o.width&&(o.width=1),0===o.height&&(o.height=1);const s=Ci.create({width:o.width,height:o.height,...r});this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;const n=e.transform;return e.transform=tr,this.renderer.render(e,{renderTexture:s,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=n,s}destroy(){}}ir.extension={type:[qe.RendererSystem,qe.CanvasRendererSystem],name:"textureGenerator"},Je.add(ir);const rr=new At,or=new At;class sr{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new At,this.destinationFrame=new At,this.viewportFrame=new At}contextChange(){const e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,i){const r=this.renderer;let o,s,n;this.current=e,e?(o=e.baseTexture,n=o.resolution,t||(rr.width=e.frame.width,rr.height=e.frame.height,t=rr),i||(or.x=e.frame.x,or.y=e.frame.y,or.width=t.width,or.height=t.height,i=or),s=o.framebuffer):(n=r.resolution,t||(rr.width=r._view.screen.width,rr.height=r._view.screen.height,t=rr),i||((i=rr).width=t.width,i.height=t.height));const l=this.viewportFrame;l.x=i.x*n,l.y=i.y*n,l.width=i.width*n,l.height=i.height*n,e||(l.y=r.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(s,l),this.renderer.projection.update(i,t,n,!s),e?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(i)}clear(e,t){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=Te.shared.setValue(e||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const o=this.destinationFrame,s=this.current?this.current.baseTexture:this.renderer._view.screen,n=o.width!==s.width||o.height!==s.height;if(n){let{x:e,y:t,width:i,height:r}=this.viewportFrame;e=Math.round(e),t=Math.round(t),i=Math.round(i),r=Math.round(r),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(e,t,i,r)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,t),n&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}sr.extension={type:qe.RendererSystem,name:"renderTexture"},Je.add(sr);class nr{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function lr(e,t,i){const r=e.createShader(t);return e.shaderSource(r,i),e.compileShader(r),r}function ar(e){const t=new Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return t}function hr(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return ar(2*t);case"bvec3":return ar(3*t);case"bvec4":return ar(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function dr(e,t){const i=e.getShaderSource(t).split("\n").map(((e,t)=>`${t}: ${e}`)),r=e.getShaderInfoLog(t),o=r.split("\n"),s={},n=o.map((e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((e=>!(!e||s[e]||(s[e]=!0,0)))),l=[""];n.forEach((e=>{i[e-1]=`%c${i[e-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const a=i.join("\n");l[0]=a,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function cr(e,t,i,r,o){i.buffer.update(o)}const ur={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},mr={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};let pr,br=0;const fr={textureCount:0,uboCount:0};class gr{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=br++}systemCheck(){if(!function(){if("boolean"==typeof pr)return pr;try{const e=new Function("param1","param2","param3","return param1[param2] === param3;");pr=!0===e({a:"b"},"a","b")}catch(e){pr=!1}return pr}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const i=e.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),t||(fr.textureCount=0,fr.uboCount=0,this.syncUniformGroup(e.uniformGroup,fr)),r}setUniforms(e){const t=this.shader.program,i=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,t){const i=this.getGlProgram();e.static&&e.dirtyId===i.uniformDirtyGroups[e.id]||(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,t))}syncUniforms(e,t,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=function(e,t){const i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const r in e.uniforms){const o=t[r];if(!o){e.uniforms[r]?.group&&(e.uniforms[r].ubo?i.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');\n                    `):i.push(`\n                        renderer.shader.syncUniformGroup(uv.${r}, syncData);\n                    `));continue}const s=e.uniforms[r];let n=!1;for(let e=0;e<jt.length;e++)if(jt[e].test(o,s)){i.push(jt[e].code(r,s)),n=!0;break}if(!n){const e=(1!==o.size||o.isArray?Xt:Wt)[o.type].replace("location",`ud["${r}"].location`);i.push(`\n            cu = ud["${r}"];\n            cv = cu.value;\n            v = uv["${r}"];\n            ${e};`)}}return new Function("ud","uv","renderer","syncData",i.join("\n"))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const i=this.getGlProgram();if(!e.static||0!==e.dirtyId||!i.uniformGroups[e.id]){e.dirtyId=0;const r=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t);e.buffer.update(),r(i.uniformData,e.uniforms,this.renderer,fr,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])}createSyncBufferGroup(e,t,i){const{gl:r}=this.renderer;this.renderer.buffer.bind(e.buffer);const o=this.gl.getUniformBlockIndex(t.program,i);t.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;const s=this.getSignature(e,this.shader.program.uniformData,"ubo");let n=this._uboCache[s];if(n||(n=this._uboCache[s]=function(e,t){if(!e.autoManage)return{size:0,syncFunc:cr};const i=function(e,t){const i=[];for(const r in e)t[r]&&i.push(t[r]);return i.sort(((e,t)=>e.index-t.index)),i}(e.uniforms,t),{uboElements:r,size:o}=function(e){const t=e.map((e=>({data:e,offset:0,dataLen:0,dirty:0})));let i=0,r=0,o=0;for(let e=0;e<t.length;e++){const s=t[e];if(i=mr[s.data.type],s.data.size>1&&(i=Math.max(i,16)*s.data.size),s.dataLen=i,r%i!=0&&r<16){const e=r%i%16;r+=e,o+=e}r+i>16?(o=16*Math.ceil(o/16),s.offset=o,o+=i,r=i):(s.offset=o,r+=i,o+=i)}return o=16*Math.ceil(o/16),{uboElements:t,size:o}}(i),s=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let t=0;t<r.length;t++){const i=r[t],o=e.uniforms[i.data.name],n=i.data.name;let l=!1;for(let e=0;e<jt.length;e++){const t=jt[e];if(t.codeUbo&&t.test(i.data,o)){s.push(`offset = ${i.offset/4};`,jt[e].codeUbo(i.data.name,o)),l=!0;break}}if(!l)if(i.data.size>1){const e=Kt(i.data.type),t=Math.max(mr[i.data.type]/16,1),r=e/t,o=(4-r%4)%4;s.push(`\n                cv = ud.${n}.value;\n                v = uv.${n};\n                offset = ${i.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${i.data.size*t}; i++)\n                {\n                    for(var j = 0; j < ${r}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${o};\n                }\n\n                `)}else{const e=ur[i.data.type];s.push(`\n                cv = ud.${n}.value;\n                v = uv.${n};\n                offset = ${i.offset/4};\n                ${e};\n                `)}}return s.push("\n       renderer.buffer.update(buffer);\n    "),{size:o,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join("\n"))}}(e,this.shader.program.uniformData)),e.autoManage){const t=new Float32Array(n.size/4);e.buffer.update(t)}return t.uniformGroups[e.id]=n.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,i){const r=e.uniforms,o=[`${i}-`];for(const e in r)o.push(e),t[e]&&o.push(t[e].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,i=e.program,r=function(e,t){const i=lr(e,e.VERTEX_SHADER,t.vertexSrc),r=lr(e,e.FRAGMENT_SHADER,t.fragmentSrc),o=e.createProgram();e.attachShader(o,i),e.attachShader(o,r);const s=t.extra?.transformFeedbackVaryings;if(s&&("function"!=typeof e.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(o,s.names,"separate"===s.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||function(e,t,i,r){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(i,e.COMPILE_STATUS)||dr(e,i),e.getShaderParameter(r,e.COMPILE_STATUS)||dr(e,r),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}(e,o,i,r),t.attributeData=function(e,t){const i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let o=0;o<r;o++){const r=t.getActiveAttrib(e,o);if(r.name.startsWith("gl_"))continue;const s=ei(t,r.type),n={type:s,name:r.name,size:Kt(s),location:t.getAttribLocation(e,r.name)};i[r.name]=n}return i}(o,e),t.uniformData=function(e,t){const i={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let o=0;o<r;o++){const r=t.getActiveUniform(e,o),s=r.name.replace(/\[.*?\]$/,""),n=!!r.name.match(/\[.*?\]$/),l=ei(t,r.type);i[s]={name:s,index:o,type:l,size:r.size,isArray:n,value:hr(l,r.size)}}return i}(o,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const i=Object.keys(t.attributeData);i.sort(((e,t)=>e>t?1:-1));for(let r=0;r<i.length;r++)t.attributeData[i[r]].location=r,e.bindAttribLocation(o,r,i[r]);e.linkProgram(o)}e.deleteShader(i),e.deleteShader(r);const n={};for(const i in t.uniformData){const r=t.uniformData[i];n[i]={location:e.getUniformLocation(o,i),value:hr(r.type,r.size)}}return new nr(o,n)}(t,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}gr.extension={type:qe.RendererSystem,name:"shader"},Je.add(gr);class Fr{constructor(e){this.renderer=e}run(e){const{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.2.4 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}Fr.defaultOptions={hello:!1},Fr.extension={type:[qe.RendererSystem,qe.CanvasRendererSystem],name:"startup"},Je.add(Fr);const yr=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=o.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new it,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=function(e,t=[]){return t[o.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.ADD]=[e.ONE,e.ONE],t[o.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.NONE]=[0,0],t[o.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[o.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[o.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[o.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[o.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[o.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[o.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[o.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[o.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[o.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,i=0;for(;t;)1&t&&this.map[i].call(this,!!(e.data&1<<i)),t>>=1,i++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(yr.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(yr.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],i=this.gl;2===t.length?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const i=this.checks.indexOf(e);t&&-1===i?this.checks.push(e):t||-1===i||this.checks.splice(i,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let vr=yr;vr.extension={type:qe.RendererSystem,name:"state"},Je.add(vr);class xr extends G{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter((t=>e.systems[t])),i=[...t,...Object.keys(e.systems).filter((e=>!t.includes(e)))];for(const t of i)this.addSystem(e.systems[t],t)}addRunners(...e){e.forEach((e=>{this.runners[e]=new st(e)}))}addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const e in this.runners)this.runners[e].add(i);return this}emitWithCustomOptions(e,t){const i=Object.keys(this._systemsHash);e.items.forEach((r=>{const o=i.find((e=>this._systemsHash[e]===r));r[e.name](t[o])}))}destroy(){Object.values(this.runners).forEach((e=>{e.destroy()})),this._systemsHash={}}}const _r=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=_r.defaultMaxIdle,this.checkCountMax=_r.defaultCheckCountMax,this.mode=_r.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==b.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let i=!1;for(let r=0;r<t.length;r++){const o=t[r];!o.framebuffer&&this.count-o.touched>this.maxIdle&&(e.destroyTexture(o,!0),t[r]=null,i=!0)}if(i){let e=0;for(let i=0;i<t.length;i++)null!==t[i]&&(t[e++]=t[i]);t.length=e}}unload(e){const t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(let t=e.children.length-1;t>=0;t--)this.unload(e.children[t])}destroy(){this.renderer=null}};let wr=_r;wr.defaultMode=b.AUTO,wr.defaultMaxIdle=3600,wr.defaultCheckCountMax=600,wr.extension={type:qe.RendererSystem,name:"textureGC"},Je.add(wr);class Sr{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=a.UNSIGNED_BYTE,this.internalFormat=n.RGBA,this.samplerType=0}}class Tr{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new dt,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(e){let t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[a.UNSIGNED_BYTE]:{[n.RGBA]:e.RGBA8,[n.RGB]:e.RGB8,[n.RG]:e.RG8,[n.RED]:e.R8,[n.RGBA_INTEGER]:e.RGBA8UI,[n.RGB_INTEGER]:e.RGB8UI,[n.RG_INTEGER]:e.RG8UI,[n.RED_INTEGER]:e.R8UI,[n.ALPHA]:e.ALPHA,[n.LUMINANCE]:e.LUMINANCE,[n.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[a.BYTE]:{[n.RGBA]:e.RGBA8_SNORM,[n.RGB]:e.RGB8_SNORM,[n.RG]:e.RG8_SNORM,[n.RED]:e.R8_SNORM,[n.RGBA_INTEGER]:e.RGBA8I,[n.RGB_INTEGER]:e.RGB8I,[n.RG_INTEGER]:e.RG8I,[n.RED_INTEGER]:e.R8I},[a.UNSIGNED_SHORT]:{[n.RGBA_INTEGER]:e.RGBA16UI,[n.RGB_INTEGER]:e.RGB16UI,[n.RG_INTEGER]:e.RG16UI,[n.RED_INTEGER]:e.R16UI,[n.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[a.SHORT]:{[n.RGBA_INTEGER]:e.RGBA16I,[n.RGB_INTEGER]:e.RGB16I,[n.RG_INTEGER]:e.RG16I,[n.RED_INTEGER]:e.R16I},[a.UNSIGNED_INT]:{[n.RGBA_INTEGER]:e.RGBA32UI,[n.RGB_INTEGER]:e.RGB32UI,[n.RG_INTEGER]:e.RG32UI,[n.RED_INTEGER]:e.R32UI,[n.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[a.INT]:{[n.RGBA_INTEGER]:e.RGBA32I,[n.RGB_INTEGER]:e.RGB32I,[n.RG_INTEGER]:e.RG32I,[n.RED_INTEGER]:e.R32I},[a.FLOAT]:{[n.RGBA]:e.RGBA32F,[n.RGB]:e.RGB32F,[n.RG]:e.RG32F,[n.RED]:e.R32F,[n.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[a.HALF_FLOAT]:{[n.RGBA]:e.RGBA16F,[n.RGB]:e.RGB16F,[n.RG]:e.RG16F,[n.RED]:e.R16F},[a.UNSIGNED_SHORT_5_6_5]:{[n.RGB]:e.RGB565},[a.UNSIGNED_SHORT_4_4_4_4]:{[n.RGBA]:e.RGBA4},[a.UNSIGNED_SHORT_5_5_5_1]:{[n.RGBA]:e.RGB5_A1},[a.UNSIGNED_INT_2_10_10_10_REV]:{[n.RGBA]:e.RGB10_A2,[n.RGBA_INTEGER]:e.RGB10_A2UI},[a.UNSIGNED_INT_10F_11F_11F_REV]:{[n.RGB]:e.R11F_G11F_B10F},[a.UNSIGNED_INT_5_9_9_9_REV]:{[n.RGB]:e.RGB9_E5},[a.UNSIGNED_INT_24_8]:{[n.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[a.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[n.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:{[a.UNSIGNED_BYTE]:{[n.RGBA]:e.RGBA,[n.RGB]:e.RGB,[n.ALPHA]:e.ALPHA,[n.LUMINANCE]:e.LUMINANCE,[n.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[a.UNSIGNED_SHORT_5_6_5]:{[n.RGB]:e.RGB},[a.UNSIGNED_SHORT_4_4_4_4]:{[n.RGBA]:e.RGBA},[a.UNSIGNED_SHORT_5_5_5_1]:{[n.RGBA]:e.RGBA}},t}(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let e=0;e<t;e++)this.boundTextures[e]=null;this.emptyTextures={};const i=new Sr(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Sr(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let t=0;t<6;t++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let e=0;e<this.boundTextures.length;e++)this.bind(null,e)}bind(e,t=0){const{gl:i}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let e=0;e<i.length;e++)i[e]===this.unknownTexture&&this.bind(null,e)}for(let r=0;r<i.length;r++)i[r]===e&&(this.currentLocation!==r&&(t.activeTexture(t.TEXTURE0+r),this.currentLocation=r),t.bindTexture(e.target,this.emptyTextures[e.target].texture),i[r]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(i)for(let i=e-1;i>=0;--i){const e=t[i];e&&e._glTextures[r].samplerType!==h.FLOAT&&this.renderer.texture.unbind(e)}}initTexture(e){const t=new Sr(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){t.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,2===this.webGLVersion&&e.type===a.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const i=this.renderer;if(this.initTextureType(e,t),e.resource?.upload(i,e,t))t.samplerType!==h.FLOAT&&(this.hasIntegerTextures=!0);else{const r=e.realWidth,o=e.realHeight,s=i.gl;(t.width!==r||t.height!==o||t.dirtyId<0)&&(t.width=r,t.height=o,s.texImage2D(e.target,0,t.internalFormat,r,o,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:i}=this;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const t=this.managedTextures.indexOf(e);-1!==t&&Ie(this.managedTextures,t,1)}}updateTextureStyle(e){const t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==u.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=c.CLAMP,e.resource?.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const i=this.gl;if(t.mipmap&&e.mipmap!==u.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===d.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const t=this.renderer.context.extensions.anisotropicFiltering;if(t&&e.anisotropicLevel>0&&e.scaleMode===d.LINEAR){const r=Math.min(e.anisotropicLevel,i.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===d.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===d.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}Tr.extension={type:qe.RendererSystem,name:"texture"},Je.add(Tr);class Er{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:i,renderer:r}=this;t&&r.shader.bind(t),i.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:i,CONTEXT_UID:r}=this,o=t.createTransformFeedback();e._glTransformFeedbacks[r]=o,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,o);for(let o=0;o<e.buffers.length;o++){const s=e.buffers[o];s&&(i.buffer.update(s),s._glBuffers[r].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,o,s._glBuffers[r].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),o}disposeTransformFeedback(e,t){const i=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);const o=this.renderer.buffer;if(o)for(let i=0;i<e.buffers.length;i++){const r=e.buffers[i];if(!r)continue;const s=r._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0!==s.refCount||t||o.dispose(r,t))}i&&(t||r.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Er.extension={type:qe.RendererSystem,name:"transformFeedback"},Je.add(Er);class Ar{constructor(e){this.renderer=e}init(e){this.screen=new At(0,0,e.width,e.height),this.element=e.view||x.ADAPTER.createCanvas(),this.resolution=e.resolution||x.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}Ar.defaultOptions={width:800,height:600,resolution:x.RESOLUTION,autoDensity:!1},Ar.extension={type:[qe.RendererSystem,qe.CanvasRendererSystem],name:"_view"},Je.add(Ar),x.PREFER_ENV=e.WEBGL2,x.STRICT_TEXTURE_CACHE=!1,x.RENDER_OPTIONS={...yi.defaultOptions,...fi.defaultOptions,...Ar.defaultOptions,...Fr.defaultOptions},Object.defineProperties(x,{WRAP_MODE:{get:()=>dt.defaultOptions.wrapMode,set(e){Y("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),dt.defaultOptions.wrapMode=e}},SCALE_MODE:{get:()=>dt.defaultOptions.scaleMode,set(e){Y("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),dt.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get:()=>dt.defaultOptions.mipmap,set(e){Y("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),dt.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get:()=>dt.defaultOptions.anisotropicLevel,set(e){Y("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),dt.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get:()=>(Y("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),bi.defaultResolution),set(e){bi.defaultResolution=e}},FILTER_MULTISAMPLE:{get:()=>(Y("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),bi.defaultMultisample),set(e){bi.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get:()=>mi.defaultMaxTextures,set(e){Y("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),mi.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get:()=>mi.defaultBatchSize,set(e){Y("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),mi.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get:()=>mi.canUploadSameBuffer,set(e){Y("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),mi.canUploadSameBuffer=e}},GC_MODE:{get:()=>wr.defaultMode,set(e){Y("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),wr.defaultMode=e}},GC_MAX_IDLE:{get:()=>wr.defaultMaxIdle,set(e){Y("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),wr.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get:()=>wr.defaultCheckCountMax,set(e){Y("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),wr.defaultCheckCountMax=e}},PRECISION_VERTEX:{get:()=>si.defaultVertexPrecision,set(e){Y("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),si.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get:()=>si.defaultFragmentPrecision,set(e){Y("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),si.defaultFragmentPrecision=e}}});var Pr=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(Pr||{});class Cr{constructor(e,t=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=i,this.once=r}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const kr=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Cr(null,null,1/0),this.deltaMS=1/kr.targetFPMS,this.elapsedMS=1/kr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=Pr.NORMAL){return this._addListener(new Cr(e,t,i))}addOnce(e,t,i=Pr.NORMAL){return this._addListener(new Cr(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}else e.connect(i);return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i=i.match(e,t)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const t=e-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=e-t%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*kr.targetFPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,kr.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(0===e)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!kr._shared){const e=kr._shared=new kr;e.autoStart=!0,e._protected=!0}return kr._shared}static get system(){if(!kr._system){const e=kr._system=new kr;e.autoStart=!0,e._protected=!0}return kr._system}};let Br=kr;Br.targetFPMS=.06,Object.defineProperties(x,{TARGET_FPMS:{get:()=>Br.targetFPMS,set(e){Y("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Br.targetFPMS=e}}});class Mr{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Pr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Br.shared:new Br,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}Mr.extension=qe.Application,Je.add(Mr);const Rr=[];function Ir(e){for(const t of Rr)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}Je.handleByList(qe.Renderer,Rr);const Dr="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class Or{constructor(e){this.renderer=e}contextChange(e){let t;if(1===this.renderer.context.webGLVersion){const i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{const i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}t>=F.HIGH?this.multisample=F.HIGH:t>=F.MEDIUM?this.multisample=F.MEDIUM:t>=F.LOW?this.multisample=F.LOW:this.multisample=F.NONE}destroy(){}}Or.extension={type:qe.RendererSystem,name:"_multisample"},Je.add(Or);class Nr{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Lr{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glBuffers[i]||this.createGLBuffer(e);t.bindBuffer(e.type,r.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[t]!==e){const o=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[t]=e,i.bindBufferBase(i.UNIFORM_BUFFER,t,o.buffer)}}bindBufferRange(e,t,i){const{gl:r,CONTEXT_UID:o}=this;i=i||0;const s=e._glBuffers[o]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,t||0,s.buffer,256*i,256)}update(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,t.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const i=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,i)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const i=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),i&&(t||r.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let i=0;i<t.length;i++)this.dispose(this.managedBuffers[t[i]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:i}=this;return e._glBuffers[t]=new Nr(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}Lr.extension={type:qe.RendererSystem,name:"buffer"},Je.add(Lr);class zr{constructor(e){this.renderer=e}render(e,t){const i=this.renderer;let r,o,s,n;if(t&&(r=t.renderTexture,o=t.clear,s=t.transform,n=t.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=s,!i.context.isLost){if(r||(this.lastObjectRendered=e),!n){const t=e.enableTempParent();e.updateTransform(),e.disableTempParent(t)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(o??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),r&&(t.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}zr.extension={type:qe.RendererSystem,name:"objectRenderer"},Je.add(zr);const Gr=class extends xr{constructor(e){super(),this.type=t.WEBGL,e=Object.assign({},x.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new li({projectionMatrix:new Mt},!0);const i={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Gr.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(i),"useContextAlpha"in e&&(Y("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&"notMultiplied"!==e.useContextAlpha,e.backgroundAlpha=!1===e.useContextAlpha?1:e.backgroundAlpha),this._plugin.rendererPlugins=Gr.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return!e?.forceCanvas&&(void 0===q&&(q=function(){const e={stencil:!0,failIfMajorPerformanceCaveat:x.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!x.ADAPTER.getWebGLRenderingContext())return!1;const t=x.ADAPTER.createCanvas();let i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const r=!!i?.getContextAttributes()?.stencil;if(i){const e=i.getExtension("WEBGL_lose_context");e&&e.loseContext()}return i=null,r}catch(e){return!1}}()),q)}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Y("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Y("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Y("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Y("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Y("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Y("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Y("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Y("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};let Ur=Gr;Ur.extension={type:qe.Renderer,priority:1},Ur.__plugins={},Ur.__systems={},Je.handleByMap(qe.RendererPlugin,Ur.__plugins),Je.handleByMap(qe.RendererSystem,Ur.__systems),Je.add(Ur);class Hr extends nt{constructor(e,t){const{width:i,height:r}=t||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let t=0;t<e;t++){const e=new dt;this.items.push(e),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof nt?this.addResourceAt(e[i],i):this.addResourceAt(ot(e[i],t),i))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map((e=>e.resource)).filter((e=>e)).map((e=>e.load()));return this._load=Promise.all(e).then((()=>{const{realWidth:e,realHeight:t}=this.items[0];return this.resize(e,t),Promise.resolve(this)})),this._load}}const Vr=class extends Hr{constructor(e,t){const{width:i,height:r,autoLoad:o,linkBaseTexture:s}=t||{};if(e&&e.length!==Vr.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:i,height:r});for(let e=0;e<Vr.SIDES;e++)this.items[e].target=l.TEXTURE_CUBE_MAP_POSITIVE_X+e;this.linkBaseTexture=!1!==s,e&&this.initFromArray(e,t),!1!==o&&this.load()}bind(e){super.bind(e),e.target=l.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,i){if(void 0===i&&(i=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=l.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,i){const r=this.itemDirtyIds;for(let o=0;o<Vr.SIDES;o++){const s=this.items[o];(r[o]<s.dirtyId||i.dirtyId<t.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(e,s,i),r[o]=s.dirtyId):r[o]<-1&&(e.gl.texImage2D(s.target,0,i.internalFormat,t.realWidth,t.realHeight,0,t.format,i.type,null),r[o]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Vr.SIDES}};let jr=Vr;jr.SIDES=6;class Wr extends wi{constructor(e,t){let i,r;t=t||{},"string"==typeof e?(i=Wr.EMPTY,r=e):(i=e,r=null),super(i),this.url=r,this.crossOrigin=t.crossOrigin??!0,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((async(e,t)=>{if(null!==this.url)try{const t=await x.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await t.blob();if(this.destroyed)return;const r=await createImageBitmap(i,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===m.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=r,this.update(),e(this)}catch(e){if(this.destroyed)return;t(e),this.onError.emit(e)}else e(this)}))),this._load}upload(e,t,i){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),super.upload(e,t,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&("string"==typeof e||e instanceof ImageBitmap)}static get EMPTY(){return Wr._EMPTY=Wr._EMPTY??x.ADAPTER.createCanvas(0,0),Wr._EMPTY}}const Xr=class extends wi{constructor(e,t){t=t||{},super(x.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},Xr.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const e=new Image;wi.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,i=e.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=t*this.scale,o=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/i*t,o=this._overrideHeight||this._overrideWidth/t*i),r=Math.round(r),o=Math.round(o);const s=this.source;s.width=r,s.height=o,s._pixiId=`canvas_${Ne()}`,s.getContext("2d").drawImage(e,0,0,t,i,0,0,r,o),this._resolve(),this._resolve=null}}static getSize(e){const t=Xr.SVG_SIZE.exec(e),i={};return t&&(i[t[1]]=Math.round(parseFloat(t[3])),i[t[5]]=Math.round(parseFloat(t[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return"svg"===t||"string"==typeof e&&e.startsWith("data:image/svg+xml")||"string"==typeof e&&Xr.SVG_XML.test(e)}};let $r=Xr;$r.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,$r.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Yr=class extends wi{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]);const r=e[0].src||e[0];wi.crossOrigin(i,r,t.crossorigin);for(let t=0;t<e.length;++t){const r=document.createElement("source");let{src:o,mime:s}=e[t];o=o||e[t];const n=o.split("?").shift().toLowerCase(),l=n.slice(n.lastIndexOf(".")+1);s=s||Yr.MIME_TYPES[l]||`video/${l}`,r.src=o,r.type=s,i.appendChild(r)}e=i}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==t.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==t.autoLoad&&this.load()}update(e=0){if(!this.destroyed){const e=Br.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((t=>{this.valid?t(this):(this._resolve=t,e.load())})),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Br.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Br.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(Br.shared.remove(this.update,this),this._isConnectedToTicker=!1);const e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Br.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Br.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Yr.TYPES.includes(t)}};let qr=Yr;qr.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],qr.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},rt.push(Wr,Si,class extends wi{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return!!(t&&e instanceof t)||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}},qr,$r,lt,jr,class extends Hr{constructor(e,t){const{width:i,height:r}=t||{};let o,s;Array.isArray(e)?(o=e,s=e.length):s=e,super(s,{width:i,height:r}),o&&this.initFromArray(o,t)}addBaseTextureAt(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this}bind(e){super.bind(e),e.target=l.TEXTURE_2D_ARRAY}upload(e,t,i){const{length:r,itemDirtyIds:o,items:s}=this,{gl:n}=e;i.dirtyId<0&&n.texImage3D(n.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,t.format,i.type,null);for(let e=0;e<r;e++){const r=s[e];o[e]<r.dirtyId&&(o[e]=r.dirtyId,r.valid&&n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,e,r.resource.width,r.resource.height,1,t.format,i.type,r.resource.source))}return!0}});class Zr{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?At.EMPTY:((e=e||new At(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:i,b:r,c:o,d:s,tx:n,ty:l}=e,a=i*t.x+o*t.y+n,h=r*t.x+s*t.y+l;this.minX=Math.min(this.minX,a),this.maxX=Math.max(this.maxX,a),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(e){let t=this.minX,i=this.minY,r=this.maxX,o=this.maxY,s=e[0],n=e[1];t=s<t?s:t,i=n<i?n:i,r=s>r?s:r,o=n>o?n:o,s=e[2],n=e[3],t=s<t?s:t,i=n<i?n:i,r=s>r?s:r,o=n>o?n:o,s=e[4],n=e[5],t=s<t?s:t,i=n<i?n:i,r=s>r?s:r,o=n>o?n:o,s=e[6],n=e[7],t=s<t?s:t,i=n<i?n:i,r=s>r?s:r,o=n>o?n:o,this.minX=t,this.minY=i,this.maxX=r,this.maxY=o}addFrame(e,t,i,r,o){this.addFrameMatrix(e.worldTransform,t,i,r,o)}addFrameMatrix(e,t,i,r,o){const s=e.a,n=e.b,l=e.c,a=e.d,h=e.tx,d=e.ty;let c=this.minX,u=this.minY,m=this.maxX,p=this.maxY,b=s*t+l*i+h,f=n*t+a*i+d;c=b<c?b:c,u=f<u?f:u,m=b>m?b:m,p=f>p?f:p,b=s*r+l*i+h,f=n*r+a*i+d,c=b<c?b:c,u=f<u?f:u,m=b>m?b:m,p=f>p?f:p,b=s*t+l*o+h,f=n*t+a*o+d,c=b<c?b:c,u=f<u?f:u,m=b>m?b:m,p=f>p?f:p,b=s*r+l*o+h,f=n*r+a*o+d,c=b<c?b:c,u=f<u?f:u,m=b>m?b:m,p=f>p?f:p,this.minX=c,this.minY=u,this.maxX=m,this.maxY=p}addVertexData(e,t,i){let r=this.minX,o=this.minY,s=this.maxX,n=this.maxY;for(let l=t;l<i;l+=2){const t=e[l],i=e[l+1];r=t<r?t:r,o=i<o?i:o,s=t>s?t:s,n=i>n?i:n}this.minX=r,this.minY=o,this.maxX=s,this.maxY=n}addVertices(e,t,i,r){this.addVerticesMatrix(e.worldTransform,t,i,r)}addVerticesMatrix(e,t,i,r,o=0,s=o){const n=e.a,l=e.b,a=e.c,h=e.d,d=e.tx,c=e.ty;let u=this.minX,m=this.minY,p=this.maxX,b=this.maxY;for(let e=i;e<r;e+=2){const i=t[e],r=t[e+1],f=n*i+a*r+d,g=h*r+l*i+c;u=Math.min(u,f-o),p=Math.max(p,f+o),m=Math.min(m,g-s),b=Math.max(b,g+s)}this.minX=u,this.minY=m,this.maxX=p,this.maxY=b}addBounds(e){const t=this.minX,i=this.minY,r=this.maxX,o=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>o?e.maxY:o}addBoundsMask(e,t){const i=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,o=e.maxX<t.maxX?e.maxX:t.maxX,s=e.maxY<t.maxY?e.maxY:t.maxY;if(i<=o&&r<=s){const e=this.minX,t=this.minY,n=this.maxX,l=this.maxY;this.minX=i<e?i:e,this.minY=r<t?r:t,this.maxX=o>n?o:n,this.maxY=s>l?s:l}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const i=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,o=e.maxX<t.x+t.width?e.maxX:t.x+t.width,s=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(i<=o&&r<=s){const e=this.minX,t=this.minY,n=this.maxX,l=this.maxY;this.minX=i<e?i:e,this.minY=r<t?r:t,this.maxX=o>n?o:n,this.maxY=s>l?s:l}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,i,r,o,s){e-=o,t-=s,i+=o,r+=s,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r}}class Kr extends G{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Vt,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Zr,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let i=0;i<t.length;++i){const r=t[i];Object.defineProperty(Kr.prototype,r,Object.getOwnPropertyDescriptor(e,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new At),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new At),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Zr);const t=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,o=this._boundsID;this._bounds=this._localBounds;const s=this.getBounds(!1,e);return this.parent=i,this.transform=t,this._bounds=r,this._bounds.updateID+=this._boundsID-o,s}toGlobal(e,t,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,i,r){return t&&(e=t.toGlobal(e,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){this.parent?.removeChild(this)}setTransform(e=0,t=0,i=1,r=1,o=0,s=0,n=0,l=0,a=0){return this.position.x=e,this.position.y=t,this.scale.x=i||1,this.scale.y=r||1,this.rotation=o,this.skew.x=s,this.skew.y=n,this.pivot.x=l,this.pivot.y=a,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Jr),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*_t}set angle(e){this.transform.rotation=e*wt}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1))}if(this._mask=e,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(0===e._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class Jr extends Kr{constructor(){super(...arguments),this.sortDirty=null}}Kr.prototype.displayObjectUpdateTransform=Kr.prototype.updateTransform;const Qr=new Mt;function eo(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const to=class extends Kr{constructor(){super(),this.children=[],this.sortableChildren=to.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const i=this.getChildIndex(e),r=this.getChildIndex(t);this.children[i]=t,this.children[r]=e,this.onChildrenChange(i<r?i:r)}getChildIndex(e){const t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(e);Ie(this.children,i,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],i=this.children.indexOf(t);if(-1===i)return null;t.parent=null,t.transform._parentID=-1,Ie(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Ie(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const i=e,r=t-i;let o;if(r>0&&r<=t){o=this.children.splice(i,r);for(let e=0;e<o.length;++e)o[e].parent=null,o[e].transform&&(o[e].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let e=0;e<o.length;++e)o[e].emit("removed",this),this.emit("childRemoved",o[e],this,e);return o}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,i=this.children.length;t<i;++t){const i=this.children[t];i._lastSortedIndex=t,e||0===i.zIndex||(e=!0)}e&&this.children.length>1&&this.children.sort(eo),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const t=this.children[e];t.visible&&t.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(t.visible&&t.renderable)if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const i=super.getLocalBounds(e);if(!t)for(let e=0,t=this.children.length;e<t;++e){const t=this.children[e];t.visible&&t.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let i,r;this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==to.prototype._render&&(i=this.getBounds(!0));const o=e.projection.transform;if(o&&(r?(r=Qr.copyFrom(r),r.prepend(o)):r=o),i&&t.intersects(i,r))this._render(e);else if(this.cullArea)return;for(let t=0,i=this.children.length;t<i;++t){const i=this.children[t],r=i.cullable;i.cullable=r||!this.cullArea,i.render(e),i.cullable=r}}render(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,i=this.children.length;t<i;++t)this.children[t].render(e)}}renderAdvanced(e){const t=this.filters,i=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let e=0;e<t.length;e++)t[e].enabled&&this._enabledFilters.push(t[e])}const r=t&&this._enabledFilters?.length||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==g.NONE));if(r&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,i=this.children.length;t<i;++t)this.children[t].render(e)}r&&e.batch.flush(),i&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t="boolean"==typeof e?e:e?.children,i=this.removeChildren(0,this.children.length);if(t)for(let t=0;t<i.length;++t)i[t].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e}};let io=to;io.defaultSortableChildren=!1,io.prototype.containerUpdateTransform=io.prototype.updateTransform,Object.defineProperties(x,{SORTABLE_CHILDREN:{get:()=>io.defaultSortableChildren,set(e){Y("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),io.defaultSortableChildren=e}}});const ro=new Tt,oo=new Uint16Array([0,1,2,0,2,3]);class so extends io{constructor(e){super(),this._anchor=new Ut(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Te(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=o.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Pi.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=oo,this.pluginName="batch",this.isSprite=!0,this._roundPixels=x.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=De(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=De(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,i=t.a,r=t.b,o=t.c,s=t.d,n=t.tx,l=t.ty,a=this.vertexData,h=e.trim,d=e.orig,c=this._anchor;let u=0,m=0,p=0,b=0;if(h?(m=h.x-c._x*d.width,u=m+h.width,b=h.y-c._y*d.height,p=b+h.height):(m=-c._x*d.width,u=m+d.width,b=-c._y*d.height,p=b+d.height),a[0]=i*m+o*b+n,a[1]=s*b+r*m+l,a[2]=i*u+o*b+n,a[3]=s*b+r*u+l,a[4]=i*u+o*p+n,a[5]=s*p+r*u+l,a[6]=i*m+o*p+n,a[7]=s*p+r*m+l,this._roundPixels){const e=x.RESOLUTION;for(let t=0;t<a.length;++t)a[t]=Math.round(a[t]*e)/e}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,i=e.orig,r=this._anchor,o=this.transform.worldTransform,s=o.a,n=o.b,l=o.c,a=o.d,h=o.tx,d=o.ty,c=-r._x*i.width,u=c+i.width,m=-r._y*i.height,p=m+i.height;t[0]=s*c+l*m+h,t[1]=a*m+n*c+d,t[2]=s*u+l*m+h,t[3]=a*m+n*u+d,t[4]=s*u+l*p+h,t[5]=a*p+n*u+d,t[6]=s*c+l*p+h,t[7]=a*p+n*c+d}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new Zr),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new At),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,ro);const t=this._texture.orig.width,i=this._texture.orig.height,r=-t*this.anchor.x;let o=0;return ro.x>=r&&ro.x<r+t&&(o=-i*this.anchor.y,ro.y>=o&&ro.y<o+i)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e?.texture){const t="boolean"==typeof e?e:e?.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){const i=e instanceof Pi?e:Pi.from(e,t);return new so(i)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=De(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=De(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Pi.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const no=new Mt;Kr.prototype._cacheAsBitmap=!1,Kr.prototype._cacheData=null,Kr.prototype._cacheAsBitmapResolution=null,Kr.prototype._cacheAsBitmapMultisample=null;class lo{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Kr.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;let t;this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new lo),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}),Kr.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},Kr.prototype._initCachedDisplayObject=function(e){if(this._cacheData?.sprite)return;const t=this.alpha;this.alpha=1,e.batch.flush();const i=this.getLocalBounds(null,!0).clone();if(this.filters?.length){const e=this.filters[0].padding;i.pad(e)}i.ceil(x.RESOLUTION);const r=e.renderTexture.current,o=e.renderTexture.sourceFrame.clone(),s=e.renderTexture.destinationFrame.clone(),n=e.projection.transform,l=Ci.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:this.cacheAsBitmapMultisample??e.multisample}),a=`cacheAsBitmap_${Ne()}`;this._cacheData.textureCacheId=a,dt.addToCache(l.baseTexture,a),Pi.addToCache(l,a);const h=this.transform.localTransform.copyTo(no).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:l,clear:!0,transform:h,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=n,e.renderTexture.bind(r,o,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const d=new so(l);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-i.x/i.width,d.anchor.y=-i.y/i.height,d.alpha=t,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)},Kr.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},Kr.prototype._initCachedDisplayObjectCanvas=function(e){if(this._cacheData?.sprite)return;const t=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;const r=e.canvasContext.activeContext,o=e._projTransform;t.ceil(x.RESOLUTION);const s=Ci.create({width:t.width,height:t.height}),n=`cacheAsBitmap_${Ne()}`;this._cacheData.textureCacheId=n,dt.addToCache(s.baseTexture,n),Pi.addToCache(s,n);const l=no;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=t.x,l.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:s,clear:!0,transform:l,skipUpdateTransform:!1}),e.canvasContext.activeContext=r,e._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const a=new so(s);a.transform.worldTransform=this.transform.worldTransform,a.anchor.x=-t.x/t.width,a.anchor.y=-t.y/t.height,a.alpha=i,a._bounds=this._bounds,this._cacheData.sprite=a,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=a.containsPoint.bind(a)},Kr.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},Kr.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},Kr.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,dt.removeFromCache(this._cacheData.textureCacheId),Pi.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},Kr.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},Kr.prototype.name=null,io.prototype.getChildByName=function(e,t){for(let t=0,i=this.children.length;t<i;t++)if(this.children[t].name===e)return this.children[t];if(t)for(let t=0,i=this.children.length;t<i;t++){const i=this.children[t];if(!i.getChildByName)continue;const r=i.getChildByName(e,!0);if(r)return r}return null},Kr.prototype.getGlobalPosition=function(e=new Tt,t=!1){return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};const ao={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},ho=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");class co extends bi{constructor(e,t=8,i=4,r=bi.defaultResolution,o=5){const s=function(e,t){const i=Math.ceil(e/2);let r,o="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";r=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let t=0;t<e;t++){let e=r.replace("%index%",t.toString());e=e.replace("%sampleIndex%",t-(i-1)+".0"),s+=e,s+="\n"}return o=o.replace("%blur%",s),o=o.replace("%size%",e.toString()),o}(o,e),n=function(e){const t=ao[e],i=t.length;let r,o=ho,s="";for(let o=0;o<e;o++){let n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());r=o,o>=i&&(r=e-o-1),n=n.replace("%value%",t[r].toString()),s+=n,s+="\n"}return o=o.replace("%blur%",s),o=o.replace("%size%",e.toString()),o}(o);super(s,n),this.horizontal=e,this.resolution=r,this._quality=0,this.quality=i,this.blur=t}apply(e,t,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/t.width):this.uniforms.strength=1/i.height*(i.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,i,r);else{const o=e.getFilterTexture(),s=e.renderer;let n=t,l=o;this.state.blend=!1,e.applyFilter(this,n,l,p.CLEAR);for(let t=1;t<this.passes-1;t++){e.bindAndClear(n,p.BLIT),this.uniforms.uSampler=l;const t=l;l=n,n=t,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,i,r),e.returnFilterTexture(o)}}get blur(){return this.strength}set blur(e){this.padding=1+2*Math.abs(e),this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class uo extends bi{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Dr,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e),this.alpha=1}_loadMatrix(e,t=!1){let i=e;t&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(e,t,i){return e[0]=t[0]*i[0]+t[1]*i[5]+t[2]*i[10]+t[3]*i[15],e[1]=t[0]*i[1]+t[1]*i[6]+t[2]*i[11]+t[3]*i[16],e[2]=t[0]*i[2]+t[1]*i[7]+t[2]*i[12]+t[3]*i[17],e[3]=t[0]*i[3]+t[1]*i[8]+t[2]*i[13]+t[3]*i[18],e[4]=t[0]*i[4]+t[1]*i[9]+t[2]*i[14]+t[3]*i[19]+t[4],e[5]=t[5]*i[0]+t[6]*i[5]+t[7]*i[10]+t[8]*i[15],e[6]=t[5]*i[1]+t[6]*i[6]+t[7]*i[11]+t[8]*i[16],e[7]=t[5]*i[2]+t[6]*i[7]+t[7]*i[12]+t[8]*i[17],e[8]=t[5]*i[3]+t[6]*i[8]+t[7]*i[13]+t[8]*i[18],e[9]=t[5]*i[4]+t[6]*i[9]+t[7]*i[14]+t[8]*i[19]+t[9],e[10]=t[10]*i[0]+t[11]*i[5]+t[12]*i[10]+t[13]*i[15],e[11]=t[10]*i[1]+t[11]*i[6]+t[12]*i[11]+t[13]*i[16],e[12]=t[10]*i[2]+t[11]*i[7]+t[12]*i[12]+t[13]*i[17],e[13]=t[10]*i[3]+t[11]*i[8]+t[12]*i[13]+t[13]*i[18],e[14]=t[10]*i[4]+t[11]*i[9]+t[12]*i[14]+t[13]*i[19]+t[14],e[15]=t[15]*i[0]+t[16]*i[5]+t[17]*i[10]+t[18]*i[15],e[16]=t[15]*i[1]+t[16]*i[6]+t[17]*i[11]+t[18]*i[16],e[17]=t[15]*i[2]+t[16]*i[7]+t[17]*i[12]+t[18]*i[17],e[18]=t[15]*i[3]+t[16]*i[8]+t[17]*i[13]+t[18]*i[18],e[19]=t[15]*i[4]+t[16]*i[9]+t[17]*i[14]+t[18]*i[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}tint(e,t){const[i,r,o]=Te.shared.setValue(e).toArray(),s=[i,0,0,0,0,0,r,0,0,0,0,0,o,0,0,0,0,0,1,0];this._loadMatrix(s,t)}greyscale(e,t){const i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}hue(e,t){e=(e||0)/180*Math.PI;const i=Math.cos(e),r=Math.sin(e),o=1/3,s=(0,Math.sqrt)(o),n=[i+(1-i)*o,o*(1-i)-s*r,o*(1-i)+s*r,0,0,o*(1-i)+s*r,i+o*(1-i),o*(1-i)-s*r,0,0,o*(1-i)-s*r,o*(1-i)+s*r,i+o*(1-i),0,0,0,0,0,1,0];this._loadMatrix(n,t)}contrast(e,t){const i=(e||0)+1,r=-.5*(i-1),o=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(o,t)}saturate(e=0,t){const i=2*e/3+1,r=-.5*(i-1),o=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(o,t)}desaturate(){this.saturate(-1)}negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}colorTone(e,t,i,r,o){e=e||.2,t=t||.15,i=i||16770432,r=r||3375104;const s=Te.shared,[n,l,a]=s.setValue(i).toArray(),[h,d,c]=s.setValue(r).toArray(),u=[.3,.59,.11,0,0,n,l,a,e,0,h,d,c,t,0,n-h,l-d,a-c,0,0];this._loadMatrix(u,o)}night(e,t){const i=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}predator(e,t){const i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,t)}lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}uo.prototype.grayscale=uo.prototype.greyscale;const mo={AlphaFilter:class extends bi{constructor(e=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}},BlurFilter:class extends bi{constructor(e=8,t=4,i=bi.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new co(!0,e,t,i,r),this.blurYFilter=new co(!1,e,t,i,r),this.resolution=i,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,i,r){const o=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(o&&s){const o=e.getFilterTexture();this.blurXFilter.apply(e,t,o,p.CLEAR),this.blurYFilter.apply(e,o,i,r),e.returnFilterTexture(o)}else s?this.blurYFilter.apply(e,t,i,r):this.blurXFilter.apply(e,t,i,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}},BlurFilterPass:co,ColorMatrixFilter:uo,DisplacementFilter:class extends bi{constructor(e,t){const i=new Mt;e.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,null==t&&(t=20),this.scale=new Tt(t,t)}apply(e,t,i,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const o=this.maskSprite.worldTransform,s=Math.sqrt(o.a*o.a+o.b*o.b),n=Math.sqrt(o.c*o.c+o.d*o.d);0!==s&&0!==n&&(this.uniforms.rotation[0]=o.a/s,this.uniforms.rotation[1]=o.b/s,this.uniforms.rotation[2]=o.c/n,this.uniforms.rotation[3]=o.d/n),e.applyFilter(this,t,i,r)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}},FXAAFilter:class extends bi{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}},NoiseFilter:class extends bi{constructor(e=.5,t=Math.random()){super(Dr,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}};Object.entries(mo).forEach((([e,t])=>{Object.defineProperty(mo,e,{get:()=>(Y("7.1.0",`filters.${e} has moved to ${e}`),t)})}));const po=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){!this.tickerAdded&&this.domElement&&(Br.system.add(this.tickerUpdate,this,Pr.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Br.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())}};class bo{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=bo.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Tt,this.page=new Tt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,i,r,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class fo extends bo{constructor(){super(...arguments),this.client=new Tt,this.movement=new Tt,this.offset=new Tt,this.global=new Tt,this.screen=new Tt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,i,r,o,s,n,l,a,h,d,c,u,m,p){throw new Error("Method not implemented.")}}class go extends fo{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Fo extends fo{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Fo.DOM_DELTA_PIXEL=0,Fo.DOM_DELTA_LINE=1,Fo.DOM_DELTA_PAGE=2;const yo=new Tt,vo=new Tt;class xo{constructor(e){this.dispatch=new G,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(((e,t)=>e.priority-t.priority))}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let i=0,r=t.length;i<r;i++)t[i].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){po.pauseUpdate=!0;const i=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,yo.set(e,t),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,t){if(!e.target)return;const i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let r=0,o=i.length-1;r<o;r++)if(e.currentTarget=i[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(e.currentTarget=i[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,i=this._allInteractiveElements){if(0===i.length)return;e.eventPhase=e.BUBBLING_PHASE;const r=Array.isArray(t)?t:[t];for(let t=i.length-1;t>=0;t--)r.forEach((r=>{e.currentTarget=i[t],this.notifyTarget(e,r)}))}propagationPath(e){const t=[e];for(let i=0;i<2048&&e!==this.rootTarget;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,i,r,o,s=!1){let n=!1;if(this._interactivePrune(e))return null;if("dynamic"!==e.eventMode&&"dynamic"!==t||(po.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let a=l.length-1;a>=0;a--){const h=l[a],d=this.hitTestMoveRecursive(h,this._isInteractive(t)?t:h.eventMode,i,r,o,s||o(e,i));if(d){if(d.length>0&&!d[d.length-1].parent)continue;const t=e.isInteractive();(d.length>0||t)&&(t&&this._allInteractiveElements.push(e),d.push(e)),0===this._hitElements.length&&(this._hitElements=d),n=!0}}}const l=this._isInteractive(t),a=e.isInteractive();return a&&a&&this._allInteractiveElements.push(e),s||this._hitElements.length>0?null:n?this._hitElements:l&&!o(e,i)&&r(e,i)?a?[e]:[]:null}hitTestRecursive(e,t,i,r,o){if(this._interactivePrune(e)||o(e,i))return null;if("dynamic"!==e.eventMode&&"dynamic"!==t||(po.pauseUpdate=!1),e.interactiveChildren&&e.children){const s=e.children;for(let n=s.length-1;n>=0;n--){const l=s[n],a=this.hitTestRecursive(l,this._isInteractive(t)?t:l.eventMode,i,r,o);if(a){if(a.length>0&&!a[a.length-1].parent)continue;const t=e.isInteractive();return(a.length>0||t)&&a.push(e),a}}}const s=this._isInteractive(t),n=e.isInteractive();return s&&r(e,i)?n?[e]:[]:null}_isInteractive(e){return"static"===e||"dynamic"===e}_interactivePrune(e){return!(e&&!e.isMask&&e.visible&&e.renderable)||"none"===e.eventMode||"passive"===e.eventMode&&!e.interactiveChildren||!!e.isMask}hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,vo),!e.hitArea.contains(vo.x,vo.y)))return!0;if(e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;if(i&&!i.containsPoint?.(t))return!0}return!1}hitTestFn(e,t){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(t))}notifyTarget(e,t){const i=`on${t=t??e.type}`;e.currentTarget[i]?.(e);const r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof go))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){const e=2===t.button;this.dispatchEvent(t,e?"rightdown":"mousedown")}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){if(!(e instanceof go))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const i="mouse"===t.pointerType||"pen"===t.pointerType,r=this.trackingData(e.pointerId),o=this.findMountedTarget(r.overTargets);if(r.overTargets?.length>0&&o!==t.target){const r="mousemove"===e.type?"mouseout":"pointerout",s=this.createPointerEvent(e,r,o);if(this.dispatchEvent(s,"pointerout"),i&&this.dispatchEvent(s,"mouseout"),!t.composedPath().includes(o)){const r=this.createPointerEvent(e,"pointerleave",o);for(r.eventPhase=r.AT_TARGET;r.target&&!t.composedPath().includes(r.target);)r.currentTarget=r.target,this.notifyTarget(r),i&&this.notifyTarget(r,"mouseleave"),r.target=r.target.parent;this.freeEvent(r)}this.freeEvent(s)}if(o!==t.target){const r="mousemove"===e.type?"mouseover":"pointerover",s=this.clonePointerEvent(t,r);this.dispatchEvent(s,"pointerover"),i&&this.dispatchEvent(s,"mouseover");let n=o?.parent;for(;n&&n!==this.rootTarget.parent&&n!==t.target;)n=n.parent;if(!n||n===this.rootTarget.parent){const e=this.clonePointerEvent(t,"pointerenter");for(e.eventPhase=e.AT_TARGET;e.target&&e.target!==o&&e.target!==this.rootTarget.parent;)e.currentTarget=e.target,this.notifyTarget(e),i&&this.notifyTarget(e,"mouseenter"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(s)}const s=[],n=this.enableGlobalMoveEvents??!0;this.moveOnAll?s.push("pointermove"):this.dispatchEvent(t,"pointermove"),n&&s.push("globalpointermove"),"touch"===t.pointerType&&(this.moveOnAll?s.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),n&&s.push("globaltouchmove")),i&&(this.moveOnAll?s.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),n&&s.push("globalmousemove"),this.cursor=t.target?.cursor),s.length>0&&this.all(t,s),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){if(!(e instanceof go))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),i=this.createPointerEvent(e),r="mouse"===i.pointerType||"pen"===i.pointerType;this.dispatchEvent(i,"pointerover"),r&&this.dispatchEvent(i,"mouseover"),"mouse"===i.pointerType&&(this.cursor=i.target?.cursor);const o=this.clonePointerEvent(i,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;t.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(o)}mapPointerOut(e){if(!(e instanceof go))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId);if(t.overTargets){const i="mouse"===e.pointerType||"pen"===e.pointerType,r=this.findMountedTarget(t.overTargets),o=this.createPointerEvent(e,"pointerout",r);this.dispatchEvent(o),i&&this.dispatchEvent(o,"mouseout");const s=this.createPointerEvent(e,"pointerleave",r);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;t.overTargets=null,this.freeEvent(o),this.freeEvent(s)}this.cursor=null}mapPointerUp(e){if(!(e instanceof go))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),"touch"===i.pointerType)this.dispatchEvent(i,"touchend");else if("mouse"===i.pointerType||"pen"===i.pointerType){const e=2===i.button;this.dispatchEvent(i,e?"rightup":"mouseup")}const r=this.trackingData(e.pointerId),o=this.findMountedTarget(r.pressTargetsByButton[e.button]);let s=o;if(o&&!i.composedPath().includes(o)){let t=o;for(;t&&!i.composedPath().includes(t);){if(i.currentTarget=t,this.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType)this.notifyTarget(i,"touchendoutside");else if("mouse"===i.pointerType||"pen"===i.pointerType){const e=2===i.button;this.notifyTarget(i,e?"rightupoutside":"mouseupoutside")}t=t.parent}delete r.pressTargetsByButton[e.button],s=t}if(s){const o=this.clonePointerEvent(i,"click");o.target=s,o.path=null,r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:o.target,timeStamp:t});const n=r.clicksByButton[e.button];if(n.target===o.target&&t-n.timeStamp<200?++n.clickCount:n.clickCount=1,n.target=o.target,n.timeStamp=t,o.detail=n.clickCount,"mouse"===o.pointerType){const e=2===o.button;this.dispatchEvent(o,e?"rightclick":"click")}else"touch"===o.pointerType&&this.dispatchEvent(o,"tap");this.dispatchEvent(o,"pointertap"),this.freeEvent(o)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof go))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),i=this.findMountedTarget(t.pressTargetsByButton[e.button]),r=this.createPointerEvent(e);if(i){let o=i;for(;o;)r.currentTarget=o,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),o=o.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(r)}mapWheel(e){if(!(e instanceof Fo))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let i=1;i<e.length&&e[i].parent===t;i++)t=e[i];return t}createPointerEvent(e,t,i){const r=this.allocateEvent(go);return this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=i??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],"string"==typeof t&&(r.type=t),r}createWheelEvent(e){const t=this.allocateEvent(Fo);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const i=this.allocateEvent(go);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=t??i.type,i}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof go&&t instanceof go&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof fo&&t instanceof fo&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const i=e.currentTarget._events[t];if(i&&e.currentTarget.isInteractive())if("fn"in i)i.once&&e.currentTarget.removeListener(t,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let r=0,o=i.length;r<o&&!e.propagationImmediatelyStopped;r++)i[r].once&&e.currentTarget.removeListener(t,i[r].fn,void 0,!0),i[r].fn.call(i[r].context,e)}}const _o={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},wo=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new xo(null),po.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new go(null),this.rootWheelEvent=new Fo(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...wo.defaultEventFeatures},{set:(e,t,i)=>("globalMove"===t&&(this.rootBoundary.enableGlobalMoveEvents=i),e[t]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:i}=this.renderer;this.setTargetElement(t),this.resolution=i,wo._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":t&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":t&&Object.assign(this.domElement.style,i)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===e.pointerType)return;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let e=0,i=t.length;e<i;e++){const i=t[e],r=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===e.pointerType)return;po.pointerMoved();const t=this.normalizeToPointerData(e);for(let e=0,i=t.length;e<i;e++){const i=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===e.pointerType)return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const i=t!==this.domElement?"outside":"",r=this.normalizeToPointerData(e);for(let e=0,t=r.length;e<t;e++){const t=this.bootstrapEvent(this.rootPointerEvent,r[e]);t.type+=i,this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===e.pointerType)return;const t=this.normalizeToPointerData(e);for(let e=0,i=t.length;e<i;e++){const i=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,po.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;po.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;po.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,i){let r;r=this.domElement.parentElement?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const o=1/this.resolution;e.x=(t-r.left)*(this.domElement.width/r.width)*o,e.y=(i-r.top)*(this.domElement.height/r.height)*o}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,r=e.changedTouches.length;i<r;i++){const r=e.changedTouches[i];void 0===r.button&&(r.button=0),void 0===r.buttons&&(r.buttons=1),void 0===r.isPrimary&&(r.isPrimary=1===e.touches.length&&"touchstart"===e.type),void 0===r.width&&(r.width=r.radiusX||1),void 0===r.height&&(r.height=r.radiusY||1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="touch"),void 0===r.pointerId&&(r.pointerId=r.identifier||0),void 0===r.pressure&&(r.pressure=r.force||.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),void 0===r.layerX&&(r.layerX=r.offsetX=r.clientX),void 0===r.layerY&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=e.type,t.push(r)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&!(this.supportsPointerEvents&&e instanceof globalThis.PointerEvent)){const i=e;void 0===i.isPrimary&&(i.isPrimary=!0),void 0===i.width&&(i.width=1),void 0===i.height&&(i.height=1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="mouse"),void 0===i.pointerId&&(i.pointerId=1),void 0===i.pressure&&(i.pressure=.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),i.isNormalized=!0,t.push(i)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=_o[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};let So=wo;function To(e){return"dynamic"===e||"static"===e}So.extension={name:"events",type:[qe.RendererSystem,qe.CanvasRendererSystem]},So.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},Je.add(So);const Eo={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??To(So.defaultEventMode)},set interactive(e){Y("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??So.defaultEventMode},set eventMode(e){this._internalInteractive=To(e),this._internalEventMode=e},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(e,t,i){const r="function"==typeof t?void 0:t;e="boolean"==typeof i&&i||"object"==typeof i&&i.capture?`${e}capture`:e,t="function"==typeof t?t:t.handleEvent,this.on(e,t,r)},removeEventListener(e,t,i){const r="function"==typeof t?void 0:t;e="boolean"==typeof i&&i||"object"==typeof i&&i.capture?`${e}capture`:e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,r)},dispatchEvent(e){if(!(e instanceof bo))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Kr.mixin(Eo),Kr.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});class Ao{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(z.tablet||z.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex=2..toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let e=0;e<t.length;e++)this.updateAccessibleObjects(t[e])}update(){const e=performance.now();if(z.android.device&&e<this.androidUpdateCount)return;if(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen)return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:i,width:r,height:o}=this.renderer.view.getBoundingClientRect(),{width:s,height:n,resolution:l}=this.renderer,a=r/s*l,h=o/n*l;let d=this.div;d.style.left=`${t}px`,d.style.top=`${i}px`,d.style.width=`${s}px`,d.style.height=`${n}px`;for(let e=0;e<this.children.length;e++){const t=this.children[e];if(t.renderId!==this.renderId)t._accessibleActive=!1,Ie(this.children,e,1),this.div.removeChild(t._accessibleDiv),this.pool.push(t._accessibleDiv),t._accessibleDiv=null,e--;else{d=t._accessibleDiv;let e=t.hitArea;const i=t.worldTransform;t.hitArea?(d.style.left=(i.tx+e.x*i.a)*a+"px",d.style.top=(i.ty+e.y*i.d)*h+"px",d.style.width=e.width*i.a*a+"px",d.style.height=e.height*i.d*h+"px"):(e=t.getBounds(),this.capHitArea(e),d.style.left=e.x*a+"px",d.style.top=e.y*h+"px",d.style.width=e.width*a+"px",d.style.height=e.height*h+"px",d.title!==t.accessibleTitle&&null!==t.accessibleTitle&&(d.title=t.accessibleTitle),d.getAttribute("aria-label")!==t.accessibleHint&&null!==t.accessibleHint&&d.setAttribute("aria-label",t.accessibleHint)),t.accessibleTitle===d.title&&t.tabIndex===d.tabIndex||(d.title=t.accessibleTitle,d.tabIndex=t.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:i}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>i&&(e.height=i-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=2..toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:i}=e.target,r=this.renderer.events.rootBoundary,o=Object.assign(new bo(r),{target:i});r.rootTarget=this.renderer.lastObjectRendered,t.forEach((e=>r.dispatchEvent(o,e)))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){9===e.keyCode&&this.activate()}_onMouseMove(e){0===e.movementX&&0===e.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Ao.extension={name:"accessibility",type:[qe.RendererPlugin,qe.CanvasRendererPlugin]},Je.add(Ao);const Po=class{constructor(e){this.stage=new io,e=Object.assign({forceCanvas:!1},e),this.renderer=Ir(e),Po._plugins.forEach((t=>{t.init.call(this,e)}))}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){const i=Po._plugins.slice(0);i.reverse(),i.forEach((e=>{e.destroy.call(this)})),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};let Co=Po;Co._plugins=[],Je.handleByList(qe.Application,Co._plugins);class ko{static init(e){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let e,t;if(this.cancelResize(),this._resizeTo===globalThis.window)e=globalThis.innerWidth,t=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:r}=this._resizeTo;e=i,t=r}this.renderer.resize(e,t),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ko.extension=qe.Application,Je.add(ko);const Bo={loader:qe.LoadParser,resolver:qe.ResolveParser,cache:qe.CacheParser,detection:qe.DetectionParser};Je.handle(qe.Asset,(e=>{const t=e.ref;Object.entries(Bo).filter((([e])=>!!t[e])).forEach((([e,i])=>Je.add(Object.assign(t[e],{extension:t[e].extension??i}))))}),(e=>{const t=e.ref;Object.keys(Bo).filter((e=>!!t[e])).forEach((e=>Je.remove(t[e])))}));class Mo{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach((e=>{this._assetList.push(e)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function Ro(e,t){const i=e.split("?")[0],r=X.extname(i).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const Io=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map((e=>"string"==typeof e?t(e):e)):e),Do=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=Io(e);let r;for(let e=0;e<this.parsers.length;e++){const o=this.parsers[e];if(o.test(t)){r=o.getCacheableAssets(i,t);break}}r||(r={},i.forEach((e=>{r[e]=t})));const o=Object.keys(r),s={cacheKeys:o,keys:i};if(i.forEach((e=>{this._cacheMap.set(e,s)})),o.forEach((e=>{this._cache.has(e)&&this._cache.get(e)!==t&&console.warn("[Cache] already has key:",e),this._cache.set(e,r[e])})),t instanceof Pi){const e=t;i.forEach((t=>{e.baseTexture!==Pi.EMPTY.baseTexture&&dt.addToCache(e.baseTexture,t),Pi.addToCache(e,t)}))}}remove(e){if(this._cacheMap.get(e),!this._cacheMap.has(e))return void console.warn(`[Assets] Asset id ${e} was not found in the Cache`);const t=this._cacheMap.get(e);t.cacheKeys.forEach((e=>{this._cache.delete(e)})),t.keys.forEach((e=>{this._cacheMap.delete(e)}))}get parsers(){return this._parsers}},Oo=e=>!Array.isArray(e);class No{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{let r=null,o=null;if(t.loadParser&&(o=this._parserHash[t.loadParser],o||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!o){for(let i=0;i<this.parsers.length;i++){const r=this.parsers[i];if(r.load&&r.test?.(e,t,this)){o=r;break}}if(!o)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await o.load(e,t,this),i.parser=o;for(let e=0;e<this.parsers.length;e++){const o=this.parsers[e];o.parse&&o.parse&&await(o.testParse?.(r,t,this))&&(r=await o.parse(r,t,this)||r,i.parser=o)}return r})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const r={},o=Oo(e),s=Io(e,(e=>({src:e}))),n=s.length,l=s.map((async e=>{const o=X.toAbsolute(e.src);if(!r[e.src])try{this.promiseCache[o]||(this.promiseCache[o]=this._getLoadPromiseAndParser(o,e)),r[e.src]=await this.promiseCache[o].promise,t&&t(++i/n)}catch(t){throw delete this.promiseCache[o],delete r[e.src],new Error(`[Loader.load] Failed to load ${o}.\n${t}`)}}));return await Promise.all(l),o?r[s[0].src]:r}async unload(e){const t=Io(e,(e=>({src:e}))).map((async e=>{const t=X.toAbsolute(e.src),i=this.promiseCache[t];if(i){const r=await i.promise;i.parser?.unload?.(r,e,this),delete this.promiseCache[t]}}));await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter((e=>e.name)).reduce(((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t})),{})}}var Lo=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(Lo||{});function zo(e,t){if(Array.isArray(t)){for(const i of t)if(e.startsWith(`data:${i}`))return!0;return!1}return e.startsWith(`data:${t}`)}const Go={extension:{type:qe.LoadParser,priority:Lo.Low},name:"loadJson",test:e=>zo(e,"application/json")||Ro(e,".json"),async load(e){const t=await x.ADAPTER.fetch(e);return await t.json()}};Je.add(Go);const Uo={name:"loadTxt",extension:{type:qe.LoadParser,priority:Lo.Low},test:e=>zo(e,"text/plain")||Ro(e,".txt"),async load(e){const t=await x.ADAPTER.fetch(e);return await t.text()}};Je.add(Uo);const Ho=["normal","bold","100","200","300","400","500","600","700","800","900"],Vo=[".ttf",".otf",".woff",".woff2"],jo=["font/ttf","font/otf","font/woff","font/woff2"],Wo=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,Xo={extension:{type:qe.LoadParser,priority:Lo.Low},name:"loadWebFont",test:e=>zo(e,jo)||Ro(e,Vo),async load(e,t){const i=x.ADAPTER.getFontFaceSet();if(i){const r=[],o=t.data?.family??function(e){const t=X.extname(e),i=X.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1)));let r=i.length>0;for(const e of i)if(!e.match(Wo)){r=!1;break}let o=i.join(" ");return r||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}(e),s=t.data?.weights?.filter((e=>Ho.includes(e)))??["normal"],n=t.data??{};for(let t=0;t<s.length;t++){const l=s[t],a=new FontFace(o,`url(${encodeURI(e)})`,{...n,weight:l});await a.load(),i.add(a),r.push(a)}return 1===r.length?r[0]:r}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach((e=>x.ADAPTER.getFontFaceSet().delete(e)))}};Je.add(Xo);let $o,Yo=0;const qo="\n    async function checkImageBitmap()\n    {\n        try\n        {\n            if (typeof createImageBitmap !== 'function') return false;\n\n            const response = await fetch('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=');\n            const imageBlob =  await response.blob();\n            const imageBitmap = await createImageBitmap(imageBlob);\n\n            return imageBitmap.width === 1 && imageBitmap.height === 1;\n        }\n        catch (e)\n        {\n            return false;\n        }\n    }\n    checkImageBitmap().then((result) => { self.postMessage(result); });\n    ",Zo="\n    async function loadImageBitmap(url)\n    {\n        const response = await fetch(url);\n\n        if (!response.ok)\n        {\n            throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: `\n                + `${response.status} ${response.statusText}`);\n        }\n\n        const imageBlob =  await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n\n        return imageBitmap;\n    }\n    self.onmessage = async (event) =>\n    {\n        try\n        {\n            const imageBitmap = await loadImageBitmap(event.data.data[0]);\n\n            self.postMessage({\n                data: imageBitmap,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            }, [imageBitmap]);\n        }\n        catch(e)\n        {\n            self.postMessage({\n                error: e,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            });\n        }\n    };";let Ko;const Jo=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((e=>{const t=URL.createObjectURL(new Blob([qo],{type:"application/javascript"})),i=new Worker(t);i.addEventListener("message",(r=>{i.terminate(),URL.revokeObjectURL(t),e(r.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===$o&&($o=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<$o&&(Ko||(Ko=URL.createObjectURL(new Blob([Zo],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(Ko),e.addEventListener("message",(e=>{this.complete(e.data),this.returnWorker(e.target),this.next()}))),e}returnWorker(e){this.workerPool.push(e)}complete(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise(((i,r)=>{this.queue.push({id:e,arguments:t,resolve:i,reject:r})}));return this.next(),i}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),i=t.id;this.resolveHash[Yo]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:Yo++,id:i})}};function Qo(e,t,i){const r=new Pi(e);return r.baseTexture.on("dispose",(()=>{delete t.promiseCache[i]})),r}const es=[".jpeg",".jpg",".png",".webp",".avif"],ts=["image/jpeg","image/png","image/webp","image/avif"],is={name:"loadTextures",extension:{type:qe.LoadParser,priority:Lo.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:e=>zo(e,ts)||Ro(e,es),async load(e,t,i){let r=null;r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Jo.isImageBitmapSupported()?await Jo.loadImageBitmap(e):await async function(e){const t=await x.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const i=await t.blob();return await createImageBitmap(i)}(e):await new Promise((t=>{r=new Image,r.crossOrigin=this.config.crossOrigin,r.src=e,r.complete?t(r):r.onload=()=>{t(r)}}));const o=new dt(r,{resolution:Ye(e),...t.data});return o.resource.src=e,Qo(o,i,e)},unload(e){e.destroy(!0)}};Je.add(is);const rs={extension:{type:qe.LoadParser,priority:Lo.High},name:"loadSVG",test:e=>zo(e,"image/svg+xml")||Ro(e,".svg"),testParse:async e=>$r.test(e),async parse(e,t,i){const r=new $r(e,t?.data?.resourceOptions);await r.load();const o=new dt(r,{resolution:Ye(e),...t?.data});return o.resource.src=e,Qo(o,i,e)},load:async(e,t)=>(await x.ADAPTER.fetch(e)).text(),unload:is.unload};function os(e,t,i,r,o){const s=t[i];for(let n=0;n<s.length;n++){const l=s[n];i<t.length-1?os(e.replace(r[i],l),t,i+1,r,o):o.push(e.replace(r[i],l))}}function ss(e){const t=e.match(/\{(.*?)\}/g),i=[];if(t){const r=[];t.forEach((e=>{const t=e.substring(1,e.length-1).split(",");r.push(t)})),os(e,r,0,t,i)}else i.push(e);return i}Je.add(rs);class ns{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach((e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))})),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if("string"==typeof e)this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`)).join("&")}}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach((e=>{this.addBundle(e.name,e.assets)}))}addBundle(e,t){const i=[];Array.isArray(t)?t.forEach((t=>{if("string"==typeof t.name){const r=this._createBundleAssetId(e,t.name);i.push(r),this.add([t.name,r],t.srcs,t.data)}else{const r=t.name.map((t=>this._createBundleAssetId(e,t)));r.forEach((e=>{i.push(e)})),this.add([...t.name,...r],t.srcs)}})):Object.keys(t).forEach((r=>{i.push(this._createBundleAssetId(e,r)),this.add([r,this._createBundleAssetId(e,r)],t[r])})),this._bundles[e]=i}add(e,t,i){const r=Io(e);r.forEach((e=>{this.hasKey(e)&&console.warn(`[Resolver] already has key: ${e} overwriting`)})),Array.isArray(t)||(t="string"==typeof t?ss(t):[t]);const o=t.map((e=>{let t=e;if("string"==typeof e){let i=!1;for(let r=0;r<this._parsers.length;r++){const o=this._parsers[r];if(o.test(e)){t=o.parse(e),i=!0;break}}i||(t={src:e})}return t.format||(t.format=t.src.split(".").pop()),t.alias||(t.alias=r),(this._basePath||this._rootPath)&&(t.src=X.toAbsolute(t.src,this._basePath,this._rootPath)),t.src=this._appendDefaultSearchParams(t.src),t.data=t.data??i,t}));r.forEach((e=>{this._assetMap[e]=o}))}resolveBundle(e){const t=Oo(e);e=Io(e);const i={};return e.forEach((e=>{const t=this._bundles[e];if(t){const r=this.resolve(t),o={};for(const t in r){const i=r[t];o[this._extractAssetIdFromBundle(e,t)]=i}i[e]=o}})),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if("string"!=typeof e){const e={};for(const i in t)e[i]=t[i].src;return e}return t.src}resolve(e){const t=Oo(e);e=Io(e);const i={};return e.forEach((e=>{if(!this._resolverHash[e])if(this._assetMap[e]){let t=this._assetMap[e];const i=this._getPreferredOrder(t),r=t[0];i?.priority.forEach((e=>{i.params[e].forEach((i=>{const r=t.filter((t=>!!t[e]&&t[e]===i));r.length&&(t=r)}))})),this._resolverHash[e]=t[0]??r}else{let t=e;(this._basePath||this._rootPath)&&(t=X.toAbsolute(t,this._basePath,this._rootPath)),t=this._appendDefaultSearchParams(t),this._resolverHash[e]={src:t}}i[e]=this._resolverHash[e]})),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const t=e[0],i=this._preferredOrder.find((e=>e.params.format.includes(t.format)));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){return this._defaultSearchParams?`${e}${/\?/.test(e)?"&":"?"}${this._defaultSearchParams}`:e}}const ls=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new ns,this.loader=new No,this.cache=Do,this._backgroundLoader=new Mo(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;"string"==typeof t&&(t=await this.load(t)),this.resolver.addManifest(t)}const t=e.texturePreference?.resolution??1,i="number"==typeof t?[t]:t;let r=[];if(e.texturePreference?.format){const t=e.texturePreference?.format;r="string"==typeof t?[t]:t;for(const e of this._detections)await e.test()||(r=await e.remove(r))}else for(const e of this._detections)await e.test()&&(r=await e.add(r));this.resolver.prefer({params:{format:r,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,i){this.resolver.add(e,t,i)}async load(e,t){this._initialized||await this.init();const i=Oo(e),r=Io(e).map((e=>"string"!=typeof e?(this.resolver.add(e.src,e),e.src):(this.resolver.hasKey(e)||this.resolver.add(e,e),e))),o=this.resolver.resolve(r),s=await this._mapLoadToResolve(o,t);return i?s[r[0]]:s}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;"string"==typeof e&&(i=!0,e=[e]);const r=this.resolver.resolveBundle(e),o={},s=Object.keys(r);let n=0,l=0;const a=()=>{t?.(++n/l)},h=s.map((e=>{const t=r[e];return l+=Object.keys(t).length,this._mapLoadToResolve(t,a).then((t=>{o[e]=t}))}));return await Promise.all(h),i?o[e[0]]:o}async backgroundLoad(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach((e=>{this._backgroundLoader.add(Object.values(e))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if("string"==typeof e)return Do.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=Do.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=Object.values(e),r=Object.keys(e);this._backgroundLoader.active=!1;const o=await this.loader.load(i,t);this._backgroundLoader.active=!0;const s={};return i.forEach(((e,t)=>{const i=o[e.src],n=[e.src];e.alias&&n.push(...e.alias),s[r[t]]=i,Do.set(n,i)})),s}async unload(e){this._initialized||await this.init();const t=Io(e).map((e=>"string"!=typeof e?e.src:e)),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=Io(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map((e=>this._unloadFromResolved(t[e])));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach((e=>{Do.remove(e.src)})),await this.loader.unload(t)}get detections(){return this._detections}get preferWorkers(){return is.config.preferWorkers}set preferWorkers(e){Y("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach((t=>{t.config&&Object.keys(t.config).filter((t=>t in e)).forEach((i=>{t.config[i]=e[i]}))}))}};Je.handleByList(qe.LoadParser,ls.loader.parsers).handleByList(qe.ResolveParser,ls.resolver.parsers).handleByList(qe.CacheParser,ls.cache.parsers).handleByList(qe.DetectionParser,ls.detections);const as={extension:qe.CacheParser,test:e=>Array.isArray(e)&&e.every((e=>e instanceof Pi)),getCacheableAssets:(e,t)=>{const i={};return e.forEach((e=>{t.forEach(((t,r)=>{i[e+(0===r?"":r+1)]=t}))})),i}};Je.add(as);const hs={extension:{type:qe.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e=await x.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then((e=>e.blob()));return createImageBitmap(e).then((()=>!0),(()=>!1))},add:async e=>[...e,"avif"],remove:async e=>e.filter((e=>"avif"!==e))};Je.add(hs);const ds={extension:{type:qe.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e=await x.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then((e=>e.blob()));return createImageBitmap(e).then((()=>!0),(()=>!1))},add:async e=>[...e,"webp"],remove:async e=>e.filter((e=>"webp"!==e))};Je.add(ds);const cs=["png","jpg","jpeg"],us={extension:{type:qe.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...cs],remove:async e=>e.filter((e=>!cs.includes(e)))};Je.add(us);const ms={extension:qe.ResolveParser,test:is.test,parse:e=>({resolution:parseFloat(x.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})};Je.add(ms);const ps=(e,t)=>{const i=t.split("?")[1];return i&&(e+=`?${i}`),e};var bs=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(bs||{});const fs={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let gs,Fs;function ys(){Fs={s3tc:gs.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:gs.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:gs.getExtension("WEBGL_compressed_texture_etc"),etc1:gs.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:gs.getExtension("WEBGL_compressed_texture_pvrtc")||gs.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:gs.getExtension("WEBGL_compressed_texture_atc"),astc:gs.getExtension("WEBGL_compressed_texture_astc")}}const vs={extension:{type:qe.DetectionParser,priority:2},test:async()=>{const e=x.ADAPTER.createCanvas().getContext("webgl");return e?(gs=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{Fs||ys();const t=[];for(const e in Fs)Fs[e]&&t.push(e);return[...t,...e]},remove:async e=>(Fs||ys(),e.filter((e=>!(e in Fs))))};Je.add(vs);class xs extends lt{constructor(e,t={width:1,height:1,autoLoad:!0}){let i,r;"string"==typeof e?(i=e,r=new Uint8Array):(i=null,r=e),super(r,t),this.origin=i,this.buffer=r?new Qe(r):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==t.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load||(this._load=fetch(this.origin).then((e=>e.blob())).then((e=>e.arrayBuffer())).then((e=>(this.data=new Uint32Array(e),this.buffer=new Qe(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)))),this._load}}class _s extends xs{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=_s._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||_s._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,i){const r=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let e=0,t=this.levels;e<t;e++){const{levelID:t,levelWidth:i,levelHeight:o,levelBuffer:s}=this._levelBuffers[e];r.compressedTexImage2D(r.TEXTURE_2D,t,this.format,i,o,0,s)}return!0}onBlobLoaded(){this._levelBuffers=_s._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,t,i,r,o,s,n){const l=new Array(i);let a=e.byteOffset,h=s,d=n,c=h+r-1&~(r-1),u=d+o-1&~(o-1),m=c*u*fs[t];for(let s=0;s<i;s++)l[s]={levelID:s,levelWidth:i>1?h:c,levelHeight:i>1?d:u,levelBuffer:new Uint8Array(e.buffer,a,m)},a+=m,h=h>>1||1,d=d>>1||1,c=h+r-1&~(r-1),u=d+o-1&~(o-1),m=c*u*fs[t];return l}}const ws={827611204:bs.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:bs.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:bs.COMPRESSED_RGBA_S3TC_DXT5_EXT},Ss={70:bs.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:bs.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:bs.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:bs.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:bs.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:bs.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:bs.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:bs.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:bs.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT},Ts=[171,75,84,88,32,49,49,187,13,10,26,10],Es={[a.UNSIGNED_BYTE]:1,[a.UNSIGNED_SHORT]:2,[a.INT]:4,[a.UNSIGNED_INT]:4,[a.FLOAT]:4,[a.HALF_FLOAT]:8},As={[n.RGBA]:4,[n.RGB]:3,[n.RG]:2,[n.RED]:1,[n.LUMINANCE]:1,[n.LUMINANCE_ALPHA]:2,[n.ALPHA]:1},Ps={[a.UNSIGNED_SHORT_4_4_4_4]:2,[a.UNSIGNED_SHORT_5_5_5_1]:2,[a.UNSIGNED_SHORT_5_6_5]:2};function Cs(e){switch(e){case n.RGBA:return n.RGBA_INTEGER;case n.RGB:return n.RGB_INTEGER;case n.RG:return n.RG_INTEGER;case n.RED:return n.RED_INTEGER;default:return e}}const ks={extension:{type:qe.LoadParser,priority:Lo.High},name:"loadDDS",test:e=>Ro(e,".dds"),async load(e,t,i){const r=await x.ADAPTER.fetch(e),o=function(e){const t=new Uint32Array(e);if(542327876!==t[0])throw new Error("Invalid DDS file magic word");const i=new Uint32Array(e,0,124/Uint32Array.BYTES_PER_ELEMENT),r=i[3],o=i[4],s=i[7],n=new Uint32Array(e,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),l=n[1];if(4&l){const i=n[2];if(808540228!==i){const t=ws[i],n=new Uint8Array(e,128);return[new _s(n,{format:t,width:o,height:r,levels:s})]}const l=128,a=new Uint32Array(t.buffer,l,20/Uint32Array.BYTES_PER_ELEMENT),h=a[0],d=a[1],c=a[2],u=a[3],m=Ss[h];if(void 0===m)throw new Error(`DDSParser cannot parse texture data with DXGI format ${h}`);if(4===c)throw new Error("DDSParser does not support cubemap textures");if(6===d)throw new Error("DDSParser does not supported 3D texture data");const p=new Array,b=148;if(1===u)p.push(new Uint8Array(e,b));else{const t=fs[m];let i=0,n=o,l=r;for(let e=0;e<s;e++)i+=Math.max(1,n+3&-4)*Math.max(1,l+3&-4)*t,n>>>=1,l>>>=1;let a=b;for(let t=0;t<u;t++)p.push(new Uint8Array(e,a,i)),a+=i}return p.map((e=>new _s(e,{format:m,width:o,height:r,levels:s})))}if(64&l)throw new Error("DDSParser does not support uncompressed texture data.");if(512&l)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(131072&l)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(2&l)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}(await r.arrayBuffer()).map((r=>Qo(new dt(r,{mipmap:u.OFF,alphaMode:m.NO_PREMULTIPLIED_ALPHA,resolution:Ye(e),...t.data}),i,e)));return 1===o.length?o[0]:o},unload(e){Array.isArray(e)?e.forEach((e=>e.destroy(!0))):e.destroy(!0)}};Je.add(ks);const Bs={extension:{type:qe.LoadParser,priority:Lo.High},name:"loadKTX",test:e=>Ro(e,".ktx"),async load(e,t,i){const r=await x.ADAPTER.fetch(e),o=await r.arrayBuffer(),{compressed:s,uncompressed:n,kvData:l}=function(e,t,i=!1){const r=new DataView(t);if(!function(e,t){for(let i=0;i<Ts.length;i++)if(t.getUint8(i)!==Ts[i])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}(e,r))return null;const o=67305985===r.getUint32(12,!0),s=r.getUint32(16,o),n=r.getUint32(24,o),l=r.getUint32(28,o),h=r.getUint32(36,o),d=r.getUint32(40,o)||1,c=r.getUint32(44,o)||1,u=r.getUint32(48,o)||1,m=r.getUint32(52,o),p=r.getUint32(56,o),b=r.getUint32(60,o);if(0===d||1!==c)throw new Error("Only 2D textures are supported");if(1!==m)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==u)throw new Error("WebGL does not support array textures");const f=h+3&-4,g=d+3&-4,F=new Array(u);let y,v=h*d;if(0===s&&(v=f*g),y=0!==s?Es[s]?Es[s]*As[n]:Ps[s]:fs[l],void 0===y)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const x=i?function(e,t,i){const r=new Map;let o=0;for(;o<t;){const s=e.getUint32(64+o,i),n=64+o+4,l=3-(s+3)%4;if(0===s||s>t-o){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let a=0;for(;a<s&&0!==e.getUint8(n+a);a++);if(-1===a){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=(new TextDecoder).decode(new Uint8Array(e.buffer,n,a)),d=new DataView(e.buffer,n+a+1,s-a-1);r.set(h,d),o+=4+s+l}return r}(r,b,o):null;let _=v*y,w=h,S=d,T=f,E=g,A=64+b;for(let e=0;e<p;e++){const i=r.getUint32(A,o);let n=A+4;for(let i=0;i<u;i++){let r=F[i];r||(r=F[i]=new Array(p)),r[e]={levelID:e,levelWidth:p>1||0!==s?w:T,levelHeight:p>1||0!==s?S:E,levelBuffer:new Uint8Array(t,n,_)},n+=_}A+=i+4,A=A%4!=0?A+4-A%4:A,w=w>>1||1,S=S>>1||1,T=w+4-1&-4,E=S+4-1&-4,_=T*E*y}return 0!==s?{uncompressed:F.map((e=>{let t=e[0].levelBuffer,i=!1;return s===a.FLOAT?t=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):s===a.UNSIGNED_INT?(i=!0,t=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):s===a.INT&&(i=!0,t=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new lt(t,{width:e[0].levelWidth,height:e[0].levelHeight}),type:s,format:i?Cs(n):n}})),kvData:x}:{compressed:F.map((e=>new _s(null,{format:l,width:h,height:d,levels:p,levelBuffers:e}))),kvData:x}}(e,o),h=s??n,d={mipmap:u.OFF,alphaMode:m.NO_PREMULTIPLIED_ALPHA,resolution:Ye(e),...t.data},c=h.map((t=>{h===n&&Object.assign(d,{type:t.type,format:t.format});const r=new dt(t,d);return r.ktxKeyValueData=l,Qo(r,i,e)}));return 1===c.length?c[0]:c},unload(e){Array.isArray(e)?e.forEach((e=>e.destroy(!0))):e.destroy(!0)}};Je.add(Bs);const Ms={extension:qe.ResolveParser,test:e=>{const t=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(t)},parse:e=>{if("ktx"===e.split("?")[0].split(".").pop()){const t=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(t.some((t=>e.endsWith(t))))return{resolution:parseFloat(x.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t.find((t=>e.endsWith(t))),src:e}}return{resolution:parseFloat(x.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e}}};Je.add(Ms);const Rs=new At,Is=class{constructor(e){this.renderer=e}async image(e,t,i){const r=new Image;return r.src=await this.base64(e,t,i),r}async base64(e,t,i){const r=this.canvas(e);if(void 0!==r.toBlob)return new Promise(((e,o)=>{r.toBlob((t=>{if(!t)return void o(new Error("ICanvas.toBlob failed!"));const i=new FileReader;i.onload=()=>e(i.result),i.onerror=o,i.readAsDataURL(t)}),t,i)}));if(void 0!==r.toDataURL)return r.toDataURL(t,i);if(void 0!==r.convertToBlob){const e=await r.convertToBlob({type:t,quality:i});return new Promise(((t,i)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=i,r.readAsDataURL(e)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:i,width:r,height:o,flipY:s}=this._rawPixels(e,t);s&&Is._flipY(i,r,o),Is._unpremultiplyAlpha(i);const n=new je(r,o,1),l=new ImageData(new Uint8ClampedArray(i.buffer),r,o);return n.context.putImageData(l,0,0),n.canvas}pixels(e,t){const{pixels:i,width:r,height:o,flipY:s}=this._rawPixels(e,t);return s&&Is._flipY(i,r,o),Is._unpremultiplyAlpha(i),i}_rawPixels(e,t){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let r,o,s=!1,n=!1;if(e&&(e instanceof Ci?o=e:(o=i.generateTexture(e,{resolution:i.resolution,multisample:i.multisample}),n=!0)),o){if(r=o.baseTexture.resolution,t=t??o.frame,s=!1,!n){i.renderTexture.bind(o);const e=o.framebuffer.glFramebuffers[i.CONTEXT_UID];e.blitFramebuffer&&i.framebuffer.bind(e.blitFramebuffer)}}else r=i.resolution,t||((t=Rs).width=i.width/r,t.height=i.height/r),s=!0,i.renderTexture.bind();const l=Math.round(t.width*r),a=Math.round(t.height*r),h=new Uint8Array(4*l*a),d=i.gl;return d.readPixels(Math.round(t.x*r),Math.round(t.y*r),l,a,d.RGBA,d.UNSIGNED_BYTE,h),n&&o?.destroy(!0),{pixels:h,width:l,height:a,flipY:s}}destroy(){this.renderer=null}static _flipY(e,t,i){const r=t<<2,o=i>>1,s=new Uint8Array(r);for(let t=0;t<o;t++){const o=t*r,n=(i-t-1)*r;s.set(e.subarray(o,o+r)),e.copyWithin(o,n,n+r),e.set(s,n)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let i=0;i<t;i+=4){const t=e[i+3];if(0!==t){const r=255.001/t;e[i]=e[i]*r+.5,e[i+1]=e[i+1]*r+.5,e[i+2]=e[i+2]*r+.5}}}};let Ds=Is;Ds.extension={name:"extract",type:qe.RendererSystem},Je.add(Ds);const Os={build(e){const t=e.points;let i,r,o,s,n,l;if(e.type===St.CIRC){const t=e.shape;i=t.x,r=t.y,n=l=t.radius,o=s=0}else if(e.type===St.ELIP){const t=e.shape;i=t.x,r=t.y,n=t.width,l=t.height,o=s=0}else{const t=e.shape,a=t.width/2,h=t.height/2;i=t.x+a,r=t.y+h,n=l=Math.max(0,Math.min(t.radius,Math.min(a,h))),o=a-n,s=h-l}if(!(n>=0&&l>=0&&o>=0&&s>=0))return void(t.length=0);const a=Math.ceil(2.3*Math.sqrt(n+l)),h=8*a+(o?4:0)+(s?4:0);if(t.length=h,0===h)return;if(0===a)return t.length=8,t[0]=t[6]=i+o,t[1]=t[3]=r+s,t[2]=t[4]=i-o,void(t[5]=t[7]=r-s);let d=0,c=4*a+(o?2:0)+2,u=c,m=h;{const e=o+n,l=s,a=i+e,h=i-e,p=r+l;if(t[d++]=a,t[d++]=p,t[--c]=p,t[--c]=h,s){const e=r-l;t[u++]=h,t[u++]=e,t[--m]=e,t[--m]=a}}for(let e=1;e<a;e++){const h=Math.PI/2*(e/a),p=o+Math.cos(h)*n,b=s+Math.sin(h)*l,f=i+p,g=i-p,F=r+b,y=r-b;t[d++]=f,t[d++]=F,t[--c]=F,t[--c]=g,t[u++]=g,t[u++]=y,t[--m]=y,t[--m]=f}{const e=s+l,n=i+o,a=i-o,h=r+e,c=r-e;t[d++]=n,t[d++]=h,t[--m]=c,t[--m]=n,o&&(t[d++]=a,t[d++]=h,t[--m]=c,t[--m]=a)}},triangulate(e,t){const i=e.points,r=t.points,o=t.indices;if(0===i.length)return;let s=r.length/2;const n=s;let l,a;if(e.type!==St.RREC){const t=e.shape;l=t.x,a=t.y}else{const t=e.shape;l=t.x+t.width/2,a=t.y+t.height/2}const h=e.matrix;r.push(e.matrix?h.a*l+h.c*a+h.tx:l,e.matrix?h.b*l+h.d*a+h.ty:a),s++,r.push(i[0],i[1]);for(let e=2;e<i.length;e+=2)r.push(i[e],i[e+1]),o.push(s++,n,s);o.push(n+1,n,s)}};function Ns(e,t=!1){const i=e.length;if(i<6)return;let r=0;for(let t=0,o=e[i-2],s=e[i-1];t<i;t+=2){const i=e[t],n=e[t+1];r+=(i-o)*(n+s),o=i,s=n}if(!t&&r>0||t&&r<=0){const t=i/2;for(let r=t+t%2;r<i;r+=2){const t=i-r-2,o=i-r-1,s=r,n=r+1;[e[t],e[s]]=[e[s],e[t]],[e[o],e[n]]=[e[n],e[o]]}}}const Ls={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let i=e.points;const r=e.holes,o=t.points,s=t.indices;if(i.length>=6){Ns(i,!1);const e=[];for(let t=0;t<r.length;t++){const o=r[t];Ns(o.points,!0),e.push(i.length/2),i=i.concat(o.points)}const t=U(i,e,2);if(!t)return;const n=o.length/2;for(let e=0;e<t.length;e+=3)s.push(t[e]+n),s.push(t[e+1]+n),s.push(t[e+2]+n);for(let e=0;e<i.length;e++)o.push(i[e])}}},zs={build(e){const t=e.shape,i=t.x,r=t.y,o=t.width,s=t.height,n=e.points;n.length=0,o>=0&&s>=0&&n.push(i,r,i+o,r,i+o,r+s,i,r+s)},triangulate(e,t){const i=e.points,r=t.points;if(0===i.length)return;const o=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),t.indices.push(o,o+1,o+2,o+1,o+2,o+3)}},Gs={build(e){Os.build(e)},triangulate(e,t){Os.triangulate(e,t)}};var Us=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(Us||{}),Hs=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(Hs||{});const Vs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let i=Math.ceil(e/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};class js{static curveTo(e,t,i,r,o,s){const n=s[s.length-2],l=s[s.length-1]-t,a=n-e,h=r-t,d=i-e,c=Math.abs(l*d-a*h);if(c<1e-8||0===o)return s[s.length-2]===e&&s[s.length-1]===t||s.push(e,t),null;const u=l*l+a*a,m=h*h+d*d,p=l*h+a*d,b=o*Math.sqrt(u)/c,f=o*Math.sqrt(m)/c,g=b*p/u,F=f*p/m,y=b*d+f*a,v=b*h+f*l,x=a*(f+g),_=l*(f+g),w=d*(b+F),S=h*(b+F);return{cx:y+e,cy:v+t,radius:o,startAngle:Math.atan2(_-v,x-y),endAngle:Math.atan2(S-v,w-y),anticlockwise:a*h>d*l}}static arc(e,t,i,r,o,s,n,l,a){const h=n-s,d=Vs._segmentsCount(Math.abs(h)*o,40*Math.ceil(Math.abs(h)/xt)),c=h/(2*d),u=2*c,m=Math.cos(c),p=Math.sin(c),b=d-1,f=b%1/b;for(let e=0;e<=b;++e){const t=c+s+u*(e+f*e),n=Math.cos(t),l=-Math.sin(t);a.push((m*n+p*l)*o+i,(m*-l+p*n)*o+r)}}}class Ws{static curveLength(e,t,i,r,o,s,n,l){let a=0,h=0,d=0,c=0,u=0,m=0,p=0,b=0,f=0,g=0,F=0,y=e,v=t;for(let x=1;x<=10;++x)h=x/10,d=h*h,c=d*h,u=1-h,m=u*u,p=m*u,b=p*e+3*m*h*i+3*u*d*o+c*n,f=p*t+3*m*h*r+3*u*d*s+c*l,g=y-b,F=v-f,y=b,v=f,a+=Math.sqrt(g*g+F*F);return a}static curveTo(e,t,i,r,o,s,n){const l=n[n.length-2],a=n[n.length-1];n.length-=2;const h=Vs._segmentsCount(Ws.curveLength(l,a,e,t,i,r,o,s));let d=0,c=0,u=0,m=0,p=0;n.push(l,a);for(let b=1,f=0;b<=h;++b)f=b/h,d=1-f,c=d*d,u=c*d,m=f*f,p=m*f,n.push(u*l+3*c*f*e+3*d*m*i+p*o,u*a+3*c*f*t+3*d*m*r+p*s)}}function Xs(e,t,i,r,o,s,n,l){let a,h;n?(a=r,h=-i):(a=-r,h=i);const d=e-i*o+a,c=t-r*o+h,u=e+i*s+a,m=t+r*s+h;return l.push(d,c,u,m),2}function $s(e,t,i,r,o,s,n,l){const a=i-e,h=r-t;let d=Math.atan2(a,h),c=Math.atan2(o-e,s-t);l&&d<c?d+=2*Math.PI:!l&&d>c&&(c+=2*Math.PI);let u=d;const m=c-d,p=Math.abs(m),b=Math.sqrt(a*a+h*h),f=1+(15*p*Math.sqrt(b)/Math.PI>>0),g=m/f;if(u+=g,l){n.push(e,t,i,r);for(let i=1,r=u;i<f;i++,r+=g)n.push(e,t,e+Math.sin(r)*b,t+Math.cos(r)*b);n.push(e,t,o,s)}else{n.push(i,r,e,t);for(let i=1,r=u;i<f;i++,r+=g)n.push(e+Math.sin(r)*b,t+Math.cos(r)*b,e,t);n.push(o,s,e,t)}return 2*f}function Ys(e,t){e.lineStyle.native?function(e,t){let i=0;const r=e.shape,o=e.points||r.points,s=r.type!==St.POLY||r.closeStroke;if(0===o.length)return;const n=t.points,l=t.indices,a=o.length/2,h=n.length/2;let d=h;for(n.push(o[0],o[1]),i=1;i<a;i++)n.push(o[2*i],o[2*i+1]),l.push(d,d+1),d++;s&&l.push(d,h)}(e,t):function(e,t){const i=e.shape;let r=e.points||i.points.slice();const o=t.closePointEps;if(0===r.length)return;const s=e.lineStyle,n=new Tt(r[0],r[1]),l=new Tt(r[r.length-2],r[r.length-1]),a=i.type!==St.POLY||i.closeStroke,h=Math.abs(n.x-l.x)<o&&Math.abs(n.y-l.y)<o;if(a){r=r.slice(),h&&(r.pop(),r.pop(),l.set(r[r.length-2],r[r.length-1]));const e=.5*(n.x+l.x),t=.5*(l.y+n.y);r.unshift(e,t),r.push(e,t)}const d=t.points,c=r.length/2;let u=r.length;const m=d.length/2,p=s.width/2,b=p*p,f=s.miterLimit*s.miterLimit;let g=r[0],F=r[1],y=r[2],v=r[3],x=0,_=0,w=-(F-v),S=g-y,T=0,E=0,A=Math.sqrt(w*w+S*S);w/=A,S/=A,w*=p,S*=p;const P=s.alignment,C=2*(1-P),k=2*P;a||(s.cap===Hs.ROUND?u+=$s(g-w*(C-k)*.5,F-S*(C-k)*.5,g-w*C,F-S*C,g+w*k,F+S*k,d,!0)+2:s.cap===Hs.SQUARE&&(u+=Xs(g,F,w,S,C,k,!0,d))),d.push(g-w*C,F-S*C,g+w*k,F+S*k);for(let e=1;e<c-1;++e){g=r[2*(e-1)],F=r[2*(e-1)+1],y=r[2*e],v=r[2*e+1],x=r[2*(e+1)],_=r[2*(e+1)+1],w=-(F-v),S=g-y,A=Math.sqrt(w*w+S*S),w/=A,S/=A,w*=p,S*=p,T=-(v-_),E=y-x,A=Math.sqrt(T*T+E*E),T/=A,E/=A,T*=p,E*=p;const t=y-g,i=F-v,o=y-x,n=_-v,l=t*o+i*n,a=i*o-n*t,h=a<0;if(Math.abs(a)<.001*Math.abs(l)){d.push(y-w*C,v-S*C,y+w*k,v+S*k),l>=0&&(s.join===Us.ROUND?u+=$s(y,v,y-w*C,v-S*C,y-T*C,v-E*C,d,!1)+4:u+=2,d.push(y-T*k,v-E*k,y+T*C,v+E*C));continue}const c=(-w+g)*(-S+v)-(-w+y)*(-S+F),m=(-T+x)*(-E+v)-(-T+y)*(-E+_),P=(t*m-o*c)/a,B=(n*c-i*m)/a,M=(P-y)*(P-y)+(B-v)*(B-v),R=y+(P-y)*C,I=v+(B-v)*C,D=y-(P-y)*k,O=v-(B-v)*k,N=h?C:k,L=M<=Math.min(t*t+i*i,o*o+n*n)+N*N*b;let z=s.join;if(z===Us.MITER&&M/b>f&&(z=Us.BEVEL),L)switch(z){case Us.MITER:d.push(R,I,D,O);break;case Us.BEVEL:h?d.push(R,I,y+w*k,v+S*k,R,I,y+T*k,v+E*k):d.push(y-w*C,v-S*C,D,O,y-T*C,v-E*C,D,O),u+=2;break;case Us.ROUND:h?(d.push(R,I,y+w*k,v+S*k),u+=$s(y,v,y+w*k,v+S*k,y+T*k,v+E*k,d,!0)+4,d.push(R,I,y+T*k,v+E*k)):(d.push(y-w*C,v-S*C,D,O),u+=$s(y,v,y-w*C,v-S*C,y-T*C,v-E*C,d,!1)+4,d.push(y-T*C,v-E*C,D,O))}else{switch(d.push(y-w*C,v-S*C,y+w*k,v+S*k),z){case Us.MITER:h?d.push(D,O,D,O):d.push(R,I,R,I),u+=2;break;case Us.ROUND:u+=h?$s(y,v,y+w*k,v+S*k,y+T*k,v+E*k,d,!0)+2:$s(y,v,y-w*C,v-S*C,y-T*C,v-E*C,d,!1)+2}d.push(y-T*C,v-E*C,y+T*k,v+E*k),u+=2}}g=r[2*(c-2)],F=r[2*(c-2)+1],y=r[2*(c-1)],v=r[2*(c-1)+1],w=-(F-v),S=g-y,A=Math.sqrt(w*w+S*S),w/=A,S/=A,w*=p,S*=p,d.push(y-w*C,v-S*C,y+w*k,v+S*k),a||(s.cap===Hs.ROUND?u+=$s(y-w*(C-k)*.5,v-S*(C-k)*.5,y-w*C,v-S*C,y+w*k,v+S*k,d,!1)+2:s.cap===Hs.SQUARE&&(u+=Xs(y,v,w,S,C,k,!1,d)));const B=t.indices,M=Vs.epsilon*Vs.epsilon;for(let e=m;e<u+m-2;++e)g=d[2*e],F=d[2*e+1],y=d[2*(e+1)],v=d[2*(e+1)+1],x=d[2*(e+2)],_=d[2*(e+2)+1],Math.abs(g*(v-_)+y*(_-F)+x*(F-v))<M||B.push(e,e+1,e+2)}(e,t)}class qs{static curveLength(e,t,i,r,o,s){const n=e-2*i+o,l=t-2*r+s,a=2*i-2*e,h=2*r-2*t,d=4*(n*n+l*l),c=4*(n*a+l*h),u=a*a+h*h,m=2*Math.sqrt(d+c+u),p=Math.sqrt(d),b=2*d*p,f=2*Math.sqrt(u),g=c/p;return(b*m+p*c*(m-f)+(4*u*d-c*c)*Math.log((2*p+g+m)/(g+f)))/(4*b)}static curveTo(e,t,i,r,o){const s=o[o.length-2],n=o[o.length-1],l=Vs._segmentsCount(qs.curveLength(s,n,e,t,i,r));let a=0,h=0;for(let d=1;d<=l;++d){const c=d/l;a=s+(e-s)*c,h=n+(t-n)*c,o.push(a+(e+(i-e)*c-a)*c,h+(t+(r-t)*c-h)*c)}}}const Zs={[St.POLY]:Ls,[St.CIRC]:Os,[St.ELIP]:Os,[St.RECT]:zs,[St.RREC]:Gs},Ks=[],Js=[];class Qs{constructor(e,t=null,i=null,r=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=t,this.matrix=r,this.type=e.type}clone(){return new Qs(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class en{constructor(){this.reset()}begin(e,t,i){this.reset(),this.style=e,this.start=t,this.attribStart=i}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const tn=new Tt,rn=class extends vt{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Zr,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Js.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),Ks.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,i=null,r=null){const o=new Qs(e,t,i,r);return this.graphicsData.push(o),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const i=new Qs(e,null,null,t),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let i=0;i<t.length;++i){const r=t[i];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,tn):tn.copyFrom(e),r.shape.contains(tn.x,tn.y))){let e=!1;if(r.holes)for(let t=0;t<r.holes.length;t++)if(r.holes[t].shape.contains(tn.x,tn.y)){e=!0;break}if(!e)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let i=null,r=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],r=i.style);for(let o=this.shapeIndex;o<t.length;o++){this.shapeIndex++;const s=t[o],n=s.fillStyle,l=s.lineStyle;Zs[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix),(n.visible||l.visible)&&this.processHoles(s.holes);for(let t=0;t<2;t++){const o=0===t?n:l;if(!o.visible)continue;const a=o.texture.baseTexture,h=this.indices.length,d=this.points.length/2;a.wrapMode=c.REPEAT,0===t?this.processFill(s):this.processLine(s);const u=this.points.length/2-d;0!==u&&(i&&!this._compareStyles(r,o)&&(i.end(h,d),i=null),i||(i=Ks.pop()||new en,i.begin(o,h,d),this.batches.push(i),r=o),this.addUvs(this.points,e,o.texture,d,u,o.matrix))}}const o=this.indices.length,s=this.points.length/2;if(i&&i.end(o,s),0===this.batches.length)return void(this.batchable=!0);const n=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&n===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=n?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t)&&e.texture.baseTexture===t.texture.baseTexture&&e.color+e.alpha===t.color+t.alpha&&!!e.native==!!t.native}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const t=this.graphicsData[e],i=t.fillStyle,r=t.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,i=e.length;t<i;t++){const i=e[t];for(let e=0;e<i.size;e++){const t=i.start+e;this.indicesUint16[t]=this.indicesUint16[t]-i.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<2*rn.BATCHABLE_SIZE}buildDrawCalls(){let e=++dt._globalBatch;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Js.push(this.drawCalls[e]);this.drawCalls.length=0;const t=this.colors,i=this.textureIds;let r=Js.pop();r||(r=new ct,r.texArray=new di),r.texArray.count=0,r.start=0,r.size=0,r.type=s.TRIANGLES;let o=0,n=null,l=0,a=!1,h=s.TRIANGLES,d=0;this.drawCalls.push(r);for(let u=0;u<this.batches.length;u++){const m=this.batches[u],p=8,b=m.style,f=b.texture.baseTexture;a!==!!b.native&&(a=!!b.native,h=a?s.LINES:s.TRIANGLES,n=null,o=p,e++),n!==f&&(n=f,f._batchEnabled!==e&&(o===p&&(e++,o=0,r.size>0&&(r=Js.pop(),r||(r=new ct,r.texArray=new di),this.drawCalls.push(r)),r.start=d,r.size=0,r.texArray.count=0,r.type=h),f.touched=1,f._batchEnabled=e,f._batchLocation=o,f.wrapMode=c.REPEAT,r.texArray.elements[r.texArray.count++]=f,o++)),r.size+=m.size,d+=m.size,l=f._batchLocation,this.addColors(t,b.color,b.alpha,m.attribSize,m.attribStart),this.addTextureIds(i,l,m.attribSize,m.attribStart)}dt._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,i=this.colors,r=this.textureIds,o=new ArrayBuffer(3*e.length*4),s=new Float32Array(o),n=new Uint32Array(o);let l=0;for(let o=0;o<e.length/2;o++)s[l++]=e[2*o],s[l++]=e[2*o+1],s[l++]=t[2*o],s[l++]=t[2*o+1],n[l++]=i[o],s[l++]=r[o];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?Ls.triangulate(e,this):Zs[e.type].triangulate(e,this)}processLine(e){Ys(e,this);for(let t=0;t<e.holes.length;t++)Ys(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const i=e[t];Zs[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let i=0;i<e.length/2;i++){const r=e[2*i],o=e[2*i+1];e[2*i]=t.a*r+t.c*o+t.tx,e[2*i+1]=t.b*r+t.d*o+t.ty}}addColors(e,t,i,r,o=0){const s=Te.shared.setValue(t).toLittleEndianNumber(),n=Te.shared.setValue(s).toPremultiplied(i);e.length=Math.max(e.length,o+r);for(let t=0;t<r;t++)e[o+t]=n}addTextureIds(e,t,i,r=0){e.length=Math.max(e.length,r+i);for(let o=0;o<i;o++)e[r+o]=t}addUvs(e,t,i,r,o,s=null){let n=0;const l=t.length,a=i.frame;for(;n<o;){let i=e[2*(r+n)],o=e[2*(r+n)+1];if(s){const e=s.a*i+s.c*o+s.tx;o=s.b*i+s.d*o+s.ty,i=e}n++,t.push(i/a.width,o/a.height)}const h=i.baseTexture;(a.width<h.width||a.height<h.height)&&this.adjustUvs(t,i,l,o)}adjustUvs(e,t,i,r){const o=t.baseTexture,s=1e-6,n=i+2*r,l=t.frame,a=l.width/o.width,h=l.height/o.height;let d=l.x/l.width,c=l.y/l.height,u=Math.floor(e[i]+s),m=Math.floor(e[i+1]+s);for(let t=i+2;t<n;t+=2)u=Math.min(u,Math.floor(e[t]+s)),m=Math.min(m,Math.floor(e[t+1]+s));d-=u,c-=m;for(let t=i;t<n;t+=2)e[t]=(e[t]+d)*a,e[t+1]=(e[t+1]+c)*h}};let on=rn;on.BATCHABLE_SIZE=100;class sn{constructor(){this.color=16777215,this.alpha=1,this.texture=Pi.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new sn;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Pi.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class nn extends sn{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Hs.BUTT,this.join=Us.MITER,this.miterLimit=10}clone(){const e=new nn;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const ln={},an=class extends io{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new sn,this._lineStyle=new nn,this._matrix=null,this._holeMode=!1,this.state=it.for2d(),this._geometry=e||new on,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Te(16777215),this.blendMode=o.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new an(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,i,r=.5,o=!1){return"number"==typeof e&&(e={width:e,color:t,alpha:i,alignment:r,native:o}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:Pi.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Hs.BUTT,join:Us.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new kt,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new kt,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,r=i[i.length-2],o=i[i.length-1];return r===e&&o===t||i.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,i,r){this._initCurve();const o=this.currentPath.points;return 0===o.length&&this.moveTo(0,0),qs.curveTo(e,t,i,r,o),this}bezierCurveTo(e,t,i,r,o,s){return this._initCurve(),Ws.curveTo(e,t,i,r,o,s,this.currentPath.points),this}arcTo(e,t,i,r,o){this._initCurve(e,t);const s=this.currentPath.points,n=js.curveTo(e,t,i,r,o,s);if(n){const{cx:e,cy:t,radius:i,startAngle:r,endAngle:o,anticlockwise:s}=n;this.arc(e,t,i,r,o,s)}return this}arc(e,t,i,r,o,s=!1){if(r===o)return this;if(!s&&o<=r?o+=xt:s&&r<=o&&(r+=xt),0==o-r)return this;const n=e+Math.cos(r)*i,l=t+Math.sin(r)*i,a=this._geometry.closePointEps;let h=this.currentPath?this.currentPath.points:null;if(h){const e=Math.abs(h[h.length-2]-n),t=Math.abs(h[h.length-1]-l);e<a&&t<a||h.push(n,l)}else this.moveTo(n,l),h=this.currentPath.points;return js.arc(n,l,e,t,i,r,o,s,h),this}beginFill(e=0,t){return this.beginTextureFill({texture:Pi.WHITE,color:e,alpha:t})}normalizeColor(e){const t=Te.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:Pi.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,i,r){return this.drawShape(new At(e,t,i,r))}drawRoundedRect(e,t,i,r,o){return this.drawShape(new Bt(e,t,i,r,o))}drawCircle(e,t,i){return this.drawShape(new Pt(e,t,i))}drawEllipse(e,t,i,r){return this.drawShape(new Ct(e,t,i,r))}drawPolygon(...e){let t,i=!0;const r=e[0];r.points?(i=r.closeStroke,t=r.points):t=Array.isArray(e[0])?e[0]:e;const o=new kt(t);return o.closeStroke=i,this.drawShape(o),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return!(1!==e.length||e[0].shape.type!==St.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(let r=0;r<i;r++){const i=e.batches[r],o=i.style.color,s=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),n=new Float32Array(e.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),l={vertexData:s,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,2*i.start,i.size),uvs:n,_batchRGB:Te.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=l}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,i=this.batches.length;t<i;t++){const i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const t=this._resolveDirectShader(e),i=this._geometry,r=this.worldAlpha,o=t.uniforms,s=i.drawCalls;o.translationMatrix=this.transform.worldTransform,Te.shared.setValue(this._tintColor).premultiply(r).toArray(o.tint),e.shader.bind(t),e.geometry.bind(i,t),e.state.set(this.state);for(let t=0,r=s.length;t<r;t++)this._renderDrawCallDirect(e,i.drawCalls[t])}_renderDrawCallDirect(e,t){const{texArray:i,type:r,size:o,start:s}=t,n=i.count;for(let t=0;t<n;t++)e.texture.bind(i.elements[t],t);e.geometry.draw(r,o,s)}_resolveDirectShader(e){let t=this.shader;const i=this.pluginName;if(!t){if(!ln[i]){const{maxTextures:t}=e.plugins[i],r=new Int32Array(t);for(let e=0;e<t;e++)r[e]=e;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Mt,default:li.from({uSamplers:r},!0)},s=e.plugins[i]._shader.program;ln[i]=new ai(s,o)}t=ln[i]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:i,maxX:r,maxY:o}=e.bounds;this._bounds.addFrame(this.transform,t,i,r,o)}containsPoint(e){return this.worldTransform.applyInverse(e,an._TEMP_POINT),this._geometry.containsPoint(an._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=Te.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,i=t.a,r=t.b,o=t.c,s=t.d,n=t.tx,l=t.ty,a=this._geometry.points,h=this.vertexData;let d=0;for(let e=0;e<a.length;e+=2){const t=a[e],c=a[e+1];h[d++]=i*t+o*c+n,h[d++]=s*c+r*t+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};let hn=an;hn.curves=Vs,hn._TEMP_POINT=new Tt;class dn{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;this.data&&this.data.length===t.length||(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const cn=new Tt,un=new kt,mn=class extends io{constructor(e,t,i,r=s.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=i||it.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=x.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===s.TRIANGLES&&t.length<2*mn.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const r=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[r]),e.plugins[r].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,i=e._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const r=this.transform.worldTransform,o=r.a,s=r.b,n=r.c,l=r.d,a=r.tx,h=r.ty,d=this.vertexData;for(let e=0;e<d.length/2;e++){const i=t[2*e],r=t[2*e+1];d[2*e]=o*i+n*r+a,d[2*e+1]=s*i+l*r+h}if(this._roundPixels){const e=x.RESOLUTION;for(let t=0;t<d.length;++t)d[t]=Math.round(d[t]*e)/e}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new dn(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,cn);const t=this.geometry.getBuffer("aVertexPosition").data,i=un.points,r=this.geometry.getIndex().data,o=r.length,s=4===this.drawMode?3:1;for(let e=0;e+2<o;e+=s){const o=2*r[e],s=2*r[e+1],n=2*r[e+2];if(i[0]=t[o],i[1]=t[o+1],i[2]=t[s],i[3]=t[s+1],i[4]=t[n],i[5]=t[n+1],un.contains(cn.x,cn.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let pn=mn;pn.BATCHABLE_SIZE=100;class bn extends yt{constructor(e,t,i){super();const r=new mt(e),o=new mt(t,!0),s=new mt(i,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,a.FLOAT).addAttribute("aTextureCoord",o,2,!1,a.FLOAT).addIndex(s),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class fn extends ai{constructor(e,t){const i={uSampler:e,alpha:1,uTextureMatrix:Mt.IDENTITY,uColor:new Float32Array([1,1,1,1])};(t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t)).uniforms&&Object.assign(i,t.uniforms),super(t.program||si.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),i),this._colorDirty=!1,this.uvMatrix=new Vi(e),this.batchable=void 0===t.program,this.pluginName=t.pluginName,this._tintColor=new Te(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Te.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class gn{constructor(e,t,i){this.geometry=new yt,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let r=e[i];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||a.FLOAT,offset:r.offset},t[i]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new mt(function(e,t=null){const i=6*e;if((t=t||new Uint16Array(i)).length!==i)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${i}`);for(let e=0,r=0;e<i;e+=6,r+=4)t[e+0]=r+0,t[e+1]=r+1,t[e+2]=r+2,t[e+3]=r+0,t[e+4]=r+2,t[e+5]=r+3;return t}(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let e=0;e<this.dynamicProperties.length;++e){const i=this.dynamicProperties[e];i.offset=t,t+=i.size,this.dynamicStride+=i.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new mt(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let e=0;e<this.staticProperties.length;++e){const t=this.staticProperties[e];t.offset=r,r+=t.size,this.staticStride+=t.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new mt(this.staticData,!0,!1);for(let t=0;t<this.dynamicProperties.length;++t){const i=this.dynamicProperties[t];e.addAttribute(i.attributeName,this.dynamicBuffer,0,i.type===a.UNSIGNED_BYTE,i.type,4*this.dynamicStride,4*i.offset)}for(let t=0;t<this.staticProperties.length;++t){const i=this.staticProperties[t];e.addAttribute(i.attributeName,this.staticBuffer,0,i.type===a.UNSIGNED_BYTE,i.type,4*this.staticStride,4*i.offset)}}uploadDynamic(e,t,i){for(let r=0;r<this.dynamicProperties.length;r++){const o=this.dynamicProperties[r];o.uploadFunction(e,t,i,o.type===a.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,i){for(let r=0;r<this.staticProperties.length;r++){const o=this.staticProperties[r];o.uploadFunction(e,t,i,o.type===a.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class Fn extends ci{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Mt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:a.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=ai.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=it.for2d()}render(e){const t=e.children,i=e._maxSize,r=e._batchSize,o=this.renderer;let s=t.length;if(0===s)return;s>i&&!e.autoResize&&(s=i);let n=e._buffers;n||(n=e._buffers=this.generateBuffers(e));const l=t[0]._texture.baseTexture,a=l.alphaMode>0;this.state.blendMode=Ce(e.blendMode,a),o.state.set(this.state);const h=o.gl,d=e.worldTransform.copyTo(this.tempMatrix);d.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=d.toArray(!0),this.shader.uniforms.uColor=Te.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,a).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let c=!1;for(let i=0,l=0;i<s;i+=r,l+=1){let a=s-i;a>r&&(a=r),l>=n.length&&n.push(this._generateOneMoreBuffer(e));const d=n[l];d.uploadDynamic(t,i,a);const u=e._bufferUpdateIDs[l]||0;c=c||d._updateID<u,c&&(d._updateID=e._updateID,d.uploadStatic(t,i,a)),o.geometry.bind(d.geometry),h.drawElements(h.TRIANGLES,6*a,h.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],i=e._maxSize,r=e._batchSize,o=e._properties;for(let e=0;e<i;e+=r)t.push(new gn(this.properties,o,r));return t}_generateOneMoreBuffer(e){const t=e._batchSize,i=e._properties;return new gn(this.properties,i,t)}uploadVertices(e,t,i,r,o,s){let n=0,l=0,a=0,h=0;for(let d=0;d<i;++d){const i=e[t+d],c=i._texture,u=i.scale.x,m=i.scale.y,p=c.trim,b=c.orig;p?(l=p.x-i.anchor.x*b.width,n=l+p.width,h=p.y-i.anchor.y*b.height,a=h+p.height):(n=b.width*(1-i.anchor.x),l=b.width*-i.anchor.x,a=b.height*(1-i.anchor.y),h=b.height*-i.anchor.y),r[s]=l*u,r[s+1]=h*m,r[s+o]=n*u,r[s+o+1]=h*m,r[s+2*o]=n*u,r[s+2*o+1]=a*m,r[s+3*o]=l*u,r[s+3*o+1]=a*m,s+=4*o}}uploadPosition(e,t,i,r,o,s){for(let n=0;n<i;n++){const i=e[t+n].position;r[s]=i.x,r[s+1]=i.y,r[s+o]=i.x,r[s+o+1]=i.y,r[s+2*o]=i.x,r[s+2*o+1]=i.y,r[s+3*o]=i.x,r[s+3*o+1]=i.y,s+=4*o}}uploadRotation(e,t,i,r,o,s){for(let n=0;n<i;n++){const i=e[t+n].rotation;r[s]=i,r[s+o]=i,r[s+2*o]=i,r[s+3*o]=i,s+=4*o}}uploadUvs(e,t,i,r,o,s){for(let n=0;n<i;++n){const i=e[t+n]._texture._uvs;i?(r[s]=i.x0,r[s+1]=i.y0,r[s+o]=i.x1,r[s+o+1]=i.y1,r[s+2*o]=i.x2,r[s+2*o+1]=i.y2,r[s+3*o]=i.x3,r[s+3*o+1]=i.y3,s+=4*o):(r[s]=0,r[s+1]=0,r[s+o]=0,r[s+o+1]=0,r[s+2*o]=0,r[s+2*o+1]=0,r[s+3*o]=0,r[s+3*o+1]=0,s+=4*o)}}uploadTint(e,t,i,r,o,s){for(let n=0;n<i;++n){const i=e[t+n],l=Te.shared.setValue(i._tintRGB).toPremultiplied(i.alpha,i.texture.baseTexture.alphaMode>0);r[s]=l,r[s+o]=l,r[s+2*o]=l,r[s+3*o]=l,s+=4*o}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Fn.extension={name:"particle",type:qe.RendererPlugin},Je.add(Fn);var yn=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(yn||{});const vn={willReadFrequently:!0},xn=class{static get experimentalLetterSpacingSupported(){let e=xn._experimentalLetterSpacingSupported;if(void 0!==e){const t=x.ADAPTER.getCanvasRenderingContext2D().prototype;e=xn._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,r,o,s,n,l,a){this.text=e,this.style=t,this.width=i,this.height=r,this.lines=o,this.lineWidths=s,this.lineHeight=n,this.maxLineWidth=l,this.fontProperties=a}static measureText(e,t,i,r=xn._canvas){i=null==i?t.wordWrap:i;const o=t.toFontString(),s=xn.measureFont(o);0===s.fontSize&&(s.fontSize=t.fontSize,s.ascent=t.fontSize);const n=r.getContext("2d",vn);n.font=o;const l=(i?xn.wordWrap(e,t,r):e).split(/(?:\r\n|\r|\n)/),a=new Array(l.length);let h=0;for(let e=0;e<l.length;e++){const i=xn._measureText(l[e],t.letterSpacing,n);a[e]=i,h=Math.max(h,i)}let d=h+t.strokeThickness;t.dropShadow&&(d+=t.dropShadowDistance);const c=t.lineHeight||s.fontSize+t.strokeThickness;let u=Math.max(c,s.fontSize+2*t.strokeThickness)+(l.length-1)*(c+t.leading);return t.dropShadow&&(u+=t.dropShadowDistance),new xn(e,t,d,u,l,a,c+t.leading,h,s)}static _measureText(e,t,i){let r=!1;xn.experimentalLetterSpacingSupported&&(xn.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,r=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let o=i.measureText(e).width;return o>0&&(r?o-=t:o+=(xn.graphemeSegmenter(e).length-1)*t),o}static wordWrap(e,t,i=xn._canvas){const r=i.getContext("2d",vn);let o=0,s="",n="";const l=Object.create(null),{letterSpacing:a,whiteSpace:h}=t,d=xn.collapseSpaces(h),c=xn.collapseNewlines(h);let u=!d;const m=t.wordWrapWidth+a,p=xn.tokenize(e);for(let e=0;e<p.length;e++){let i=p[e];if(xn.isNewline(i)){if(!c){n+=xn.addLine(s),u=!d,s="",o=0;continue}i=" "}if(d){const e=xn.isBreakingSpace(i),t=xn.isBreakingSpace(s[s.length-1]);if(e&&t)continue}const h=xn.getFromCache(i,a,l,r);if(h>m)if(""!==s&&(n+=xn.addLine(s),s="",o=0),xn.canBreakWords(i,t.breakWords)){const e=xn.wordWrapSplit(i);for(let h=0;h<e.length;h++){let d=e[h],c=d,p=1;for(;e[h+p];){const r=e[h+p];if(xn.canBreakChars(c,r,i,h,t.breakWords))break;d+=r,c=r,p++}h+=p-1;const b=xn.getFromCache(d,a,l,r);b+o>m&&(n+=xn.addLine(s),u=!1,s="",o=0),s+=d,o+=b}}else{s.length>0&&(n+=xn.addLine(s),s="",o=0);const t=e===p.length-1;n+=xn.addLine(i,!t),u=!1,s="",o=0}else h+o>m&&(u=!1,n+=xn.addLine(s),s="",o=0),(s.length>0||!xn.isBreakingSpace(i)||u)&&(s+=i,o+=h)}return n+=xn.addLine(s,!1),n}static addLine(e,t=!0){return e=xn.trimRight(e),t?`${e}\n`:e}static getFromCache(e,t,i,r){let o=i[e];return"number"!=typeof o&&(o=xn._measureText(e,t,r)+t,i[e]=o),o}static collapseSpaces(e){return"normal"===e||"pre-line"===e}static collapseNewlines(e){return"normal"===e}static trimRight(e){if("string"!=typeof e)return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!xn.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static isNewline(e){return"string"==typeof e&&xn._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return"string"==typeof e&&xn._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let i="";if("string"!=typeof e)return t;for(let r=0;r<e.length;r++){const o=e[r],s=e[r+1];xn.isBreakingSpace(o,s)||xn.isNewline(o)?(""!==i&&(t.push(i),i=""),t.push(o)):i+=o}return""!==i&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,r,o){return!0}static wordWrapSplit(e){return xn.graphemeSegmenter(e)}static measureFont(e){if(xn._fonts[e])return xn._fonts[e];const t={ascent:0,descent:0,fontSize:0},i=xn._canvas,r=xn._context;r.font=e;const o=xn.METRICS_STRING+xn.BASELINE_SYMBOL,s=Math.ceil(r.measureText(o).width);let n=Math.ceil(r.measureText(xn.BASELINE_SYMBOL).width);const l=Math.ceil(xn.HEIGHT_MULTIPLIER*n);if(n=n*xn.BASELINE_MULTIPLIER|0,0===s||0===l)return xn._fonts[e]=t,t;i.width=s,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,s,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(o,0,n);const a=r.getImageData(0,0,s,l).data,h=a.length,d=4*s;let c=0,u=0,m=!1;for(c=0;c<n;++c){for(let e=0;e<d;e+=4)if(255!==a[u+e]){m=!0;break}if(m)break;u+=d}for(t.ascent=n-c,u=h-d,m=!1,c=l;c>n;--c){for(let e=0;e<d;e+=4)if(255!==a[u+e]){m=!0;break}if(m)break;u-=d}return t.descent=c-n,t.fontSize=t.ascent+t.descent,xn._fonts[e]=t,t}static clearMetrics(e=""){e?delete xn._fonts[e]:xn._fonts={}}static get _canvas(){if(!xn.__canvas){let e;try{const t=new OffscreenCanvas(0,0),i=t.getContext("2d",vn);if(i?.measureText)return xn.__canvas=t,t;e=x.ADAPTER.createCanvas()}catch(t){e=x.ADAPTER.createCanvas()}e.width=e.height=10,xn.__canvas=e}return xn.__canvas}static get _context(){return xn.__context||(xn.__context=xn._canvas.getContext("2d",vn)),xn.__context}};let _n=xn;_n.METRICS_STRING="|q",_n.BASELINE_SYMBOL="M",_n.BASELINE_MULTIPLIER=1.4,_n.HEIGHT_MULTIPLIER=2,_n.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map((e=>e.segment))}return e=>[...e]})(),_n.experimentalLetterSpacing=!1,_n._fonts={},_n._newlines=[10,13],_n._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const wn=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Sn=class{constructor(e){this.styleID=0,this.reset(),An(this,e,e)}clone(){const e={};return An(e,this,Sn.defaultStyle),new Sn(e)}reset(){An(this,Sn.defaultStyle,Sn.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=En(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=En(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0})(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=En(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let i=t[e].trim();/([\"\'])[^\'\"]+\1/.test(i)||wn.includes(i)||(i=`"${i}"`),t[e]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};let Tn=Sn;function En(e){const t=Te.shared;return Array.isArray(e)?e.map((e=>t.setValue(e).toHex())):t.setValue(e).toHex()}function An(e,t,i){for(const r in i)Array.isArray(t[r])?e[r]=t[r].slice():e[r]=t[r]}Tn.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:yn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};const Pn={texture:!0,children:!1,baseTexture:!0},Cn=class extends so{constructor(e,t,i){let r=!1;i||(i=x.ADAPTER.createCanvas(),r=!0),i.width=3,i.height=3;const o=Pi.from(i);o.orig=new At,o.trim=new At,super(o),this._ownCanvas=r,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=Cn.defaultResolution??x.RESOLUTION,this._autoResolution=Cn.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return _n.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Y("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),_n.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const i=this.context,r=_n.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=r.width,s=r.height,n=r.lines,l=r.lineHeight,a=r.lineWidths,h=r.maxLineWidth,d=r.fontProperties;let c,u;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+2*t.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+2*t.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=t.strokeThickness,i.textBaseline=t.textBaseline,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit;const m=t.dropShadow?2:1;for(let e=0;e<m;++e){const o=t.dropShadow&&0===e,m=o?Math.ceil(Math.max(1,s)+2*t.padding):0,p=m*this._resolution;if(o){i.fillStyle="black",i.strokeStyle="black";const e=t.dropShadowColor,r=t.dropShadowBlur*this._resolution,o=t.dropShadowDistance*this._resolution;i.shadowColor=Te.shared.setValue(e).setAlpha(t.dropShadowAlpha).toRgbaString(),i.shadowBlur=r,i.shadowOffsetX=Math.cos(t.dropShadowAngle)*o,i.shadowOffsetY=Math.sin(t.dropShadowAngle)*o+p}else i.fillStyle=this._generateFillStyle(t,n,r),i.strokeStyle=t.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let b=(l-d.fontSize)/2;l-d.fontSize<0&&(b=0);for(let e=0;e<n.length;e++)c=t.strokeThickness/2,u=t.strokeThickness/2+e*l+d.ascent+b,"right"===t.align?c+=h-a[e]:"center"===t.align&&(c+=(h-a[e])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(n[e],c+t.padding,u+t.padding-m,!0),t.fill&&this.drawLetterSpacing(n[e],c+t.padding,u+t.padding-m)}this.updateTexture()}drawLetterSpacing(e,t,i,r=!1){const o=this._style.letterSpacing;let s=!1;if(_n.experimentalLetterSpacingSupported&&(_n.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,s=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===o||s)return void(r?this.context.strokeText(e,t,i):this.context.fillText(e,t,i));let n=t;const l=_n.graphemeSegmenter(e);let a=this.context.measureText(e).width,h=0;for(let e=0;e<l.length;++e){const t=l[e];r?this.context.strokeText(t,n,i):this.context.fillText(t,n,i);let s="";for(let t=e+1;t<l.length;++t)s+=l[t];h=this.context.measureText(s).width,n+=a-h+o,a=h}}updateTexture(){const e=this.canvas;if(this._style.trim){const t=function(e){const t=function(e){const{width:t,height:i}=e,r=e.getContext("2d",{willReadFrequently:!0});if(null===r)throw new TypeError("Failed to get canvas 2D context");const o=r.getImageData(0,0,t,i).data;let s=0,n=0,l=t-1,a=i-1;for(;n<i&&We(o,t,n);)++n;if(n===i)return ze.EMPTY;for(;We(o,t,a);)--a;for(;Xe(o,t,s,n,a);)++s;for(;Xe(o,t,l,n,a);)--l;return++l,++a,new ze(s,n,l,a)}(e),{width:i,height:r}=t;let o=null;if(!t.isEmpty()){const s=e.getContext("2d");if(null===s)throw new TypeError("Failed to get canvas 2D context");o=s.getImageData(t.left,t.top,i,r)}return{width:i,height:r,data:o}}(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}const t=this._texture,i=this._style,r=i.trim?0:i.padding,o=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-2*r,t.orig.height=t._frame.height-2*r,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),-1===this._textureID&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,i){const r=e.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];let o;const s=e.dropShadow?e.dropShadowDistance:0,n=e.padding||0,l=this.canvas.width/this._resolution-s-2*n,a=this.canvas.height/this._resolution-s-2*n,h=r.slice(),d=e.fillGradientStops.slice();if(!d.length){const e=h.length+1;for(let t=1;t<e;++t)d.push(t/e)}if(h.unshift(r[0]),d.unshift(0),h.push(r[r.length-1]),d.push(1),e.fillGradientType===yn.LINEAR_VERTICAL){o=this.context.createLinearGradient(l/2,n,l/2,a+n);const r=i.fontProperties.fontSize+e.strokeThickness;for(let e=0;e<t.length;e++){const s=i.lineHeight*(e-1)+r,n=i.lineHeight*e;let l=n;e>0&&s>n&&(l=(n+s)/2);const c=n+r,u=i.lineHeight*(e+1);let m=c;e+1<t.length&&u<c&&(m=(c+u)/2);const p=(m-l)/a;for(let e=0;e<h.length;e++){let t=0;t="number"==typeof d[e]?d[e]:e/h.length;let i=Math.min(1,Math.max(0,l/a+t*p));i=Number(i.toFixed(5)),o.addColorStop(i,h[e])}}}else{o=this.context.createLinearGradient(n,a/2,l+n,a/2);const e=h.length+1;let t=1;for(let i=0;i<h.length;i++){let r;r="number"==typeof d[i]?d[i]:t/e,o.addColorStop(r,h[i]),t++}}return o}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Pn,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=De(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=De(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},this._style=e instanceof Tn?e:new Tn(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(null==e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};let kn=Cn;kn.defaultAutoResolution=!0;class Bn{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Mn(e,t){let i=!1;if(e?._textures?.length)for(let r=0;r<e._textures.length;r++)if(e._textures[r]instanceof Pi){const o=e._textures[r].baseTexture;t.includes(o)||(t.push(o),i=!0)}return i}function Rn(e,t){if(e.baseTexture instanceof dt){const i=e.baseTexture;return t.includes(i)||t.push(i),!0}return!1}function In(e,t){if(e._texture&&e._texture instanceof Pi){const i=e._texture.baseTexture;return t.includes(i)||t.push(i),!0}return!1}function Dn(e,t){return t instanceof kn&&(t.updateText(!0),!0)}function On(e,t){if(t instanceof Tn){const e=t.toFontString();return _n.measureFont(e),!0}return!1}function Nn(e,t){if(e instanceof kn){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const i=e._texture.baseTexture;return t.includes(i)||t.push(i),!0}return!1}function Ln(e,t){return e instanceof Tn&&(t.includes(e)||t.push(e),!0)}const zn=class{constructor(e){this.limiter=new Bn(zn.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Nn),this.registerFindHook(Ln),this.registerFindHook(Mn),this.registerFindHook(Rn),this.registerFindHook(In),this.registerUploadHook(Dn),this.registerUploadHook(On)}upload(e){return new Promise((t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Br.system.addOnce(this.tick,this,Pr.UTILITY))):t()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed)for(let i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)Br.system.addOnce(this.tick,this,Pr.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,i=e.length;t<i;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof io)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&Br.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Gn=zn;function Un(e,t){return t instanceof dt&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function Hn(e,t){if(!(t instanceof hn))return!1;const{geometry:i}=t;t.finishPoly(),i.updateBatches();const{batches:r}=i;for(let t=0;t<r.length;t++){const{texture:i}=r[t].style;i&&Un(e,i.baseTexture)}return i.batchable||e.geometry.bind(i,t._resolveDirectShader(e)),!0}function Vn(e,t){return e instanceof hn&&(t.push(e),!0)}Gn.uploadsPerFrame=4,Object.defineProperties(x,{UPLOADS_PER_FRAME:{get:()=>Gn.uploadsPerFrame,set(e){Y("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Gn.uploadsPerFrame=e}}});class jn extends Gn{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(Vn),this.registerUploadHook(Un),this.registerUploadHook(Hn)}}jn.extension={name:"prepare",type:qe.RendererSystem},Je.add(jn),new Tt;var Wn="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const Xn=new Mt;class $n extends ci{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new Mi,this.state=it.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=ai.from(Wn,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",t),this.shader=e.context.webGLVersion>1?ai.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",t):ai.from(Wn,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",t)}render(e){const t=this.renderer,i=this.quad;let r=i.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y);const o=e.uvRespectAnchor?e.anchor.x:0,s=e.uvRespectAnchor?e.anchor.y:0;r=i.uvs,r[0]=r[6]=-o,r[1]=r[3]=-s,r[2]=r[4]=1-o,r[5]=r[7]=1-s,i.invalidate();const n=e._texture,l=n.baseTexture,a=l.alphaMode>0,h=e.tileTransform.localTransform,d=e.uvMatrix;let u=l.isPowerOfTwo&&n.frame.width===l.width&&n.frame.height===l.height;u&&(l._glTextures[t.CONTEXT_UID]?u=l.wrapMode!==c.CLAMP:l.wrapMode===c.CLAMP&&(l.wrapMode=c.REPEAT));const m=u?this.simpleShader:this.shader,p=n.width,b=n.height,f=e._width,g=e._height;Xn.set(h.a*p/f,h.b*p/g,h.c*b/f,h.d*b/g,h.tx/f,h.ty/g),Xn.invert(),u?Xn.prepend(d.mapCoord):(m.uniforms.uMapCoord=d.mapCoord.toArray(!0),m.uniforms.uClampFrame=d.uClampFrame,m.uniforms.uClampOffset=d.uClampOffset),m.uniforms.uTransform=Xn.toArray(!0),m.uniforms.uColor=Te.shared.setValue(e.tint).premultiply(e.worldAlpha,a).toArray(m.uniforms.uColor),m.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),m.uniforms.uSampler=n,t.shader.bind(m),t.geometry.bind(i),this.state.blendMode=Ce(e.blendMode,a),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}$n.extension={name:"tilingSprite",type:qe.RendererPlugin},Je.add($n);const Yn=class{constructor(e,t,i=null){this.linkedSheets=[],this._texture=e instanceof Pi?e:null,this.baseTexture=e instanceof dt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const r=this.baseTexture.resource;this.resolution=this._updateResolution(i||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let i=Ye(e,null);return null===i&&(i=parseFloat(t??"1")),1!==i&&this.baseTexture.setResolution(i),i}parse(){return new Promise((e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Yn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(e){let t=e;const i=Yn.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const e=this._frameKeys[t],i=this._frames[e],r=i.frame;if(r){let t=null,o=null;const s=!1!==i.trimmed&&i.sourceSize?i.sourceSize:i.frame,n=new At(0,0,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution);t=i.rotated?new At(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.h)/this.resolution,Math.floor(r.w)/this.resolution):new At(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution),!1!==i.trimmed&&i.spriteSourceSize&&(o=new At(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution)),this.textures[e]=new Pi(this.baseTexture,t,n,o,i.rotated?2:0,i.anchor,i.borders),Pi.addToCache(this.textures[e],e)}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const r=e[t][i];this.animations[t].push(this.textures[r])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Yn.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*Yn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(e=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let qn=Yn;qn.BATCH_SIZE=1e3;const Zn=["jpg","png","jpeg","avif","webp"];function Kn(e,t,i){const r={};if(e.forEach((e=>{r[e]=t})),Object.keys(t.textures).forEach((e=>{r[e]=t.textures[e]})),!i){const i=X.dirname(e[0]);t.linkedSheets.forEach(((e,o)=>{const s=Kn([`${i}/${t.data.meta.related_multi_packs[o]}`],e,!0);Object.assign(r,s)}))}return r}const Jn={extension:qe.Asset,cache:{test:e=>e instanceof qn,getCacheableAssets:(e,t)=>Kn(e,t,!1)},resolver:{test:e=>{const t=e.split("?")[0].split("."),i=t.pop(),r=t.pop();return"json"===i&&Zn.includes(r)},parse:e=>{const t=e.split(".");return{resolution:parseFloat(x.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:qe.LoadParser,priority:Lo.Normal},testParse:async(e,t)=>".json"===X.extname(t.src).toLowerCase()&&!!e.frames,async parse(e,t,i){let r=X.dirname(t.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let o=r+e.meta.image;o=ps(o,t.src);const s=(await i.load([o]))[o],n=new qn(s.baseTexture,e,t.src);await n.parse();const l=e?.meta?.related_multi_packs;if(Array.isArray(l)){const e=[];for(const o of l){if("string"!=typeof o)continue;let s=r+o;t.data?.ignoreMultiPack||(s=ps(s,t.src),e.push(i.load({src:s,data:{ignoreMultiPack:!0}})))}const o=await Promise.all(e);n.linkedSheets=o,o.forEach((e=>{e.linkedSheets=[n].concat(n.linkedSheets.filter((t=>t!==e)))}))}return n},unload(e){e.destroy(!0)}}};Je.add(Jn);class Qn{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class el{static test(e){return"string"==typeof e&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const e in t){const r=t[e].match(/^[a-z]+/gm)[0],o=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(const e in o){const t=o[e].split("="),i=t[0],r=t[1].replace(/"/gm,""),n=parseFloat(r),l=isNaN(n)?r:n;s[i]=l}i[r].push(s)}const r=new Qn;return i.info.forEach((e=>r.info.push({face:e.face,size:parseInt(e.size,10)}))),i.common.forEach((e=>r.common.push({lineHeight:parseInt(e.lineHeight,10)}))),i.page.forEach((e=>r.page.push({id:parseInt(e.id,10),file:e.file}))),i.char.forEach((e=>r.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)}))),i.kerning.forEach((e=>r.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)}))),i.distanceField.forEach((e=>r.distanceField.push({distanceRange:parseInt(e.distanceRange,10),fieldType:e.fieldType}))),r}}class tl{static test(e){const t=e;return"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")}static parse(e){const t=new Qn,i=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),o=e.getElementsByTagName("page"),s=e.getElementsByTagName("char"),n=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let e=0;e<i.length;e++)t.info.push({face:i[e].getAttribute("face"),size:parseInt(i[e].getAttribute("size"),10)});for(let e=0;e<r.length;e++)t.common.push({lineHeight:parseInt(r[e].getAttribute("lineHeight"),10)});for(let e=0;e<o.length;e++)t.page.push({id:parseInt(o[e].getAttribute("id"),10)||0,file:o[e].getAttribute("file")});for(let e=0;e<s.length;e++){const i=s[e];t.char.push({id:parseInt(i.getAttribute("id"),10),page:parseInt(i.getAttribute("page"),10)||0,x:parseInt(i.getAttribute("x"),10),y:parseInt(i.getAttribute("y"),10),width:parseInt(i.getAttribute("width"),10),height:parseInt(i.getAttribute("height"),10),xoffset:parseInt(i.getAttribute("xoffset"),10),yoffset:parseInt(i.getAttribute("yoffset"),10),xadvance:parseInt(i.getAttribute("xadvance"),10)})}for(let e=0;e<n.length;e++)t.kerning.push({first:parseInt(n[e].getAttribute("first"),10),second:parseInt(n[e].getAttribute("second"),10),amount:parseInt(n[e].getAttribute("amount"),10)});for(let e=0;e<l.length;e++)t.distanceField.push({fieldType:l[e].getAttribute("fieldType"),distanceRange:parseInt(l[e].getAttribute("distanceRange"),10)});return t}}class il{static test(e){return!("string"!=typeof e||!e.includes("<font>"))&&tl.test(x.ADAPTER.parseXML(e))}static parse(e){return tl.parse(x.ADAPTER.parseXML(e))}}const rl=[el,tl,il];function ol(e,t,i,r,o,s,n){const l=i.text,a=i.fontProperties;t.translate(r,o),t.scale(s,s);const h=n.strokeThickness/2,d=-n.strokeThickness/2;if(t.font=n.toFontString(),t.lineWidth=n.strokeThickness,t.textBaseline=n.textBaseline,t.lineJoin=n.lineJoin,t.miterLimit=n.miterLimit,t.fillStyle=function(e,t,i,r,o,s){const n=i.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];let l;const a=i.dropShadow?i.dropShadowDistance:0,h=i.padding||0,d=e.width/r-a-2*h,c=e.height/r-a-2*h,u=n.slice(),m=i.fillGradientStops.slice();if(!m.length){const e=u.length+1;for(let t=1;t<e;++t)m.push(t/e)}if(u.unshift(n[0]),m.unshift(0),u.push(n[n.length-1]),m.push(1),i.fillGradientType===yn.LINEAR_VERTICAL){l=t.createLinearGradient(d/2,h,d/2,c+h);let e=0;const r=(s.fontProperties.fontSize+i.strokeThickness)/c;for(let t=0;t<o.length;t++){const i=s.lineHeight*t;for(let t=0;t<u.length;t++){let o=0;o="number"==typeof m[t]?m[t]:t/u.length;const s=i/c+o*r;let n=Math.max(e,s);n=Math.min(n,1),l.addColorStop(n,u[t]),e=n}}}else{l=t.createLinearGradient(h,c/2,d+h,c/2);const e=u.length+1;let i=1;for(let t=0;t<u.length;t++){let r;r="number"==typeof m[t]?m[t]:i/e,l.addColorStop(r,u[t]),i++}}return l}(e,t,n,s,[l],i),t.strokeStyle=n.stroke,n.dropShadow){const e=n.dropShadowColor,i=n.dropShadowBlur*s,r=n.dropShadowDistance*s;t.shadowColor=Te.shared.setValue(e).setAlpha(n.dropShadowAlpha).toRgbaString(),t.shadowBlur=i,t.shadowOffsetX=Math.cos(n.dropShadowAngle)*r,t.shadowOffsetY=Math.sin(n.dropShadowAngle)*r}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;n.stroke&&n.strokeThickness&&t.strokeText(l,h,d+i.lineHeight-a.descent),n.fill&&t.fillText(l,h,d+i.lineHeight-a.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function sl(e){return Array.from?Array.from(e):e.split("")}function nl(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}const ll=class{constructor(e,t,i){const[r]=e.info,[o]=e.common,[s]=e.page,[n]=e.distanceField,l=Ye(s.file),a={};this._ownsTextures=i,this.font=r.face,this.size=r.size,this.lineHeight=o.lineHeight/l,this.chars={},this.pageTextures=a;for(let i=0;i<e.page.length;i++){const{id:r,file:o}=e.page[i];a[r]=t instanceof Array?t[i]:t[o],n?.fieldType&&"none"!==n.fieldType&&(a[r].baseTexture.alphaMode=m.NO_PREMULTIPLIED_ALPHA,a[r].baseTexture.mipmap=u.OFF)}for(let t=0;t<e.char.length;t++){const{id:i,page:r}=e.char[t];let{x:o,y:s,width:n,height:h,xoffset:d,yoffset:c,xadvance:u}=e.char[t];o/=l,s/=l,n/=l,h/=l,d/=l,c/=l,u/=l;const m=new At(o+a[r].frame.x/l,s+a[r].frame.y/l,n,h);this.chars[i]={xOffset:d,yOffset:c,xAdvance:u,kerning:{},texture:new Pi(a[r].baseTexture,m),page:r}}for(let t=0;t<e.kerning.length;t++){let{first:i,second:r,amount:o}=e.kerning[t];i/=l,r/=l,o/=l,this.chars[r]&&(this.chars[r].kerning[i]=o)}this.distanceFieldRange=n?.distanceRange,this.distanceFieldType=n?.fieldType?.toLowerCase()??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,i){let r;if(e instanceof Qn)r=e;else{const t=function(e){for(let t=0;t<rl.length;t++)if(rl[t].test(e))return rl[t];return null}(e);if(!t)throw new Error("Unrecognized data format for font.");r=t.parse(e)}t instanceof Pi&&(t=[t]);const o=new ll(r,t,i);return ll.available[o.font]=o,o}static uninstall(e){const t=ll.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete ll.available[e]}static from(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:o,resolution:s,textureWidth:n,textureHeight:l,...a}=Object.assign({},ll.defaultOptions,i),h=function(e){"string"==typeof e&&(e=[e]);const t=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];if(Array.isArray(r)){if(2!==r.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const e=r[0].charCodeAt(0),i=r[1].charCodeAt(0);if(i<e)throw new Error("[BitmapFont]: Invalid character range.");for(let r=e,o=i;r<=o;r++)t.push(String.fromCharCode(r))}else t.push(...sl(r))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}(r),d=t instanceof Tn?t:new Tn(t),c=n,u=new Qn;u.info[0]={face:d.fontFamily,size:d.fontSize},u.common[0]={lineHeight:d.fontSize};let m,p,b,f=0,g=0,F=0;const y=[],v=[];for(let e=0;e<h.length;e++){m||(m=x.ADAPTER.createCanvas(),m.width=n,m.height=l,p=m.getContext("2d"),b=new dt(m,{resolution:s,...a}),y.push(b),v.push(new Pi(b)),u.page.push({id:v.length-1,file:""}));const t=h[e],i=_n.measureText(t,d,!1,m),r=i.width,_=Math.ceil(i.height),w=Math.ceil(("italic"===d.fontStyle?2:1)*r);if(g>=l-_*s){if(0===g)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${t}')`);--e,m=null,p=null,b=null,g=0,f=0,F=0;continue}if(F=Math.max(_+i.fontProperties.descent,F),w*s+f>=c){if(0===f)throw new Error(`[BitmapFont] textureWidth ${n}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${t}')`);--e,g+=F*s,g=Math.ceil(g),f=0,F=0;continue}ol(m,p,i,f,g,s,d);const S=nl(i.text);u.char.push({id:S,page:v.length-1,x:f/s,y:g/s,width:w,height:_,xoffset:0,yoffset:0,xadvance:r-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0)}),f+=(w+2*o)*s,f=Math.ceil(f)}for(let e=0,t=h.length;e<t;e++){const i=h[e];for(let e=0;e<t;e++){const t=h[e],r=p.measureText(i).width,o=p.measureText(t).width,s=p.measureText(i+t).width-(r+o);s&&u.kerning.push({first:nl(i),second:nl(t),amount:s})}}const _=new ll(u,v,!0);return void 0!==ll.available[e]&&ll.uninstall(e),ll.available[e]=_,_}};let al=ll;al.ALPHA=[["a","z"],["A","Z"]," "],al.NUMERIC=[["0","9"]],al.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],al.ASCII=[[" ","~"]],al.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ll.ALPHANUMERIC},al.available={};const hl=[],dl=[],cl=[],ul=class extends io{constructor(e,t={}){super();const{align:i,tint:r,maxWidth:o,letterSpacing:s,fontName:n,fontSize:l}=Object.assign({},ul.styleDefaults,t);if(!al.available[n])throw new Error(`Missing BitmapFont "${n}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new Te(r),this._font=void 0,this._fontName=n,this._fontSize=l,this.text=e,this._maxWidth=o,this._maxLineHeight=0,this._letterSpacing=s,this._anchor=new Ut((()=>{this.dirty=!0}),this,0,0),this._roundPixels=x.ROUND_PIXELS,this.dirty=!0,this._resolution=x.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const e=al.available[this._fontName],t=this.fontSize,i=t/e.size,r=new Tt,s=[],n=[],l=[],a=sl(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),h=this._maxWidth*e.size/t,d="none"===e.distanceFieldType?hl:dl;let c=null,u=0,m=0,p=0,b=-1,f=0,g=0,F=0,y=0;for(let t=0;t<a.length;t++){const i=a[t],o=nl(i);if(/(?:\s)/.test(i)&&(b=t,f=u,y++),"\r"===i||"\n"===i){n.push(u),l.push(-1),m=Math.max(m,u),++p,++g,r.x=0,r.y+=e.lineHeight,c=null,y=0;continue}const d=e.chars[o];if(!d)continue;c&&d.kerning[c]&&(r.x+=d.kerning[c]);const v=cl.pop()||{texture:Pi.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Tt};v.texture=d.texture,v.line=p,v.charCode=o,v.position.x=Math.round(r.x+d.xOffset+this._letterSpacing/2),v.position.y=Math.round(r.y+d.yOffset),v.prevSpaces=y,s.push(v),u=v.position.x+Math.max(d.xAdvance-d.xOffset,d.texture.orig.width),r.x+=d.xAdvance+this._letterSpacing,F=Math.max(F,d.yOffset+d.texture.height),c=o,-1!==b&&h>0&&r.x>h&&(++g,Ie(s,1+b-g,1+t-b),t=b,b=-1,n.push(f),l.push(s.length>0?s[s.length-1].prevSpaces:0),m=Math.max(m,f),p++,r.x=0,r.y+=e.lineHeight,c=null,y=0)}const v=a[a.length-1];"\r"!==v&&"\n"!==v&&(/(?:\s)/.test(v)&&(u=f),n.push(u),m=Math.max(m,u),l.push(-1));const x=[];for(let e=0;e<=p;e++){let t=0;"right"===this._align?t=m-n[e]:"center"===this._align?t=(m-n[e])/2:"justify"===this._align&&(t=l[e]<0?0:(m-n[e])/l[e]),x.push(t)}const _=s.length,w={},S=[],T=this._activePagesMeshData;d.push(...T);for(let t=0;t<_;t++){const i=s[t].texture,r=i.baseTexture.uid;if(!w[r]){let t=d.pop();if(!t){const i=new bn;let r,s;"none"===e.distanceFieldType?(r=new fn(Pi.EMPTY),s=o.NORMAL):(r=new fn(Pi.EMPTY,{program:si.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),s=o.NORMAL_NPM);const n=new pn(i,r);n.blendMode=s,t={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:n,vertices:null,uvs:null,indices:null}}t.index=0,t.indexCount=0,t.vertexCount=0,t.uvsCount=0,t.total=0;const{_textureCache:s}=this;s[r]=s[r]||new Pi(i.baseTexture),t.mesh.texture=s[r],t.mesh.tint=this._tintColor.value,S.push(t),w[r]=t}w[r].total++}for(let e=0;e<T.length;e++)S.includes(T[e])||this.removeChild(T[e].mesh);for(let e=0;e<S.length;e++)S[e].mesh.parent!==this&&this.addChild(S[e].mesh);this._activePagesMeshData=S;for(const e in w){const t=w[e],i=t.total;if(!(t.indices?.length>6*i)||t.vertices.length<2*pn.BATCHABLE_SIZE)t.vertices=new Float32Array(8*i),t.uvs=new Float32Array(8*i),t.indices=new Uint16Array(6*i);else{const e=t.total,i=t.vertices;for(let t=4*e*2;t<i.length;t++)i[t]=0}t.mesh.size=6*i}for(let e=0;e<_;e++){const t=s[e];let r=t.position.x+x[t.line]*("justify"===this._align?t.prevSpaces:1);this._roundPixels&&(r=Math.round(r));const o=r*i,n=t.position.y*i,l=t.texture,a=w[l.baseTexture.uid],h=l.frame,d=l._uvs,c=a.index++;a.indices[6*c+0]=0+4*c,a.indices[6*c+1]=1+4*c,a.indices[6*c+2]=2+4*c,a.indices[6*c+3]=0+4*c,a.indices[6*c+4]=2+4*c,a.indices[6*c+5]=3+4*c,a.vertices[8*c+0]=o,a.vertices[8*c+1]=n,a.vertices[8*c+2]=o+h.width*i,a.vertices[8*c+3]=n,a.vertices[8*c+4]=o+h.width*i,a.vertices[8*c+5]=n+h.height*i,a.vertices[8*c+6]=o,a.vertices[8*c+7]=n+h.height*i,a.uvs[8*c+0]=d.x0,a.uvs[8*c+1]=d.y0,a.uvs[8*c+2]=d.x1,a.uvs[8*c+3]=d.y1,a.uvs[8*c+4]=d.x2,a.uvs[8*c+5]=d.y2,a.uvs[8*c+6]=d.x3,a.uvs[8*c+7]=d.y3}this._textWidth=m*i,this._textHeight=(r.y+e.lineHeight)*i;for(const e in w){const t=w[e];if(0!==this.anchor.x||0!==this.anchor.y){let e=0;const i=this._textWidth*this.anchor.x,r=this._textHeight*this.anchor.y;for(let o=0;o<t.total;o++)t.vertices[e++]-=i,t.vertices[e++]-=r,t.vertices[e++]-=i,t.vertices[e++]-=r,t.vertices[e++]-=i,t.vertices[e++]-=r,t.vertices[e++]-=i,t.vertices[e++]-=r}this._maxLineHeight=F*i;const r=t.mesh.geometry.getBuffer("aVertexPosition"),o=t.mesh.geometry.getBuffer("aTextureCoord"),s=t.mesh.geometry.getIndex();r.data=t.vertices,o.data=t.uvs,s.data=t.indices,r.update(),o.update(),s.update()}for(let e=0;e<s.length;e++)cl.push(s[e]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:i,size:r}=al.available[this._fontName];if("none"!==i){const{a:i,b:o,c:s,d:n}=this.worldTransform,l=Math.sqrt(i*i+o*o),a=Math.sqrt(s*s+n*n),h=(Math.abs(l)+Math.abs(a))/2,d=this.fontSize/r,c=e._view.resolution;for(const e of this._activePagesMeshData)e.mesh.shader.uniforms.uFWidth=h*t*d*c}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=al.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!al.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??al.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(null==e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,i="none"===al.available[this._fontName].distanceFieldType?hl:dl;i.push(...this._activePagesMeshData);for(const e of this._activePagesMeshData)this.removeChild(e.mesh);this._activePagesMeshData=[],i.filter((e=>t[e.mesh.texture.baseTexture.uid])).forEach((e=>{e.mesh.texture=Pi.EMPTY}));for(const e in t)t[e].destroy(),delete t[e];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};ul.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const ml=[".xml",".fnt"],pl={extension:{type:qe.LoadParser,priority:Lo.Normal},name:"loadBitmapFont",test:e=>ml.includes(X.extname(e).toLowerCase()),testParse:async e=>el.test(e)||il.test(e),async parse(e,t,i){const r=el.test(e)?el.parse(e):il.parse(e),{src:o}=t,{page:s}=r,n=[];for(let e=0;e<s.length;++e){const t=s[e].file;let i=X.join(X.dirname(o),t);i=ps(i,o),n.push(i)}const l=await i.load(n),a=n.map((e=>l[e]));return al.install(r,a,!0)},load:async(e,t)=>(await x.ADAPTER.fetch(e)).text(),unload(e){e.destroy()}};Je.add(pl);const bl=class extends Tn{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new bl(Object.keys(bl.defaultOptions).reduce(((t,i)=>({...t,[i]:e[i]})),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach((e=>{URL.revokeObjectURL(e.src),e.refs--,0===e.refs&&(e.fontFace&&document.fonts.delete(e.fontFace),delete bl.availableFonts[e.originalUrl])})),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:i}=bl;if(i[e]){const t=i[e];return this._fonts.push(t),t.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return x.ADAPTER.fetch(e).then((e=>e.blob())).then((async e=>new Promise(((t,i)=>{const r=URL.createObjectURL(e),o=new FileReader;o.onload=()=>t([r,o.result]),o.onerror=i,o.readAsDataURL(e)})))).then((async([r,o])=>{const s=Object.assign({family:X.basename(e,X.extname(e)),weight:"normal",style:"normal",src:r,dataSrc:o,refs:1,originalUrl:e,fontFace:null},t);i[e]=s,this._fonts.push(s),this.styleID++;const n=new FontFace(s.family,`url(${s.src})`,{weight:s.weight,style:s.style});s.fontFace=n,await n.load(),document.fonts.add(n),await document.fonts.ready,this.styleID++,this.fontsDirty=!0}))}addOverride(...e){const t=e.filter((e=>!this._overrides.includes(e)));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter((e=>this._overrides.includes(e)));t.length>0&&(this._overrides=this._overrides.filter((e=>!t.includes(e))),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce(((e,t)=>`${e}\n            @font-face {\n                font-family: "${t.family}";\n                src: url('${t.dataSrc}');\n                font-weight: ${t.weight};\n                font-style: ${t.style}; \n            }`),this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=Ae(e)),"number"==typeof e?(t=e,Y("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Te.shared.setValue(t).toHex()):e;var t}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(255*t|0).toString(16).padStart(2,"0"));const o=`${i}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${o} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${o} ${e}`}reset(){Object.assign(this,bl.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise((e=>setTimeout(e,100))):Promise.resolve()}get isSafari(){const{userAgent:e}=x.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let fl=bl;fl.availableFonts={},fl.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const gl=class extends so{constructor(e="",t={}){super(Pi.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const i=new Image,r=Pi.from(i,{scaleMode:x.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new At,r.trim=new At,this.texture=r;const o="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xhtml",n=document.createElementNS(o,"svg"),l=document.createElementNS(o,"foreignObject"),a=document.createElementNS(s,"div"),h=document.createElementNS(s,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",n.appendChild(l),this.maxWidth=gl.defaultMaxWidth,this.maxHeight=gl.defaultMaxHeight,this._domElement=a,this._styleElement=h,this._svgRoot=n,this._foreignObject=l,this._foreignObject.appendChild(h),this._foreignObject.appendChild(a),this._image=i,this._loadImage=new Image,this._autoResolution=gl.defaultAutoResolution,this._resolution=gl.defaultResolution??x.RESOLUTION,this.text=e,this.style=t}measureText(e){const{text:t,style:i,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:i.toCSS(r)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const o=this._domElement.getBoundingClientRect();this._svgRoot.remove();const s=Math.min(this.maxWidth,Math.ceil(o.width)),n=Math.min(this.maxHeight,Math.ceil(o.height));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",n.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(r)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:s+2*i.padding,height:n+2*i.padding}}async updateText(e=!0){const{style:t,_image:i,_loadImage:r}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:o,height:s}=this.measureText();i.width=r.width=Math.ceil(Math.max(1,o)),i.height=r.height=Math.ceil(Math.max(1,s)),this._loading||(this._loading=!0,await new Promise((e=>{r.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,i.src=r.src,r.onload=null,r.src="",this.updateTexture(),e()};const o=(new XMLSerializer).serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(o)}`})))}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:i,resolution:r}=this,{padding:o}=e,{baseTexture:s}=t;t.trim.width=t._frame.width=i.width/r,t.trim.height=t._frame.height=i.height/r,t.trim.x=-o,t.trim.y=-o,t.orig.width=t._frame.width-2*o,t.orig.height=t._frame.height-2*o,this._onTextureUpdate(),s.setRealSize(i.width,i.height,r),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},gl.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=t,this._svgRoot?.remove(),this._svgRoot=t,this._domElement?.remove(),this._domElement=t,this._foreignObject?.remove(),this._foreignObject=t,this._styleElement?.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=De(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=De(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&((e=e||{})instanceof fl?(this.ownsStyle=!1,this._style=e):e instanceof Tn?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=fl.from(e)):(this.ownsStyle=!0,this._style=new fl(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(""===e||null==e?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let Fl=gl;Fl.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Fl.defaultMaxWidth=2024,Fl.defaultMaxHeight=2024,Fl.defaultAutoResolution=!0,dt.defaultOptions.scaleMode=d.NEAREST,document.addEventListener("wheel",(e=>e.ctrlKey&&e.preventDefault()),{passive:!1});class yl{constructor(e,t){this.x=e,this.y=t}get r(){return this.x}get th(){return this.y}get isNull(){return 0===this.x&&0===this.y}get isNaN(){return Number.isNaN(this.y+this.x)}set(e){this.x=e.x,this.y=e.y}abs(){return new yl(Math.abs(this.x),Math.abs(this.y))}negate(){return new yl(-this.x,-this.y)}add(e){return new yl(this.x+e.x,this.y+e.y)}sub(e){return new yl(this.x-e.x,this.y-e.y)}elementwiseMul(e){return new yl(this.x*e.x,this.y*e.y)}elementwiseDiv(e){return new yl(this.x/e.x,this.y/e.y)}mul(e){return new yl(this.x*e,this.y*e)}div(e){return new yl(this.x/e,this.y/e)}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}distanceSquared(e){return(this.x-e.x)**2+(this.y-e.y)**2}distance(e){return Math.sqrt(this.distanceSquared(e))}unit(){const e=1/(this.isNull?1:this.length());return new yl(this.x*e,this.y*e)}scaledTo1(){if(this.x===this.y)return this.isNull?new yl(0,0):new yl(this.x/Math.abs(this.x),this.y/Math.abs(this.y));if(Math.abs(this.x)<Math.abs(this.y)){if(0===this.x)return new yl(0,Math.sign(this.y));const e=Math.abs(this.x)/Math.abs(this.y);return new yl(e*Math.sign(this.x),Math.sign(this.y))}{if(0===this.y)return new yl(Math.sign(this.x),0);const e=Math.abs(this.y)/Math.abs(this.x);return new yl(Math.sign(this.x),e*Math.sign(this.y))}}project(e){const t=new yl(e.x,e.y);return t.isNull?t:this.dot(t.unit())}equals(e){return this.x===e.x&&this.y===e.y}toPolar(){return new yl(this.length(),Math.atan2(this.y,this.x))}toCartesian(){return new yl(this.x*Math.cos(this.y),this.x*Math.sin(this.y))}}function vl(e,t){return!(e.x<=t.pos.x||e.x>=t.pos.x+t.size.x||e.y<=t.pos.y||e.y>=t.pos.y+t.size.y)}function xl(e,t){return!(e.pos.x+e.size.x<=t.pos.x||e.pos.x>=t.pos.x+t.size.x||e.pos.y+e.size.y<=t.pos.y||e.pos.y>=t.pos.y+t.size.y)}function _l(e,t){if(e.direction.isNull)return[!1,null];const i=t.pos.sub(e.origin).elementwiseDiv(e.direction),r=t.pos.add(t.size).sub(e.origin).elementwiseDiv(e.direction);if(i.isNaN||r.isNaN)return[!1,null];if(i.x>r.x&&([r.x,i.x]=[i.x,r.x]),i.y>r.y&&([r.y,i.y]=[i.y,r.y]),i.x>r.y||i.y>r.x)return[!1,null];const o=Math.max(i.x,i.y);if(Math.min(r.x,r.y)<0)return[!1,null];const s=e.direction.mul(o).add(e.origin),n=t.pos.sub(s).length(),l=t.pos.add(t.size).sub(s).length(),a=t.pos.add(new yl(t.size.x,0)).sub(s).length(),h=t.pos.add(new yl(0,t.size.y)).sub(s).length(),d=Math.min(n,l,a,h);let c=new yl(0,0);return i.x>i.y?e.direction.x<0?c.x=1:c.x=-1:e.direction.y<0?c.y=1:c.y=-1,[!0,{point:s,normal:c,time:o,edginess:d}]}function wl(e,t){if(e.dr.isNull)return[!1,null];const i={pos:e.size.mul(-.5).add(t.pos),size:e.size.add(t.size)},r=e.pos.add(e.size.div(2)),o=_l({origin:r,direction:e.dr},i);if(o[0]){const t=-3e-12;if(0===o[1].edginess){const t=i.pos.add(i.size.div(2)),o=r.sub(t);if(o.x>0){if(o.y>0){if(e.dr.x>=0||e.dr.y>=0)return[!1,null]}else if(e.dr.x>=0||e.dr.y<=0)return[!1,null]}else if(o.y>0){if(e.dr.x<=0||e.dr.y>=0)return[!1,null]}else if(e.dr.x<=0||e.dr.y<=0)return[!1,null]}return o[1].time>=t&&o[1].time<1?o:[!1,null]}return o}function Sl(e,t){return wl({pos:e.pos,size:e.size,dr:e.dr.sub(t.dr)},t)}const Tl={pointVsRect:vl,rectVsRect:xl,rayVsRect:_l,dynamicRectVsRect:wl,dynamicRectVsDynamicRect:Sl},El=new class{changeResolution(e){const t=e/this.baseWidth;this.stage.scale.set(t);const i=e/this.aspectRatio;this.renderer.resize(e,i)}updateFps(e){const t=Math.floor(1/e);this.currentFPS=t,this.fpsList.push(t),this.smallestFPS>t&&(this.smallestFPS=t),this.biggestFPS<t&&(this.biggestFPS=t),this.fpsDisplay&&(this.fpsDisplay.innerHTML="fps: "+t+"<br>max-fps: "+this.biggestFPSView+"<br>min-fps: "+this.smallestFPSView+"<br>avg-fps: "+this.averageFPSView),void 0!==this.fpsInterval&&requestAnimationFrame((e=>{const t=(e-this.prev)/1e3;this.prev=e,this.updateFps(t)}))}getFps(){return this.currentFPS}getMaxFps(){return this.biggestFPSView}getMinFps(){return this.smallestFPSView}getAvgFps(){return this.averageFPSView}showFps(){this.fpsDisplay=document.createElement("div"),this.fpsDisplay.style.color="red",this.fpsDisplay.style.position="fixed",this.fpsDisplay.style.left="0px",this.fpsDisplay.style.top="0px";const e=document.getElementById("display");e&&e.append(this.fpsDisplay)}hideFps(){var e;null===(e=this.fpsDisplay)||void 0===e||e.remove(),this.fpsDisplay=void 0}countFps(){void 0===this.fpsInterval&&(this.fpsInterval=window.setInterval((()=>{this.biggestFPSView=this.biggestFPS,this.biggestFPS=0,this.smallestFPSView=this.smallestFPS,this.smallestFPS=1/0,this.averageFPSView=this.fpsList.reduce(((e,t)=>e+t),0)/this.fpsList.length,this.fpsList.length=0}),1e3),this.updateFps(1/0))}stopFpsCount(){clearInterval(this.fpsInterval),this.fpsInterval=void 0}constructor(){this.baseWidth=1280,this.baseHeight=720,this.aspectRatio=this.baseWidth/this.baseHeight,this.px=0,this.py=0,this.width=this.baseWidth,this.height=this.baseHeight,this.mousex=0,this.mousey=0,this.pivotx=0,this.pivoty=0,this.scale=1,this.angle=0,this.boundingBox={l:0,t:0,r:0,b:0,w:0,h:0},this.boundingBoxRectData={pos:{x:0,y:0},size:{x:0,y:0}},this.posLerp=700,this.posPerc=2.7,this.scalePerc=4.95,this.transformEffects=new Set,this.renderer=Ir({width:this.baseWidth,height:this.baseHeight,backgroundColor:"#900C3F"}),this.stage=new io,this.effects=new io,this.view=new io,this.currentFPS=0,this.biggestFPS=0,this.fpsList=[],this.smallestFPS=1/0,this.biggestFPSView=this.biggestFPS,this.smallestFPSView=this.biggestFPS,this.averageFPSView=0,this.prev=performance.now(),this.view.eventMode="none",this.view.sortableChildren=!0,this.view.position.set(this.baseWidth/2,this.baseHeight/2);const e=this.renderer.view;if(!(e instanceof HTMLCanvasElement))return;const t=document.getElementById("display");t&&(t.append(e),this.stage.addChild(this.effects),this.effects.addChild(this.view),new ResizeObserver((e=>{for(const t of e){const e=t.contentRect.width,i=t.contentRect.height;if(e/i>this.aspectRatio){const e=i*this.aspectRatio;this.width=e,this.height=i}else{const t=e/this.aspectRatio;this.width=e,this.height=t}this.px=.5*(e-this.width),this.py=.5*(i-this.height)}this.computeBoundingBox()})).observe(e),e.addEventListener("mousemove",(e=>{if(e.offsetX>this.px+this.width)return;if(e.offsetY>this.py+this.height)return;const t=e.offsetX-this.px,i=e.offsetY-this.py;t<0||i<0||(this.mousex=t/this.width,this.mousey=i/this.height)})),this.computeBoundingBox())}getCanvas(){const e=this.renderer.view;if(e instanceof HTMLCanvasElement)return e}setBGColor(e){this.renderer.background.backgroundColor.setValue(e)}setBGAlpha(e){this.renderer.background.alpha=e}toViewport(e,t){const i=this.view.rotation;return[(((e-this.view.pivot.x)*Math.cos(i)-(t-this.view.pivot.y)*Math.sin(i))*this.view.scale.x+this.view.position.x)*(this.width/this.baseWidth),(((e-this.view.pivot.x)*Math.sin(i)+(t-this.view.pivot.y)*Math.cos(i))*this.view.scale.y+this.view.position.y)*(this.height/this.baseHeight)]}fromViewport(e,t){const i=(this.baseWidth*e/this.width-this.view.position.x)/this.view.scale.x,r=(this.baseHeight*t/this.height-this.view.position.y)/this.view.scale.y,o=this.view.rotation,s=i*Math.cos(o)+r*Math.sin(o),n=r*Math.cos(o)-i*Math.sin(o);return[this.view.pivot.x+s,this.view.pivot.y+n]}getMousePos(){return this.fromViewport(this.mousex*this.width,this.mousey*this.height)}getMouseViewportPos(){return[this.mousex*this.width,this.mousey*this.height]}getCenterX(){return this.pivotx}getCenterY(){return this.pivoty}_setCenter(e,t){this.pivotx=e,this.pivoty=t,this.view.pivot.set(e,t),this.computeBoundingBox()}setCenter(e,t){this._setCenter(e,t),this.targetX=this.pivotx,this.targetY=this.pivoty}moveToCenter(e,t){this.targetX=e,this.targetY=t}getViewportWidth(){return this.width}getViewportHeight(){return this.height}getScale(){return this.scale}_setScale(e){this.scale=e,this.view.scale.set(e,e),this.computeBoundingBox()}setScale(e){this._setScale(e),this.targetScale=this.scale}moveToScale(e){this.targetScale=e}setAngle(e){this.angle=e,this.view.rotation=e,this.computeBoundingBox()}getAngle(){return this.angle}add(e){this.view.addChild(e)}computeBoundingBox(){const[e,t]=this.fromViewport(0,0),[i,r]=this.fromViewport(this.width,0),[o,s]=this.fromViewport(this.width,this.height),[n,l]=this.fromViewport(0,this.height),a=Math.min(e,i,o,n),h=Math.min(t,r,s,l),d=Math.max(e,i,o,n),c=Math.max(t,r,s,l);this.boundingBox.l=a,this.boundingBox.r=d,this.boundingBox.t=h,this.boundingBox.b=c,this.boundingBox.w=d-a,this.boundingBox.h=c-h,this.boundingBoxRectData.pos.x=a,this.boundingBoxRectData.pos.y=h,this.boundingBoxRectData.size.x=d-a,this.boundingBoxRectData.size.y=c-h}getBoundingBox(){return this.boundingBox}containsBroad(e){return vl(e,this.boundingBoxRectData)}overlapsRectBroad(e){return xl(e,this.boundingBoxRectData)}clamp(e,t,i,r){const o=this.scale,s=this.pivotx,n=this.pivoty,l=this.computeClamp(this.pivotx,this.pivoty,this.scale,e,t,i,r);s===l.targetX&&n===l.targetY||this.setCenter(l.targetX,l.targetY),this.targetX=l.targetX,this.targetY=l.targetY,o!==l.targetScale&&this.setScale(l.targetScale),this.targetScale=l.targetScale}moveToClamp(e,t,i,r,o,s,n){const l=this.getCenterX(),a=this.getCenterY(),h=this.getScale();this._setCenter(e,t),this._setScale(i);const d=this.computeClamp(e,t,i,r,o,s,n);this.targetX=d.targetX,this.targetY=d.targetY,this.targetScale=d.targetScale,this._setCenter(l,a),this._setScale(h)}computeClamp(e,t,i,r,o,s,n){const l=s>this.boundingBox.w,a=n>this.boundingBox.h;if(l&&a)this.boundingBox.l<r&&(e=r+.5*this.boundingBox.w),this.boundingBox.r>r+s&&(e=r+s-.5*this.boundingBox.w),this.boundingBox.t<o&&(t=o+.5*this.boundingBox.h),this.boundingBox.b>o+n&&(t=o+n-.5*this.boundingBox.h);else if(l||a)if(l){t=o+.5*n;const l=this.scale;i=this.scale*this.boundingBox.h/n,this._setScale(i),this.boundingBox.l<r&&(e=r+.5*this.boundingBox.w),this.boundingBox.r>r+s&&(e=r+s-.5*this.boundingBox.w),this._setScale(l)}else{e=r+.5*s;const l=this.scale;i=this.scale*this.boundingBox.w/s,this._setScale(i),this.boundingBox.t<o&&(t=o+.5*this.boundingBox.h),this.boundingBox.b>o+n&&(t=o+n-.5*this.boundingBox.h),this._setScale(l)}else{const l=Math.max(this.boundingBox.w/s,this.boundingBox.h/n);i=this.scale*l;const a=this.scale;this._setScale(i),this.boundingBox.l<r&&(e=r+.5*this.boundingBox.w),this.boundingBox.r>r+s&&(e=r+s-.5*this.boundingBox.w),this.boundingBox.t<o&&(t=o+.5*this.boundingBox.h),this.boundingBox.b>o+n&&(t=o+n-.5*this.boundingBox.h),this._setScale(a)}return{targetX:e,targetY:t,targetScale:i}}pushEffect(e){this.transformEffects.add(e)}stopMoveTo(){this.targetScale=void 0,this.targetX=void 0,this.targetY=void 0}computeDeltaOf(e,t){let i=0,r="x"===e?this.targetX:this.targetY;if(void 0!==r){const o=r-("x"===e?this.pivotx:this.pivoty);if(this.posPerc&&(i=o*this.posPerc*t),this.posLerp){const e=Math.sign(o)*this.posLerp*t;Math.abs(i)<Math.abs(e)&&(i=e)}Math.abs(o)<Math.abs(i)&&(i=o)}return i}update(e){let t=this.computeDeltaOf("x",e),i=this.computeDeltaOf("y",e),r=0;if(this._setCenter(this.pivotx+t,this.pivoty+i),this.targetScale){const t=this.targetScale-this.scale;if(this.scalePerc){r=t*this.scalePerc*e;const i=.5*Math.sign(t)*this.scalePerc*e;Math.abs(r)<Math.abs(i)&&(r=i)}Math.abs(t)<Math.abs(r)&&(r=t)}this._setScale(this.scale+r)}render(){this.effects.position.set(0),this.effects.scale.set(1),this.effects.rotation=0;for(const e of this.transformEffects){const t=e.next();t.done?this.transformEffects.delete(e):(t.value.x&&(this.effects.position.x+=t.value.x),t.value.y&&(this.effects.position.y+=t.value.y),t.value.angle&&(this.effects.rotation+=t.value.angle),t.value.scale&&(this.effects.scale.x+=t.value.scale,this.effects.scale.y+=t.value.scale))}this.renderer.render(this.stage)}},Al=El;class Pl{constructor(){this.deltaTime=0,this.frame=void 0,this.prevRafTimestamp=0,this.isRunning=!1}get dt(){return this.deltaTime}start(){this.isRunning||(this.isRunning=!0,this.onStart(),this.onFrameDraw!==Pl.prototype.onFrameDraw&&this.rafCallback(0))}onStart(){}onStop(){}onFrameDraw(){}rafCallback(e=0){const t=e-this.prevRafTimestamp;this.prevRafTimestamp=e,this.deltaTime=.001*Math.min(500,t),this.onFrameDraw(),this.isRunning&&(this.frame=requestAnimationFrame((e=>this.rafCallback(e))))}stop(){this.isRunning&&(this.isRunning=!1,this.frame&&cancelAnimationFrame(this.frame),this.onStop())}isStopped(){return!this.isRunning}}class Cl{constructor(e){this.prev=new Set,this.current=new Set,this.held=new Set,this.stopper=()=>{},this.isRunning=!1,this.mouseTarget=e,this.mouseTarget&&this.mouseTarget.addEventListener("contextmenu",(e=>e.preventDefault())),this.start()}update(){this.prev.clear();for(const e of this.current)this.prev.add(e);this.current.clear();for(const e of this.held)this.current.add(e);this.wheel=this.nextWheel,this.nextWheel=void 0}getWheel(){return this.wheel}isPressed(e){return this.current.has(e)&&!this.prev.has(e)}isHeld(e){return this.current.has(e)&&this.prev.has(e)}isReleased(e){return!this.current.has(e)&&this.prev.has(e)}start(){this.isRunning=!0;const e=e=>this.nextWheel=e,t=e=>{const t=1===e.button?"MouseAuxiliary":2===e.button?"MouseSecondary":"MouseMain";this.held.add(t)},i=e=>{const t=1===e.button?"MouseAuxiliary":2===e.button?"MouseSecondary":"MouseMain";this.held.delete(t)},r=e=>{this.held.add(e.code)},o=e=>{this.held.delete(e.code)};addEventListener("keydown",r),addEventListener("keyup",o),this.mouseTarget&&(this.mouseTarget.addEventListener("mousedown",t),this.mouseTarget.addEventListener("mouseup",i),this.mouseTarget.addEventListener("wheel",e)),this.stopper=()=>{this.isRunning=!1,removeEventListener("keydown",r),removeEventListener("keyup",o),this.mouseTarget&&(this.mouseTarget.removeEventListener("mousedown",t),this.mouseTarget.removeEventListener("mouseup",i),this.mouseTarget.addEventListener("wheel",e))}}stop(){this.stopper()}isStopped(){return!this.isRunning}}const kl=Symbol("null-query-id");let Bl=Number.MIN_SAFE_INTEGER;class Ml{constructor(e){this.cells=new Map,this.size=e}getCells(){return this.cells}clear(){return this.cells.clear()}initCell(e,t){const i=[];return this.cells.set(e+"."+t,i),i}getCell(e,t){return this.cells.get(e+"."+t)}toGridBounds(e,t,i,r){return{imin:Math.floor(e/this.size),imax:Math.floor((e+i)/this.size),jmin:Math.floor(t/this.size),jmax:Math.floor((t+r)/this.size)}}removeFromCell(e,t,i){const r=e[e.length-1];if(r){e[t]=r;const i=r._cellsData.get(e);i&&(i[0]=t)}e.pop(),i._cellsData.delete(e)}set(e){var t;const i=this.toGridBounds(e.l,e.t,e.w,e.h);for(let r=i.jmin;r<=i.jmax;r++)for(let o=i.imin;o<=i.imax;o++){const i=null!==(t=this.getCell(o,r))&&void 0!==t?t:this.initCell(o,r);if(void 0===e._cellsData.get(i)){const t=i.push(e);e._cellsData.set(i,[t-1,o,r])}}}unset(e){const t=this.toGridBounds(e.l,e.t,e.w,e.h);for(const[i,[r,o,s]]of e._cellsData)(o<t.imin||o>t.imax||s<t.jmin||s>t.jmax)&&this.removeFromCell(i,r,e)}create(e,t,i,r,o){const s={_cellsData:new Map,_queryID:kl,l:e,t,w:i,h:r,userData:o};return this.set(s),s}update(e){this.unset(e),this.set(e)}remove(e){for(const[t,[i]]of e._cellsData)this.removeFromCell(t,i,e)}*findNear(e,t,i,r){const o=Symbol(String(Bl++)),s=this.toGridBounds(e,t,i,r);for(let e=s.jmin;e<=s.jmax;e++)for(let t=s.imin;t<=s.imax;t++){const i=this.getCell(t,e);if(i)for(const e of i)e._queryID!==o&&(e._queryID=o,yield e)}}*findNearCells(e,t,i,r){const o=this.toGridBounds(e,t,i,r);for(let e=o.jmin;e<=o.jmax;e++)for(let t=o.imin;t<=o.imax;t++)yield[t,e]}}function Rl(e,...t){let i=e;for(const e of t)i=i.connect(e);return i}class Il{constructor(e,t){this.loadingProgress=1,this.loaded={},this.loadingProgress=0;const i=[];for(const r of Object.keys(t)){const o=t[r];i.push(fetch(o).then((e=>{if(!e.ok)throw Error(o+" preload failed.");return e.arrayBuffer()})).then((t=>e.decodeAudioData(t))).then((e=>(this.loadingProgress+=1/i.length,[r,e]))))}this.loading=Promise.all(i).then((e=>{this.loadingProgress=1;for(const[t,i]of e)this.loaded[t]=i}))}getloadingProgress(){return this.loadingProgress}loadingDone(){return this.loading}}class Dl extends Il{constructor(e,t,i){super(t,i),this.context=t,this.parent=e}}class Ol extends Dl{setVolume(e){e=Math.min(1,Math.max(0,e)),this.volume=e,this.volNode.gain.value=e*this.parent.getVolume()}getVolume(){return this.volume}constructor(e,t,i){super(e,t,i),this.volume=1,this.context=t,this.volNode=t.createGain(),this.fade=t.createGain();let r=0,o=performance.now();setInterval((()=>{var e,t,i,s,n;const l=performance.now(),a=(l-o)/1e3;o=l,"changed"===this.state&&(this.state="fadeout",(null===(e=this.nextData)||void 0===e?void 0:e.name)===(null===(t=this.currentData)||void 0===t?void 0:t.name)&&(this.currentData=this.nextData,this.currentData&&(this.currentData.fadeIn=this.currentData.fadeOutPrev),this.nextData=void 0,this.state="fadein")),"fadeout"===this.state&&(this.nextData?this.fade.gain.value?this.nextData.fadeOutPrev?(this.fade.gain.value-=a/this.nextData.fadeOutPrev,this.fade.gain.value=Math.min(Math.max(0,this.fade.gain.value),1)):this.nextData.silence?(this.fade.gain.value=0,this.state="silenceStart"):this.state="ready":this.state="silenceStart":this.state="fadein"),"silenceStart"===this.state&&(r=0,this.state="silence"),"silence"===this.state&&(r+=a,r>=(null!==(s=null===(i=this.nextData)||void 0===i?void 0:i.silence)&&void 0!==s?s:0)&&(this.state="ready")),"ready"===this.state&&(this.currentData=this.nextData,this.nextData=void 0,this.playCurrent(),this.state="fadein"),"fadein"===this.state&&((null===(n=this.currentData)||void 0===n?void 0:n.fadeIn)?(this.fade.gain.value+=a/this.currentData.fadeIn,this.fade.gain.value=Math.min(Math.max(0,this.fade.gain.value),1),1===this.fade.gain.value&&(this.state=void 0)):(this.fade.gain.value=1,this.state=void 0))}))}playCurrent(){var e,t,i,r,o,s;const n=this.setActiveAudio(null===(e=this.currentData)||void 0===e?void 0:e.name);n&&(n.loop=!0,void 0!==(null===(t=this.currentData)||void 0===t?void 0:t.loopStart)&&(n.loopStart=this.currentData.loopStart),n.loopEnd=null!==(s=null!==(r=null===(i=n.buffer)||void 0===i?void 0:i.duration)&&void 0!==r?r:null===(o=this.currentData)||void 0===o?void 0:o.loopEnd)&&void 0!==s?s:0,n.start())}setActiveAudio(e){if(this.activeAudio&&(this.activeAudio.stop(),this.activeAudio.disconnect()),!e)return;const t=this.loaded[e];if(!t)return;const i=this.context.createBufferSource();return i.buffer=t,this.activeAudio=i,Rl(i,this.volNode,this.fade,this.context.destination),i}setMusic(e){const t=Object.assign({},e);this.nextData=t,"silence"!==this.state&&(this.state="changed")}getMusic(){return this.currentData}}class Nl extends Dl{getFinalVolume(){return this.volume*this.parent.getVolume()}getVolume(){return this.volume}setVolume(e){e=Math.min(1,Math.max(0,e)),this.volume=e;const t=this.getFinalVolume();for(const[e,{volume:i}]of this.playing)i.gain.value=t}constructor(e,t,i){super(e,t,i),this.cached=new Set,this.playing=new Map,this.volume=1}play(e,t){if(e){if(this.cached.has(e))return null;this.cached.add(e),setTimeout((()=>{this.cached.delete(e)}))}if(!e)return null;const i=this.loaded[e];if(!i)return null;const r=this.context.createBufferSource();r.buffer=i;const o=this.context.createGain();o.gain.value=this.getFinalVolume(),Rl(r,o,this.context.destination);let s=()=>{s=()=>{},this.playing.delete(r),r.disconnect(),r.onended=null};r.onended=s,r.start();const n={name:e,playing:()=>this.playing.has(r),stop:s,tags:t};return this.playing.set(r,{volume:o,name:e,sound:n}),n}get(e){const t=[...this.playing.values()].map((e=>e.sound));return null==e?t:t.filter((t=>t.name===e))}}class Ll{constructor(){this.context=new AudioContext,this.containers=[],this.loaded=Promise.resolve(),this.volume=1}resetLoaded(){this.loaded=Promise.all(this.containers.map((e=>e.loadingDone()))).then((()=>{}))}init(){this.context.resume()}getloadingProgress(){const e=this.containers.length;return e?this.containers.reduce(((e,t)=>e+t.getloadingProgress()),0)/e:1}loadingDone(){return this.loaded}createMusicPlayer(e){const t=new Ol(this,this.context,e);return t.setVolume(this.volume),this.containers.push(t),this.resetLoaded(),t}createSoundPlayer(e){const t=new Nl(this,this.context,e);return t.setVolume(this.volume),this.containers.push(t),this.resetLoaded(),t}setVolume(e){this.volume=e,this.containers.forEach((e=>e.setVolume(e.getVolume())))}getVolume(){return this.volume}}class zl{constructor(){this.connections=new Map}connect(e,t){if(this.connections.has(t))throw Error("Connection already exists");this.connections.set(t,e)}start(e){let t=null;return i=>{t||(this.onStart(e),e=null,t=this),!1===t.onUpdate(i)&&(t=t.end())}}end(){const[e,t]=this.onEnd(),i=this.connections.get(t);return i?(i.onStart(e),i):null}}const Gl=i.p+"d7c6917b696090bc804d.mp3",Ul=i.p+"02a7ee083b54a54cbac5.mp3",Hl=i.p+"45d4bd467612e2822a67.mp3",Vl=i.p+"449f49fc5754270bc1a2.mp3",jl=i.p+"440658c944620548a9bf.mp3",Wl=i.p+"45fd6ed902b3de877e29.mp3",Xl=i.p+"3baa116d804590f4be5d.mp3",$l=i.p+"05186d3e7be1699ee412.mp3",Yl=i.p+"4cd28ba6800c564dfa3e.mp3",ql=i.p+"f2226aaed2bfb0f5afcf.mp3",Zl=i.p+"fc6cd0272cdf39ecfcdd.mp3",Kl=i.p+"cece351d7b914950cacc.mp3",Jl=i.p+"5688c504509d9a42e80f.mp3",Ql=i.p+"41c93f7fd19b2b2c692f.mp3",ea=i.p+"a028dcb8a6be7ce8b20b.mp3",ta=i.p+"2a8e305b372e64d2b2e2.mp3",ia=i.p+"c299ae27ebbac6de38c2.mp3",ra=i.p+"d5be7445eff6bb7a41ba.mp3",oa=i.p+"9dd4a061713cd3ee19e8.mp3",sa=i.p+"3e32a9dbb839ae418477.mp3",na=i.p+"e804121c0c35e732f7ac.mp3",la=i.p+"3e72d507ea5ccc31f0ae.mp3",aa=i.p+"3c66f462280717322261.mp3",ha=i.p+"de5188b6a40f04325303.mp3",da=i.p+"a33a7c21bc52128263c1.mp3";let ca=null;function ua(){if(ca)return ca;const e=new Ll,t=e.createSoundPlayer({mariodiestart:ea,oneUp:Gl,bowserfalls:Ul,bowserfire:Hl,breakblock:Vl,bump:jl,coin:Wl,fireball:Xl,fireworks:$l,flagpole:Yl,gameover:ql,jumpSmall:Zl,jumpBig:Kl,kick:Jl,mariodie:Ql,pause:ta,pipe:ia,powerup:ra,powerup_appears:oa,stage_clear:sa,stomp:na,vine:la,warning:aa,world_clear:ha}),i=e.createMusicPlayer({mustest:da}),r={controller:e,sounds:t,music:i};return ca=r,e.setVolume(.5),r}const ma={red:.71},pa=new bi(void 0,"\n  varying vec2 vTextureCoord;\n  uniform sampler2D uSampler;\n  uniform float red;\n  void main(void)\n  {\n    vec4 c = texture2D(uSampler, vTextureCoord);\n    if (\n      (c.x > 0.70 && c.y < 0.20 && c.z < 0.13)\n    ) {\n      gl_FragColor = vec4(0.969,0.847,0.647,c.a);\n    } else if (\n      (c.x < 0.43 && c.x > 0.4 && c.y < 0.43 && c.z < 0.02)\n    ) {\n      gl_FragColor = vec4(red,0.192,0.125,c.a);\n    }  else {\n      gl_FragColor = texture2D(uSampler, vTextureCoord);\n    }\n  }\n",ma);function ba(e){const t={positionStart:new yl(0,0),positionPrev:new yl(0,0),position:new yl(0,0),size:new yl(0,0),dynamicIndex:-1,staticIndex:-1,kinematicIndex:-1,sensorIndex:-1,gridIndex:-1};return Object.assign(t,e),t}const fa=new class{constructor(){this.entities=[],this.entToIndex=new Map,this.targetToProxy=new WeakMap,this.views={},this.queuedActions=[],this.hadCompsAdded=new Set,this.hadCompsRemoved=new Set,this.toBeRemoved=new Set,this.toBeAdded=new Set,this.propChangeHandlers=new Map,this.viewToOnAddingHandlers=new Map,this.viewToOnRemovingHandlers=new Map}getViewPopulation(){let e=[];for(const[t,i]of Object.entries(this.views))e.push([t,i.entities.length]);return e.sort(((e,t)=>t[1]-e[1]))}number(){return this.entities.length}hasComponent(e,t){return void 0!==e[t]}*toBeRemovedIterator(){for(const e of this.toBeRemoved)if(this.entityExists(e)){yield[e,null];for(const t of Object.values(this.views))t.entToIndex.has(e)&&(yield[e,t])}}*hadCompsRemovedIterator(e){for(const t of this.hadCompsRemoved)if(this.entityExists(t)&&!(null==e?void 0:e.has(t)))for(const[e,i]of Object.entries(this.views))i.entToIndex.has(t)&&e.split("/").some((e=>!this.hasComponent(t,e)))&&(yield[t,i])}*toBeAddedIterator(e){for(const t of this.toBeAdded)if(!this.entityExists(t)&&!(null==e?void 0:e.has(t))){yield[t,null];for(const[e,i]of Object.entries(this.views))e.split("/").every((e=>this.hasComponent(t,e)))&&(yield[t,i])}}*hadCompsAddedIterator(...e){for(const t of this.hadCompsAdded)if(this.entityExists(t)){for(const i of e)if(i.has(t))continue;for(const[e,i]of Object.entries(this.views))!i.entToIndex.has(t)&&e.split("/").every((e=>this.hasComponent(t,e)))&&(yield[t,i])}}update(){var e,t,i,r;for(const[t,i]of this.toBeRemovedIterator()){const r=null!==(e=null==i?void 0:i.entities)&&void 0!==e?e:this.entities,o=this.viewToOnRemovingHandlers.get(r);if(o)for(const e of o)e(t)}for(const[e,t]of this.hadCompsRemovedIterator(this.toBeRemoved)){const i=this.viewToOnRemovingHandlers.get(t.entities);if(i)for(const t of i)t(e)}for(const[e,i]of this.toBeAddedIterator(this.toBeRemoved)){const r=null!==(t=null==i?void 0:i.entities)&&void 0!==t?t:this.entities,o=this.viewToOnAddingHandlers.get(r);if(o)for(const t of o)t(e)}for(const[e,t]of this.hadCompsAddedIterator(this.toBeRemoved,this.toBeAdded)){const i=this.viewToOnAddingHandlers.get(t.entities);if(i)for(const t of i)t(e)}for(const[e,t]of this.toBeRemovedIterator())this.removeFromView(e,null!=t?t:void 0);for(const[e,t]of this.hadCompsRemovedIterator(this.toBeRemoved))this.removeFromView(e,t);for(const[e,t]of this.toBeAddedIterator(this.toBeRemoved)){const o=null!==(i=null==t?void 0:t.entities)&&void 0!==i?i:this.entities,s=null!==(r=null==t?void 0:t.entToIndex)&&void 0!==r?r:this.entToIndex,n=o.push(e);s.set(e,n-1)}for(const[e,t]of this.hadCompsAddedIterator(this.toBeRemoved,this.toBeAdded)){const i=t.entities.push(e);t.entToIndex.set(e,i-1)}this.toBeRemoved.clear(),this.hadCompsRemoved.clear(),this.toBeAdded.clear(),this.hadCompsAdded.clear();for(const e of this.queuedActions)e.cancelled||e.action();this.queuedActions=[]}enqueue(e){const t={action:e,cancelled:!1};return this.queuedActions.push(t),()=>t.cancelled=!0}createEntity(e){const t=Object.assign({},e),i=this;for(const r of Object.keys(e)){const e=i.propChangeHandlers.get(r);if(e){const i=t[r];e(Object.assign({},t),i)}}const r=new Proxy(t,{deleteProperty:(e,t)=>{const r=i.propChangeHandlers.get(t),o=e[t],s=delete e[t];r&&r(Object.assign({},e),o);const n=i.targetToProxy.get(e);return s&&n&&i.hadCompsRemoved.add(n),s},defineProperty(e,t,r){const o=r.get?r.get():r.value,s=e[t];e[t]=o;const n=i.targetToProxy.get(e);void 0!==s&&void 0===o?n&&i.hadCompsRemoved.add(n):void 0!==o&&void 0===s&&n&&i.hadCompsAdded.add(n);const l=i.propChangeHandlers.get(t);if(l){const i=e[t];l(Object.assign({},e),i)}return!0}});return this.targetToProxy.set(t,r),this.toBeAdded.add(r),r}onPropChange(e,t){this.propChangeHandlers.set(e,t)}entityExists(e){return this.entToIndex.has(e)}removeFromView(e,t){var i,r;const o=null!==(i=null==t?void 0:t.entities)&&void 0!==i?i:this.entities,s=null!==(r=null==t?void 0:t.entToIndex)&&void 0!==r?r:this.entToIndex,n=s.get(e);if(void 0===n)return!1;s.delete(e);const l=o.length-1,a=o[l];return!!a&&(o[l]=e,o[n]=a,o.pop()!==a&&s.set(a,n),!0)}clear(){for(const e of this.entities)this.remove(e)}remove(e){return this.toBeRemoved.add(e)}constructViewKey(e){return[...new Set(e)].sort().join("/")}view(e){if(!e)return this.entities;const t=this.constructViewKey(e);if(""===t)return this.entities;let i=this.views[t];if(i)return i.entities;const r=e.some((e=>/\//.test(e)));if(r)throw Error("Illegal character in component: '/'. Please do not use this character in your component name.");return i={entities:this.entities.filter((t=>!e.some((e=>!this.hasComponent(t,e))))),entToIndex:new Map},i.entities.forEach(((e,t)=>null==i?void 0:i.entToIndex.set(e,t))),this.views[t]=i,i.entities}onAdding(e,t){const i=this.view(e),r=this.viewToOnAddingHandlers.get(i)||[];this.viewToOnAddingHandlers.set(i,r),r.push(t)}onRemoving(e,t){const i=this.view(e),r=this.viewToOnRemovingHandlers.get(i)||[];this.viewToOnRemovingHandlers.set(i,r),r.push(t)}};fa.onAdding([],(e=>e.justAdded=!0));const ga=fa;class Fa extends bi{constructor(e=4,t=3,i=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",i?"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n":"\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}"),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new Tt,this.pixelSize=1,this._clamp=i,Array.isArray(e)?this.kernels=e:(this._blur=e,this.quality=t)}apply(e,t,i,r){const o=this._pixelSize.x/t._frame.width,s=this._pixelSize.y/t._frame.height;let n;if(1===this._quality||0===this._blur)n=this._kernels[0]+.5,this.uniforms.uOffset[0]=n*o,this.uniforms.uOffset[1]=n*s,e.applyFilter(this,t,i,r);else{const l=e.getFilterTexture();let a,h=t,d=l;const c=this._quality-1;for(let t=0;t<c;t++)n=this._kernels[t]+.5,this.uniforms.uOffset[0]=n*o,this.uniforms.uOffset[1]=n*s,e.applyFilter(this,h,d,1),a=h,h=d,d=a;n=this._kernels[c]+.5,this.uniforms.uOffset[0]=n*o,this.uniforms.uOffset[1]=n*s,e.applyFilter(this,h,i,r),e.returnFilterTexture(l)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce(((e,t)=>e+t+.5),0))}_generateKernels(){const e=this._blur,t=this._quality,i=[e];if(e>0){let r=e;const o=e/t;for(let e=1;e<t;e++)r-=o,i.push(r)}this._kernels=i,this._updatePadding()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof Tt?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get blur(){return this._blur}set blur(e){this._blur=e,this._generateKernels()}}var ya="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}";class va extends bi{constructor(e=.5){super(ya,"\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform float threshold;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    // A simple & fast algorithm for getting brightness.\n    // It's inaccuracy , but good enought for this feature.\n    float _max = max(max(color.r, color.g), color.b);\n    float _min = min(min(color.r, color.g), color.b);\n    float brightness = (_max + _min) * 0.5;\n\n    if(brightness > threshold) {\n        gl_FragColor = color;\n    } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n}\n"),this.threshold=e}get threshold(){return this.uniforms.threshold}set threshold(e){this.uniforms.threshold=e}}const xa=class extends bi{constructor(e){super(ya,"uniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D bloomTexture;\nuniform float bloomScale;\nuniform float brightness;\n\nvoid main() {\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    color.rgb *= brightness;\n    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);\n    bloomColor.rgb *= bloomScale;\n    gl_FragColor = color + bloomColor;\n}\n"),this.bloomScale=1,this.brightness=1,this._resolution=x.FILTER_RESOLUTION,"number"==typeof e&&(e={threshold:e});const t=Object.assign(xa.defaults,e);this.bloomScale=t.bloomScale,this.brightness=t.brightness;const{kernels:i,blur:r,quality:o,pixelSize:s,resolution:n}=t;this._extractFilter=new va(t.threshold),this._extractFilter.resolution=n,this._blurFilter=i?new Fa(i):new Fa(r,o),this.pixelSize=s,this.resolution=n}apply(e,t,i,r,o){const s=e.getFilterTexture();this._extractFilter.apply(e,t,s,1,o);const n=e.getFilterTexture();this._blurFilter.apply(e,s,n,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=n,e.applyFilter(this,t,i,r),e.returnFilterTexture(n),e.returnFilterTexture(s)}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this._extractFilter&&(this._extractFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)}get threshold(){return this._extractFilter.threshold}set threshold(e){this._extractFilter.threshold=e}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.blur}set blur(e){this._blurFilter.blur=e}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){this._blurFilter.pixelSize=e}};xa.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:x.FILTER_RESOLUTION};const _a=class extends bi{constructor(e){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","uniform float radius;\nuniform float strength;\nuniform vec2 center;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nvoid main()\n{\n    vec2 coord = vTextureCoord * filterArea.xy;\n    coord -= center * dimensions.xy;\n    float distance = length(coord);\n    if (distance < radius) {\n        float percent = distance / radius;\n        if (strength > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);\n        }\n    }\n    coord += center * dimensions.xy;\n    coord /= filterArea.xy;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    gl_FragColor = color;\n}\n"),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,_a.defaults,e)}apply(e,t,i,r){const{width:o,height:s}=t.filterFrame;this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=s,e.applyFilter(this,t,i,r)}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}get strength(){return this.uniforms.strength}set strength(e){this.uniforms.strength=e}get center(){return this.uniforms.center}set center(e){this.uniforms.center=e}};var wa,Sa;_a.defaults={center:[.5,.5],radius:100,strength:1},(wa=wa||{}).stringify=(Sa={"visit_linear-gradient":function(e){return Sa.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return Sa.visit_gradient(e)},"visit_radial-gradient":function(e){return Sa.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return Sa.visit_gradient(e)},visit_gradient:function(e){var t=Sa.visit(e.orientation);return t&&(t+=", "),e.type+"("+t+Sa.visit(e.colorStops)+")"},visit_shape:function(e){var t=e.value,i=Sa.visit(e.at),r=Sa.visit(e.style);return r&&(t+=" "+r),i&&(t+=" at "+i),t},"visit_default-radial":function(e){var t="",i=Sa.visit(e.at);return i&&(t+=i),t},"visit_extent-keyword":function(e){var t=e.value,i=Sa.visit(e.at);return i&&(t+=" at "+i),t},"visit_position-keyword":function(e){return e.value},visit_position:function(e){return Sa.visit(e.value.x)+" "+Sa.visit(e.value.y)},"visit_%":function(e){return e.value+"%"},visit_em:function(e){return e.value+"em"},visit_px:function(e){return e.value+"px"},visit_literal:function(e){return Sa.visit_color(e.value,e)},visit_hex:function(e){return Sa.visit_color("#"+e.value,e)},visit_rgb:function(e){return Sa.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return Sa.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,t){var i=e,r=Sa.visit(t.length);return r&&(i+=" "+r),i},visit_angular:function(e){return e.value+"deg"},visit_directional:function(e){return"to "+e.value},visit_array:function(e){var t="",i=e.length;return e.forEach((function(e,r){t+=Sa.visit(e),r<i-1&&(t+=", ")})),t},visit:function(e){if(!e)return"";if(e instanceof Array)return Sa.visit_array(e,"");if(e.type){var t=Sa["visit_"+e.type];if(t)return t(e);throw Error("Missing visitor visit_"+e.type)}throw Error("Invalid node.")}},function(e){return Sa.visit(e)}),(wa=wa||{}).parse=function(){var e={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function i(e){var i=new Error(t+": "+e);throw i.source=t,i}function r(){return o("linear-gradient",e.linearGradient,n)||o("repeating-linear-gradient",e.repeatingLinearGradient,n)||o("radial-gradient",e.radialGradient,l)||o("repeating-radial-gradient",e.repeatingRadialGradient,l)}function o(t,r,o){return s(r,(function(r){var s=o();return s&&(F(e.comma)||i("Missing comma before color stops")),{type:t,orientation:s,colorStops:u(m)}}))}function s(t,r){var o=F(t);if(o){F(e.startCall)||i("Missing (");var s=r(o);return F(e.endCall)||i("Missing )"),s}}function n(){return g("directional",e.sideOrCorner,1)||g("angular",e.angleValue,1)}function l(){var i,r,o=a();return o&&((i=[]).push(o),r=t,F(e.comma)&&((o=a())?i.push(o):t=r)),i}function a(){var e=function(){var e=g("shape",/^(circle)/i,0);return e&&(e.style=f()||h()),e}()||function(){var e=g("shape",/^(ellipse)/i,0);return e&&(e.style=b()||h()),e}();if(e)e.at=d();else{var t=h();if(t){e=t;var i=d();i&&(e.at=i)}else{var r=c();r&&(e={type:"default-radial",at:r})}}return e}function h(){return g("extent-keyword",e.extentKeywords,1)}function d(){if(g("position",/^at/,0)){var e=c();return e||i("Missing positioning value"),e}}function c(){var e={x:b(),y:b()};if(e.x||e.y)return{type:"position",value:e}}function u(t){var r=t(),o=[];if(r)for(o.push(r);F(e.comma);)(r=t())?o.push(r):i("One extra comma");return o}function m(){var t=g("hex",e.hexColor,1)||s(e.rgbaColor,(function(){return{type:"rgba",value:u(p)}}))||s(e.rgbColor,(function(){return{type:"rgb",value:u(p)}}))||g("literal",e.literalColor,0);return t||i("Expected color definition"),t.length=b(),t}function p(){return F(e.number)[1]}function b(){return g("%",e.percentageValue,1)||g("position-keyword",e.positionKeywords,1)||f()}function f(){return g("px",e.pixelValue,1)||g("em",e.emValue,1)}function g(e,t,i){var r=F(t);if(r)return{type:e,value:r[i]}}function F(e){var i,r;return(r=/^[\n\r\t\s]+/.exec(t))&&y(r[0].length),(i=e.exec(t))&&y(i[0].length),i}function y(e){t=t.substr(e)}return function(e){return t=e.toString(),function(){var e=u(r);return t.length>0&&i("Invalid input not EOF"),e}()}}();var Ta=wa.parse;wa.stringify;var Ea={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Aa={red:0,orange:60,yellow:120,green:180,blue:240,purple:300},Pa={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},Ca={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t,i,r,o,s,n=e[0]/360,l=e[1]/100,a=e[2]/100;if(0===l)return[s=255*a,s,s];t=2*a-(i=a<.5?a*(1+l):a+l-a*l),o=[0,0,0];for(var h=0;h<3;h++)(r=n+1/3*-(h-1))<0?r++:r>1&&r--,s=6*r<1?t+6*(i-t)*r:2*r<1?i:3*r<2?t+(i-t)*(2/3-r)*6:t,o[h]=255*s;return o}};function ka(e){switch(typeof e){case"string":return function(e){const t=function(e){Array.isArray(e)&&e.raw&&(e=String.raw(...arguments));var t,i=function(e){var t,i,r=[],o=1;if("string"==typeof e)if(Ea[e])r=Ea[e].slice(),i="rgb";else if("transparent"===e)o=0,i="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var s=e.slice(1);o=1,(a=s.length)<=4?(r=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===a&&(o=parseInt(s[3]+s[3],16)/255)):(r=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===a&&(o=parseInt(s[6]+s[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),i="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var n=t[1],l="rgb"===n;i=s=n.replace(/a$/,"");var a="cmyk"===s?4:"gray"===s?1:3;r=t[2].trim().split(/\s*[,\/]\s*|\s+/).map((function(e,t){if(/%$/.test(e))return t===a?parseFloat(e)/100:"rgb"===s?255*parseFloat(e)/100:parseFloat(e);if("h"===s[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==Aa[e])return Aa[e]}return parseFloat(e)})),n===s&&r.push(1),o=l||void 0===r[a]?1:r[a],r=r.slice(0,a)}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(r=e.match(/([0-9]+)/g).map((function(e){return parseFloat(e)})),i=e.match(/([a-z])/gi).join("").toLowerCase());else isNaN(e)?Array.isArray(e)||e.length?(r=[e[0],e[1],e[2]],i="rgb",o=4===e.length?e[3]:1):e instanceof Object&&(null!=e.r||null!=e.red||null!=e.R?(i="rgb",r=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(i="hsl",r=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),o=e.a||e.alpha||e.opacity||1,null!=e.opacity&&(o/=100)):(i="rgb",r=[e>>>16,(65280&e)>>>8,255&e]);return{space:i,values:r,alpha:o}}(e);if(!i.space)return[];const r="h"===i.space[0]?Ca.min:Pa.min,o="h"===i.space[0]?Ca.max:Pa.max;return(t=Array(3))[0]=Math.min(Math.max(i.values[0],r[0]),o[0]),t[1]=Math.min(Math.max(i.values[1],r[1]),o[1]),t[2]=Math.min(Math.max(i.values[2],r[2]),o[2]),"h"===i.space[0]&&(t=Ca.rgb(t)),t.push(Math.min(Math.max(i.alpha,0),1)),t}(e);if(!t)throw new Error(`Unable to parse color "${e}" as RGBA.`);return[t[0]/255,t[1]/255,t[2]/255,t[3]]}(e);case"number":return Ee(e);default:return e}}function Ba(e){return ka(function(e){switch(e.type){case"hex":return`#${e.value}`;case"literal":return e.value;default:return`${e.type}(${e.value.join(",")})`}}(e))}function Ma(e){return e.toString().length>6?parseFloat(e.toString().substring(0,6)):e}Pa.hsl=function(e){var t,i,r=e[0]/255,o=e[1]/255,s=e[2]/255,n=Math.min(r,o,s),l=Math.max(r,o,s),a=l-n;return l===n?t=0:r===l?t=(o-s)/a:o===l?t=2+(s-r)/a:s===l&&(t=4+(r-o)/a),(t=Math.min(60*t,360))<0&&(t+=360),i=(n+l)/2,[t,100*(l===n?0:i<=.5?a/(l+n):a/(2-l-n)),100*i]};var Ra=Object.defineProperty,Ia=Object.defineProperties,Da=Object.getOwnPropertyDescriptors,Oa=Object.getOwnPropertySymbols,Na=Object.prototype.hasOwnProperty,La=Object.prototype.propertyIsEnumerable,za=(e,t,i)=>t in e?Ra(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Ga=(e,t)=>{for(var i in t||(t={}))Na.call(t,i)&&za(e,i,t[i]);if(Oa)for(var i of Oa(t))La.call(t,i)&&za(e,i,t[i]);return e};const Ua=class extends bi{constructor(e){e&&"css"in e&&(e=((e,t)=>Ia(e,Da(t)))(Ga({},function(e){const t=Ta(function(e){let t=e.replace(/\s{2,}/gu," ");return t=t.replace(/;/g,""),t=t.replace(/ ,/g,","),t=t.replace(/\( /g,"("),t=t.replace(/ \)/g,")"),t.trim()}(e));if(0===t.length)throw new Error("Invalid CSS gradient.");if(1!==t.length)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const i=t[0],r=function(e){const t={"linear-gradient":0,"radial-gradient":1};if(!(e in t))throw new Error(`Unsupported gradient type "${e}"`);return t[e]}(i.type),o=function(e){const t=function(e){const t=[];for(let i=0;i<e.length;i++){const r=e[i];let o=-1;"literal"===r.type&&r.length&&"type"in r.length&&"%"===r.length.type&&"value"in r.length&&(o=parseFloat(r.length.value)/100),t.push(o)}const i=e=>{for(let i=e;i<t.length;i++)if(-1!==t[i])return{indexDelta:i-e,offset:t[i]};return{indexDelta:t.length-1-e,offset:1}};let r=0;for(let e=0;e<t.length;e++){const o=t[e];if(-1!==o)r=o;else if(0===e)t[e]=0;else if(e+1===t.length)t[e]=1;else{const o=i(e),s=(o.offset-r)/(1+o.indexDelta);for(let i=0;i<=o.indexDelta;i++)t[e+i]=r+(i+1)*s;e+=o.indexDelta,r=t[e]}}return t.map(Ma)}(e),i=[];for(let r=0;r<e.length;r++){const o=Ba(e[r]);i.push({offset:t[r],color:o.slice(0,3),alpha:o[3]})}return i}(i.colorStops),s=function(e){if(void 0===e)return 0;if("type"in e&&"value"in e)switch(e.type){case"angular":return parseFloat(e.value);case"directional":return function(e){const t={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(e in t))throw new Error(`Unsupported directional value "${e}"`);return t[e]}(e.value)}return 0}(i.orientation);return{type:r,stops:o,angle:s}}(e.css||"")),{alpha:e.alpha,maxColors:e.maxColors}));const t=Ga(Ga({},Ua.defaults),e);if(!t.stops||t.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;\n}\n","const float PI = 3.1415926538;\nconst float PI_2 = PI*2.;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nuniform sampler2D uSampler;\n\nconst int TYPE_LINEAR = 0;\nconst int TYPE_RADIAL = 1;\nconst int TYPE_CONIC = 2;\nconst int MAX_STOPS = 32;\n\nuniform int uNumStops;\nuniform float uAlphas[3*MAX_STOPS];\nuniform vec3 uColors[MAX_STOPS];\nuniform float uOffsets[MAX_STOPS];\nuniform int uType;\nuniform float uAngle;\nuniform float uAlpha;\nuniform int uMaxColors;\n\nstruct ColorStop {\n    float offset;\n    vec3 color;\n    float alpha;\n};\n\nmat2 rotate2d(float angle){\n    return mat2(cos(angle), -sin(angle),\n    sin(angle), cos(angle));\n}\n\nfloat projectLinearPosition(vec2 pos, float angle){\n    vec2 center = vec2(0.5);\n    vec2 result = pos - center;\n    result = rotate2d(angle) * result;\n    result = result + center;\n    return clamp(result.x, 0., 1.);\n}\n\nfloat projectRadialPosition(vec2 pos) {\n    float r = distance(vFilterCoord, vec2(0.5));\n    return clamp(2.*r, 0., 1.);\n}\n\nfloat projectAnglePosition(vec2 pos, float angle) {\n    vec2 center = pos - vec2(0.5);\n    float polarAngle=atan(-center.y, center.x);\n    return mod(polarAngle + angle, PI_2) / PI_2;\n}\n\nfloat projectPosition(vec2 pos, int type, float angle) {\n    if (type == TYPE_LINEAR) {\n        return projectLinearPosition(pos, angle);\n    } else if (type == TYPE_RADIAL) {\n        return projectRadialPosition(pos);\n    } else if (type == TYPE_CONIC) {\n        return projectAnglePosition(pos, angle);\n    }\n\n    return pos.y;\n}\n\nvoid main(void) {\n    // current/original color\n    vec4 currentColor = texture2D(uSampler, vTextureCoord);\n\n    // skip calculations if gradient alpha is 0\n    if (0.0 == uAlpha) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // project position\n    float y = projectPosition(vFilterCoord, uType, radians(uAngle));\n\n    // check gradient bounds\n    float offsetMin = uOffsets[0];\n    float offsetMax = 0.0;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (i == uNumStops-1){ // last index\n            offsetMax = uOffsets[i];\n        }\n    }\n\n    if (y  < offsetMin || y > offsetMax) {\n        gl_FragColor = currentColor;\n        return;\n    }\n\n    // limit colors\n    if (uMaxColors > 0) {\n        float stepSize = 1./float(uMaxColors);\n        float stepNumber = float(floor(y/stepSize));\n        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment\n    }\n\n    // find color stops\n    ColorStop from;\n    ColorStop to;\n\n    for (int i = 0; i < MAX_STOPS; i++) {\n        if (y >= uOffsets[i]) {\n            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);\n            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);\n        }\n\n        if (i == uNumStops-1){ // last index\n            break;\n        }\n    }\n\n    // mix colors from stops\n    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);\n    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);\n\n    float segmentHeight = to.offset - from.offset;\n    float relativePos = y - from.offset;// position from 0 to [segmentHeight]\n    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].\n\n    float gradientAlpha = uAlpha * currentColor.a;\n    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;\n\n    // mix resulting color with current color\n    gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);\n}\n"),this._stops=[],this.autoFit=!1,Object.assign(this,t)}get stops(){return this._stops}set stops(e){const t=function(e){return[...e].sort(((e,t)=>e.offset-t.offset))}(e),i=new Float32Array(3*t.length);for(let e=0;e<t.length;e++){const r=ka(t[e].color),o=3*e;i[o+0]=r[0],i[o+1]=r[1],i[o+2]=r[2]}this.uniforms.uColors=i,this.uniforms.uOffsets=t.map((e=>e.offset)),this.uniforms.uAlphas=t.map((e=>e.alpha)),this.uniforms.uNumStops=t.length,this._stops=t}set type(e){this.uniforms.uType=e}get type(){return this.uniforms.uType}set angle(e){this.uniforms.uAngle=e-90}get angle(){return this.uniforms.uAngle+90}set alpha(e){this.uniforms.uAlpha=e}get alpha(){return this.uniforms.uAlpha}set maxColors(e){this.uniforms.uMaxColors=e}get maxColors(){return this.uniforms.uMaxColors}};let Ha=Ua;Ha.LINEAR=0,Ha.RADIAL=1,Ha.CONIC=2,Ha.defaults={type:Ua.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0};const Va=class extends bi{constructor(e){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nconst float SQRT_2 = 1.414213;\n\nconst float light = 1.0;\n\nuniform float curvature;\nuniform float lineWidth;\nuniform float lineContrast;\nuniform bool verticalLine;\nuniform float noise;\nuniform float noiseSize;\n\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\n\nuniform float seed;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));\n    \n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 rgb = gl_FragColor.rgb;\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        rgb += _noise * noise;\n    }\n\n    if (lineWidth > 0.0)\n    {\n        float _c = curvature > 0. ? curvature : 1.;\n        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;\n        vec2 uv = dir * k;\n\n        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;\n        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;\n        rgb *= j;\n        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);\n        rgb *= 0.99 + ceil(segment) * 0.015;\n    }\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    gl_FragColor.rgb = rgb;\n}\n"),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Va.defaults,e)}apply(e,t,i,r){const{width:o,height:s}=t.filterFrame;this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=s,this.uniforms.seed=this.seed,this.uniforms.time=this.time,e.applyFilter(this,t,i,r)}set curvature(e){this.uniforms.curvature=e}get curvature(){return this.uniforms.curvature}set lineWidth(e){this.uniforms.lineWidth=e}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(e){this.uniforms.lineContrast=e}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(e){this.uniforms.verticalLine=e}get verticalLine(){return this.uniforms.verticalLine}set noise(e){this.uniforms.noise=e}get noise(){return this.uniforms.noise}set noiseSize(e){this.uniforms.noiseSize=e}get noiseSize(){return this.uniforms.noiseSize}set vignetting(e){this.uniforms.vignetting=e}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(e){this.uniforms.vignettingAlpha=e}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(e){this.uniforms.vignettingBlur=e}get vignettingBlur(){return this.uniforms.vignettingBlur}};Va.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var ja=Object.defineProperty,Wa=Object.getOwnPropertySymbols,Xa=Object.prototype.hasOwnProperty,$a=Object.prototype.propertyIsEnumerable,Ya=(e,t,i)=>t in e?ja(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,qa=(e,t)=>{for(var i in t||(t={}))Xa.call(t,i)&&Ya(e,i,t[i]);if(Wa)for(var i of Wa(t))$a.call(t,i)&&Ya(e,i,t[i]);return e};const Za=class extends bi{constructor(e){super(),this.angle=45,this._distance=5,this._resolution=x.FILTER_RESOLUTION;const t=e?qa(qa({},Za.defaults),e):Za.defaults,{kernels:i,blur:r,quality:o,pixelSize:s,resolution:n}=t;this._offset=new Ut(this._updatePadding,this),this._tintFilter=new bi("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}"),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=n,this._blurFilter=i?new Fa(i):new Fa(r,o),this.pixelSize=s,this.resolution=n;const{shadowOnly:l,rotation:a,distance:h,offset:d,alpha:c,color:u}=t;this.shadowOnly=l,void 0!==a&&void 0!==h?(this.rotation=a,this.distance=h):this.offset=d,this.alpha=c,this.color=u}apply(e,t,i,r){const o=e.getFilterTexture();this._tintFilter.apply(e,t,o,1),this._blurFilter.apply(e,o,i,r),!0!==this.shadowOnly&&e.applyFilter(this,t,i,0),e.returnFilterTexture(o)}_updatePadding(){const e=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=e+2*this.blur}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(e){this._offset.copyFrom(e),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this._tintFilter&&(this._tintFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)}get distance(){return this._distance}set distance(e){Y("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=e,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/wt}set rotation(e){Y("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=e*wt,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(e){this._tintFilter.uniforms.alpha=e}get color(){return Ae(this._tintFilter.uniforms.color)}set color(e){Ee(e,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.blur}set blur(e){this._blurFilter.blur=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){this._blurFilter.pixelSize=e}};Za.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:x.FILTER_RESOLUTION};const Ka=class extends bi{constructor(e){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","// precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\nuniform float aspect;\n\nuniform sampler2D displacementMap;\nuniform float offset;\nuniform float sinDir;\nuniform float cosDir;\nuniform int fillMode;\n\nuniform float seed;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nconst int TRANSPARENT = 0;\nconst int ORIGINAL = 1;\nconst int LOOP = 2;\nconst int CLAMP = 3;\nconst int MIRROR = 4;\n\nvoid main(void)\n{\n    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;\n\n    if (coord.x > 1.0 || coord.y > 1.0) {\n        return;\n    }\n\n    float cx = coord.x - 0.5;\n    float cy = (coord.y - 0.5) * aspect;\n    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;\n\n    // displacementMap: repeat\n    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);\n\n    // displacementMap: mirror\n    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);\n\n    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));\n\n    float displacement = (dc.r - dc.g) * (offset / filterArea.x);\n\n    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);\n\n    if (fillMode == CLAMP) {\n        coord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    } else {\n        if( coord.x > filterClamp.z ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x -= filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x = filterClamp.z * 2.0 - coord.x;\n            }\n        } else if( coord.x < filterClamp.x ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.x += filterClamp.z;\n            } else if (fillMode == MIRROR) {\n                coord.x *= -filterClamp.z;\n            }\n        }\n\n        if( coord.y > filterClamp.w ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y -= filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y = filterClamp.w * 2.0 - coord.y;\n            }\n        } else if( coord.y < filterClamp.y ) {\n            if (fillMode == TRANSPARENT) {\n                discard;\n            } else if (fillMode == LOOP) {\n                coord.y += filterClamp.w;\n            } else if (fillMode == MIRROR) {\n                coord.y *= -filterClamp.w;\n            }\n        }\n    }\n\n    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;\n    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;\n    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;\n    gl_FragColor.a = texture2D(uSampler, coord).a;\n}\n"),this.offset=100,this.fillMode=Ka.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=Pi.from(this._canvas,{scaleMode:d.NEAREST}),Object.assign(this,Ka.defaults,e)}apply(e,t,i,r){const{width:o,height:s}=t.filterFrame;this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/o,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,e.applyFilter(this,t,i,r)}_randomizeSizes(){const e=this._sizes,t=this._slices-1,i=this.sampleSize,r=Math.min(this.minSize/i,.9/this._slices);if(this.average){const i=this._slices;let o=1;for(let s=0;s<t;s++){const t=o/(i-s),n=Math.max(t*(1-.6*Math.random()),r);e[s]=n,o-=n}e[t]=o}else{let i=1;const o=Math.sqrt(1/this._slices);for(let s=0;s<t;s++){const t=Math.max(o*i*Math.random(),r);e[s]=t,i-=t}e[t]=i}this.shuffle()}shuffle(){const e=this._sizes;for(let t=this._slices-1;t>0;t--){const i=Math.random()*t>>0,r=e[t];e[t]=e[i],e[i]=r}}_randomizeOffsets(){for(let e=0;e<this._slices;e++)this._offsets[e]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const e=this.sampleSize,t=this.texture,i=this._canvas.getContext("2d");i.clearRect(0,0,8,e);let r,o=0;for(let t=0;t<this._slices;t++){r=Math.floor(256*this._offsets[t]);const s=this._sizes[t]*e,n=r>0?r:0,l=r<0?-r:0;i.fillStyle=`rgba(${n}, ${l}, 0, 1)`,i.fillRect(0,o>>0,e,s+1>>0),o+=s}t.baseTexture.update(),this.uniforms.displacementMap=t}set sizes(e){const t=Math.min(this._slices,e.length);for(let i=0;i<t;i++)this._sizes[i]=e[i]}get sizes(){return this._sizes}set offsets(e){const t=Math.min(this._slices,e.length);for(let i=0;i<t;i++)this._offsets[i]=e[i]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(e){this._slices!==e&&(this._slices=e,this.uniforms.slices=e,this._sizes=this.uniforms.slicesWidth=new Float32Array(e),this._offsets=this.uniforms.slicesOffset=new Float32Array(e),this.refresh())}get direction(){return this._direction}set direction(e){if(this._direction===e)return;this._direction=e;const t=e*wt;this.uniforms.sinDir=Math.sin(t),this.uniforms.cosDir=Math.cos(t)}get red(){return this.uniforms.red}set red(e){this.uniforms.red=e}get green(){return this.uniforms.green}set green(e){this.uniforms.green=e}get blue(){return this.uniforms.blue}set blue(e){this.uniforms.blue=e}destroy(){var e;null==(e=this.texture)||e.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let Ja=Ka;Ja.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},Ja.TRANSPARENT=0,Ja.ORIGINAL=1,Ja.LOOP=2,Ja.CLAMP=3,Ja.MIRROR=4;const Qa=class extends bi{constructor(e){const t=Object.assign({},Qa.defaults,e),{outerStrength:i,innerStrength:r,color:o,knockout:s,quality:n,alpha:l}=t,a=Math.round(t.distance);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nuniform float outerStrength;\nuniform float innerStrength;\n\nuniform vec4 glowColor;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform bool knockout;\nuniform float alpha;\n\nconst float PI = 3.14159265358979323846264;\n\nconst float DIST = __DIST__;\nconst float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);\nconst float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);\n\nconst float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;\n\nvoid main(void) {\n    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);\n\n    float totalAlpha = 0.0;\n\n    vec2 direction;\n    vec2 displaced;\n    vec4 curColor;\n\n    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {\n       direction = vec2(cos(angle), sin(angle)) * px;\n\n       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {\n           displaced = clamp(vTextureCoord + direction * \n                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);\n\n           curColor = texture2D(uSampler, displaced);\n\n           totalAlpha += (DIST - curDistance) * curColor.a;\n       }\n    }\n    \n    curColor = texture2D(uSampler, vTextureCoord);\n\n    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);\n\n    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;\n    float innerGlowStrength = min(1.0, innerGlowAlpha);\n    \n    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);\n\n    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);\n    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);\n\n    if (knockout) {\n      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;\n      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);\n    }\n    else {\n      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;\n      gl_FragColor = innerColor + outerGlowColor;\n    }\n}\n".replace(/__ANGLE_STEP_SIZE__/gi,`${(1/n/a).toFixed(7)}`).replace(/__DIST__/gi,`${a.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:o,outerStrength:i,innerStrength:r,padding:a,knockout:s,alpha:l})}get color(){return Ae(this.uniforms.glowColor)}set color(e){Ee(e,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(e){this.uniforms.outerStrength=e}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(e){this.uniforms.innerStrength=e}get knockout(){return this.uniforms.knockout}set knockout(e){this.uniforms.knockout=e}get alpha(){return this.uniforms.alpha}set alpha(e){this.uniforms.alpha=e}};let eh=Qa;eh.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};const th=class extends bi{constructor(e){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform vec2 light;\nuniform bool parallel;\nuniform float aspect;\n\nuniform float gain;\nuniform float lacunarity;\nuniform float time;\nuniform float alpha;\n\n${perlin}\n\nvoid main(void) {\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    float d;\n\n    if (parallel) {\n        float _cos = light.x;\n        float _sin = light.y;\n        d = (_cos * coord.x) + (_sin * coord.y * aspect);\n    } else {\n        float dx = coord.x - light.x / dimensions.x;\n        float dy = (coord.y - light.y / dimensions.y) * aspect;\n        float dis = sqrt(dx * dx + dy * dy) + 0.00001;\n        d = dy / dis;\n    }\n\n    vec3 dir = vec3(d, d, 0.0);\n\n    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);\n    noise = mix(noise, 0.0, 0.3);\n    //fade vertically.\n    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);\n    mist.a = 1.0;\n    // apply user alpha\n    mist *= alpha;\n\n    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;\n\n}\n".replace("${perlin}","vec3 mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\n    return mod289(((x * 34.0) + 1.0) * x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t)\n{\n    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n    Pi0 = mod289(Pi0);\n    Pi1 = mod289(Pi1);\n    vec3 Pf0 = fract(P); // Fractional part for interpolation\n    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n    vec4 iy = vec4(Pi0.yy, Pi1.yy);\n    vec4 iz0 = Pi0.zzzz;\n    vec4 iz1 = Pi1.zzzz;\n    vec4 ixy = permute(permute(ix) + iy);\n    vec4 ixy0 = permute(ixy + iz0);\n    vec4 ixy1 = permute(ixy + iz1);\n    vec4 gx0 = ixy0 * (1.0 / 7.0);\n    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n    gx0 = fract(gx0);\n    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n    vec4 sz0 = step(gz0, vec4(0.0));\n    gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n    gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n    vec4 gx1 = ixy1 * (1.0 / 7.0);\n    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n    gx1 = fract(gx1);\n    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n    vec4 sz1 = step(gz1, vec4(0.0));\n    gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n    gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);\n    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);\n    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);\n    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);\n    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);\n    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);\n    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);\n    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);\n    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n    g000 *= norm0.x;\n    g010 *= norm0.y;\n    g100 *= norm0.z;\n    g110 *= norm0.w;\n    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n    g001 *= norm1.x;\n    g011 *= norm1.y;\n    g101 *= norm1.z;\n    g111 *= norm1.w;\n    float n000 = dot(g000, Pf0);\n    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n    float n111 = dot(g111, Pf1);\n    vec3 fade_xyz = fade(Pf0);\n    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n    return 2.2 * n_xyz;\n}\nfloat turb(vec3 P, vec3 rep, float lacunarity, float gain)\n{\n    float sum = 0.0;\n    float sc = 1.0;\n    float totalgain = 1.0;\n    for (float i = 0.0; i < 6.0; i++)\n    {\n        sum += totalgain * pnoise(P * sc, rep);\n        sc *= lacunarity;\n        totalgain *= gain;\n    }\n    return abs(sum);\n}\n")),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const t=Object.assign(th.defaults,e);this._angleLight=new Tt,this.angle=t.angle,this.gain=t.gain,this.lacunarity=t.lacunarity,this.alpha=t.alpha,this.parallel=t.parallel,this.center=t.center,this.time=t.time}apply(e,t,i,r){const{width:o,height:s}=t.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=o,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/o,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,e.applyFilter(this,t,i,r)}get angle(){return this._angle}set angle(e){this._angle=e;const t=e*wt;this._angleLight.x=Math.cos(t),this._angleLight.y=Math.sin(t)}get gain(){return this.uniforms.gain}set gain(e){this.uniforms.gain=e}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(e){this.uniforms.lacunarity=e}get alpha(){return this.uniforms.alpha}set alpha(e){this.uniforms.alpha=e}};th.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};const ih=class extends bi{constructor(e){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float uHue;\nuniform float uAlpha;\nuniform bool uColorize;\nuniform float uSaturation;\nuniform float uLightness;\n\n// https://en.wikipedia.org/wiki/Luma_(video)\nconst vec3 weight = vec3(0.299, 0.587, 0.114);\n\nfloat getWeightedAverage(vec3 rgb) {\n    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;\n}\n\n// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243\nconst vec3 k = vec3(0.57735, 0.57735, 0.57735);\n\nvec3 hueShift(vec3 color, float angle) {\n    float cosAngle = cos(angle);\n    return vec3(\n    color * cosAngle +\n    cross(k, color) * sin(angle) +\n    k * dot(k, color) * (1.0 - cosAngle)\n    );\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    vec4 result = color;\n\n    // colorize\n    if (uColorize) {\n        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);\n    }\n\n    // hue\n    result.rgb = hueShift(result.rgb, uHue);\n\n    // saturation\n    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js\n    float average = (result.r + result.g + result.b) / 3.0;\n\n    if (uSaturation > 0.) {\n        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));\n    } else {\n        result.rgb -= (average - result.rgb) * uSaturation;\n    }\n\n    // lightness\n    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));\n\n    // alpha\n    gl_FragColor = mix(color, result, uAlpha);\n}\n"),this._hue=0;const t=Object.assign({},ih.defaults,e);Object.assign(this,t)}get hue(){return this._hue}set hue(e){this._hue=e,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get colorize(){return this.uniforms.uColorize}set colorize(e){this.uniforms.uColorize=e}get lightness(){return this.uniforms.uLightness}set lightness(e){this.uniforms.uLightness=e}get saturation(){return this.uniforms.uSaturation}set saturation(e){this.uniforms.uSaturation=e}};ih.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};const rh=class extends bi{constructor(e,t=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec2 dimensions;\n\nuniform float sepia;\nuniform float noise;\nuniform float noiseSize;\nuniform float scratch;\nuniform float scratchDensity;\nuniform float scratchWidth;\nuniform float vignetting;\nuniform float vignettingAlpha;\nuniform float vignettingBlur;\nuniform float seed;\n\nconst float SQRT_2 = 1.414213;\nconst vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvec3 Overlay(vec3 src, vec3 dst)\n{\n    // if (dst <= 0.5) then: 2 * src * dst\n    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)\n    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),\n                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),\n                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));\n}\n\n\nvoid main()\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n    vec3 color = gl_FragColor.rgb;\n\n    if (sepia > 0.0)\n    {\n        float gray = (color.x + color.y + color.z) / 3.0;\n        vec3 grayscale = vec3(gray);\n\n        color = Overlay(SEPIA_RGB, grayscale);\n\n        color = grayscale + sepia * (color - grayscale);\n    }\n\n    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;\n\n    if (vignetting > 0.0)\n    {\n        float outter = SQRT_2 - vignetting * SQRT_2;\n        vec2 dir = vec2(vec2(0.5, 0.5) - coord);\n        dir.y *= dimensions.y / dimensions.x;\n        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);\n        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);\n    }\n\n    if (scratchDensity > seed && scratch != 0.0)\n    {\n        float phase = seed * 256.0;\n        float s = mod(floor(phase), 2.0);\n        float dist = 1.0 / scratchDensity;\n        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));\n        if (d < seed * 0.6 + 0.4)\n        {\n            highp float period = scratchDensity * 10.0;\n\n            float xx = coord.x * period + phase;\n            float aa = abs(mod(xx, 0.5) * 4.0);\n            float bb = mod(floor(xx / 0.5), 2.0);\n            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);\n\n            float kk = 2.0 * period;\n            float dw = scratchWidth / dimensions.x * (0.75 + seed);\n            float dh = dw * kk;\n\n            float tine = (yy - (2.0 - dh));\n\n            if (tine > 0.0) {\n                float _sign = sign(scratch);\n\n                tine = s * tine / period + scratch + 0.1;\n                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);\n\n                color.rgb *= tine;\n            }\n        }\n    }\n\n    if (noise > 0.0 && noiseSize > 0.0)\n    {\n        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n        pixelCoord.x = floor(pixelCoord.x / noiseSize);\n        pixelCoord.y = floor(pixelCoord.y / noiseSize);\n        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);\n        // float _noise = snoise(d) * 0.5;\n        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;\n        color += _noise * noise;\n    }\n\n    gl_FragColor.rgb = color;\n}\n"),this.seed=0,this.uniforms.dimensions=new Float32Array(2),"number"==typeof e?(this.seed=e,e=void 0):this.seed=t,Object.assign(this,rh.defaults,e)}apply(e,t,i,r){var o,s;this.uniforms.dimensions[0]=null==(o=t.filterFrame)?void 0:o.width,this.uniforms.dimensions[1]=null==(s=t.filterFrame)?void 0:s.height,this.uniforms.seed=this.seed,e.applyFilter(this,t,i,r)}set sepia(e){this.uniforms.sepia=e}get sepia(){return this.uniforms.sepia}set noise(e){this.uniforms.noise=e}get noise(){return this.uniforms.noise}set noiseSize(e){this.uniforms.noiseSize=e}get noiseSize(){return this.uniforms.noiseSize}set scratch(e){this.uniforms.scratch=e}get scratch(){return this.uniforms.scratch}set scratchDensity(e){this.uniforms.scratchDensity=e}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(e){this.uniforms.scratchWidth=e}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(e){this.uniforms.vignetting=e}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(e){this.uniforms.vignettingAlpha=e}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(e){this.uniforms.vignettingBlur=e}get vignettingBlur(){return this.uniforms.vignettingBlur}};rh.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};const oh=class extends bi{constructor(e=1,t=0,i=.1,r=1,o=!1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterClamp;\n\nuniform float uAlpha;\nuniform vec2 uThickness;\nuniform vec4 uColor;\nuniform bool uKnockout;\n\nconst float DOUBLE_PI = 2. * 3.14159265358979323846264;\nconst float ANGLE_STEP = ${angleStep};\n\nfloat outlineMaxAlphaAtPos(vec2 pos) {\n    if (uThickness.x == 0. || uThickness.y == 0.) {\n        return 0.;\n    }\n\n    vec4 displacedColor;\n    vec2 displacedPos;\n    float maxAlpha = 0.;\n\n    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {\n        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);\n        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);\n        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));\n        maxAlpha = max(maxAlpha, displacedColor.a);\n    }\n\n    return maxAlpha;\n}\n\nvoid main(void) {\n    vec4 sourceColor = texture2D(uSampler, vTextureCoord);\n    vec4 contentColor = sourceColor * float(!uKnockout);\n    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);\n    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);\n    gl_FragColor = contentColor + outlineColor;\n}\n".replace(/\$\{angleStep\}/,oh.getAngleStep(i))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=r,this.uniforms.uKnockout=o,Object.assign(this,{thickness:e,color:t,quality:i,alpha:r,knockout:o})}static getAngleStep(e){const t=Math.max(e*oh.MAX_SAMPLES,oh.MIN_SAMPLES);return(2*Math.PI/t).toFixed(7)}apply(e,t,i,r){this.uniforms.uThickness[0]=this._thickness/t._frame.width,this.uniforms.uThickness[1]=this._thickness/t._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,e.applyFilter(this,t,i,r)}get alpha(){return this._alpha}set alpha(e){this._alpha=e}get color(){return Ae(this.uniforms.uColor)}set color(e){Ee(e,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(e){this._knockout=e}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this.padding=e}};let sh=oh;sh.MIN_SAMPLES=1,sh.MAX_SAMPLES=100;const nh=class extends bi{constructor(e){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\nuniform vec2 dimensions;\n\nuniform bool mirror;\nuniform float boundary;\nuniform vec2 amplitude;\nuniform vec2 waveLength;\nuniform vec2 alpha;\nuniform float time;\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\n    vec2 coord = pixelCoord / dimensions;\n\n    if (coord.y < boundary) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    float k = (coord.y - boundary) / (1. - boundary + 0.0001);\n    float areaY = boundary * dimensions.y / filterArea.y;\n    float v = areaY + areaY - vTextureCoord.y;\n    float y = mirror ? v : vTextureCoord.y;\n\n    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;\n    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;\n    float _alpha = (alpha.y - alpha.x) * k + alpha.x;\n\n    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;\n    x = clamp(x, filterClamp.x, filterClamp.z);\n\n    vec4 color = texture2D(uSampler, vec2(x, y));\n\n    gl_FragColor = color * _alpha;\n}\n"),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,nh.defaults,e)}apply(e,t,i,r){var o,s;this.uniforms.dimensions[0]=null==(o=t.filterFrame)?void 0:o.width,this.uniforms.dimensions[1]=null==(s=t.filterFrame)?void 0:s.height,this.uniforms.time=this.time,e.applyFilter(this,t,i,r)}set mirror(e){this.uniforms.mirror=e}get mirror(){return this.uniforms.mirror}set boundary(e){this.uniforms.boundary=e}get boundary(){return this.uniforms.boundary}set amplitude(e){this.uniforms.amplitude[0]=e[0],this.uniforms.amplitude[1]=e[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(e){this.uniforms.waveLength[0]=e[0],this.uniforms.waveLength[1]=e[1]}get waveLength(){return this.uniforms.waveLength}set alpha(e){this.uniforms.alpha[0]=e[0],this.uniforms.alpha[1]=e[1]}get alpha(){return this.uniforms.alpha}};nh.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};const lh=class extends bi{constructor(e=[0,0],t,i=0){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nuniform vec2 center;\n\nuniform float amplitude;\nuniform float wavelength;\n// uniform float power;\nuniform float brightness;\nuniform float speed;\nuniform float radius;\n\nuniform float time;\n\nconst float PI = 3.14159;\n\nvoid main()\n{\n    float halfWavelength = wavelength * 0.5 / filterArea.x;\n    float maxRadius = radius / filterArea.x;\n    float currentRadius = time * speed / filterArea.x;\n\n    float fade = 1.0;\n\n    if (maxRadius > 0.0) {\n        if (currentRadius > maxRadius) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\n    }\n\n    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);\n    dir.y *= filterArea.y / filterArea.x;\n    float dist = length(dir);\n\n    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\n        gl_FragColor = texture2D(uSampler, vTextureCoord);\n        return;\n    }\n\n    vec2 diffUV = normalize(dir);\n\n    float diff = (dist - currentRadius) / halfWavelength;\n\n    float p = 1.0 - pow(abs(diff), 2.0);\n\n    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );\n    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );\n\n    vec2 offset = diffUV * powDiff / filterArea.xy;\n\n    // Do clamp :\n    vec2 coord = vTextureCoord + offset;\n    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);\n    vec4 color = texture2D(uSampler, clampedCoord);\n    if (coord != clampedCoord) {\n        color *= max(0.0, 1.0 - length(coord - clampedCoord));\n    }\n\n    // No clamp :\n    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);\n\n    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;\n\n    gl_FragColor = color;\n}\n"),this.center=e,Object.assign(this,lh.defaults,t),this.time=i}apply(e,t,i,r){this.uniforms.time=this.time,e.applyFilter(this,t,i,r)}get center(){return this.uniforms.center}set center(e){this.uniforms.center=e}get amplitude(){return this.uniforms.amplitude}set amplitude(e){this.uniforms.amplitude=e}get wavelength(){return this.uniforms.wavelength}set wavelength(e){this.uniforms.wavelength=e}get brightness(){return this.uniforms.brightness}set brightness(e){this.uniforms.brightness=e}get speed(){return this.uniforms.speed}set speed(e){this.uniforms.speed=e}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}};lh.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};class ah extends bi{constructor(e){var t,i;super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    color /= total;\n    color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n"),this.uniforms.blur=e.blur,this.uniforms.gradientBlur=e.gradientBlur,this.uniforms.start=null!=(t=e.start)?t:new Tt(0,window.innerHeight/2),this.uniforms.end=null!=(i=e.end)?i:new Tt(600,window.innerHeight/2),this.uniforms.delta=new Tt(30,30),this.uniforms.texSize=new Tt(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(e){this.uniforms.blur=e}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(e){this.uniforms.gradientBlur=e}get start(){return this.uniforms.start}set start(e){this.uniforms.start=e,this.updateDelta()}get end(){return this.uniforms.end}set end(e){this.uniforms.end=e,this.updateDelta()}}class hh extends ah{updateDelta(){const e=this.uniforms.end.x-this.uniforms.start.x,t=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(e*e+t*t);this.uniforms.delta.x=e/i,this.uniforms.delta.y=t/i}}class dh extends ah{updateDelta(){const e=this.uniforms.end.x-this.uniforms.start.x,t=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(e*e+t*t);this.uniforms.delta.x=-t/i,this.uniforms.delta.y=e/i}}const ch=class extends bi{constructor(e,t,i,r){super(),"number"==typeof e&&(Y("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),e={blur:e,gradientBlur:t,start:i,end:r}),e=Object.assign({},ch.defaults,e),this.tiltShiftXFilter=new hh(e),this.tiltShiftYFilter=new dh(e)}apply(e,t,i,r){const o=e.getFilterTexture();this.tiltShiftXFilter.apply(e,t,o,1),this.tiltShiftYFilter.apply(e,o,i,r),e.returnFilterTexture(o)}get blur(){return this.tiltShiftXFilter.blur}set blur(e){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=e}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(e){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=e}get start(){return this.tiltShiftXFilter.start}set start(e){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=e}get end(){return this.tiltShiftXFilter.end}set end(e){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=e}};ch.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};const uh=class extends bi{constructor(e){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform vec4 filterArea;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvec2 twist(vec2 coord)\n{\n    coord -= offset;\n\n    float dist = length(coord);\n\n    if (dist < radius)\n    {\n        float ratioDist = (radius - dist) / radius;\n        float angleMod = ratioDist * ratioDist * angle;\n        float s = sin(angleMod);\n        float c = cos(angleMod);\n        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n    }\n\n    coord += offset;\n\n    return coord;\n}\n\nvoid main(void)\n{\n\n    vec2 coord = mapCoord(vTextureCoord);\n\n    coord = twist(coord);\n\n    coord = unmapCoord(coord);\n\n    gl_FragColor = texture2D(uSampler, coord );\n\n}\n"),Object.assign(this,uh.defaults,e)}get offset(){return this.uniforms.offset}set offset(e){this.uniforms.offset=e}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}get angle(){return this.uniforms.angle}set angle(e){this.uniforms.angle=e}};uh.defaults={radius:200,angle:4,padding:20,offset:new Tt};var mh=Object.getOwnPropertySymbols,ph=Object.prototype.hasOwnProperty,bh=Object.prototype.propertyIsEnumerable;const fh=class extends bi{constructor(e){const t=Object.assign(fh.defaults,e),{maxKernelSize:i}=t,r=((e,t)=>{var i={};for(var r in e)ph.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&mh)for(var r of mh(e))t.indexOf(r)<0&&bh.call(e,r)&&(i[r]=e[r]);return i})(t,["maxKernelSize"]);super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\nuniform vec2 uCenter;\nuniform float uStrength;\nuniform float uInnerRadius;\nuniform float uRadius;\n\nconst float MAX_KERNEL_SIZE = ${maxKernelSize};\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}\n\nvoid main() {\n\n    float minGradient = uInnerRadius * 0.3;\n    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;\n\n    float gradient = uRadius * 0.3;\n    float radius = (uRadius - gradient * 0.5) / filterArea.x;\n\n    float countLimit = MAX_KERNEL_SIZE;\n\n    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);\n    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));\n\n    float strength = uStrength;\n\n    float delta = 0.0;\n    float gap;\n    if (dist < innerRadius) {\n        delta = innerRadius - dist;\n        gap = minGradient;\n    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity\n        delta = dist - radius;\n        gap = gradient;\n    }\n\n    if (delta > 0.0) {\n        float normalCount = gap / filterArea.x;\n        delta = (normalCount - delta) / normalCount;\n        countLimit *= delta;\n        strength *= delta;\n        if (countLimit < 1.0)\n        {\n            gl_FragColor = texture2D(uSampler, vTextureCoord);\n            return;\n        }\n    }\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = rand(vTextureCoord, 0.0);\n\n    float total = 0.0;\n    vec4 color = vec4(0.0);\n\n    dir *= strength;\n\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = vTextureCoord + dir * percent;\n        vec4 sample = texture2D(uSampler, p);\n\n        // switch to pre-multiplied alpha to correctly blur transparent images\n        // sample.rgb *= sample.a;\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > countLimit){\n            break;\n        }\n    }\n\n    color /= total;\n    // switch back from pre-multiplied alpha\n    // color.rgb /= color.a + 0.00001;\n\n    gl_FragColor = color;\n}\n".replace("${maxKernelSize}",i.toFixed(1))),Object.assign(this,r)}get center(){return this.uniforms.uCenter}set center(e){this.uniforms.uCenter=e}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(e){this.uniforms.uInnerRadius=e}get radius(){return this.uniforms.uRadius}set radius(e){(e<0||e===1/0)&&(e=-1),this.uniforms.uRadius=e}};fh.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};const gh=new Pi(new dt),Fh=[gh];class yh{constructor(){this.ready=!0,this.readyPromise=Promise.resolve()}isReady(){return this.ready}whenReady(){return this.readyPromise}}class vh extends yh{constructor(){super(),this.container=new io,this.durlCache=new Map,this.container.cullable=!0,this.sprite=new so(gh),this.container.addChild(this.sprite)}getDataUrl(){var e,t;const i=this.durlCache.get(this.sprite.texture);if(i)return i;const r=null===(t=(e=Al.renderer.extract.canvas(this.sprite)).toDataURL)||void 0===t?void 0:t.call(e);return r&&this.durlCache.set(this.sprite.texture,r),r}}class xh extends vh{static from(e,t,i){const r={};if(e.isReady())return t.forEach((t=>r[t]=e.getAnimation(t))),new xh(r,i);{const o=new xh(r,i);return o.ready=!1,o.readyPromise=e.parse().then((()=>{t.forEach((t=>r[t]=e.getAnimation(t))),o.load(r),o.ready=!0})),o}}load(e){for(const[t,i]of Object.entries(e))this.textures[t]=i;this.forceSetAnimation(this.animation)}constructor(e,t){super(),this.index=0,this.frames=[],this.looped=!1,this.anchors=new Map,this.loopsPerSecond=1,this.textures=e,this.animation=t,this.forceSetAnimation(this.animation)}setAnimationAnchor(e,t){this.anchors.set(e,t)}forceSetAnimation(e){this.animation=e.toString()+"s",this.setAnimation(e)}setAnimation(e){var t;if(this.animation===e)return!1;const i=this.anchors.get(e);return i?this.sprite.anchor.set(i.x,i.y):this.sprite.anchor.set(.5),this.frames=null!==(t=this.textures[e])&&void 0!==t?t:[],this.animation=e,this.updateTexture(),!0}getAnimation(){return this.animation}getAnimations(){return Object.keys(this.textures)}setProgress(e){this.index=Math.floor(e*this.frames.length),this.updateTexture()}getFrames(){return this.frames.length}setFrame(e){this.index=e,this.updateTexture()}getFrame(){return Math.floor(this.index)}getFramesPerSecond(){return this.loopsPerSecond*this.frames.length}setFramesPerSecond(e){this.frames.length&&(this.loopsPerSecond=e/this.frames.length)}update(e){this.looped=!1,this.index+=e*this.getFramesPerSecond();const t=this.index;this.updateTexture(),Math.abs(t-this.index)>.001&&(this.looped=!0)}didLoop(){return this.looped}updateTexture(){const e=this.frames.length||1;this.index=(this.index%e+e)%e;const t=this.frames[Math.floor(this.index)];t&&(this.sprite.texture=t)}}function _h(e){const t=e.toString();return t.includes(".")?t:t+".0"}class wh extends yh{constructor(e,t,i){var r,o;super(),this.transparencyCache=new WeakMap,this.resolveReady=()=>{},this.unparsed=!0,this.ready=!1,this.readyPromise=new Promise((e=>{this.resolveReady=e})),this.src=e,this.json={frames:{},meta:{scale:"1"}};for(const[e,i]of Object.entries(t.frames))this.json.frames[e]={frame:i};if(this.frames=[...Object.keys(null!==(r=t.frames)&&void 0!==r?r:{})],this.animations=[...Object.keys(null!==(o=t.animations)&&void 0!==o?o:{})],t.animations){this.json.animations={};for(const[e,i]of Object.entries(t.animations)){const t=[];this.json.animations[e]=t,i.forEach((e=>{"string"==typeof e&&t.push(e)}))}}this.transparency=t.transparency,this.setFilters(i)}setFilters(e){if(this.transparency){let t;if(t=this.transparencyCache.get(this.transparency),!t){const e=this.transparency.map((e=>`(c.x >= ${_h(e.r.from)} && c.x <= ${_h(e.r.to)} && c.y >= ${_h(e.g.from)} && c.y <= ${_h(e.g.to)} && c.z >= ${_h(e.b.from)} && c.z <= ${_h(e.b.to)})`)).join("||");t=new bi(void 0,`\n        varying vec2 vTextureCoord;\n        uniform sampler2D uSampler;\n        void main(void)\n        {\n          vec4 c = texture2D(uSampler, vTextureCoord);\n          if (\n            ${e}\n          ) {\n            gl_FragColor = vec4(0.0,0.0,0.0,0.0);\n          } else {\n            gl_FragColor = c;\n          }\n        }\n        `)}t&&(this.filters=[t,...null!=e?e:[]])}else this.filters=e}parse(){var e,t;return function(e,t,i,r){return new(i||(i=Promise))((function(o,s){function n(e){try{a(r.next(e))}catch(e){s(e)}}function l(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,l)}a((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){if(this.ready)return;if(!this.unparsed)return yield this.readyPromise;this.unparsed=!1;const i=yield ls.load(this.src);if(!(i instanceof Pi))throw Error("Src was not pointing to a texture.");const r=Ci.create({width:i.width,height:i.height}),o=so.from(i);(null===(e=this.filters)||void 0===e?void 0:e.length)&&(o.filters=this.filters),Al.renderer.render(o,{renderTexture:r}),this.texture=i,this.renderTexture=r,this.sheet=new qn(r,this.json),Ve(),yield this.sheet.parse(),Ve();for(const[e,t]of Object.entries(this.sheet.textures)){const i=Ci.create({width:t.width+2,height:t.height+2}),r=so.from(t),o=t.frame.x,s=t.frame.y,n=t.frame.width,l=t.frame.height;t.frame.x=o,t.frame.y=s,t.frame.width=1,t.frame.height=l,t.updateUvs(),r.position.x=0,r.position.y=1,Al.renderer.render(r,{renderTexture:i,clear:!1}),t.frame.x=o+n-1,t.frame.y=s,t.frame.width=1,t.frame.height=l,t.updateUvs(),r.position.x=n+1,r.position.y=1,Al.renderer.render(r,{renderTexture:i,clear:!1}),t.frame.x=o,t.frame.y=s,t.frame.width=n,t.frame.height=1,t.updateUvs(),r.position.y=0,r.position.x=1,Al.renderer.render(r,{renderTexture:i,clear:!1}),t.frame.x=o,t.frame.y=s+l-1,t.frame.width=n,t.frame.height=1,t.updateUvs(),r.position.y=l+1,r.position.x=1,Al.renderer.render(r,{renderTexture:i,clear:!1}),t.frame.x=o,t.frame.y=s,t.frame.width=n,t.frame.height=l,t.updateUvs(),r.position.x=1,r.position.y=1,Al.renderer.render(r,{renderTexture:i,clear:!1}),i.frame.x=1,i.frame.y=1,i.frame.width=t.width,i.frame.height=t.height,i.updateUvs(),this.sheet.textures[e]=i}for(const e of Object.values(this.sheet.animations))for(let i=0;i!=e.length;i++){const r=null===(t=e[i])||void 0===t?void 0:t.textureCacheIds[0],o=r&&this.sheet.textures[r];o&&(e[i]=o)}this.ready=!0,this.resolveReady()}))}modifyTexture(e){if(!this.texture||!this.renderTexture)return;const t=so.from(this.texture);this.filters=e,t.filters=this.filters,Al.renderer.render(t,{renderTexture:this.renderTexture,clear:!0})}getFrame(e){var t,i;return null!==(i=null===(t=this.sheet)||void 0===t?void 0:t.textures[e])&&void 0!==i?i:gh}getAnimation(e){var t,i;return null!==(i=null===(t=this.sheet)||void 0===t?void 0:t.animations[e])&&void 0!==i?i:Fh}getAnimations(){return[...this.animations]}getFrames(){return[...this.frames]}}const Sh=i.p+"e4b818525e39d11f3c37.png";class Th{constructor(e){this.called=!1,this.loaded=!1,this.spritesheet=e,this.promise=this.spritesheet.whenReady(),this.spritesheet.isReady()?(this.called=!0,this.loaded=!0):this.promise.then((()=>{this.called=!0,this.loaded=!0}))}new(){return this.called=!0,this.produce()}getState(){return this.loaded?"ready":this.called?"loading":"standby"}whenReady(){return this.promise}}const Eh=new wh(Sh,{frames:{smallIdle:{x:0,y:8,w:16,h:16},bigIdle:{x:0,y:32,w:16,h:32},smallWalk1:{x:56,y:8,w:16,h:16},smallWalk2:{x:20,y:8,w:16,h:16},smallWalk3:{x:38,y:8,w:16,h:16},bigWalk1:{x:56,y:32,w:16,h:32},bigWalk2:{x:20,y:32,w:16,h:32},bigWalk3:{x:38,y:32,w:16,h:32},smallSkid:{x:76,y:8,w:16,h:16},bigSkid:{x:76,y:32,w:16,h:32},smallJump:{x:96,y:8,w:16,h:16},bigJump:{x:96,y:32,w:16,h:32},smallDie:{x:116,y:8,w:16,h:16},bigDuck:{x:116,y:42,w:16,h:22},smallClimb1:{x:136,y:8,w:16,h:16},smallClimb2:{x:154,y:8,w:16,h:16},bigClimb1:{x:136,y:32,w:16,h:32},bigClimb2:{x:154,y:32,w:16,h:32},smallSwim1:{x:174,y:8,w:16,h:16},smallSwim2:{x:192,y:8,w:16,h:16},smallSwim3:{x:210,y:8,w:16,h:16},smallSwim4:{x:228,y:8,w:16,h:16},smallSwim5:{x:246,y:8,w:16,h:16},smallSwim6:{x:264,y:8,w:16,h:16},bigSwim1:{x:174,y:32,w:16,h:32},bigSwim2:{x:192,y:32,w:16,h:32},bigSwim3:{x:210,y:32,w:16,h:32},bigSwim4:{x:228,y:32,w:16,h:32},bigSwim5:{x:246,y:32,w:16,h:32},bigSwim6:{x:264,y:32,w:16,h:32},bigShootIdle:{x:136,y:72,w:16,h:32},bigShootWalk1:{x:190,y:72,w:16,h:32},bigShootWalk2:{x:154,y:72,w:16,h:32},bigShootWalk3:{x:172,y:72,w:16,h:32},bigShootSkid:{x:208,y:72,w:16,h:32},bigShootJump:{x:244,y:72,w:16,h:32}},animations:{smallWalk:["smallWalk1","smallWalk2","smallWalk3"],bigWalk:["bigWalk1","bigWalk2","bigWalk3"],bigShootWalk:["bigShootWalk1","bigShootWalk2","bigShootWalk3"],smallClimb:["smallClimb1","smallClimb2"],bigClimb:["bigClimb1","bigClimb2"],smallSwimStroke:["smallSwim1","smallSwim2","smallSwim3","smallSwim4","smallSwim5","smallSwim6"],bigSwimStroke:["bigSwim1","bigSwim2","bigSwim3","bigSwim4","bigSwim5","bigSwim6"],smallSwim:["smallSwim1","smallSwim2"],bigSwim:["bigSwim1","bigSwim2"],smallIdle:["smallIdle"],bigIdle:["bigIdle"],bigShootIdle:["bigShootIdle"],smallJump:["smallJump"],bigJump:["bigJump"],bigShootJump:["bigShootJump"],smallSkid:["smallSkid"],bigSkid:["bigSkid"],bigShootSkid:["bigShootSkid"],smallDie:["smallDie"],bigDuck:["bigDuck"]},transparency:[{r:{from:.57,to:.58},g:{from:.56,to:.57},b:{from:.99,to:1}},{r:{from:0,to:.01},g:{from:.16,to:.17},b:{from:.54,to:.55}}]}),Ah=new class extends Th{produce(){const e=xh.from(Eh,Eh.getAnimations(),"smallIdle");return Eh.getAnimations().forEach((t=>{t.includes("small")&&e.setAnimationAnchor(t,{x:.5,y:.475})})),e.setAnimationAnchor("smallJump",{x:.5,y:.55}),e.setAnimationAnchor("bigJump",{x:.5,y:.57}),e.setAnimationAnchor("bigShootJump",{x:.5,y:.57}),e.setAnimationAnchor("bigDuck",{x:.5,y:.61}),e.container.zIndex=1,e}}(Eh);class Ph extends vh{static from(e,t,i){const r={};if(e.isReady())return t.forEach((t=>r[t]=e.getFrame(t))),new Ph(r,i);{const o=new Ph(r,i);return o.ready=!1,o.readyPromise=e.parse().then((()=>{t.forEach((t=>r[t]=e.getFrame(t))),o.load(r),o.ready=!0})),o}}load(e){for(const[t,i]of Object.entries(e))this.textures[t]=i;this.forceSetFrame(this.frame)}constructor(e,t){super(),this.anchors=new Map,this.textures=e,this.frame=t,this.forceSetFrame(this.frame)}setFrameAnchor(e,t){this.anchors.set(e,t)}forceSetFrame(e){this.frame=e.toString()+"s",this.setFrame(e)}setFrame(e){if(this.frame===e)return!1;const t=this.anchors.get(e);t?this.sprite.anchor.set(t.x,t.y):this.sprite.anchor.set(.5),this.frame=e;const i=this.textures[e];return!!i&&(this.sprite.texture=i,!0)}getFrame(){return this.frame}getFrames(){return Object.keys(this.textures)}}const Ch=new wh(i.p+"b4528045099555cfdd58.png",{frames:{solidFloor1:{x:0,y:16,w:16,h:16},solidBlock1:{x:0,y:33,w:16,h:16},solidFloor2:{x:147,y:16,w:16,h:16},solidBlock2:{x:147,y:33,w:16,h:16},solidCastleBlock:{x:0,y:151,w:16,h:16},solidUnderwaterBlock:{x:147,y:134,w:16,h:16},solidUnderwaterSeaweed:{x:215,y:297,w:16,h:16},solidBridge:{x:34,y:33,w:16,h:16},solidBulletBillHead:{x:119,y:16,w:16,h:16},solidBulletBillBody:{x:119,y:33,w:16,h:16},solidBulletBillBase:{x:119,y:50,w:16,h:16},solidGreenShroomLeft:{x:0,y:196,w:16,h:16},solidGreenShroomMiddle:{x:17,y:196,w:16,h:16},solidGreenShroomRight:{x:34,y:196,w:16,h:16},solidGreenDotShroomLeft:{x:51,y:196,w:16,h:16},solidGreenDotShroomMiddle:{x:68,y:196,w:16,h:16},solidGreenDotShroomRight:{x:85,y:196,w:16,h:16},solidOrangeShroomLeft:{x:0,y:364,w:16,h:16},solidOrangeShroomMiddle:{x:17,y:364,w:16,h:16},solidOrangeShroomRight:{x:34,y:364,w:16,h:16},solidOrangeDotShroomLeft:{x:51,y:364,w:16,h:16},solidOrangeDotShroomMiddle:{x:68,y:364,w:16,h:16},solidOrangeDotShroomRight:{x:85,y:364,w:16,h:16},solidGreenPipeLeftmostExitN:{x:329,y:231,w:16,h:16},solidGreenPipeLeftmostExitS:{x:329,y:248,w:16,h:16},solidGreenPipeUpperExitW:{x:346,y:197,w:16,h:16},solidGreenPipeUpperExitE:{x:363,y:197,w:16,h:16},solidGreenPipeRightmostExitN:{x:397,y:231,w:16,h:16},solidGreenPipeRightmostExitS:{x:397,y:248,w:16,h:16},solidGreenPipeLowerExitW:{x:346,y:265,w:16,h:16},solidGreenPipeLowerExitE:{x:363,y:265,w:16,h:16},solidGreenPipeVerticalBodyW:{x:346,y:214,w:16,h:16},solidGreenPipeVerticalBodyE:{x:363,y:214,w:16,h:16},solidGreenPipeHorizontalBodyN:{x:380,y:231,w:16,h:16},solidGreenPipeHorizontalBodyS:{x:380,y:248,w:16,h:16},solidGreenPipeConnectorNW:{x:346,y:231,w:16,h:16},solidGreenPipeConnectorNE:{x:363,y:231,w:16,h:16},solidGreenPipeConnectorSW:{x:346,y:248,w:16,h:16},solidGreenPipeConnectorSE:{x:363,y:248,w:16,h:16},solidPurplePipeLeftmostExitN:{x:380,y:197,w:16,h:16},solidPurplePipeLeftmostExitS:{x:380,y:214,w:16,h:16},solidPurplePipeUpperExitW:{x:414,y:180,w:16,h:16},solidPurplePipeUpperExitE:{x:431,y:180,w:16,h:16},solidPurplePipeRightmostExitN:{x:448,y:197,w:16,h:16},solidPurplePipeRightmostExitS:{x:448,y:214,w:16,h:16},solidPurplePipeLowerExitW:{x:414,y:248,w:16,h:16},solidPurplePipeLowerExitE:{x:431,y:248,w:16,h:16},solidPurplePipeVerticalBodyW:{x:414,y:231,w:16,h:16},solidPurplePipeVerticalBodyE:{x:431,y:231,w:16,h:16},solidPurplePipeHorizontalBodyN:{x:397,y:197,w:16,h:16},solidPurplePipeHorizontalBodyS:{x:397,y:214,w:16,h:16},solidPurplePipeConnectorNW:{x:414,y:197,w:16,h:16},solidPurplePipeConnectorNE:{x:431,y:197,w:16,h:16},solidPurplePipeConnectorSW:{x:414,y:214,w:16,h:16},solidPurplePipeConnectorSE:{x:431,y:214,w:16,h:16},solidSilverPipeLeftmostExitN:{x:448,y:231,w:16,h:16},solidSilverPipeLeftmostExitS:{x:448,y:248,w:16,h:16},solidSilverPipeUpperExitW:{x:465,y:197,w:16,h:16},solidSilverPipeUpperExitE:{x:482,y:197,w:16,h:16},solidSilverPipeRightmostExitN:{x:516,y:231,w:16,h:16},solidSilverPipeRightmostExitS:{x:516,y:248,w:16,h:16},solidSilverPipeLowerExitW:{x:465,y:265,w:16,h:16},solidSilverPipeLowerExitE:{x:482,y:265,w:16,h:16},solidSilverPipeVerticalBodyW:{x:465,y:214,w:16,h:16},solidSilverPipeVerticalBodyE:{x:482,y:214,w:16,h:16},solidSilverPipeHorizontalBodyN:{x:499,y:231,w:16,h:16},solidSilverPipeHorizontalBodyS:{x:499,y:248,w:16,h:16},solidSilverPipeConnectorNW:{x:465,y:231,w:16,h:16},solidSilverPipeConnectorNE:{x:482,y:231,w:16,h:16},solidSilverPipeConnectorSW:{x:465,y:248,w:16,h:16},solidSilverPipeConnectorSE:{x:482,y:248,w:16,h:16},solidCloud:{x:366,y:16,w:16,h:16},brick1:{x:17,y:16,w:16,h:16},brick2:{x:164,y:16,w:16,h:16},brick3:{x:17,y:100,w:16,h:16},brickBottom1:{x:34,y:16,w:16,h:16},brickBottom2:{x:181,y:16,w:16,h:16},brickBottom3:{x:34,y:100,w:16,h:16},blockHit1:{x:51,y:16,w:16,h:16},blockHit2:{x:198,y:16,w:16,h:16},blockHit3:{x:51,y:100,w:16,h:16},block1:{x:298,y:78,w:16,h:16},block2:{x:315,y:78,w:16,h:16},block3:{x:332,y:78,w:16,h:16},blockCoin:{x:349,y:78,w:16,h:16},blockCoins:{x:349,y:95,w:16,h:16},blockPowerup:{x:349,y:112,w:16,h:16},blockStar:{x:349,y:129,w:16,h:16},blockLife:{x:349,y:146,w:16,h:16},blockInvisibleCoin:{x:366,y:78,w:16,h:16},blockInvisibleCoins:{x:366,y:95,w:16,h:16},blockInvisiblePowerup:{x:366,y:112,w:16,h:16},blockInvisibleStar:{x:366,y:129,w:16,h:16},blockInvisibleLife:{x:366,y:146,w:16,h:16},blockBrick1Coin:{x:383,y:78,w:16,h:16},blockBrick1Coins:{x:383,y:95,w:16,h:16},blockBrick1Powerup:{x:383,y:112,w:16,h:16},blockBrick1Star:{x:383,y:129,w:16,h:16},blockBrick1Life:{x:383,y:146,w:16,h:16},blockBrick1BottomCoin:{x:400,y:78,w:16,h:16},blockBrick1BottomCoins:{x:400,y:95,w:16,h:16},blockBrick1BottomPowerup:{x:400,y:112,w:16,h:16},blockBrick1BottomStar:{x:400,y:129,w:16,h:16},blockBrick1BottomLife:{x:400,y:146,w:16,h:16},blockBrick2Coin:{x:417,y:78,w:16,h:16},blockBrick2Coins:{x:417,y:95,w:16,h:16},blockBrick2Powerup:{x:417,y:112,w:16,h:16},blockBrick2Star:{x:417,y:129,w:16,h:16},blockBrick2Life:{x:417,y:146,w:16,h:16},blockBrick2BottomCoin:{x:434,y:78,w:16,h:16},blockBrick2BottomCoins:{x:434,y:95,w:16,h:16},blockBrick2BottomPowerup:{x:434,y:112,w:16,h:16},blockBrick2BottomStar:{x:434,y:129,w:16,h:16},blockBrick2BottomLife:{x:434,y:146,w:16,h:16},blockBrick3Coin:{x:451,y:78,w:16,h:16},blockBrick3Coins:{x:451,y:95,w:16,h:16},blockBrick3Powerup:{x:451,y:112,w:16,h:16},blockBrick3Star:{x:451,y:129,w:16,h:16},blockBrick3Life:{x:451,y:146,w:16,h:16},blockBrick3BottomCoin:{x:468,y:78,w:16,h:16},blockBrick3BottomCoins:{x:468,y:95,w:16,h:16},blockBrick3BottomPowerup:{x:468,y:112,w:16,h:16},blockBrick3BottomStar:{x:468,y:129,w:16,h:16},blockBrick3BottomLife:{x:468,y:146,w:16,h:16},coin1:{x:298,y:95,w:16,h:16},coin2:{x:315,y:95,w:16,h:16},coin3:{x:332,y:95,w:16,h:16},clutterGreenPipeLeftmostExitN:{x:329,y:231,w:16,h:16},clutterGreenPipeLeftmostExitS:{x:329,y:248,w:16,h:16},clutterGreenPipeUpperExitW:{x:346,y:197,w:16,h:16},clutterGreenPipeUpperExitE:{x:363,y:197,w:16,h:16},clutterGreenPipeRightmostExitN:{x:397,y:231,w:16,h:16},clutterGreenPipeRightmostExitS:{x:397,y:248,w:16,h:16},clutterGreenPipeLowerExitW:{x:346,y:265,w:16,h:16},clutterGreenPipeLowerExitE:{x:363,y:265,w:16,h:16},clutterGreenPipeVerticalBodyW:{x:346,y:214,w:16,h:16},clutterGreenPipeVerticalBodyE:{x:363,y:214,w:16,h:16},clutterGreenPipeHorizontalBodyN:{x:380,y:231,w:16,h:16},clutterGreenPipeHorizontalBodyS:{x:380,y:248,w:16,h:16},clutterGreenPipeConnectorNW:{x:346,y:231,w:16,h:16},clutterGreenPipeConnectorNE:{x:363,y:231,w:16,h:16},clutterGreenPipeConnectorSW:{x:346,y:248,w:16,h:16},clutterGreenPipeConnectorSE:{x:363,y:248,w:16,h:16},clutterPurplePipeLeftmostExitN:{x:380,y:197,w:16,h:16},clutterPurplePipeLeftmostExitS:{x:380,y:214,w:16,h:16},clutterPurplePipeUpperExitW:{x:414,y:180,w:16,h:16},clutterPurplePipeUpperExitE:{x:431,y:180,w:16,h:16},clutterPurplePipeRightmostExitN:{x:448,y:197,w:16,h:16},clutterPurplePipeRightmostExitS:{x:448,y:214,w:16,h:16},clutterPurplePipeLowerExitW:{x:414,y:248,w:16,h:16},clutterPurplePipeLowerExitE:{x:431,y:248,w:16,h:16},clutterPurplePipeVerticalBodyW:{x:414,y:231,w:16,h:16},clutterPurplePipeVerticalBodyE:{x:431,y:231,w:16,h:16},clutterPurplePipeHorizontalBodyN:{x:397,y:197,w:16,h:16},clutterPurplePipeHorizontalBodyS:{x:397,y:214,w:16,h:16},clutterPurplePipeConnectorNW:{x:414,y:197,w:16,h:16},clutterPurplePipeConnectorNE:{x:431,y:197,w:16,h:16},clutterPurplePipeConnectorSW:{x:414,y:214,w:16,h:16},clutterPurplePipeConnectorSE:{x:431,y:214,w:16,h:16},clutterSilverPipeLeftmostExitN:{x:448,y:231,w:16,h:16},clutterSilverPipeLeftmostExitS:{x:448,y:248,w:16,h:16},clutterSilverPipeUpperExitW:{x:465,y:197,w:16,h:16},clutterSilverPipeUpperExitE:{x:482,y:197,w:16,h:16},clutterSilverPipeRightmostExitN:{x:516,y:231,w:16,h:16},clutterSilverPipeRightmostExitS:{x:516,y:248,w:16,h:16},clutterSilverPipeLowerExitW:{x:465,y:265,w:16,h:16},clutterSilverPipeLowerExitE:{x:482,y:265,w:16,h:16},clutterSilverPipeVerticalBodyW:{x:465,y:214,w:16,h:16},clutterSilverPipeVerticalBodyE:{x:482,y:214,w:16,h:16},clutterSilverPipeHorizontalBodyN:{x:499,y:231,w:16,h:16},clutterSilverPipeHorizontalBodyS:{x:499,y:248,w:16,h:16},clutterSilverPipeConnectorNW:{x:465,y:231,w:16,h:16},clutterSilverPipeConnectorNE:{x:482,y:231,w:16,h:16},clutterSilverPipeConnectorSW:{x:465,y:248,w:16,h:16},clutterSilverPipeConnectorSE:{x:482,y:248,w:16,h:16},clutterBgCloudSmall:{x:18,y:596,w:32,h:24},clutterBgCloud:{x:51,y:596,w:48,h:24},clutterBgCloudBig:{x:18,y:621,w:64,h:24},clutterBushSmall:{x:18,y:647,w:32,h:16},clutterBush:{x:51,y:647,w:48,h:16},clutterBushBig:{x:18,y:664,w:64,h:16},clutterGreenHillSmall:{x:200,y:745,w:48,h:19},clutterGreenHill:{x:112,y:729,w:80,h:35},clutterFence:{x:34,y:67,w:16,h:16},clutterTreebark:{x:17,y:67,w:16,h:16},clutterTree:{x:85,y:213,w:16,h:16},clutterTreebottom:{x:102,y:213,w:16,h:16},clutterTreetop:{x:102,y:196,w:16,h:16},clutterSnowTree:{x:85,y:297,w:16,h:16},clutterSnowTreebottom:{x:102,y:297,w:16,h:16},clutterSnowTreetop:{x:102,y:280,w:16,h:16},clutterFlagpoletop:{x:136,y:230,w:16,h:16},clutterFlagpole:{x:136,y:247,w:16,h:16},clutterBridgeHandle:{x:0,y:230,w:16,h:16},clutterBridgeHandleSnow:{x:164,y:398,w:16,h:16},clutterCastleBridgeChain:{x:17,y:314,w:16,h:16},clutterBigTreebark:{x:17,y:33,w:16,h:16},clutterBigMushroomRing:{x:68,y:50,w:16,h:16},clutterBigMushroomStem:{x:68,y:67,w:16,h:16},clutterSuspenderLeft:{x:17,y:50,w:16,h:16},clutterSuspenderRope:{x:34,y:50,w:16,h:16},clutterSuspenderRight:{x:51,y:50,w:16,h:16},clutterSuspenderRopeVertical:{x:51,y:67,w:16,h:16},clutterWaterSurface:{x:349,y:16,w:16,h:16},clutterWater:{x:349,y:33,w:16,h:16},clutterLavaSurface:{x:541,y:16,w:16,h:16},clutterLava:{x:541,y:33,w:16,h:16},clutterFlagpoleWhole:{x:0,y:596,w:16,h:168},clutterBrownCastleSmall:{x:24,y:684,w:80,h:80},clutterBrownCastle:{x:400,y:588,w:144,h:176},brokenBrick1:{x:102,y:50,w:8,h:8},brokenBrick2:{x:249,y:50,w:8,h:8},brokenBrick3:{x:102,y:134,w:8,h:8}},animations:{block:["block1","block2","block3"],coin:["coin1","coin2","coin3"]},transparency:[{r:{from:.579,to:.581},g:{from:.579,to:.581},b:{from:.99,to:1}},{r:{from:0,to:.01},g:{from:.16,to:.17},b:{from:.54,to:.55}}]}),kh=new class extends Th{produce(){const e=Ph.from(Ch,Ch.getFrames(),"solidFloor1"),t=e.getFrame();for(const t of e.getFrames()){e.setFrame(t);const i=(e.container.height-8)/e.container.height;e.setFrameAnchor(t,{x:.5,y:i})}return e.setFrame(t),e}}(Ch),Bh=kh,Mh=new class extends Th{produce(){return xh.from(Ch,Ch.getAnimations(),"coin")}}(Ch),Rh=new wh(i.p+"5535f3b13181732936c9.png",{frames:{mushroom:{x:0,y:8,w:16,h:16},oneup:{x:0,y:26,w:16,h:16},flower:{x:68,y:8,w:16,h:16},star:{x:142,y:8,w:16,h:16},coin1:{x:180,y:36,w:8,h:16},coin2:{x:190,y:36,w:8,h:16},coin3:{x:200,y:36,w:8,h:16},coin4:{x:210,y:36,w:8,h:16},fireball1:{x:180,y:54,w:8,h:8},fireball2:{x:190,y:54,w:8,h:8},fireball3:{x:200,y:54,w:8,h:8},fireball4:{x:210,y:54,w:8,h:8},firework1:{x:180,y:64,w:16,h:16},firework2:{x:198,y:64,w:16,h:16},firework3:{x:216,y:64,w:16,h:16},platformTiny:{x:32,y:64,w:16,h:8},platformSmall:{x:52,y:64,w:24,h:8},platformMedium:{x:80,y:64,w:32,h:8},platformBig:{x:116,y:64,w:48,h:8},cloudMedium:{x:80,y:74,w:32,h:8},cloudBig:{x:116,y:74,w:48,h:8},spring1:{x:24,y:75,w:16,h:31},spring2:{x:42,y:75,w:16,h:31},spring3:{x:60,y:75,w:16,h:31},starflag:{x:110,y:90,w:16,h:16},evilflag:{x:92,y:90,w:16,h:16},vinetop:{x:130,y:90,w:16,h:16},vine:{x:148,y:90,w:16,h:16},peach:{x:18,y:444,w:16,h:24},toad:{x:0,y:444,w:16,h:24}},animations:{fireball:["fireball1","fireball2","fireball3","fireball4"],firework:["firework1","firework2","firework3"],spring:["spring1","spring2","spring3"],coin:["coin1","coin2","coin3","coin4"]},transparency:[{r:{from:.57,to:.581},g:{from:.56,to:.57},b:{from:.99,to:1}},{r:{from:0,to:.01},g:{from:.16,to:.17},b:{from:.54,to:.55}}]}),Ih=new class extends Th{produce(){const e=Ph.from(Rh,Rh.getFrames(),"mushroom"),t=e.getFrame();e.setFrame("toad");let i=(e.container.height-8)/e.container.height;return e.setFrameAnchor("toad",{x:.5,y:i}),e.setFrame("peach"),i=(e.container.height-8)/e.container.height,e.setFrameAnchor("peach",{x:.5,y:i}),e.setFrame(t),e}}(Rh),Dh=Ih,Oh=new class extends Th{produce(){return xh.from(Rh,Rh.getAnimations(),"coin")}}(Rh),Nh=new wh(i.p+"49e5c6058797c6716cc2.png",{frames:{goomba1:{x:0,y:16,w:16,h:16},goomba2:{x:18,y:16,w:16,h:16},goombaDead:{x:36,y:24,w:16,h:8},buzzy1:{x:0,y:34,w:16,h:16},buzzy2:{x:18,y:34,w:16,h:16},buzzyShell:{x:36,y:34,w:16,h:16},blooper1:{x:0,y:52,w:16,h:24},blooper2:{x:18,y:52,w:16,h:16},hammer1:{x:4,y:78,w:8,h:16},hammer2:{x:18,y:82,w:16,h:8},hammer3:{x:40,y:78,w:8,h:16},hammer4:{x:54,y:82,w:16,h:8},greenKoopa1:{x:0,y:112,w:16,h:24},greenKoopa2:{x:18,y:112,w:16,h:24},greenParakoopa1:{x:36,y:112,w:16,h:24},greenParakoopa2:{x:54,y:112,w:16,h:24},greenKoopashell1:{x:72,y:120,w:16,h:15},greenKoopashell2:{x:90,y:120,w:16,h:15},greenPiranhaPlant1:{x:0,y:138,w:16,h:24},greenPiranhaPlant2:{x:18,y:138,w:16,h:24},lakitu1:{x:54,y:138,w:16,h:24},lakitu2:{x:72,y:138,w:16,h:24},greenCheep1:{x:0,y:164,w:16,h:16},greenCheep2:{x:18,y:164,w:16,h:16},hammerbro1:{x:0,y:182,w:16,h:24},hammerbro2:{x:18,y:182,w:16,h:24},hammerbroAttack1:{x:72,y:172,w:16,h:34},hammerbroAttack2:{x:90,y:172,w:16,h:34},bowserOpenMouth1:{x:0,y:208,w:32,h:32},bowserOpenMouth2:{x:34,y:208,w:32,h:32},bowserClosedMouth1:{x:68,y:208,w:32,h:32},bowserClosedMouth2:{x:102,y:208,w:32,h:32},bowserfire1:{x:102,y:242,w:24,h:8},bowserfire2:{x:102,y:252,w:24,h:8},bulletbill:{x:54,y:52,w:16,h:16},redKoopa1:{x:0,y:318,w:16,h:24},redKoopa2:{x:18,y:318,w:16,h:24},redParakoopa1:{x:36,y:318,w:16,h:24},redParakoopa2:{x:54,y:318,w:16,h:24},redKoopashell1:{x:72,y:326,w:16,h:15},redKoopashell2:{x:90,y:326,w:16,h:15},redCheep1:{x:0,y:370,w:16,h:16},redCheep2:{x:18,y:370,w:16,h:16},lavaBubble:{x:90,y:370,w:16,h:16},spinyEgg1:{x:36,y:352,w:16,h:16},spinyEgg2:{x:54,y:352,w:16,h:16},spiny1:{x:72,y:352,w:16,h:16},spiny2:{x:90,y:352,w:16,h:16},bruceOpenMouth1:{x:146,y:208,w:32,h:32},bruceOpenMouth2:{x:180,y:208,w:32,h:32},bruceClosedMouth1:{x:214,y:208,w:32,h:32},bruceClosedMouth2:{x:248,y:208,w:32,h:32}},animations:{goomba:["goomba1","goomba2"],buzzy:["buzzy1","buzzy2"],buzzyShell:["buzzyShell"],goombaDead:["goombaDead"],greenKoopa:["greenKoopa1","greenKoopa2"],greenParakoopa:["greenParakoopa1","greenParakoopa2"],greenKoopashell:["greenKoopashell1","greenKoopashell2"],greenPiranhaPlant:["greenPiranhaPlant1","greenPiranhaPlant2"],greenCheep:["greenCheep1","greenCheep2"],redKoopa:["redKoopa1","redKoopa2"],redParakoopa:["redParakoopa1","redParakoopa2"],redKoopashell:["redKoopashell1","redKoopashell2"],redCheep:["redCheep1","redCheep2"],lakitu:["lakitu1","lakitu2"],hammerbro:["hammerbro1","hammerbro2"],hammerbroAttack:["hammerbroAttack1","hammerbroAttack2"],hammer:["hammer1","hammer2","hammer3","hammer4"],bowserfire:["bowserfire1","bowserfire2"],bulletbill:["bulletbill"],bowserOpenMouth:["bowserOpenMouth1","bowserOpenMouth2"],bowserClosedMouth:["bowserClosedMouth1","bowserClosedMouth2"],bruceOpenMouth:["bruceOpenMouth1","bruceOpenMouth2"],bruceClosedMouth:["bruceClosedMouth1","bruceClosedMouth2"],lavaBubble:["lavaBubble"],spinyEgg:["spinyEgg1","spinyEgg2"],spiny:["spiny1","spiny2"],blooper:["blooper1","blooper2"]},transparency:[{r:{from:.57,to:.581},g:{from:.56,to:.57},b:{from:.99,to:1}},{r:{from:0,to:.01},g:{from:.16,to:.17},b:{from:.54,to:.55}}]}),Lh=new class extends Th{produce(){const e=xh.from(Nh,Nh.getAnimations(),"goomba");e.setAnimationAnchor("hammerbroAttack",{x:.5,y:.65}),e.setAnimationAnchor("goombaDead",{x:.5,y:0}),e.setAnimationAnchor("greenKoopashell",{x:.5,y:.46}),e.setAnimationAnchor("redKoopashell",{x:.5,y:.46});let t=.67;return e.setAnimationAnchor("greenKoopa",{x:.5,y:t}),e.setAnimationAnchor("redKoopa",{x:.5,y:t}),e.setAnimationAnchor("greenParakoopa",{x:.5,y:t}),e.setAnimationAnchor("redParakoopa",{x:.5,y:t}),e}}(Nh),zh=Lh,Gh=new class{constructor(e){this.factories=e,this.promise=Promise.all(Object.values(e).map((e=>e.whenReady()))).then()}getFactory(e){return this.factories[e]}whenReady(){return this.promise}getProgress(){const e=Object.values(this.factories);return e.filter((e=>"ready"===e.getState())).length/e.length}}({mario:Ah,tiles:Bh,animTiles:Mh,objects:Dh,animObjects:Oh,enemies:zh}),Uh=Gh,Hh=ma.red;let Vh=0,jh=0;const Wh=new eh;Wh.color=16711680,Wh.outerStrength=1,Wh.innerStrength=1,Wh.alpha=.5;const Xh=[pa,Wh];let $h=0;const Yh=new class extends bi{constructor(e,t=.05,i=e.length){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform float epsilon;\n\nconst int MAX_COLORS = %maxColors%;\n\nuniform vec3 originalColors[MAX_COLORS];\nuniform vec3 targetColors[MAX_COLORS];\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    float alpha = gl_FragColor.a;\n    if (alpha < 0.0001)\n    {\n      return;\n    }\n\n    vec3 color = gl_FragColor.rgb / alpha;\n\n    for(int i = 0; i < MAX_COLORS; i++)\n    {\n      vec3 origColor = originalColors[i];\n      if (origColor.r < 0.0)\n      {\n        break;\n      }\n      vec3 colorDiff = origColor - color;\n      if (length(colorDiff) < epsilon)\n      {\n        vec3 targetColor = targetColors[i];\n        gl_FragColor = vec4((targetColor + colorDiff) * alpha, alpha);\n        return;\n      }\n    }\n}\n".replace(/%maxColors%/g,i.toFixed(0))),this._replacements=[],this._maxColors=0,this.epsilon=t,this._maxColors=i,this.uniforms.originalColors=new Float32Array(3*i),this.uniforms.targetColors=new Float32Array(3*i),this.replacements=e}set replacements(e){const t=this.uniforms.originalColors,i=this.uniforms.targetColors,r=e.length;if(r>this._maxColors)throw new Error(`Length of replacements (${r}) exceeds the maximum colors length (${this._maxColors})`);t[3*r]=-1;for(let o=0;o<r;o++){const r=e[o];let s=r[0];"number"==typeof s?s=Ee(s):r[0]=Ae(s),t[3*o]=s[0],t[3*o+1]=s[1],t[3*o+2]=s[2];let n=r[1];"number"==typeof n?n=Ee(n):r[1]=Ae(n),i[3*o]=n[0],i[3*o+1]=n[1],i[3*o+2]=n[2]}this._replacements=e}get replacements(){return this._replacements}refresh(){this.replacements=this._replacements}get maxColors(){return this._maxColors}set epsilon(e){this.uniforms.epsilon=e}get epsilon(){return this.uniforms.epsilon}}([[11874592,16711680],[15375906,65280],[7040256,255]],.1),qh=new eh;qh.alpha=.9;const Zh=[Yh,qh],Kh=new eh;Kh.color=16711680,Kh.innerStrength=1;const Jh=[Yh,Kh],Qh=Uh.getFactory("mario").new();function ed(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function td(e,t,i){let r,o,s;if(0===t)r=o=s=i;else{const n=i<.5?i*(1+t):i+t-i*t,l=2*i-n;r=ed(l,n,e+1/3),o=ed(l,n,e),s=ed(l,n,e-1/3)}const{round:n}=Math;return[n(255*r),n(255*o),n(255*s)]}function id(e){var t,i,r,o,s,n;Vh=(Vh+e*Math.PI)%(2*Math.PI),jh=.2*Math.sin(Vh),ma.red=jh*Hh+Hh;const l=$h;if($h=(Vh+e)%.8,l>$h){let e=0;for(const t of Yh.replacements)t[1]=td(Math.random(),(3-e)/3,(3-e)/3.5).map((e=>e/255)),e++;Yh.refresh()}for(const l of ga.view(["mario","smb1MarioAnimations"])){const a=l.smb1MarioAnimations,h=l.mario,d=null===(t=l.dynamic)||void 0===t?void 0:t.velocity,c=null===(i=l.dynamic)||void 0===i?void 0:i.acceleration,u=d?Math.abs(d.x):(null===(o=null===(r=l.mario)||void 0===r?void 0:r.inPipe)||void 0===o?void 0:o.nonIdle)?50:0,m=c?Math.abs(c.x):0,p=u<2*Number.EPSILON&&m<2*Number.EPSILON;if(a&&h){if(h.inPipe?a.container.scale.set(.9):a.container.scale.set(1),h.star&&"fire"===h.powerup?l.filters!==Jh&&(l.filters=Jh):h.star?l.filters!==Zh&&(l.filters=Zh):"fire"===h.powerup?l.filters!==Xh&&(l.filters=Xh):l.filters&&delete l.filters,a.container.scale.x=h.facing,h.grounded?a.loopsPerSecond=p?0:u/16:a.loopsPerSecond=0,h.onSpring&&(a.container.position.y+=16*Math.sin(null!==(n=null===(s=h.onSpring.spring.spring)||void 0===s?void 0:s.progress)&&void 0!==n?n:0)),h.climbing)l.positionPrev.y!==l.position.y?a.loopsPerSecond=3:a.loopsPerSecond=0,h.big?a.setAnimation("bigClimb"):a.setAnimation("smallClimb");else if(!h.grounded&&l.underwater)a.loopsPerSecond=3,h.jumped?(h.big?h.shooting?a.setAnimation("bigShootIdle"):a.setAnimation("bigSwimStroke"):a.setAnimation("smallSwimStroke"),h.swimLoops=2):h.swimLoops?(a.didLoop()&&(h.swimLoops-=1),h.big?h.shooting?a.setAnimation("bigShootIdle"):a.setAnimation("bigSwimStroke"):a.setAnimation("smallSwimStroke")):h.big?h.shooting?a.setAnimation("bigShootIdle"):a.setAnimation("bigSwim"):a.setAnimation("smallSwim");else if(h.swimLoops=0,h.ducking||h.forcedDucking)h.big?a.setAnimation("bigDuck"):a.setAnimation("smallDie");else if(h.jumping)h.big?h.shooting?a.setAnimation("bigShootJump"):a.setAnimation("bigJump"):a.setAnimation("smallJump");else if(h.skidding)h.big?h.shooting?a.setAnimation("bigShootSkid"):a.setAnimation("bigSkid"):a.setAnimation("smallSkid"),a.container.scale.x=-h.facing;else if(p&&h.grounded)h.big?h.shooting?a.setAnimation("bigShootIdle"):a.setAnimation("bigIdle"):a.setAnimation("smallIdle");else{const e=a.getAnimation();"bigWalk"!==e&&"bigShootWalk"!==e&&"smallWalk"!==e&&a.setFrame(.8),h.big?h.shooting?a.setAnimation("bigShootWalk"):a.setAnimation("bigWalk"):a.setAnimation("smallWalk")}a.update(e),l.iframesSecs?a.container.alpha=.5:a.container.alpha=1}}}Qh.container.filters=Xh,Al.add(Qh.container),setTimeout((()=>{Qh.container.filters=Zh,setTimeout((()=>{Qh.container.filters=Jh,setTimeout((()=>{Qh.container.removeFromParent()}))}))}));const rd=ua();let od=Date.now(),sd=null,nd=null;function ld(){var e,t;for(const i of ga.view(["mario"]))(null===(t=null===(e=i.mario)||void 0===e?void 0:e.inPipe)||void 0===t?void 0:t.started)&&rd.sounds.play("pipe");for(const e of ga.view(["mario","dynamic"])){const t=e.mario;t&&(t.jumped&&(e.underwater?(null==nd||nd.stop(),nd=rd.sounds.play("stomp")):t.big?rd.sounds.play("jumpBig"):rd.sounds.play("jumpSmall")),t.changedSize&&(t.big?rd.sounds.play("powerup"):rd.sounds.play("pipe")),t.shot&&rd.sounds.play("fireball"),e.player&&(e.player.gainedPow&&rd.sounds.play("powerup"),e.player.gainedOneUp&&rd.sounds.play("oneUp")))}for(const e of ga.view(["bonk"]))e.bonk&&!e.smash&&rd.sounds.play("bump");for(const e of ga.view(["smash"]))e.smash&&rd.sounds.play("breakblock");for(const e of ga.view(["vineStart"]))e.vineStart&&(rd.sounds.get("powerup_appears").forEach((e=>e.stop())),rd.sounds.play("vine")),delete e.vineStart}function ad(e,t,i){const r=Uh.getFactory("tiles").new(),o=(null==i?void 0:i.includes("Coins"))?"coins":(null==i?void 0:i.includes("Pow"))?"pow":(null==i?void 0:i.includes("Star"))?"star":(null==i?void 0:i.includes("Life"))?"life":"coin";switch(i){case"blockCoin":case"blockCoins":case"blockPowerup":case"blockStar":case"blockLife":const s=Uh.getFactory("animTiles").new();return s.setAnimation("block"),r.setFrame(null!=i?i:"solidFloor1"),ga.createEntity(ba({position:new yl(e,t),size:new yl(16,16),static:!0,smb1TilesAnimations:s,coinblock:o,smb1TilesSpritesEditMode:r}));default:const n=Uh.getFactory("tiles").new();return n.setFrame(null!=i?i:"solidFloor1"),(null==i?void 0:i.includes("Brick"))?(null==i?void 0:i.includes("Bottom"))?i.includes("2")?r.setFrame("brickBottom2"):i.includes("3")?r.setFrame("brickBottom3"):r.setFrame("brickBottom1"):i.includes("2")?r.setFrame("brick2"):i.includes("3")?r.setFrame("brick3"):r.setFrame("brick1"):(null==i?void 0:i.includes("Invisible"))&&r.setFrame(i),ga.createEntity(ba({position:new yl(e,t),size:new yl(16,16),static:!0,smb1TilesSprites:r,coinblock:o,invisibleBlock:null==i?void 0:i.includes("Invisible"),smb1TilesSpritesEditMode:n}))}}function hd(e,t,i){const r=Uh.getFactory("tiles").new();return r.setFrame(null!=i?i:"solidFloor1"),ga.createEntity(ba({position:new yl(e,t),size:new yl(16,16),static:!0,smb1TilesSprites:r}))}function dd(e,t,i){var r,o,s;if("tile"===i.type){const s=Uh.getFactory("tiles").new();s.setFrame(null!==(r=i.frame)&&void 0!==r?r:"clutterFence"),(null===(o=i.frame)||void 0===o?void 0:o.includes("Pipe"))?s.container.zIndex=2:s.container.zIndex=-5;const n=ga.createEntity(ba({position:new yl(e,t),size:new yl(16,16),smb1TilesSprites:s,grid:!0}));return i.frame&&("clutterFence"===i.frame?(s.container.zIndex=-25,n.distanceModifiers={x:.05,y:0}):i.frame.includes("Hill")?(s.container.zIndex=-500,n.distanceModifiers={x:.3,y:0}):i.frame.includes("Bush")?(s.container.zIndex=-50,n.distanceModifiers={x:.1,y:0}):i.frame.includes("BgCloud")?(s.container.zIndex=-1e3,n.distanceModifiers={x:.4,y:0}):i.frame.includes("Tree")&&"clutterBigTreebark"!==i.frame?(s.container.zIndex=-100,n.distanceModifiers={x:.2,y:0}):i.frame.includes("Castle")&&(s.container.zIndex=-200,n.distanceModifiers={x:.25,y:0})),n}{const r=Uh.getFactory("objects").new();return r.setFrame(null!==(s=i.frame)&&void 0!==s?s:"vine"),r.container.zIndex=-5,ga.createEntity(ba({position:new yl(e,t),size:new yl(16,16),smb1ObjectsSprites:r}))}}function cd(e,t){const i=Uh.getFactory("mario").new();return i.container.zIndex=10,ga.createEntity(ba({position:new yl(e,t),touchingUp:[],touchingDown:[],touchingLeft:[],touchingRight:[],hits:[],prevHits:[],size:new yl(12,15),dynamic:{velocity:new yl(0,0),acceleration:new yl(0,0)},player:{coins:0,lives:3,kicks8k:0},marioInput:{inputs:{}},marioMovementConfig:{minWalkSpeed:4.453125,maxWalkSpeed:93.75,walkAccel:133.59375,maxWalkSpeedUnderwater:63.75,cutsceneWalkSpeed:48.75,maxRunSpeed:153.75,runAccel:200.390625,releaseDecel:182.8125,skidDecel:365.625,skidTurnaround:33.75,jumpBackwardsDecelThreshold:108.75,jumpFastAccel:200.390625,jumpSlowAccel:133.59375,jumpFastDecel:200.390625,jumpNormalDecel:182.8125,jumpSlowDecel:133.59375,initFallGravity:562.5,initJumpGravity:562.5,walkGravitySpeed:60,walkJump:240,walkFallGravity:1575,walkJumpGravity:450,midGravitySpeed:568260/4096,midJump:240,midFallGravity:1350,midJumpGravity:421.875,runJump:300,runFallGravity:2025,runJumpGravity:562.5,swimJump:90,swimFallGravity:140.625,swimJumpGravity:182.8125,whirlpoolJump:60,whirlpoolFallGravity:126.5625,whirlpoolJumpGravity:56.25,surfaceJump:90,surfaceFallGravity:337.5,surfaceJumpGravity:337.5},mario:{facing:1},floorSpeed:0,gravity:0,smb1MarioAnimations:i,followCam:!0}))}var ud;function md(e,t,i){const r=Uh.getFactory("tiles").new();return r.setFrame(null!=i?i:"brick1"),ga.createEntity(ba({position:new yl(e,t),size:new yl(16,16),static:!0,brick:!0,smb1TilesSprites:r}))}function pd(e,t){const i=Uh.getFactory("animTiles").new();return i.setAnimation("coin"),ga.createEntity(ba({position:new yl(e,t),size:new yl(10,14),smb1TilesAnimations:i,sensor:!0,coin:!0}))}function bd(e,t,i){const r=Uh.getFactory("objects").new();r.setFrame(null!=i?i:"platformBig");const o=r.getFrame().includes("Big")?48:r.getFrame().includes("Medium")?32:r.getFrame().includes("Small")?24:16;return ga.createEntity(ba({position:new yl(e,t),size:new yl(o,8),kinematic:{velocity:new yl(0,0),acceleration:new yl(0,0)},smb1ObjectsSprites:r,platform:{crumble:!0},touchingUp:[]}))}function fd(e,t,i){const r=Uh.getFactory("enemies").new();r.setAnimation(i||"goomba");let o=14,s=14;const n="hammerbro"===i,l="greenPiranhaPlant"===i,a="blooper"===i;l?(o=10,s=24):n&&(o=10,s=22),t=t+8-.5*s,r.container.zIndex=2,r.loopsPerSecond=4,l&&(s=10,r.container.zIndex=-2),a&&(r.loopsPerSecond=0);const h=ga.createEntity(ba(Object.assign({position:new yl(e,t),size:new yl(o,s),smb1EnemiesAnimations:r,grid:!0,enemActivateOnVisible:"goomba"===i?"goomba":"redKoopa"===i?"koopaR":"greenKoopa"===i?"koopaG":"greenParakoopa"===i?"bouncyKoop":"redParakoopa"===i?"flyingKoopa":"buzzy"===i?"buzzy":a?"blooper":l?"plant":n?"hammerbro":void 0},l?{displace:{x:8,y:24}}:null)));return"redParakoopa"===i&&(h.dynamic={velocity:new yl(0,0),acceleration:new yl(0,0)},h.enemy={fireball:!0,star:!0,stomp:!0,shell:!0,lookTowards:"mario"}),h}function gd(e){var t,i,r,o,s,n,l;const a="string"==typeof e?JSON.parse(e):e,h={},d={};for(const e of[1,2]){const c=1===e?h:d,u=1===e?a.entities:a.entities2;for(const h of u){let d=null;switch(h[0]){case ud.mario:d=cd(h[1],h[2]);break;case ud.block:{const i=null===(t=h[3])||void 0===t?void 0:t.tileFrame;d=hd(h[1],h[2],i),"solidBulletBillHead"===i&&(d.billShooter={}),2===e&&d.smb1TilesSprites&&(d.smb1TilesSprites.container.zIndex=-5);break}case ud.brick:{const e=null===(i=h[3])||void 0===i?void 0:i.tileFrame;d=md(h[1],h[2],e);break}case ud.coin:d=pd(h[1],h[2]);break;case ud.clutter:{const e=null===(r=h[3])||void 0===r?void 0:r.tileFrame;d=dd(h[1],h[2],{type:"tile",frame:e});break}case ud.coinblock:{const e=null===(o=h[3])||void 0===o?void 0:o.tileFrame;d=ad(h[1],h[2],e);break}case ud.platform:{const e=null===(s=h[3])||void 0===s?void 0:s.objectFrame;d=bd(h[1],h[2],e);break}case ud.enemy:{const e=null===(n=h[3])||void 0===n?void 0:n.enemyAnim;d=fd(h[1],h[2],e);break}case ud.npc:{const e=null===(l=h[3])||void 0===l?void 0:l.objectFrame,t=Uh.getFactory("objects").new();t.setFrame(null!=e?e:"toad"),d=ga.createEntity(ba({position:new yl(h[1],h[2]),size:new yl(16,24),smb1ObjectsSprites:t,npc:{text:""}}));break}}if(d){const e=16*Math.floor(d.position.x/16)+"."+16*Math.floor(d.position.y/16),t=c[e];if(t){ga.remove(t.gameObj);const e=a.entities.indexOf(t.init);if(-1!==e){const t=a.entities.at(-1);t&&(a.entities[e]=t),a.entities.pop()}}c[e]={gameObj:d,init:h}}}}return{parsed:a,grid:h,grid2:d}}ga.onPropChange("coinGotCollected",(e=>{if(e.coinGotCollected){const e=od;if(od=Date.now(),od-e<5)return;null==sd||sd.stop(),sd=rd.sounds.play("coin")}})),function(e){e.mario="m",e.block="b",e.brick="r",e.coinblock="q",e.coin="c",e.kinematic="k",e.clutter="d",e.platform="p",e.enemy="e",e.npc="n"}(ud||(ud={}));const Fd=new Set,yd={speedLimiter(e,t){const i=null!=t?t:1e3;if(e.length()>i)return e.unit().mul(i)},addRemoveRenderable(e){Fd.has(e)||(Fd.add(e),ga.onPropChange(e,((t,i)=>{var r,o;(null==i?void 0:i.container.parent)&&(null==i||i.container.removeFromParent());const s=null===(r=t[e])||void 0===r?void 0:r.container;s&&(i&&(i.container.position.x=t.position.x,i.container.position.y=t.position.y,i.container.filters=null!==(o=t.filters)&&void 0!==o?o:null),Al.add(s))})),ga.onRemoving([e],(t=>{var i;const r=null===(i=t[e])||void 0===i?void 0:i.container;(null==r?void 0:r.parent)&&(r.filters=null,r.removeFromParent())})),ga.onPropChange("filters",(e=>{var t,i;for(const r of Fd){const o=null===(t=e[r])||void 0===t?void 0:t.container;o&&(o.filters=null!==(i=e.filters)&&void 0!==i?i:null)}})))},updateRenderable(e,t){for(const t of ga.view(["dynamic",e])){const i=t[e];i&&(i.container.position.x=t.position.x,i.container.position.y=t.position.y)}for(const t of ga.view(["kinematic",e])){const i=t[e];i&&(i.container.position.x=t.position.x,i.container.position.y=t.position.y)}for(const t of ga.view(["moving",e])){const i=t[e];i&&(i.container.position.x=t.position.x,i.container.position.y=t.position.y)}for(const i of ga.view(["angVel"])){if(!i.angVel)continue;const r=i[e];r&&(r.container.angle+=i.angVel*t)}}},vd=yd;vd.addRemoveRenderable("smb1MarioAnimations"),vd.addRemoveRenderable("smb1ObjectsSprites"),vd.addRemoveRenderable("smb1ObjectsAnimations"),vd.addRemoveRenderable("smb1EnemiesAnimations"),vd.addRemoveRenderable("smb1TilesAnimations"),vd.addRemoveRenderable("smb1TilesSprites"),vd.addRemoveRenderable("smb1TilesSpritesEditMode"),ga.onRemoving(["invisibleBlock"],(e=>{var t;(null===(t=e.smb1TilesSprites)||void 0===t?void 0:t.container)&&(e.smb1TilesSprites.container.visible=!0)}));let xd,_d=0;function wd(e,t){var i,r,o;if(void 0===xd||xd!==!!t){xd=!!t;for(const e of ga.view(["smb1TilesAnimations","smb1TilesSpritesEditMode"]))t?(e.smb1TilesSpritesEditMode&&(e.smb1TilesSpritesEditMode.container.visible=!0),e.smb1TilesAnimations&&(e.smb1TilesAnimations.container.visible=!1)):(e.smb1TilesSpritesEditMode&&(e.smb1TilesSpritesEditMode.container.visible=!1),e.smb1TilesAnimations&&(e.smb1TilesAnimations.container.visible=!0));for(const e of ga.view(["smb1TilesSprites","smb1TilesSpritesEditMode"]))t?(e.smb1TilesSpritesEditMode&&(e.smb1TilesSpritesEditMode.container.visible=!0),e.smb1TilesSprites&&(e.smb1TilesSprites.container.visible=!1)):(e.smb1TilesSpritesEditMode&&(e.smb1TilesSpritesEditMode.container.visible=!1),e.smb1TilesSprites&&(e.smb1TilesSprites.container.visible=!0));for(const e of ga.view(["smb1TilesSprites","invisibleBlock"]))e.smb1TilesSprites&&(t?e.invisibleBlock&&(e.smb1TilesSprites.container.visible=!0):e.invisibleBlock&&(e.smb1TilesSprites.container.visible=!1))}vd.updateRenderable("smb1MarioAnimations",e),vd.updateRenderable("smb1ObjectsSprites",e),vd.updateRenderable("smb1TilesSprites",e),vd.updateRenderable("smb1ObjectsAnimations",e),vd.updateRenderable("smb1EnemiesAnimations",e);for(const e of ga.view(["smb1EnemiesAnimations","enemy"])){if(!e.smb1EnemiesAnimations||!e.enemy)continue;let t=0;switch(e.enemy.lookTowards){case"direction":t=Math.sign((null===(i=e.dynamic)||void 0===i?void 0:i.velocity.x)||(null===(r=e.kinematic)||void 0===r?void 0:r.velocity.x)||0);break;case"mario":const o=ga.view(["mario"])[0];o&&(t=Math.sign(o.position.x-e.position.x))}t&&(e.smb1EnemiesAnimations.container.scale.x=-t)}if(t)vd.updateRenderable("smb1TilesSpritesEditMode",e);else{vd.updateRenderable("smb1TilesAnimations",e);const t=_d;_d=(_d+8*e*1.1)%8;let i=0;_d>4&&(i=Math.floor(_d-4),3===i&&(i=1));for(const e of ga.view(["smb1TilesAnimations"])){const t=e.smb1TilesAnimations;t&&t.setFrame(i)}const r=Math.floor(t)!==Math.floor(_d);for(const e of ga.view(["smb1TilesSprites","brokenBrick"])){const t=e.smb1TilesSprites;t&&r&&(t.container.scale.x=-t.container.scale.x)}for(const t of ga.view(["collectedCoin"])){if(t.collectedCoin){t.collectedCoin.lifetime+=e,t.collectedCoin.lifetime>=.5&&ga.remove(t);const i=Math.sin(t.collectedCoin.lifetime*Math.PI/.6);t.position.y=t.positionStart.y-48*i}t.smb1ObjectsAnimations&&t.positionStart.y-t.position.y>25&&(t.smb1ObjectsAnimations.container.zIndex=2)}for(const t of ga.view(["smb1ObjectsAnimations"])){const i=t.smb1ObjectsAnimations;i&&i.update(e)}for(const t of ga.view(["smb1EnemiesAnimations"])){const i=t.smb1EnemiesAnimations;i&&i.update(e)}for(const e of ga.view(["fireballHit","smb1ObjectsAnimations"]))(null===(o=e.smb1ObjectsAnimations)||void 0===o?void 0:o.didLoop())&&(ga.remove(e),e.smb1ObjectsAnimations.container.visible=!1,delete e.smb1ObjectsAnimations)}for(const e of ga.view(["platformConnection"])){const t=e.platformConnection;if(!t)continue;const i=t.rope1.smb1TilesSprites,r=t.rope2.smb1TilesSprites;if(!i||!r)continue;const o=t.p1H/16;i.container.scale.y=o,i.container.position.y=t.rope1.position.y+.5*t.p1H-8;const s=t.p2H/16;r.container.scale.y=s,r.container.position.y=t.rope2.position.y+.5*t.p2H-8}}const Sd=JSON.parse('{"entities":[["b",-424,56],["b",-408,56],["b",-392,56],["b",-376,56],["b",-360,56],["b",-344,56],["b",-328,56],["b",-312,56],["b",-296,56],["b",-280,56],["b",-264,56],["b",-248,56],["b",-232,56],["b",-216,56],["b",-200,56],["b",-184,56],["b",-168,56],["b",-152,56],["b",-136,56],["b",-120,56],["b",-104,56],["b",-88,56],["b",-72,56],["b",-40,56],["b",-24,56],["b",-8,56],["b",8,56],["b",24,56],["b",40,56],["b",-56,56],["b",56,56],["b",72,56],["b",88,56],["b",104,56],["b",120,56],["b",136,56],["b",152,56],["b",168,56],["b",184,56],["b",200,56],["b",216,56],["b",232,56],["b",248,56],["b",264,56],["b",280,56],["b",296,56],["b",312,56],["b",328,56],["b",344,56],["b",360,56],["b",376,56],["b",392,56],["b",408,56],["b",424,56],["b",440,56],["b",456,56],["b",472,56],["b",488,56],["b",504,56],["b",520,56],["b",536,56],["b",552,56],["b",568,56],["b",584,56],["b",600,56],["b",616,56],["b",632,56],["b",648,56],["b",648,72],["b",632,72],["b",616,72],["b",600,72],["b",584,72],["b",568,72],["b",552,72],["b",536,72],["b",520,72],["b",504,72],["b",488,72],["b",472,72],["b",456,72],["b",440,72],["b",424,72],["b",408,72],["b",392,72],["b",376,72],["b",360,72],["b",344,72],["b",328,72],["b",312,72],["b",296,72],["b",280,72],["b",264,72],["b",248,72],["b",232,72],["b",216,72],["b",200,72],["b",184,72],["b",168,72],["b",152,72],["b",136,72],["b",120,72],["b",104,72],["b",88,72],["b",72,72],["b",56,72],["b",40,72],["b",24,72],["b",8,72],["b",-8,72],["b",-24,72],["b",-40,72],["b",-56,72],["b",-72,72],["b",-88,72],["b",-104,72],["b",-120,72],["b",-136,72],["b",-152,72],["b",-168,72],["b",-184,72],["b",-200,72],["b",-216,72],["b",-232,72],["b",-248,72],["b",-264,72],["b",-280,72],["b",-296,72],["b",-312,72],["b",-328,72],["b",-344,72],["b",-360,72],["b",-376,72],["b",-392,72],["b",-408,72],["b",-424,72],["r",-104,-8,{"tileFrame":"brick1"}],["r",-72,-8,{"tileFrame":"brick1"}],["r",-40,-8,{"tileFrame":"brick1"}],["b",696,56],["b",696,72],["b",712,56],["b",728,56],["b",744,72],["b",760,72],["b",776,72],["b",792,56],["b",808,56],["b",824,56],["b",840,72],["b",856,72],["b",872,72],["b",888,56],["b",904,56],["b",920,56],["b",920,72],["b",904,72],["b",888,72],["b",824,72],["b",808,72],["b",792,72],["b",728,72],["b",712,72],["b",744,56],["b",760,56],["b",776,56],["b",840,56],["b",856,56],["b",872,56],["r",792,-8,{"tileFrame":"brick1"}],["r",824,-8,{"tileFrame":"brick1"}],["r",840,-72,{"tileFrame":"brick1"}],["r",856,-72,{"tileFrame":"brick1"}],["r",872,-72,{"tileFrame":"brick1"}],["r",888,-72,{"tileFrame":"brick1"}],["r",904,-72,{"tileFrame":"brick1"}],["r",920,-72,{"tileFrame":"brick1"}],["r",936,-72,{"tileFrame":"brick1"}],["r",952,-72,{"tileFrame":"brick1"}],["r",1016,-72,{"tileFrame":"brick1"}],["r",1032,-72,{"tileFrame":"brick1"}],["r",1048,-72,{"tileFrame":"brick1"}],["b",984,56],["b",984,72],["r",1160,-8,{"tileFrame":"brick1"}],["r",1448,-8,{"tileFrame":"brick1"}],["r",1496,-72,{"tileFrame":"brick1"}],["r",1512,-72,{"tileFrame":"brick1"}],["r",1528,-72,{"tileFrame":"brick1"}],["r",1608,-72,{"tileFrame":"brick1"}],["r",1656,-72,{"tileFrame":"brick1"}],["r",1624,-8,{"tileFrame":"brick1"}],["r",1640,-8,{"tileFrame":"brick1"}],["b",1000,56],["b",1016,56],["b",1032,56],["b",1048,56],["b",1064,56],["b",1080,56],["b",1096,56],["b",1112,56],["b",1128,56],["b",1144,56],["b",1160,56],["b",1176,56],["b",1192,56],["b",1208,56],["b",1224,56],["b",1240,56],["b",1256,56],["b",1272,56],["b",1288,56],["b",1304,56],["b",1320,56],["b",1336,56],["b",1352,56],["b",1368,56],["b",1384,56],["b",1400,56],["b",1416,56],["b",1432,56],["b",1448,56],["b",1464,56],["b",1480,56],["b",1496,56],["b",1512,56],["b",1528,56],["b",1544,56],["b",1560,56],["b",1576,56],["b",1592,56],["b",1608,56],["b",1624,56],["b",1640,56],["b",1656,56],["b",1656,72],["b",1640,72],["b",1624,72],["b",1608,72],["b",1592,72],["b",1576,72],["b",1560,72],["b",1544,72],["b",1528,72],["b",1512,72],["b",1496,72],["b",1480,72],["b",1464,72],["b",1448,72],["b",1432,72],["b",1416,72],["b",1400,72],["b",1384,72],["b",1368,72],["b",1352,72],["b",1336,72],["b",1320,72],["b",1304,72],["b",1288,72],["b",1272,72],["b",1256,72],["b",1240,72],["b",1224,72],["b",1208,72],["b",1192,72],["b",1176,72],["b",1160,72],["b",1144,72],["b",1128,72],["b",1112,72],["b",1096,72],["b",1080,72],["b",1064,72],["b",1048,72],["b",1032,72],["b",1016,72],["b",1000,72],["b",1672,56],["b",1672,72],["b",1688,72],["b",1688,56],["b",1704,40,{"tileFrame":"solidBlock1"}],["b",1720,24,{"tileFrame":"solidBlock1"}],["b",1736,8,{"tileFrame":"solidBlock1"}],["b",1752,-8,{"tileFrame":"solidBlock1"}],["b",1752,8,{"tileFrame":"solidBlock1"}],["b",1752,24,{"tileFrame":"solidBlock1"}],["b",1752,40,{"tileFrame":"solidBlock1"}],["b",1736,40,{"tileFrame":"solidBlock1"}],["b",1720,40,{"tileFrame":"solidBlock1"}],["b",1736,24,{"tileFrame":"solidBlock1"}],["b",1800,-8,{"tileFrame":"solidBlock1"}],["b",1800,8,{"tileFrame":"solidBlock1"}],["b",1800,24,{"tileFrame":"solidBlock1"}],["b",1800,40,{"tileFrame":"solidBlock1"}],["b",1816,40,{"tileFrame":"solidBlock1"}],["b",1832,40,{"tileFrame":"solidBlock1"}],["b",1848,40,{"tileFrame":"solidBlock1"}],["b",1832,24,{"tileFrame":"solidBlock1"}],["b",1816,24,{"tileFrame":"solidBlock1"}],["b",1816,8,{"tileFrame":"solidBlock1"}],["b",1704,56],["b",1720,56],["b",1736,56],["b",1752,56],["b",1768,56],["b",1784,56],["b",1800,56],["b",1816,56],["b",1832,56],["b",1848,56],["b",1848,72],["b",1832,72],["b",1816,72],["b",1800,72],["b",1784,72],["b",1768,72],["b",1752,72],["b",1736,72],["b",1720,72],["b",1704,72],["b",1864,56],["b",1880,56],["b",1896,56],["b",1912,56],["b",1912,72],["b",1896,72],["b",1880,72],["b",1864,72],["b",1928,40,{"tileFrame":"solidBlock1"}],["b",1944,24,{"tileFrame":"solidBlock1"}],["b",1960,8,{"tileFrame":"solidBlock1"}],["b",1976,-8,{"tileFrame":"solidBlock1"}],["b",1992,-8,{"tileFrame":"solidBlock1"}],["b",1992,8,{"tileFrame":"solidBlock1"}],["b",1992,24,{"tileFrame":"solidBlock1"}],["b",1992,40,{"tileFrame":"solidBlock1"}],["b",1976,40,{"tileFrame":"solidBlock1"}],["b",1960,40,{"tileFrame":"solidBlock1"}],["b",1944,40,{"tileFrame":"solidBlock1"}],["b",1960,24,{"tileFrame":"solidBlock1"}],["b",1976,24,{"tileFrame":"solidBlock1"}],["b",1976,8,{"tileFrame":"solidBlock1"}],["b",2040,-8,{"tileFrame":"solidBlock1"}],["b",2040,8,{"tileFrame":"solidBlock1"}],["b",2040,24,{"tileFrame":"solidBlock1"}],["b",2040,40,{"tileFrame":"solidBlock1"}],["b",2056,24,{"tileFrame":"solidBlock1"}],["b",2056,8,{"tileFrame":"solidBlock1"}],["b",2056,40,{"tileFrame":"solidBlock1"}],["b",2072,40,{"tileFrame":"solidBlock1"}],["b",2072,24,{"tileFrame":"solidBlock1"}],["b",2088,40,{"tileFrame":"solidBlock1"}],["b",1928,56],["b",1944,56],["b",1960,56],["b",1976,56],["b",1992,56],["b",1992,72],["b",1976,72],["b",1960,72],["b",1944,72],["b",1928,72],["b",2040,56],["b",2040,72],["b",2056,72],["b",2072,72],["b",2088,72],["b",2104,72],["b",2120,72],["b",2056,56],["b",2072,56],["b",2088,56],["b",2104,56],["b",2120,56],["b",2136,56],["b",2136,72],["b",2152,72],["b",2152,56],["b",2168,56],["b",2168,72],["b",2184,72],["b",2184,56],["b",2200,56],["b",2216,56],["b",2232,56],["b",2232,72],["b",2216,72],["b",2200,72],["r",2248,-8,{"tileFrame":"brick1"}],["r",2264,-8,{"tileFrame":"brick1"}],["r",2296,-8,{"tileFrame":"brick1"}],["b",2248,56],["b",2264,56],["b",2280,56],["b",2296,56],["b",2312,56],["b",2296,72],["b",2280,72],["b",2264,72],["b",2248,72],["b",2312,72],["b",2328,56],["b",2344,56],["b",2360,56],["b",2376,56],["b",2392,56],["b",2408,56],["b",2424,56],["b",2328,72],["b",2344,72],["b",2360,72],["b",2376,72],["b",2408,72],["b",2424,72],["b",2392,72],["q",584,-24,{"tileFrame":"blockInvisibleLife"}],["q",808,-8,{"tileFrame":"blockPowerup"}],["q",1064,-72,{"tileFrame":"blockCoin"}],["q",1176,-8,{"tileFrame":"blockBrick1Star"}],["q",1064,-8,{"tileFrame":"blockBrick1Coins"}],["q",1256,-8,{"tileFrame":"blockCoin"}],["q",1304,-8,{"tileFrame":"blockCoin"}],["q",1352,-8,{"tileFrame":"blockCoin"}],["q",1640,-72,{"tileFrame":"blockCoin"}],["q",1624,-72,{"tileFrame":"blockCoin"}],["q",1304,-72,{"tileFrame":"blockPowerup"}],["q",2280,-8,{"tileFrame":"blockCoin"}],["q",-168,-8,{"tileFrame":"blockCoin"}],["q",-56,-8,{"tileFrame":"blockCoin"}],["q",-72,-72,{"tileFrame":"blockCoin"}],["q",-88,-8,{"tileFrame":"blockPowerup"}],["b",24,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",184,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",184,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",312,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",312,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",312,8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",488,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",488,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",488,8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2184,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",504,8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",504,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",504,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",328,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",328,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",328,8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",200,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",200,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",40,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",24,24,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",40,24,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",200,8,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",184,8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",312,-8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",328,-8,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",504,-8,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",488,-8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",2168,24,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",2184,24,{"tileFrame":"solidGreenPipeUpperExitE"}],["r",1992,120,{"tileFrame":"brickBottom2"}],["r",2008,120,{"tileFrame":"brickBottom2"}],["r",2024,120,{"tileFrame":"brickBottom2"}],["r",2040,120,{"tileFrame":"brickBottom2"}],["r",2056,120,{"tileFrame":"brickBottom2"}],["r",2072,120,{"tileFrame":"brickBottom2"}],["r",2088,120,{"tileFrame":"brickBottom2"}],["r",1928,120,{"tileFrame":"brickBottom2"}],["b",1928,88,{"tileFrame":"solidGreenPipeRightmostExitN"}],["b",1928,104,{"tileFrame":"solidGreenPipeRightmostExitS"}],["r",1928,136,{"tileFrame":"brickBottom2"}],["r",1928,152,{"tileFrame":"brickBottom2"}],["r",1928,168,{"tileFrame":"brickBottom2"}],["r",1928,184,{"tileFrame":"brickBottom2"}],["r",1928,200,{"tileFrame":"brickBottom2"}],["r",1928,216,{"tileFrame":"brickBottom2"}],["r",1928,232,{"tileFrame":"brickBottom2"}],["r",1928,248,{"tileFrame":"brickBottom2"}],["r",1928,264,{"tileFrame":"brickBottom2"}],["r",1928,280,{"tileFrame":"brickBottom2"}],["b",1928,296,{"tileFrame":"solidFloor2"}],["b",1928,312,{"tileFrame":"solidFloor2"}],["b",1944,296,{"tileFrame":"solidFloor2"}],["b",1960,296,{"tileFrame":"solidFloor2"}],["b",1976,296,{"tileFrame":"solidFloor2"}],["b",1992,296,{"tileFrame":"solidFloor2"}],["b",2008,296,{"tileFrame":"solidFloor2"}],["b",2024,296,{"tileFrame":"solidFloor2"}],["b",2040,296,{"tileFrame":"solidFloor2"}],["b",1944,312,{"tileFrame":"solidFloor2"}],["b",1960,312,{"tileFrame":"solidFloor2"}],["b",1976,312,{"tileFrame":"solidFloor2"}],["b",1992,312,{"tileFrame":"solidFloor2"}],["b",2008,312,{"tileFrame":"solidFloor2"}],["b",2024,312,{"tileFrame":"solidFloor2"}],["b",2040,312,{"tileFrame":"solidFloor2"}],["b",2056,312,{"tileFrame":"solidFloor2"}],["b",2072,312,{"tileFrame":"solidFloor2"}],["b",2056,296,{"tileFrame":"solidFloor2"}],["b",2072,296,{"tileFrame":"solidFloor2"}],["b",2088,296,{"tileFrame":"solidFloor2"}],["b",2088,312,{"tileFrame":"solidFloor2"}],["b",2104,296,{"tileFrame":"solidFloor2"}],["b",2104,312,{"tileFrame":"solidFloor2"}],["b",2120,312,{"tileFrame":"solidFloor2"}],["b",2120,296,{"tileFrame":"solidFloor2"}],["b",2136,296,{"tileFrame":"solidFloor2"}],["b",2152,296,{"tileFrame":"solidFloor2"}],["b",2168,296,{"tileFrame":"solidFloor2"}],["b",2184,296,{"tileFrame":"solidFloor2"}],["b",2184,312,{"tileFrame":"solidFloor2"}],["b",2168,312,{"tileFrame":"solidFloor2"}],["b",2152,312,{"tileFrame":"solidFloor2"}],["b",2136,312,{"tileFrame":"solidFloor2"}],["b",2136,264,{"tileFrame":"solidGreenPipeLeftmostExitN"}],["b",2136,280,{"tileFrame":"solidGreenPipeLeftmostExitS"}],["b",2152,280,{"tileFrame":"solidGreenPipeHorizontalBodyS"}],["b",2152,264,{"tileFrame":"solidGreenPipeHorizontalBodyN"}],["b",2168,264,{"tileFrame":"solidGreenPipeConnectorNW"}],["b",2168,280,{"tileFrame":"solidGreenPipeConnectorSW"}],["b",2168,248,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,232,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,136,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,120,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,104,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,88,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["r",2088,280,{"tileFrame":"brickBottom2"}],["r",1992,280,{"tileFrame":"brickBottom2"}],["r",1992,264,{"tileFrame":"brickBottom2"}],["r",1992,248,{"tileFrame":"brickBottom2"}],["r",2008,248,{"tileFrame":"brickBottom2"}],["r",2024,248,{"tileFrame":"brickBottom2"}],["r",2040,248,{"tileFrame":"brickBottom2"}],["r",2056,248,{"tileFrame":"brickBottom2"}],["r",2072,248,{"tileFrame":"brickBottom2"}],["r",2088,248,{"tileFrame":"brickBottom2"}],["r",2088,264,{"tileFrame":"brickBottom2"}],["r",2072,264,{"tileFrame":"brickBottom2"}],["r",2056,264,{"tileFrame":"brickBottom2"}],["r",2040,264,{"tileFrame":"brickBottom2"}],["r",2024,264,{"tileFrame":"brickBottom2"}],["r",2008,264,{"tileFrame":"brickBottom2"}],["r",2008,280,{"tileFrame":"brickBottom2"}],["r",2024,280,{"tileFrame":"brickBottom2"}],["r",2040,280,{"tileFrame":"brickBottom2"}],["r",2056,280,{"tileFrame":"brickBottom2"}],["r",2072,280,{"tileFrame":"brickBottom2"}],["c",1992,232],["c",2008,232],["c",2024,232],["c",2040,232],["c",2056,232],["c",2072,232],["c",2088,232],["c",2088,200],["c",2072,200],["c",2056,200],["c",2040,200],["c",2024,200],["c",2008,200],["c",1992,200],["c",2008,168],["c",2024,168],["c",2040,168],["c",2056,168],["c",2072,168],["d",1912,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1896,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1880,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1880,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1896,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1912,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["b",1912,312,{"tileFrame":"solidFloor2"}],["b",1912,296,{"tileFrame":"solidFloor2"}],["b",1896,296,{"tileFrame":"solidFloor2"}],["b",1880,280,{"tileFrame":"solidFloor2"}],["b",2200,312,{"tileFrame":"solidFloor2"}],["b",2200,296,{"tileFrame":"solidFloor2"}],["b",2216,296,{"tileFrame":"solidFloor2"}],["b",2232,296,{"tileFrame":"solidFloor2"}],["b",2232,280,{"tileFrame":"solidFloor2"}],["b",2232,264,{"tileFrame":"solidFloor2"}],["b",2232,248,{"tileFrame":"solidFloor2"}],["b",2232,232,{"tileFrame":"solidFloor2"}],["b",2232,216,{"tileFrame":"solidFloor2"}],["b",2232,200,{"tileFrame":"solidFloor2"}],["b",2232,184,{"tileFrame":"solidFloor2"}],["b",2232,168,{"tileFrame":"solidFloor2"}],["b",2216,280,{"tileFrame":"solidFloor2"}],["b",2216,264,{"tileFrame":"solidFloor2"}],["b",2216,248,{"tileFrame":"solidFloor2"}],["b",2216,232,{"tileFrame":"solidFloor2"}],["b",2216,216,{"tileFrame":"solidFloor2"}],["b",2200,280,{"tileFrame":"solidFloor2"}],["b",2200,264,{"tileFrame":"solidFloor2"}],["b",2200,248,{"tileFrame":"solidFloor2"}],["b",1880,264,{"tileFrame":"solidFloor2"}],["b",1880,248,{"tileFrame":"solidFloor2"}],["b",1880,232,{"tileFrame":"solidFloor2"}],["b",1880,216,{"tileFrame":"solidFloor2"}],["b",1896,280,{"tileFrame":"solidFloor2"}],["b",1896,264,{"tileFrame":"solidFloor2"}],["b",1896,248,{"tileFrame":"solidFloor2"}],["b",1896,312,{"tileFrame":"solidFloor2"}],["b",1880,296,{"tileFrame":"solidFloor2"}],["b",1880,312,{"tileFrame":"solidFloor2"}],["b",1912,280,{"tileFrame":"solidFloor2"}],["b",1912,136],["b",1912,120],["b",1896,120],["b",1880,120],["b",1880,136],["b",1880,152],["b",2200,136],["b",2200,120],["b",2200,104],["b",2200,88],["b",2216,88],["b",2232,88],["b",2232,104],["b",2216,120],["b",2216,104],["b",2168,216,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,200,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,184,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,168,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",2168,152,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",600,88],["b",744,88],["b",584,104],["b",584,120],["b",584,136],["b",584,152],["b",584,168],["b",600,168],["b",616,168],["b",632,168],["b",648,168],["b",664,168],["b",728,168],["b",744,168],["b",760,168],["b",760,152],["b",760,136],["b",760,120],["b",760,104],["q",680,120,{"tileFrame":"blockBrick1Life"}],["b",584,88],["b",760,88],["b",-440,-40],["b",-456,-40],["b",-472,-40],["b",-488,-40],["b",-504,-40],["b",-520,-40],["b",-536,-24],["b",-536,-8],["b",-536,24],["b",-536,40],["b",-536,56],["b",-520,56],["b",-488,56],["b",-472,56],["b",-456,56],["b",-440,56],["b",-456,72],["b",-472,72],["b",-488,72],["b",-504,72],["b",-520,72],["b",-536,72],["b",-504,56],["b",-440,72],["b",-440,-24],["b",-536,-40],["b",-632,56,{"tileFrame":"solidOrangeDotShroomLeft"}],["b",-600,56,{"tileFrame":"solidOrangeDotShroomRight"}],["b",-616,56,{"tileFrame":"solidOrangeDotShroomMiddle"}],["d",-616,72,{"tileFrame":"clutterBigMushroomRing"}],["d",-616,88,{"tileFrame":"clutterBigMushroomStem"}],["c",-616,40],["c",-616,24],["c",-616,8],["b",-520,-24],["b",-440,-8],["p",-552,24,{"objectFrame":"platformTiny"}],["e",-72,40,{"enemyAnim":"goomba"}],["e",216,40,{"enemyAnim":"goomba"}],["e",392,40,{"enemyAnim":"goomba"}],["e",840,-88,{"enemyAnim":"goomba"}],["e",1112,40,{"enemyAnim":"goomba"}],["e",1272,40,{"enemyAnim":"greenKoopa"}],["e",1384,40,{"enemyAnim":"goomba"}],["e",1544,40,{"enemyAnim":"goomba"}],["e",1608,40,{"enemyAnim":"goomba"}],["e",2344,40,{"enemyAnim":"goomba"}],["e",408,40,{"enemyAnim":"goomba"}],["e",1128,40,{"enemyAnim":"goomba"}],["e",863.5824024420147,-88,{"enemyAnim":"goomba"}],["e",1400,40,{"enemyAnim":"goomba"}],["e",1560,40,{"enemyAnim":"goomba"}],["e",1624,40,{"enemyAnim":"goomba"}],["e",2360,40,{"enemyAnim":"goomba"}],["b",2440,56],["b",2456,56],["b",2472,56],["b",2488,56],["b",2504,56],["b",2520,56],["b",2536,56],["b",2552,56],["b",2568,56],["b",2440,72],["b",2456,72],["b",2472,72],["b",2488,72],["b",2504,72],["b",2520,72],["b",2536,72],["b",2552,72],["b",2568,72],["b",2584,40,{"tileFrame":"solidBlock1"}],["b",2600,24,{"tileFrame":"solidBlock1"}],["b",2616,8,{"tileFrame":"solidBlock1"}],["b",2632,-8,{"tileFrame":"solidBlock1"}],["b",2648,-24,{"tileFrame":"solidBlock1"}],["b",2648,-8,{"tileFrame":"solidBlock1"}],["b",2648,8,{"tileFrame":"solidBlock1"}],["b",2648,24,{"tileFrame":"solidBlock1"}],["b",2648,40,{"tileFrame":"solidBlock1"}],["b",2632,40,{"tileFrame":"solidBlock1"}],["b",2616,40,{"tileFrame":"solidBlock1"}],["b",2600,40,{"tileFrame":"solidBlock1"}],["b",2616,24,{"tileFrame":"solidBlock1"}],["b",2632,24,{"tileFrame":"solidBlock1"}],["b",2632,8,{"tileFrame":"solidBlock1"}],["b",2584,56],["b",2584,72],["b",2600,72],["b",2616,72],["b",2632,72],["b",2648,72],["b",2648,56],["b",2632,56],["b",2616,56],["b",2600,56],["b",2664,56],["b",2680,56],["b",2696,56],["b",2696,72],["b",2680,72],["b",2664,72],["b",2712,56],["b",2728,56],["b",2744,56],["b",2760,56],["b",2776,56],["b",2792,56],["b",2792,72],["b",2776,72],["b",2760,72],["b",2744,72],["b",2728,72],["b",2712,72],["b",2808,40,{"tileFrame":"solidBlock1"}],["b",2808,24,{"tileFrame":"solidBlock1"}],["b",2808,8,{"tileFrame":"solidBlock1"}],["b",2808,-8,{"tileFrame":"solidBlock1"}],["e",2792,40,{"enemyAnim":"greenKoopa"}],["e",2776,40,{"enemyAnim":"greenKoopa"}],["e",2648,-40,{"enemyAnim":"goomba"}],["b",2808,56],["b",2808,72],["b",2824,72],["b",2824,56],["b",2824,40,{"tileFrame":"solidBlock1"}],["b",2824,24,{"tileFrame":"solidBlock1"}],["b",2840,56],["b",2856,56],["b",2872,56],["b",2888,72],["b",2904,72],["b",2920,72],["b",2936,56],["b",2952,56],["b",2968,56],["b",2984,56],["b",2984,72],["b",2968,72],["b",2952,72],["b",2936,72],["b",2872,72],["b",2856,72],["b",2840,72],["b",2888,56],["b",2904,56],["b",2920,56],["e",2952,40,{"enemyAnim":"goomba"}],["e",2936,40,{"enemyAnim":"goomba"}],["b",3000,56],["b",3000,72],["b",3016,72],["b",3016,56],["b",3000,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3000,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3000,8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3016,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3016,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3016,8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3000,-8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",3016,-8,{"tileFrame":"solidGreenPipeUpperExitE"}],["e",3000,-24,{"enemyAnim":"greenPiranhaPlant"}],["q",600,120,{"tileFrame":"blockPowerup"}],["q",744,120,{"tileFrame":"blockLife"}],["q",664,120,{"tileFrame":"blockBrick1Coin"}],["q",2712,-8,{"tileFrame":"blockInvisibleCoin"}],["q",2712,-72,{"tileFrame":"blockInvisibleLife"}],["r",2728,-72,{"tileFrame":"brick1"}],["r",2744,-72,{"tileFrame":"brick1"}],["r",2760,-72,{"tileFrame":"brick1"}],["b",3032,56],["b",3048,56],["b",3064,56],["b",3080,56],["b",3096,56],["b",3096,72],["b",3080,72],["b",3064,72],["b",3048,72],["b",3032,72],["q",3128,-8,{"tileFrame":"blockCoin"}],["q",3144,-8,{"tileFrame":"blockCoin"}],["q",3160,-8,{"tileFrame":"blockCoin"}],["q",3176,-8,{"tileFrame":"blockCoin"}],["q",3176,-72,{"tileFrame":"blockCoin"}],["q",3160,-72,{"tileFrame":"blockCoin"}],["q",3144,-72,{"tileFrame":"blockCoin"}],["q",3128,-72,{"tileFrame":"blockCoin"}],["q",3112,-72,{"tileFrame":"blockCoin"}],["q",3112,-8,{"tileFrame":"blockPowerup"}],["b",3112,56],["b",3128,56],["b",3144,56],["b",3160,56],["b",3176,56],["b",3176,72],["b",3160,72],["b",3144,72],["b",3128,72],["b",3112,72],["b",3192,56],["b",3192,72],["b",3208,72],["b",3208,56],["e",3208,40,{"enemyAnim":"goomba"}],["b",3224,56],["b",3224,72],["b",3240,72],["b",3240,56],["b",3256,56],["b",3272,56],["b",3288,56],["b",3304,72],["b",3320,72],["b",3336,72],["b",3352,56],["b",3368,56],["b",3384,56],["b",3400,72],["b",3416,72],["b",3432,72],["e",3352,40,{"enemyAnim":"goomba"}],["e",3320,40,{"enemyAnim":"greenKoopa"}],["b",3256,72],["b",3272,72],["b",3288,72],["b",3352,72],["b",3368,72],["b",3384,72],["b",3432,56],["b",3416,56],["b",3400,56],["b",3336,56],["b",3320,56],["b",3304,56],["r",3352,-8,{"tileFrame":"brick1"}],["r",3384,-72,{"tileFrame":"brick1"}],["r",3400,-72,{"tileFrame":"brick1"}],["r",3416,-72,{"tileFrame":"brick1"}],["q",3368,-72,{"tileFrame":"blockBrick1Star"}],["b",3448,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3448,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3448,8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3464,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3464,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3464,8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3448,-8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",3464,-8,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",3448,56],["b",3448,72],["b",3464,72],["b",3464,56],["e",3448,-24,{"enemyAnim":"greenPiranhaPlant"}],["b",3496,56],["b",3480,56],["b",3480,72],["b",3496,72],["b",3512,72],["b",3512,56],["q",3528,-8,{"tileFrame":"blockCoin"}],["q",3544,-8,{"tileFrame":"blockCoin"}],["q",3560,-8,{"tileFrame":"blockCoin"}],["q",3576,-8,{"tileFrame":"blockCoin"}],["q",3624,-8,{"tileFrame":"blockCoin"}],["q",3640,-8,{"tileFrame":"blockCoin"}],["q",3656,-8,{"tileFrame":"blockCoin"}],["b",3528,56],["b",3544,56],["b",3560,56],["b",3576,56],["b",3592,56],["b",3608,56],["b",3624,56],["b",3640,56],["b",3656,56],["b",3656,72],["b",3640,72],["b",3624,72],["b",3608,72],["b",3592,72],["b",3576,72],["b",3560,72],["b",3544,72],["b",3528,72],["b",3672,56],["b",3688,56],["b",3704,56],["b",3720,56],["b",3720,72],["b",3704,72],["b",3688,72],["b",3672,72],["e",3656,40,{"enemyAnim":"goomba"}],["e",3672,40,{"enemyAnim":"goomba"}],["e",3688,40,{"enemyAnim":"goomba"}],["e",3368,40,{"enemyAnim":"goomba"}],["e",3384,40,{"enemyAnim":"goomba"}],["r",3560,-72,{"tileFrame":"brick1"}],["r",3576,-72,{"tileFrame":"brick1"}],["r",3592,-72,{"tileFrame":"brick1"}],["r",3608,-72,{"tileFrame":"brick1"}],["r",3624,-72,{"tileFrame":"brick1"}],["b",3528,-216,{"tileFrame":"solidCloud"}],["b",3544,-216,{"tileFrame":"solidCloud"}],["b",3560,-216,{"tileFrame":"solidCloud"}],["b",3624,-216,{"tileFrame":"solidCloud"}],["b",3640,-216,{"tileFrame":"solidCloud"}],["b",3656,-216,{"tileFrame":"solidCloud"}],["b",3672,-216,{"tileFrame":"solidCloud"}],["b",3800,56],["b",3800,72],["b",3816,56],["b",3816,72],["b",3832,72],["b",3832,56],["b",3848,56],["b",3848,72],["b",3864,72],["b",3864,56],["b",3880,56],["b",3880,72],["b",3896,56],["b",3912,56],["b",3928,56],["b",3944,56],["b",3944,72],["b",3928,72],["b",3912,72],["b",3896,72],["b",3912,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3912,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3912,8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3928,8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3928,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3928,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3912,-8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",3928,-8,{"tileFrame":"solidGreenPipeUpperExitE"}],["e",3912,-24,{"enemyAnim":"greenPiranhaPlant"}],["b",4008,56],["b",4008,72],["b",4024,56],["b",4040,56],["b",4056,56],["b",4072,56],["b",4088,56],["b",4088,72],["b",4072,72],["b",4056,72],["b",4040,72],["b",4024,72],["b",4104,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4120,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4104,24,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",4120,24,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",4104,56],["b",4120,56],["b",4120,72],["b",4104,72],["e",4104,8,{"enemyAnim":"greenPiranhaPlant"}],["b",4136,56],["b",4152,56],["b",4168,56],["b",4184,56],["b",4200,56],["b",4200,72],["b",4184,72],["b",4168,72],["b",4152,72],["b",4136,72],["b",4216,72],["b",4232,72],["b",4248,56],["b",4248,72],["b",4264,56],["b",4264,72],["b",4280,72],["b",4296,72],["b",4312,56],["b",4312,72],["b",4328,72],["b",4328,56],["b",4344,72],["b",4360,72],["b",4376,72],["b",4376,56],["b",4392,56],["b",4408,56],["b",4424,56],["b",4440,72],["b",4456,72],["b",4472,72],["b",4392,72],["b",4408,72],["b",4424,72],["b",4440,56],["b",4456,56],["b",4472,56],["b",4280,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4344,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4216,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4280,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4344,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4216,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4216,8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4344,8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4232,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4232,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4232,8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4296,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4296,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4360,8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4360,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4360,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4216,-8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",4280,8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",4232,-8,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",4296,8,{"tileFrame":"solidGreenPipeUpperExitE"}],["b",4216,56],["b",4232,56],["b",4280,56],["b",4296,56],["b",4344,56],["b",4360,56],["b",4536,56],["b",4536,72],["b",3688,-216,{"tileFrame":"solidCloud"}],["b",3704,-216,{"tileFrame":"solidCloud"}],["b",3720,-216,{"tileFrame":"solidCloud"}],["b",3736,-216,{"tileFrame":"solidCloud"}],["b",3752,-216,{"tileFrame":"solidCloud"}],["b",3768,-216,{"tileFrame":"solidCloud"}],["b",3784,-216,{"tileFrame":"solidCloud"}],["b",3800,-216,{"tileFrame":"solidCloud"}],["b",3816,-216,{"tileFrame":"solidCloud"}],["b",3832,-216,{"tileFrame":"solidCloud"}],["b",3848,-216,{"tileFrame":"solidCloud"}],["b",3864,-216,{"tileFrame":"solidCloud"}],["b",3880,-216,{"tileFrame":"solidCloud"}],["b",3896,-216,{"tileFrame":"solidCloud"}],["b",3912,-216,{"tileFrame":"solidCloud"}],["b",3928,-216,{"tileFrame":"solidCloud"}],["b",3944,-216,{"tileFrame":"solidCloud"}],["b",3960,-216,{"tileFrame":"solidCloud"}],["b",3976,-216,{"tileFrame":"solidCloud"}],["b",3992,-216,{"tileFrame":"solidCloud"}],["b",4008,-216,{"tileFrame":"solidCloud"}],["b",4024,-216,{"tileFrame":"solidCloud"}],["b",4040,-216,{"tileFrame":"solidCloud"}],["b",4056,-216,{"tileFrame":"solidCloud"}],["b",4072,-216,{"tileFrame":"solidCloud"}],["b",4088,-216,{"tileFrame":"solidCloud"}],["b",4104,-216,{"tileFrame":"solidCloud"}],["b",4120,-216,{"tileFrame":"solidCloud"}],["b",4136,-216,{"tileFrame":"solidCloud"}],["b",4152,-216,{"tileFrame":"solidCloud"}],["b",4168,-216,{"tileFrame":"solidCloud"}],["b",4184,-216,{"tileFrame":"solidCloud"}],["b",4200,-216,{"tileFrame":"solidCloud"}],["b",4216,-216,{"tileFrame":"solidCloud"}],["b",4232,-216,{"tileFrame":"solidCloud"}],["b",4248,-216,{"tileFrame":"solidCloud"}],["b",4264,-216,{"tileFrame":"solidCloud"}],["b",4280,-216,{"tileFrame":"solidCloud"}],["b",4296,-216,{"tileFrame":"solidCloud"}],["b",4312,-216,{"tileFrame":"solidCloud"}],["b",4328,-216,{"tileFrame":"solidCloud"}],["b",4344,-216,{"tileFrame":"solidCloud"}],["b",4360,-216,{"tileFrame":"solidCloud"}],["b",4376,-216,{"tileFrame":"solidCloud"}],["b",4392,-216,{"tileFrame":"solidCloud"}],["b",4408,-216,{"tileFrame":"solidCloud"}],["b",4424,-216,{"tileFrame":"solidCloud"}],["b",4440,-216,{"tileFrame":"solidCloud"}],["b",4456,-216,{"tileFrame":"solidCloud"}],["b",4472,-216,{"tileFrame":"solidCloud"}],["b",4488,-216,{"tileFrame":"solidCloud"}],["b",4504,-216,{"tileFrame":"solidCloud"}],["r",3736,-72,{"tileFrame":"brick1"}],["r",3752,-72,{"tileFrame":"brick1"}],["r",3768,-72,{"tileFrame":"brick1"}],["r",3784,-72,{"tileFrame":"brick1"}],["r",4280,-72,{"tileFrame":"brick1"}],["r",4296,-72,{"tileFrame":"brick1"}],["r",4312,-72,{"tileFrame":"brick1"}],["q",4264,-72,{"tileFrame":"blockBrick1Powerup"}],["c",3768,-328],["c",3784,-328],["c",3800,-328],["p",3800,-264,{"objectFrame":"cloudBig"}],["c",3816,-328],["c",3832,-328],["c",3848,-328],["c",3864,-328],["c",3880,-328],["c",3896,-328],["c",3912,-328],["c",3928,-328],["c",3944,-328],["c",3960,-328],["c",3976,-328],["c",3992,-328],["c",4008,-328],["c",4040,-360],["c",4056,-360],["c",4072,-360],["c",4104,-344],["c",4120,-344],["c",4136,-344],["c",4152,-344],["c",4168,-344],["c",4184,-344],["c",4200,-344],["c",4216,-344],["c",4232,-344],["c",4248,-344],["c",4264,-344],["c",4280,-344],["c",4296,-344],["c",4312,-344],["c",4328,-344],["c",4344,-344],["c",4376,-360],["c",4392,-360],["c",4408,-360],["e",4216,-24,{"enemyAnim":"greenPiranhaPlant"}],["b",4344,-8,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4360,-8,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",4344,-24,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",4360,-24,{"tileFrame":"solidGreenPipeUpperExitE"}],["e",4344,-40,{"enemyAnim":"greenPiranhaPlant"}],["b",4552,56],["b",4568,56],["b",4584,56],["b",4552,72],["b",4568,72],["b",4584,72],["b",4600,56],["b",4616,56],["b",4632,56],["b",4648,72],["b",4664,72],["b",4680,72],["b",4680,56],["b",4664,56],["b",4648,56],["b",4632,72],["b",4616,72],["b",4600,72],["c",4664,-232],["c",4648,-232],["c",4632,-232],["b",4728,56],["b",4728,72],["b",4728,40,{"tileFrame":"solidBlock1"}],["b",4728,24,{"tileFrame":"solidBlock1"}],["b",4728,8,{"tileFrame":"solidBlock1"}],["b",4744,56],["b",4760,56],["b",4776,56],["b",4792,72],["b",4808,72],["b",4824,72],["b",4840,56],["b",4856,56],["b",4872,56],["b",4888,72],["b",4904,72],["b",4920,72],["b",4936,56],["b",4952,56],["b",4968,56],["b",4920,56],["b",4904,56],["b",4888,56],["b",4824,56],["b",4808,56],["b",4792,56],["b",4744,72],["b",4760,72],["b",4776,72],["b",4840,72],["b",4856,72],["b",4872,72],["b",4984,72],["b",5000,72],["b",5016,72],["b",5032,56],["b",5048,56],["b",5064,56],["b",5064,72],["b",5048,72],["b",5032,72],["b",4968,72],["b",4952,72],["b",4936,72],["b",5000,56],["b",5016,56],["b",4984,56],["b",5080,40,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",5080,24,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",5096,40,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",5096,24,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",5080,8,{"tileFrame":"solidGreenPipeUpperExitW"}],["b",5096,8,{"tileFrame":"solidGreenPipeUpperExitE"}],["e",5080,-8,{"enemyAnim":"greenPiranhaPlant"}],["b",5080,56],["b",5096,56],["b",5096,72],["b",5080,72],["b",5112,56],["b",5128,56],["b",5144,56],["b",5160,56],["b",5176,72],["b",5192,72],["b",5208,72],["b",5224,72],["b",5240,56],["b",5256,56],["b",5272,56],["b",5288,56],["b",5112,72],["b",5128,72],["b",5144,72],["b",5160,72],["b",5240,72],["b",5256,72],["b",5272,72],["b",5288,72],["b",5224,56],["b",5208,56],["b",5192,56],["b",5176,56],["b",5304,56],["b",5304,72],["b",5320,72],["b",5320,56],["b",5320,40,{"tileFrame":"solidBlock1"}],["b",5304,40,{"tileFrame":"solidBlock1"}],["b",5304,24,{"tileFrame":"solidBlock1"}],["b",5304,8,{"tileFrame":"solidBlock1"}],["b",5304,-8,{"tileFrame":"solidBlock1"}],["b",5304,-24,{"tileFrame":"solidBlock1"}],["b",5304,-40,{"tileFrame":"solidBlock1"}],["b",5320,-40,{"tileFrame":"solidBlock1"}],["b",5320,-24,{"tileFrame":"solidBlock1"}],["b",5320,-8,{"tileFrame":"solidBlock1"}],["b",5320,8,{"tileFrame":"solidBlock1"}],["b",5320,24,{"tileFrame":"solidBlock1"}],["b",5304,-56,{"tileFrame":"solidBlock1"}],["b",5304,-72,{"tileFrame":"solidBlock1"}],["b",5304,-88,{"tileFrame":"solidBlock1"}],["b",5304,-104,{"tileFrame":"solidBlock1"}],["b",5320,-104,{"tileFrame":"solidBlock1"}],["b",5320,-88,{"tileFrame":"solidBlock1"}],["b",5320,-72,{"tileFrame":"solidBlock1"}],["b",5320,-56,{"tileFrame":"solidBlock1"}],["e",3903.674819318484,-24,{"enemyAnim":"goomba"}],["e",4093.641068165202,8,{"enemyAnim":"goomba"}],["e",4184,40,{"enemyAnim":"goomba"}],["e",4456,40,{"enemyAnim":"greenKoopa"}],["e",4680,8,{"enemyAnim":"greenParakoopa"}],["q",4840,-8,{"tileFrame":"blockBrick1Coins"}],["e",4856,40,{"enemyAnim":"goomba"}],["e",4872,40,{"enemyAnim":"goomba"}],["r",4888,-72,{"tileFrame":"brick1"}],["r",4904,-72,{"tileFrame":"brick1"}],["r",4920,-72,{"tileFrame":"brick1"}],["r",4936,-72,{"tileFrame":"brick1"}],["r",4952,-72,{"tileFrame":"brick1"}],["q",4984,-8,{"tileFrame":"blockCoin"}],["q",5016,-72,{"tileFrame":"blockBrick1Powerup"}],["r",5240,-8,{"tileFrame":"brick1"}],["r",5224,-8,{"tileFrame":"brick1"}],["q",5240,-72,{"tileFrame":"blockInvisibleCoin"}],["e",4968,8,{"enemyAnim":"greenParakoopa"}],["e",5000,8,{"enemyAnim":"greenParakoopa"}],["d",-456,40,{"tileFrame":"clutterGreenHill"}],["d",-216,40,{"tileFrame":"clutterBushBig"}],["d",-120,40,{"tileFrame":"clutterGreenHillSmall"}],["d",-24,40,{"tileFrame":"clutterBushSmall"}],["d",264,40,{"tileFrame":"clutterBush"}],["d",376,40,{"tileFrame":"clutterGreenHill"}],["d",552,40,{"tileFrame":"clutterBushBig"}],["d",632,152,{"tileFrame":"clutterBushSmall"}],["d",696,152,{"tileFrame":"clutterBushSmall"}],["d",536,40,{"tileFrame":"clutterGreenHillSmall"}],["d",728,40,{"tileFrame":"clutterBushSmall"}],["d",1023.4237444403878,40,{"tileFrame":"clutterBush"}],["d",1144,40,{"tileFrame":"clutterGreenHill"}],["d",1304,40,{"tileFrame":"clutterBushBig"}],["d",1368,40,{"tileFrame":"clutterGreenHillSmall"}],["d",1480,40,{"tileFrame":"clutterBushSmall"}],["d",1775.355366947121,40,{"tileFrame":"clutterBush"}],["d",1856.4892908203674,40,{"tileFrame":"clutterGreenHill"}],["d",2152,40,{"tileFrame":"clutterGreenHillSmall"}],["d",2248,40,{"tileFrame":"clutterBushSmall"}],["d",-264,-88,{"tileFrame":"clutterBgCloudSmall"}],["d",-104,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",104,-88,{"tileFrame":"clutterBgCloudBig"}],["d",280,-104,{"tileFrame":"clutterBgCloud"}],["d",536,-72,{"tileFrame":"clutterBgCloudSmall"}],["d",776,-88,{"tileFrame":"clutterBgCloudSmall"}],["d",952,-104,{"tileFrame":"clutterBgCloud"}],["d",1096,-120,{"tileFrame":"clutterBgCloudBig"}],["d",1304,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",1512,-120,{"tileFrame":"clutterBgCloudSmall"}],["d",1736,-104,{"tileFrame":"clutterBgCloudBig"}],["d",1976,-120,{"tileFrame":"clutterBgCloud"}],["d",2168,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",2376,-72,{"tileFrame":"clutterBgCloudSmall"}],["d",1864,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1848,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1832,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1816,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1800,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1784,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1768,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1752,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1736,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1720,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1704,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1688,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1672,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1656,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1640,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1624,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1608,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1592,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1576,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1560,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1544,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1528,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1512,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1496,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1480,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1464,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1448,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1432,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1416,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1400,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1384,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1368,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1352,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1336,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1320,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1304,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1288,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1272,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1256,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1240,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1224,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1208,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1192,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1176,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1160,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1144,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1128,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1112,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1096,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1080,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1064,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1048,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1032,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1016,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",1000,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",984,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",968,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",952,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",936,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",920,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",904,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",888,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",872,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",856,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",840,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",824,88,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",824,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",840,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",856,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",872,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",888,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",904,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",920,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",936,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",952,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",968,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",984,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1000,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1016,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1032,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1048,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1064,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1080,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1096,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1112,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1128,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1144,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1160,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1176,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1192,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1208,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1224,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1240,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1256,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1272,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1288,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1304,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1320,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1336,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1352,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1368,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1384,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1400,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1416,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1432,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1448,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1464,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1480,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1496,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1512,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1528,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1544,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1560,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1576,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1592,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1608,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1624,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1640,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1656,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1672,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1688,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1704,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1720,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1736,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1752,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1768,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1784,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1800,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1816,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1832,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1848,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",1864,104,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",808,104,{"tileFrame":"clutterGreenPipeConnectorSE"}],["d",808,88,{"tileFrame":"clutterGreenPipeConnectorNE"}],["b",568,88],["b",552,88],["b",536,88],["b",520,88],["b",504,88],["b",488,88],["b",472,88],["b",456,88],["b",440,88],["b",424,88],["b",408,88],["b",392,88],["b",376,88],["b",360,88],["b",344,88],["b",328,88],["b",312,88],["b",312,104],["b",328,104],["b",344,104],["b",296,104],["b",280,104],["b",296,88],["b",280,88],["b",264,88],["b",248,88],["b",232,88],["b",216,88],["b",200,88],["b",184,88],["b",168,88],["b",168,104],["b",184,104],["b",200,104],["b",216,104],["b",232,104],["b",264,104],["b",296,120],["b",312,120],["b",344,120],["b",360,120],["b",328,120],["b",280,120],["b",264,120],["b",232,120],["b",248,120],["b",248,104],["b",392,136],["b",392,120],["b",376,120],["b",360,104],["b",376,104],["b",392,104],["b",408,120],["b",424,120],["b",440,120],["b",456,120],["b",472,120],["b",488,120],["b",504,120],["b",520,120],["b",536,120],["b",552,120],["b",552,104],["b",568,104],["b",536,104],["b",520,104],["b",504,104],["b",488,104],["b",472,104],["b",456,104],["b",440,104],["b",424,104],["b",408,104],["b",408,152],["b",408,136],["b",376,136],["b",424,152],["b",440,136],["b",424,136],["b",440,152],["b",456,168],["b",456,152],["b",440,168],["b",456,184],["b",472,168],["b",488,168],["b",488,152],["b",488,136],["b",472,136],["b",456,136],["b",472,184],["b",472,152],["b",568,120],["b",568,136],["b",568,152],["b",568,168],["b",584,184],["b",568,184],["b",552,136],["b",536,168],["b",520,168],["b",536,152],["b",536,136],["b",552,168],["b",552,152],["b",504,136],["b",504,152],["b",504,168],["b",488,184],["b",504,184],["b",520,152],["b",520,136],["b",600,184],["b",792,184],["b",808,184],["b",824,184],["b",616,184],["b",776,88],["b",792,88],["b",792,104],["b",792,120],["b",792,136],["b",776,120],["b",776,104],["b",776,136],["b",776,152],["b",776,168],["b",792,152],["b",792,168],["b",808,168],["b",808,152],["b",808,136],["b",808,120],["b",824,120],["b",840,120],["b",840,136],["b",824,136],["b",824,152],["b",824,168],["b",840,184],["b",840,168],["b",840,152],["b",856,168],["b",856,152],["b",856,136],["b",856,120],["b",872,168],["b",872,152],["b",872,136],["b",872,120],["b",920,152],["b",904,152],["b",904,136],["b",904,120],["b",920,120],["b",920,136],["b",888,120],["b",888,136],["b",888,152],["b",984,120],["b",984,136],["b",984,152],["b",1864,152],["b",1864,136],["b",1864,120],["b",1848,120],["b",1832,120],["b",1816,120],["b",1800,120],["b",1784,120],["b",1768,120],["b",1752,120],["b",1736,120],["b",1720,120],["b",1704,120],["b",1688,120],["b",1672,120],["b",1656,120],["b",1688,136],["b",1640,120],["b",1624,120],["b",1608,120],["b",1592,120],["b",1576,120],["b",1560,120],["b",1544,120],["b",1528,120],["b",1512,120],["b",1496,120],["b",1480,120],["b",1464,120],["b",1448,120],["b",1432,120],["b",1416,120],["b",1400,136],["b",1384,136],["b",1368,136],["b",1352,136],["b",1336,136],["b",1352,120],["b",1368,120],["b",1384,120],["b",1400,120],["b",1416,136],["b",1432,136],["b",1336,120],["b",1320,120],["b",1304,120],["b",1288,120],["b",1272,120],["b",1256,120],["b",1240,120],["b",1224,120],["b",1208,120],["b",1192,120],["b",1176,120],["b",1160,120],["b",1144,120],["b",1128,120],["b",1112,120],["b",1096,120],["b",1080,120],["b",1064,120],["b",1048,120],["b",1032,120],["b",1016,120],["b",1000,120],["b",1000,136],["b",1848,152],["b",1848,136],["b",1832,136],["b",1816,136],["b",1800,136],["b",1784,136],["b",1768,136],["b",1752,136],["b",1736,136],["b",1720,136],["b",1704,136],["b",1672,136],["b",1656,136],["b",1640,136],["b",1624,136],["b",1608,136],["b",1592,136],["b",1672,152],["b",1704,152],["b",1736,152],["b",1832,152],["b",1016,136],["b",1032,136],["b",1048,136],["b",1112,152],["b",1128,152],["b",1144,152],["b",1096,136],["b",1080,136],["b",1064,136],["b",1112,136],["b",1128,136],["b",1160,136],["b",1176,136],["b",1192,136],["b",1224,136],["b",1240,152],["b",1320,152],["b",1336,152],["b",1320,136],["b",1304,136],["b",1288,136],["b",1272,136],["b",1256,136],["b",1240,136],["b",1208,136],["b",1144,136],["b",1160,152],["b",1176,152],["b",1192,152],["b",1208,152],["b",1224,152],["b",1576,136],["b",1560,136],["b",1544,136],["b",1528,136],["b",1512,136],["b",1496,136],["b",1480,136],["b",1464,136],["b",1448,136],["b",1352,152],["b",1528,152],["b",1384,152],["b",1368,152],["b",520,264,{"tileFrame":"solidFloor2"}],["b",456,232,{"tileFrame":"solidFloor2"}],["b",440,184,{"tileFrame":"solidFloor2"}],["b",424,184,{"tileFrame":"solidFloor2"}],["b",424,168,{"tileFrame":"solidFloor2"}],["b",408,168,{"tileFrame":"solidFloor2"}],["b",392,168,{"tileFrame":"solidFloor2"}],["b",392,152,{"tileFrame":"solidFloor2"}],["b",376,152,{"tileFrame":"solidFloor2"}],["b",360,136,{"tileFrame":"solidFloor2"}],["b",360,152,{"tileFrame":"solidFloor2"}],["b",344,136,{"tileFrame":"solidFloor2"}],["b",328,136,{"tileFrame":"solidFloor2"}],["b",312,136,{"tileFrame":"solidFloor2"}],["b",296,136,{"tileFrame":"solidFloor2"}],["b",280,136,{"tileFrame":"solidFloor2"}],["b",264,136,{"tileFrame":"solidFloor2"}],["b",248,136,{"tileFrame":"solidFloor2"}],["b",232,136,{"tileFrame":"solidFloor2"}],["b",216,136,{"tileFrame":"solidFloor2"}],["b",216,120,{"tileFrame":"solidFloor2"}],["b",200,120,{"tileFrame":"solidFloor2"}],["b",184,120,{"tileFrame":"solidFloor2"}],["b",168,120,{"tileFrame":"solidFloor2"}],["b",168,136,{"tileFrame":"solidFloor2"}],["b",168,152,{"tileFrame":"solidFloor2"}],["b",168,168,{"tileFrame":"solidFloor2"}],["b",168,184,{"tileFrame":"solidFloor2"}],["b",184,184,{"tileFrame":"solidFloor2"}],["b",200,184,{"tileFrame":"solidFloor2"}],["b",200,200,{"tileFrame":"solidFloor2"}],["b",184,200,{"tileFrame":"solidFloor2"}],["b",184,168,{"tileFrame":"solidFloor2"}],["b",184,152,{"tileFrame":"solidFloor2"}],["b",184,136,{"tileFrame":"solidFloor2"}],["b",200,136,{"tileFrame":"solidFloor2"}],["b",200,152,{"tileFrame":"solidFloor2"}],["b",200,168,{"tileFrame":"solidFloor2"}],["b",216,168,{"tileFrame":"solidFloor2"}],["b",216,152,{"tileFrame":"solidFloor2"}],["b",232,152,{"tileFrame":"solidFloor2"}],["b",248,152,{"tileFrame":"solidFloor2"}],["b",264,152,{"tileFrame":"solidFloor2"}],["b",280,152,{"tileFrame":"solidFloor2"}],["b",296,152,{"tileFrame":"solidFloor2"}],["b",312,152,{"tileFrame":"solidFloor2"}],["b",328,152,{"tileFrame":"solidFloor2"}],["b",344,168,{"tileFrame":"solidFloor2"}],["b",344,152,{"tileFrame":"solidFloor2"}],["b",328,168,{"tileFrame":"solidFloor2"}],["b",312,168,{"tileFrame":"solidFloor2"}],["b",296,168,{"tileFrame":"solidFloor2"}],["b",280,168,{"tileFrame":"solidFloor2"}],["b",264,168,{"tileFrame":"solidFloor2"}],["b",248,168,{"tileFrame":"solidFloor2"}],["b",232,168,{"tileFrame":"solidFloor2"}],["b",216,184,{"tileFrame":"solidFloor2"}],["b",216,200,{"tileFrame":"solidFloor2"}],["b",232,200,{"tileFrame":"solidFloor2"}],["b",248,200,{"tileFrame":"solidFloor2"}],["b",280,200,{"tileFrame":"solidFloor2"}],["b",296,200,{"tileFrame":"solidFloor2"}],["b",312,200,{"tileFrame":"solidFloor2"}],["b",328,200,{"tileFrame":"solidFloor2"}],["b",344,200,{"tileFrame":"solidFloor2"}],["b",328,184,{"tileFrame":"solidFloor2"}],["b",312,184,{"tileFrame":"solidFloor2"}],["b",296,184,{"tileFrame":"solidFloor2"}],["b",232,184,{"tileFrame":"solidFloor2"}],["b",248,184,{"tileFrame":"solidFloor2"}],["b",264,184,{"tileFrame":"solidFloor2"}],["b",264,200,{"tileFrame":"solidFloor2"}],["b",280,184,{"tileFrame":"solidFloor2"}],["b",360,168,{"tileFrame":"solidFloor2"}],["b",344,184,{"tileFrame":"solidFloor2"}],["b",360,184,{"tileFrame":"solidFloor2"}],["b",376,168,{"tileFrame":"solidFloor2"}],["b",376,184,{"tileFrame":"solidFloor2"}],["b",360,200,{"tileFrame":"solidFloor2"}],["b",312,216,{"tileFrame":"solidFloor2"}],["b",328,216,{"tileFrame":"solidFloor2"}],["b",344,216,{"tileFrame":"solidFloor2"}],["b",344,232,{"tileFrame":"solidFloor2"}],["b",328,232,{"tileFrame":"solidFloor2"}],["b",328,248,{"tileFrame":"solidFloor2"}],["b",344,248,{"tileFrame":"solidFloor2"}],["b",360,216,{"tileFrame":"solidFloor2"}],["b",376,200,{"tileFrame":"solidFloor2"}],["b",392,184,{"tileFrame":"solidFloor2"}],["b",392,200,{"tileFrame":"solidFloor2"}],["b",376,216,{"tileFrame":"solidFloor2"}],["b",360,232,{"tileFrame":"solidFloor2"}],["b",360,248,{"tileFrame":"solidFloor2"}],["b",344,264,{"tileFrame":"solidFloor2"}],["b",344,280,{"tileFrame":"solidFloor2"}],["b",344,296,{"tileFrame":"solidFloor2"}],["b",360,280,{"tileFrame":"solidFloor2"}],["b",360,264,{"tileFrame":"solidFloor2"}],["b",376,248,{"tileFrame":"solidFloor2"}],["b",376,232,{"tileFrame":"solidFloor2"}],["b",392,216,{"tileFrame":"solidFloor2"}],["b",408,184,{"tileFrame":"solidFloor2"}],["b",408,200,{"tileFrame":"solidFloor2"}],["b",392,232,{"tileFrame":"solidFloor2"}],["b",392,248,{"tileFrame":"solidFloor2"}],["b",376,264,{"tileFrame":"solidFloor2"}],["b",376,280,{"tileFrame":"solidFloor2"}],["b",376,296,{"tileFrame":"solidFloor2"}],["b",360,296,{"tileFrame":"solidFloor2"}],["b",360,312,{"tileFrame":"solidFloor2"}],["b",376,312,{"tileFrame":"solidFloor2"}],["b",392,296,{"tileFrame":"solidFloor2"}],["b",392,312,{"tileFrame":"solidFloor2"}],["b",376,328,{"tileFrame":"solidFloor2"}],["b",392,280,{"tileFrame":"solidFloor2"}],["b",408,280,{"tileFrame":"solidFloor2"}],["b",408,264,{"tileFrame":"solidFloor2"}],["b",408,248,{"tileFrame":"solidFloor2"}],["b",408,232,{"tileFrame":"solidFloor2"}],["b",408,216,{"tileFrame":"solidFloor2"}],["b",424,200,{"tileFrame":"solidFloor2"}],["b",424,216,{"tileFrame":"solidFloor2"}],["b",392,264,{"tileFrame":"solidFloor2"}],["b",424,232,{"tileFrame":"solidFloor2"}],["b",440,232,{"tileFrame":"solidFloor2"}],["b",440,216,{"tileFrame":"solidFloor2"}],["b",424,248,{"tileFrame":"solidFloor2"}],["b",424,264,{"tileFrame":"solidFloor2"}],["b",424,280,{"tileFrame":"solidFloor2"}],["b",424,296,{"tileFrame":"solidFloor2"}],["b",408,296,{"tileFrame":"solidFloor2"}],["b",408,312,{"tileFrame":"solidFloor2"}],["b",408,328,{"tileFrame":"solidFloor2"}],["b",392,328,{"tileFrame":"solidFloor2"}],["b",392,344,{"tileFrame":"solidFloor2"}],["b",408,344,{"tileFrame":"solidFloor2"}],["b",424,344,{"tileFrame":"solidFloor2"}],["b",424,328,{"tileFrame":"solidFloor2"}],["b",424,312,{"tileFrame":"solidFloor2"}],["b",440,312,{"tileFrame":"solidFloor2"}],["b",440,296,{"tileFrame":"solidFloor2"}],["b",440,280,{"tileFrame":"solidFloor2"}],["b",440,264,{"tileFrame":"solidFloor2"}],["b",440,248,{"tileFrame":"solidFloor2"}],["b",456,248,{"tileFrame":"solidFloor2"}],["b",472,248,{"tileFrame":"solidFloor2"}],["b",488,264,{"tileFrame":"solidFloor2"}],["b",472,264,{"tileFrame":"solidFloor2"}],["b",456,280,{"tileFrame":"solidFloor2"}],["b",472,280,{"tileFrame":"solidFloor2"}],["b",456,264,{"tileFrame":"solidFloor2"}],["b",456,296,{"tileFrame":"solidFloor2"}],["b",456,312,{"tileFrame":"solidFloor2"}],["b",472,312,{"tileFrame":"solidFloor2"}],["b",488,312,{"tileFrame":"solidFloor2"}],["b",504,312,{"tileFrame":"solidFloor2"}],["b",504,296,{"tileFrame":"solidFloor2"}],["b",504,280,{"tileFrame":"solidFloor2"}],["b",488,280,{"tileFrame":"solidFloor2"}],["b",472,296,{"tileFrame":"solidFloor2"}],["b",488,296,{"tileFrame":"solidFloor2"}],["b",504,264,{"tileFrame":"solidFloor2"}],["b",440,328,{"tileFrame":"solidFloor2"}],["b",440,344,{"tileFrame":"solidFloor2"}],["b",424,360,{"tileFrame":"solidFloor2"}],["b",440,360,{"tileFrame":"solidFloor2"}],["b",456,360,{"tileFrame":"solidFloor2"}],["b",472,344,{"tileFrame":"solidFloor2"}],["b",472,328,{"tileFrame":"solidFloor2"}],["b",456,328,{"tileFrame":"solidFloor2"}],["b",456,344,{"tileFrame":"solidFloor2"}],["b",520,280,{"tileFrame":"solidFloor2"}],["b",520,296,{"tileFrame":"solidFloor2"}],["b",536,312,{"tileFrame":"solidFloor2"}],["b",536,296,{"tileFrame":"solidFloor2"}],["b",552,296,{"tileFrame":"solidFloor2"}],["b",552,312,{"tileFrame":"solidFloor2"}],["b",552,328,{"tileFrame":"solidFloor2"}],["b",552,344,{"tileFrame":"solidFloor2"}],["b",552,360,{"tileFrame":"solidFloor2"}],["b",552,376,{"tileFrame":"solidFloor2"}],["b",552,392,{"tileFrame":"solidFloor2"}],["b",536,392,{"tileFrame":"solidFloor2"}],["b",520,392,{"tileFrame":"solidFloor2"}],["b",520,376,{"tileFrame":"solidFloor2"}],["b",504,376,{"tileFrame":"solidFloor2"}],["b",488,376,{"tileFrame":"solidFloor2"}],["b",472,376,{"tileFrame":"solidFloor2"}],["b",472,360,{"tileFrame":"solidFloor2"}],["b",488,360,{"tileFrame":"solidFloor2"}],["b",504,360,{"tileFrame":"solidFloor2"}],["b",520,360,{"tileFrame":"solidFloor2"}],["b",536,360,{"tileFrame":"solidFloor2"}],["b",536,376,{"tileFrame":"solidFloor2"}],["b",536,344,{"tileFrame":"solidFloor2"}],["b",536,328,{"tileFrame":"solidFloor2"}],["b",520,328,{"tileFrame":"solidFloor2"}],["b",504,328,{"tileFrame":"solidFloor2"}],["b",488,328,{"tileFrame":"solidFloor2"}],["b",520,344,{"tileFrame":"solidFloor2"}],["b",504,344,{"tileFrame":"solidFloor2"}],["b",488,344,{"tileFrame":"solidFloor2"}],["b",520,312,{"tileFrame":"solidFloor2"}],["b",152,152,{"tileFrame":"solidFloor2"}],["b",152,168,{"tileFrame":"solidFloor2"}],["b",152,184,{"tileFrame":"solidFloor2"}],["b",152,200,{"tileFrame":"solidFloor2"}],["b",168,200,{"tileFrame":"solidFloor2"}],["b",168,216,{"tileFrame":"solidFloor2"}],["b",184,216,{"tileFrame":"solidFloor2"}],["b",200,216,{"tileFrame":"solidFloor2"}],["b",216,216,{"tileFrame":"solidFloor2"}],["b",232,216,{"tileFrame":"solidFloor2"}],["b",248,216,{"tileFrame":"solidFloor2"}],["b",264,216,{"tileFrame":"solidFloor2"}],["b",280,216,{"tileFrame":"solidFloor2"}],["b",296,216,{"tileFrame":"solidFloor2"}],["b",312,248,{"tileFrame":"solidFloor2"}],["b",312,264,{"tileFrame":"solidFloor2"}],["b",312,232,{"tileFrame":"solidFloor2"}],["b",328,296,{"tileFrame":"solidFloor2"}],["b",328,280,{"tileFrame":"solidFloor2"}],["b",328,264,{"tileFrame":"solidFloor2"}],["b",344,312,{"tileFrame":"solidFloor2"}],["b",360,328,{"tileFrame":"solidFloor2"}],["b",376,344,{"tileFrame":"solidFloor2"}],["b",392,360,{"tileFrame":"solidFloor2"}],["b",408,360,{"tileFrame":"solidFloor2"}],["b",424,376,{"tileFrame":"solidFloor2"}],["b",440,376,{"tileFrame":"solidFloor2"}],["b",456,376,{"tileFrame":"solidFloor2"}],["b",504,392,{"tileFrame":"solidFloor2"}],["b",488,392,{"tileFrame":"solidFloor2"}],["b",472,392,{"tileFrame":"solidFloor2"}],["b",552,408,{"tileFrame":"solidFloor2"}],["b",536,408,{"tileFrame":"solidFloor2"}],["b",520,408,{"tileFrame":"solidFloor2"}],["b",920,232,{"tileFrame":"solidFloor2"}],["b",904,232,{"tileFrame":"solidFloor2"}],["b",888,232,{"tileFrame":"solidFloor2"}],["b",872,232,{"tileFrame":"solidFloor2"}],["b",856,232,{"tileFrame":"solidFloor2"}],["b",856,248,{"tileFrame":"solidFloor2"}],["b",840,248,{"tileFrame":"solidFloor2"}],["b",824,248,{"tileFrame":"solidFloor2"}],["b",808,264,{"tileFrame":"solidFloor2"}],["b",792,264,{"tileFrame":"solidFloor2"}],["b",776,264,{"tileFrame":"solidFloor2"}],["b",728,280,{"tileFrame":"solidFloor2"}],["b",744,280,{"tileFrame":"solidFloor2"}],["b",760,280,{"tileFrame":"solidFloor2"}],["b",696,280,{"tileFrame":"solidFloor2"}],["b",616,280,{"tileFrame":"solidFloor2"}],["b",600,280,{"tileFrame":"solidFloor2"}],["b",584,280,{"tileFrame":"solidFloor2"}],["b",568,280,{"tileFrame":"solidFloor2"}],["b",552,280,{"tileFrame":"solidFloor2"}],["b",536,280,{"tileFrame":"solidFloor2"}],["b",920,360,{"tileFrame":"solidFloor2"}],["b",920,344,{"tileFrame":"solidFloor2"}],["b",920,328,{"tileFrame":"solidFloor2"}],["b",920,312,{"tileFrame":"solidFloor2"}],["b",920,296,{"tileFrame":"solidFloor2"}],["b",920,280,{"tileFrame":"solidFloor2"}],["b",920,264,{"tileFrame":"solidFloor2"}],["b",920,248,{"tileFrame":"solidFloor2"}],["b",904,360,{"tileFrame":"solidFloor2"}],["b",888,360,{"tileFrame":"solidFloor2"}],["b",872,360,{"tileFrame":"solidFloor2"}],["b",856,360,{"tileFrame":"solidFloor2"}],["b",840,360,{"tileFrame":"solidFloor2"}],["b",824,360,{"tileFrame":"solidFloor2"}],["b",808,360,{"tileFrame":"solidFloor2"}],["b",792,360,{"tileFrame":"solidFloor2"}],["b",776,360,{"tileFrame":"solidFloor2"}],["b",760,360,{"tileFrame":"solidFloor2"}],["b",744,360,{"tileFrame":"solidFloor2"}],["b",728,360,{"tileFrame":"solidFloor2"}],["b",712,360,{"tileFrame":"solidFloor2"}],["b",696,360,{"tileFrame":"solidFloor2"}],["b",680,360,{"tileFrame":"solidFloor2"}],["b",632,360,{"tileFrame":"solidFloor2"}],["b",648,360,{"tileFrame":"solidFloor2"}],["b",664,360,{"tileFrame":"solidFloor2"}],["b",632,376,{"tileFrame":"solidFloor2"}],["b",616,376,{"tileFrame":"solidFloor2"}],["b",600,392,{"tileFrame":"solidFloor2"}],["b",568,392,{"tileFrame":"solidFloor2"}],["b",584,392,{"tileFrame":"solidFloor2"}],["b",568,296,{"tileFrame":"solidFloor2"}],["b",568,312,{"tileFrame":"solidFloor2"}],["b",568,328,{"tileFrame":"solidFloor2"}],["b",568,344,{"tileFrame":"solidFloor2"}],["b",568,360,{"tileFrame":"solidFloor2"}],["b",568,376,{"tileFrame":"solidFloor2"}],["b",584,376,{"tileFrame":"solidFloor2"}],["b",600,376,{"tileFrame":"solidFloor2"}],["b",600,360,{"tileFrame":"solidFloor2"}],["b",584,360,{"tileFrame":"solidFloor2"}],["b",584,312,{"tileFrame":"solidFloor2"}],["b",584,296,{"tileFrame":"solidFloor2"}],["b",584,328,{"tileFrame":"solidFloor2"}],["b",584,344,{"tileFrame":"solidFloor2"}],["b",600,344,{"tileFrame":"solidFloor2"}],["b",600,328,{"tileFrame":"solidFloor2"}],["b",600,312,{"tileFrame":"solidFloor2"}],["b",600,296,{"tileFrame":"solidFloor2"}],["b",616,296,{"tileFrame":"solidFloor2"}],["b",616,312,{"tileFrame":"solidFloor2"}],["b",616,328,{"tileFrame":"solidFloor2"}],["b",616,344,{"tileFrame":"solidFloor2"}],["b",616,360,{"tileFrame":"solidFloor2"}],["b",632,344,{"tileFrame":"solidFloor2"}],["b",664,344,{"tileFrame":"solidFloor2"}],["b",696,344,{"tileFrame":"solidFloor2"}],["b",664,328,{"tileFrame":"solidFloor2"}],["b",664,312,{"tileFrame":"solidFloor2"}],["b",648,312,{"tileFrame":"solidFloor2"}],["b",648,296,{"tileFrame":"solidFloor2"}],["b",632,296,{"tileFrame":"solidFloor2"}],["b",680,296,{"tileFrame":"solidFloor2"}],["b",696,296,{"tileFrame":"solidFloor2"}],["b",712,296,{"tileFrame":"solidFloor2"}],["b",728,296,{"tileFrame":"solidFloor2"}],["b",744,296,{"tileFrame":"solidFloor2"}],["b",760,296,{"tileFrame":"solidFloor2"}],["b",776,280,{"tileFrame":"solidFloor2"}],["b",792,280,{"tileFrame":"solidFloor2"}],["b",808,280,{"tileFrame":"solidFloor2"}],["b",824,280,{"tileFrame":"solidFloor2"}],["b",840,280,{"tileFrame":"solidFloor2"}],["b",856,280,{"tileFrame":"solidFloor2"}],["b",872,264,{"tileFrame":"solidFloor2"}],["b",888,264,{"tileFrame":"solidFloor2"}],["b",888,248,{"tileFrame":"solidFloor2"}],["b",904,248,{"tileFrame":"solidFloor2"}],["b",904,264,{"tileFrame":"solidFloor2"}],["b",904,280,{"tileFrame":"solidFloor2"}],["b",904,296,{"tileFrame":"solidFloor2"}],["b",904,312,{"tileFrame":"solidFloor2"}],["b",904,328,{"tileFrame":"solidFloor2"}],["b",904,344,{"tileFrame":"solidFloor2"}],["b",888,344,{"tileFrame":"solidFloor2"}],["b",872,344,{"tileFrame":"solidFloor2"}],["b",856,344,{"tileFrame":"solidFloor2"}],["b",840,344,{"tileFrame":"solidFloor2"}],["b",824,344,{"tileFrame":"solidFloor2"}],["b",808,344,{"tileFrame":"solidFloor2"}],["b",792,344,{"tileFrame":"solidFloor2"}],["b",776,344,{"tileFrame":"solidFloor2"}],["b",760,344,{"tileFrame":"solidFloor2"}],["b",744,344,{"tileFrame":"solidFloor2"}],["b",728,344,{"tileFrame":"solidFloor2"}],["b",712,344,{"tileFrame":"solidFloor2"}],["b",680,344,{"tileFrame":"solidFloor2"}],["b",648,344,{"tileFrame":"solidFloor2"}],["b",632,328,{"tileFrame":"solidFloor2"}],["b",648,328,{"tileFrame":"solidFloor2"}],["b",632,312,{"tileFrame":"solidFloor2"}],["b",664,296,{"tileFrame":"solidFloor2"}],["b",680,312,{"tileFrame":"solidFloor2"}],["b",680,328,{"tileFrame":"solidFloor2"}],["b",696,328,{"tileFrame":"solidFloor2"}],["b",712,312,{"tileFrame":"solidFloor2"}],["b",728,312,{"tileFrame":"solidFloor2"}],["b",744,312,{"tileFrame":"solidFloor2"}],["b",760,312,{"tileFrame":"solidFloor2"}],["b",776,312,{"tileFrame":"solidFloor2"}],["b",792,312,{"tileFrame":"solidFloor2"}],["b",808,312,{"tileFrame":"solidFloor2"}],["b",824,312,{"tileFrame":"solidFloor2"}],["b",840,312,{"tileFrame":"solidFloor2"}],["b",856,312,{"tileFrame":"solidFloor2"}],["b",872,312,{"tileFrame":"solidFloor2"}],["b",888,312,{"tileFrame":"solidFloor2"}],["b",888,328,{"tileFrame":"solidFloor2"}],["b",872,328,{"tileFrame":"solidFloor2"}],["b",856,328,{"tileFrame":"solidFloor2"}],["b",840,328,{"tileFrame":"solidFloor2"}],["b",824,328,{"tileFrame":"solidFloor2"}],["b",808,328,{"tileFrame":"solidFloor2"}],["b",792,328,{"tileFrame":"solidFloor2"}],["b",776,328,{"tileFrame":"solidFloor2"}],["b",744,328,{"tileFrame":"solidFloor2"}],["b",728,328,{"tileFrame":"solidFloor2"}],["b",712,328,{"tileFrame":"solidFloor2"}],["b",696,312,{"tileFrame":"solidFloor2"}],["b",760,328,{"tileFrame":"solidFloor2"}],["b",776,296,{"tileFrame":"solidFloor2"}],["b",824,296,{"tileFrame":"solidFloor2"}],["b",840,296,{"tileFrame":"solidFloor2"}],["b",856,296,{"tileFrame":"solidFloor2"}],["b",808,296,{"tileFrame":"solidFloor2"}],["b",792,296,{"tileFrame":"solidFloor2"}],["b",872,296,{"tileFrame":"solidFloor2"}],["b",888,296,{"tileFrame":"solidFloor2"}],["b",888,280,{"tileFrame":"solidFloor2"}],["b",872,280,{"tileFrame":"solidFloor2"}],["b",872,248,{"tileFrame":"solidFloor2"}],["b",856,264,{"tileFrame":"solidFloor2"}],["b",840,264,{"tileFrame":"solidFloor2"}],["b",824,264,{"tileFrame":"solidFloor2"}],["b",2200,232,{"tileFrame":"solidFloor2"}],["b",2200,216,{"tileFrame":"solidFloor2"}],["b",2200,200,{"tileFrame":"solidFloor2"}],["b",2200,184,{"tileFrame":"solidFloor2"}],["b",2200,168,{"tileFrame":"solidFloor2"}],["b",2200,152,{"tileFrame":"solidFloor2"}],["b",2216,200,{"tileFrame":"solidFloor2"}],["b",2216,184,{"tileFrame":"solidFloor2"}],["b",2216,168,{"tileFrame":"solidFloor2"}],["b",2216,152,{"tileFrame":"solidFloor2"}],["b",2216,136,{"tileFrame":"solidFloor2"}],["b",2216,312,{"tileFrame":"solidFloor2"}],["b",2232,312,{"tileFrame":"solidFloor2"}],["b",2232,152,{"tileFrame":"solidFloor2"}],["b",2232,136,{"tileFrame":"solidFloor2"}],["b",2232,120,{"tileFrame":"solidFloor2"}],["b",2248,120,{"tileFrame":"solidFloor2"}],["b",2264,120,{"tileFrame":"solidFloor2"}],["b",2280,136,{"tileFrame":"solidFloor2"}],["b",2296,136,{"tileFrame":"solidFloor2"}],["b",2312,136,{"tileFrame":"solidFloor2"}],["b",2312,120,{"tileFrame":"solidFloor2"}],["b",2328,120,{"tileFrame":"solidFloor2"}],["b",2344,120,{"tileFrame":"solidFloor2"}],["b",2360,120,{"tileFrame":"solidFloor2"}],["b",2376,120,{"tileFrame":"solidFloor2"}],["b",2376,136,{"tileFrame":"solidFloor2"}],["b",2392,136,{"tileFrame":"solidFloor2"}],["b",2408,136,{"tileFrame":"solidFloor2"}],["b",2424,136,{"tileFrame":"solidFloor2"}],["b",2440,136,{"tileFrame":"solidFloor2"}],["b",2440,152,{"tileFrame":"solidFloor2"}],["b",2456,152,{"tileFrame":"solidFloor2"}],["b",2456,168,{"tileFrame":"solidFloor2"}],["b",2472,152,{"tileFrame":"solidFloor2"}],["b",2472,136,{"tileFrame":"solidFloor2"}],["b",2488,136,{"tileFrame":"solidFloor2"}],["b",2504,120,{"tileFrame":"solidFloor2"}],["b",2520,120,{"tileFrame":"solidFloor2"}],["b",2536,120,{"tileFrame":"solidFloor2"}],["b",2248,312,{"tileFrame":"solidFloor2"}],["b",2264,312,{"tileFrame":"solidFloor2"}],["b",2280,312,{"tileFrame":"solidFloor2"}],["b",2296,312,{"tileFrame":"solidFloor2"}],["b",2312,312,{"tileFrame":"solidFloor2"}],["b",2328,312,{"tileFrame":"solidFloor2"}],["b",2344,312,{"tileFrame":"solidFloor2"}],["b",2360,296,{"tileFrame":"solidFloor2"}],["b",2376,296,{"tileFrame":"solidFloor2"}],["b",2392,296,{"tileFrame":"solidFloor2"}],["b",2408,296,{"tileFrame":"solidFloor2"}],["b",2408,280,{"tileFrame":"solidFloor2"}],["b",2424,280,{"tileFrame":"solidFloor2"}],["b",2376,312,{"tileFrame":"solidFloor2"}],["b",2360,312,{"tileFrame":"solidFloor2"}],["b",2392,312,{"tileFrame":"solidFloor2"}],["b",2424,296,{"tileFrame":"solidFloor2"}],["b",2440,280,{"tileFrame":"solidFloor2"}],["b",2440,264,{"tileFrame":"solidFloor2"}],["b",2456,248,{"tileFrame":"solidFloor2"}],["b",2456,232,{"tileFrame":"solidFloor2"}],["b",2472,232,{"tileFrame":"solidFloor2"}],["b",2472,216,{"tileFrame":"solidFloor2"}],["b",2488,216,{"tileFrame":"solidFloor2"}],["b",2488,200,{"tileFrame":"solidFloor2"}],["b",2504,200,{"tileFrame":"solidFloor2"}],["b",2504,184,{"tileFrame":"solidFloor2"}],["b",2520,184,{"tileFrame":"solidFloor2"}],["b",2520,168,{"tileFrame":"solidFloor2"}],["b",2536,168,{"tileFrame":"solidFloor2"}],["b",2536,152,{"tileFrame":"solidFloor2"}],["b",2536,136,{"tileFrame":"solidFloor2"}],["b",2520,136,{"tileFrame":"solidFloor2"}],["b",2504,136,{"tileFrame":"solidFloor2"}],["b",2488,152,{"tileFrame":"solidFloor2"}],["b",2472,168,{"tileFrame":"solidFloor2"}],["b",2504,152,{"tileFrame":"solidFloor2"}],["b",2520,152,{"tileFrame":"solidFloor2"}],["b",2504,168,{"tileFrame":"solidFloor2"}],["b",2488,168,{"tileFrame":"solidFloor2"}],["b",2472,184,{"tileFrame":"solidFloor2"}],["b",2456,184,{"tileFrame":"solidFloor2"}],["b",2456,200,{"tileFrame":"solidFloor2"}],["b",2440,200,{"tileFrame":"solidFloor2"}],["b",2440,216,{"tileFrame":"solidFloor2"}],["b",2424,216,{"tileFrame":"solidFloor2"}],["b",2472,200,{"tileFrame":"solidFloor2"}],["b",2488,184,{"tileFrame":"solidFloor2"}],["b",2456,216,{"tileFrame":"solidFloor2"}],["b",2440,232,{"tileFrame":"solidFloor2"}],["b",2424,232,{"tileFrame":"solidFloor2"}],["b",2424,248,{"tileFrame":"solidFloor2"}],["b",2408,248,{"tileFrame":"solidFloor2"}],["b",2392,264,{"tileFrame":"solidFloor2"}],["b",2376,280,{"tileFrame":"solidFloor2"}],["b",2360,280,{"tileFrame":"solidFloor2"}],["b",2408,264,{"tileFrame":"solidFloor2"}],["b",2424,264,{"tileFrame":"solidFloor2"}],["b",2440,248,{"tileFrame":"solidFloor2"}],["b",2392,280,{"tileFrame":"solidFloor2"}],["b",2344,296,{"tileFrame":"solidFloor2"}],["b",2328,296,{"tileFrame":"solidFloor2"}],["b",2312,296,{"tileFrame":"solidFloor2"}],["b",2296,296,{"tileFrame":"solidFloor2"}],["b",2280,296,{"tileFrame":"solidFloor2"}],["b",2264,296,{"tileFrame":"solidFloor2"}],["b",2248,296,{"tileFrame":"solidFloor2"}],["b",2248,280,{"tileFrame":"solidFloor2"}],["b",2248,248,{"tileFrame":"solidFloor2"}],["b",2264,232,{"tileFrame":"solidFloor2"}],["b",2264,216,{"tileFrame":"solidFloor2"}],["b",2280,200,{"tileFrame":"solidFloor2"}],["b",2280,184,{"tileFrame":"solidFloor2"}],["b",2296,184,{"tileFrame":"solidFloor2"}],["b",2296,168,{"tileFrame":"solidFloor2"}],["b",2280,168,{"tileFrame":"solidFloor2"}],["b",2264,168,{"tileFrame":"solidFloor2"}],["b",2264,184,{"tileFrame":"solidFloor2"}],["b",2280,152,{"tileFrame":"solidFloor2"}],["b",2264,136,{"tileFrame":"solidFloor2"}],["b",2248,136,{"tileFrame":"solidFloor2"}],["b",2248,152,{"tileFrame":"solidFloor2"}],["b",2248,168,{"tileFrame":"solidFloor2"}],["b",2264,200,{"tileFrame":"solidFloor2"}],["b",2264,248,{"tileFrame":"solidFloor2"}],["b",2248,216,{"tileFrame":"solidFloor2"}],["b",2248,200,{"tileFrame":"solidFloor2"}],["b",2248,184,{"tileFrame":"solidFloor2"}],["b",2248,232,{"tileFrame":"solidFloor2"}],["b",2248,264,{"tileFrame":"solidFloor2"}],["b",2264,280,{"tileFrame":"solidFloor2"}],["b",2280,264,{"tileFrame":"solidFloor2"}],["b",2296,264,{"tileFrame":"solidFloor2"}],["b",2312,264,{"tileFrame":"solidFloor2"}],["b",2280,280,{"tileFrame":"solidFloor2"}],["b",2296,280,{"tileFrame":"solidFloor2"}],["b",2312,280,{"tileFrame":"solidFloor2"}],["b",2328,280,{"tileFrame":"solidFloor2"}],["b",2344,280,{"tileFrame":"solidFloor2"}],["b",2328,264,{"tileFrame":"solidFloor2"}],["b",2264,264,{"tileFrame":"solidFloor2"}],["b",2360,264,{"tileFrame":"solidFloor2"}],["b",2376,248,{"tileFrame":"solidFloor2"}],["b",2392,248,{"tileFrame":"solidFloor2"}],["b",2360,248,{"tileFrame":"solidFloor2"}],["b",2344,248,{"tileFrame":"solidFloor2"}],["b",2344,264,{"tileFrame":"solidFloor2"}],["b",2376,264,{"tileFrame":"solidFloor2"}],["b",2408,232,{"tileFrame":"solidFloor2"}],["b",2408,216,{"tileFrame":"solidFloor2"}],["b",2424,200,{"tileFrame":"solidFloor2"}],["b",2440,184,{"tileFrame":"solidFloor2"}],["b",2440,168,{"tileFrame":"solidFloor2"}],["b",2424,168,{"tileFrame":"solidFloor2"}],["b",2408,168,{"tileFrame":"solidFloor2"}],["b",2392,168,{"tileFrame":"solidFloor2"}],["b",2392,152,{"tileFrame":"solidFloor2"}],["b",2408,152,{"tileFrame":"solidFloor2"}],["b",2424,152,{"tileFrame":"solidFloor2"}],["b",2376,152,{"tileFrame":"solidFloor2"}],["b",2360,152,{"tileFrame":"solidFloor2"}],["b",2344,152,{"tileFrame":"solidFloor2"}],["b",2328,152,{"tileFrame":"solidFloor2"}],["b",2296,152,{"tileFrame":"solidFloor2"}],["b",2264,152,{"tileFrame":"solidFloor2"}],["b",2328,136,{"tileFrame":"solidFloor2"}],["b",2344,136,{"tileFrame":"solidFloor2"}],["b",2360,136,{"tileFrame":"solidFloor2"}],["b",2312,152,{"tileFrame":"solidFloor2"}],["b",2312,168,{"tileFrame":"solidFloor2"}],["b",2296,200,{"tileFrame":"solidFloor2"}],["b",2280,216,{"tileFrame":"solidFloor2"}],["b",2280,232,{"tileFrame":"solidFloor2"}],["b",2280,248,{"tileFrame":"solidFloor2"}],["b",2296,232,{"tileFrame":"solidFloor2"}],["b",2312,232,{"tileFrame":"solidFloor2"}],["b",2312,216,{"tileFrame":"solidFloor2"}],["b",2328,216,{"tileFrame":"solidFloor2"}],["b",2328,200,{"tileFrame":"solidFloor2"}],["b",2328,184,{"tileFrame":"solidFloor2"}],["b",2312,200,{"tileFrame":"solidFloor2"}],["b",2296,216,{"tileFrame":"solidFloor2"}],["b",2296,248,{"tileFrame":"solidFloor2"}],["b",2312,248,{"tileFrame":"solidFloor2"}],["b",2328,248,{"tileFrame":"solidFloor2"}],["b",2344,232,{"tileFrame":"solidFloor2"}],["b",2360,232,{"tileFrame":"solidFloor2"}],["b",2360,216,{"tileFrame":"solidFloor2"}],["b",2344,200,{"tileFrame":"solidFloor2"}],["b",2328,232,{"tileFrame":"solidFloor2"}],["b",2376,216,{"tileFrame":"solidFloor2"}],["b",2376,200,{"tileFrame":"solidFloor2"}],["b",2360,184,{"tileFrame":"solidFloor2"}],["b",2344,184,{"tileFrame":"solidFloor2"}],["b",2376,232,{"tileFrame":"solidFloor2"}],["b",2392,216,{"tileFrame":"solidFloor2"}],["b",2392,200,{"tileFrame":"solidFloor2"}],["b",2392,184,{"tileFrame":"solidFloor2"}],["b",2376,184,{"tileFrame":"solidFloor2"}],["b",2360,200,{"tileFrame":"solidFloor2"}],["b",2344,216,{"tileFrame":"solidFloor2"}],["b",2392,232,{"tileFrame":"solidFloor2"}],["b",2408,184,{"tileFrame":"solidFloor2"}],["b",2408,200,{"tileFrame":"solidFloor2"}],["b",2424,184,{"tileFrame":"solidFloor2"}],["b",2376,168,{"tileFrame":"solidFloor2"}],["b",2360,168,{"tileFrame":"solidFloor2"}],["b",2344,168,{"tileFrame":"solidFloor2"}],["b",2328,168,{"tileFrame":"solidFloor2"}],["b",2312,184,{"tileFrame":"solidFloor2"}],["b",2248,88],["b",2264,88],["b",2280,88],["b",2296,88],["b",2312,88],["b",2328,88],["b",2344,104],["b",2360,104],["b",2376,104],["b",2392,104],["b",2408,104],["b",2424,88],["b",2440,88],["b",2456,88],["b",2472,88],["b",2488,88],["b",2504,88],["b",2520,88],["b",2536,88],["b",2536,104],["b",2520,104],["b",2504,104],["b",2488,104],["b",2472,104],["b",2456,104],["b",2440,104],["b",2424,104],["b",2328,104],["b",2312,104],["b",2296,104],["b",2280,104],["b",2264,104],["b",2248,104],["b",2280,120],["b",2296,120],["b",2392,120],["b",2408,120],["b",2424,120],["b",2440,120],["b",2456,120],["b",2472,120],["b",2488,120],["b",2456,136],["b",2408,88],["b",2392,88],["b",2376,88],["b",2360,88],["b",2344,88],["b",1912,264,{"tileFrame":"solidFloor2"}],["b",1912,248,{"tileFrame":"solidFloor2"}],["b",1912,232,{"tileFrame":"solidFloor2"}],["b",1912,216,{"tileFrame":"solidFloor2"}],["b",1912,200,{"tileFrame":"solidFloor2"}],["b",1912,184,{"tileFrame":"solidFloor2"}],["b",1912,168,{"tileFrame":"solidFloor2"}],["b",1912,152,{"tileFrame":"solidFloor2"}],["b",1896,232,{"tileFrame":"solidFloor2"}],["b",1896,216,{"tileFrame":"solidFloor2"}],["b",1896,200,{"tileFrame":"solidFloor2"}],["b",1896,184,{"tileFrame":"solidFloor2"}],["b",1896,168,{"tileFrame":"solidFloor2"}],["b",1896,152,{"tileFrame":"solidFloor2"}],["b",1896,136,{"tileFrame":"solidFloor2"}],["b",1880,200,{"tileFrame":"solidFloor2"}],["b",1880,184,{"tileFrame":"solidFloor2"}],["b",1880,168,{"tileFrame":"solidFloor2"}],["b",1864,168,{"tileFrame":"solidFloor2"}],["b",1848,168,{"tileFrame":"solidFloor2"}],["b",1832,168,{"tileFrame":"solidFloor2"}],["b",1640,168,{"tileFrame":"solidFloor2"}],["b",1656,152,{"tileFrame":"solidFloor2"}],["b",1688,152,{"tileFrame":"solidFloor2"}],["b",1720,152,{"tileFrame":"solidFloor2"}],["b",1752,152,{"tileFrame":"solidFloor2"}],["b",1768,152,{"tileFrame":"solidFloor2"}],["b",1784,152,{"tileFrame":"solidFloor2"}],["b",1800,152,{"tileFrame":"solidFloor2"}],["b",1816,152,{"tileFrame":"solidFloor2"}],["b",1816,168,{"tileFrame":"solidFloor2"}],["b",1800,168,{"tileFrame":"solidFloor2"}],["b",1784,168,{"tileFrame":"solidFloor2"}],["b",1768,168,{"tileFrame":"solidFloor2"}],["b",1752,168,{"tileFrame":"solidFloor2"}],["b",1736,168,{"tileFrame":"solidFloor2"}],["b",1720,168,{"tileFrame":"solidFloor2"}],["b",1704,168,{"tileFrame":"solidFloor2"}],["b",1688,168,{"tileFrame":"solidFloor2"}],["b",1672,168,{"tileFrame":"solidFloor2"}],["b",1656,168,{"tileFrame":"solidFloor2"}],["b",1640,152,{"tileFrame":"solidFloor2"}],["b",1624,152,{"tileFrame":"solidFloor2"}],["b",1608,152,{"tileFrame":"solidFloor2"}],["b",1592,152,{"tileFrame":"solidFloor2"}],["b",1576,152,{"tileFrame":"solidFloor2"}],["b",1560,152,{"tileFrame":"solidFloor2"}],["b",1544,152,{"tileFrame":"solidFloor2"}],["b",1512,168,{"tileFrame":"solidFloor2"}],["b",1496,168,{"tileFrame":"solidFloor2"}],["b",1480,168,{"tileFrame":"solidFloor2"}],["b",1464,168,{"tileFrame":"solidFloor2"}],["b",1400,152,{"tileFrame":"solidFloor2"}],["b",1512,152,{"tileFrame":"solidFloor2"}],["b",1496,152,{"tileFrame":"solidFloor2"}],["b",1480,152,{"tileFrame":"solidFloor2"}],["b",1464,152,{"tileFrame":"solidFloor2"}],["b",1448,152,{"tileFrame":"solidFloor2"}],["b",1432,152,{"tileFrame":"solidFloor2"}],["b",1416,152,{"tileFrame":"solidFloor2"}],["b",1448,168,{"tileFrame":"solidFloor2"}],["b",1432,168,{"tileFrame":"solidFloor2"}],["b",1416,168,{"tileFrame":"solidFloor2"}],["b",1400,168,{"tileFrame":"solidFloor2"}],["b",1384,168,{"tileFrame":"solidFloor2"}],["b",1368,168,{"tileFrame":"solidFloor2"}],["b",1352,168,{"tileFrame":"solidFloor2"}],["b",1336,168,{"tileFrame":"solidFloor2"}],["b",1320,168,{"tileFrame":"solidFloor2"}],["b",1304,168,{"tileFrame":"solidFloor2"}],["b",1288,168,{"tileFrame":"solidFloor2"}],["b",1272,168,{"tileFrame":"solidFloor2"}],["b",1256,152,{"tileFrame":"solidFloor2"}],["b",1304,152,{"tileFrame":"solidFloor2"}],["b",1288,152,{"tileFrame":"solidFloor2"}],["b",1272,152,{"tileFrame":"solidFloor2"}],["b",1256,168,{"tileFrame":"solidFloor2"}],["b",1240,168,{"tileFrame":"solidFloor2"}],["b",1224,168,{"tileFrame":"solidFloor2"}],["b",1208,168,{"tileFrame":"solidFloor2"}],["b",1192,168,{"tileFrame":"solidFloor2"}],["b",1176,168,{"tileFrame":"solidFloor2"}],["b",1128,168,{"tileFrame":"solidFloor2"}],["b",1112,168,{"tileFrame":"solidFloor2"}],["b",1096,168,{"tileFrame":"solidFloor2"}],["b",1096,152,{"tileFrame":"solidFloor2"}],["b",1080,152,{"tileFrame":"solidFloor2"}],["b",1064,152,{"tileFrame":"solidFloor2"}],["b",1048,152,{"tileFrame":"solidFloor2"}],["b",1032,152,{"tileFrame":"solidFloor2"}],["b",1016,152,{"tileFrame":"solidFloor2"}],["b",1000,152,{"tileFrame":"solidFloor2"}],["b",1000,168,{"tileFrame":"solidFloor2"}],["b",984,168,{"tileFrame":"solidFloor2"}],["b",984,184,{"tileFrame":"solidFloor2"}],["b",984,200,{"tileFrame":"solidFloor2"}],["b",984,216,{"tileFrame":"solidFloor2"}],["b",984,232,{"tileFrame":"solidFloor2"}],["b",984,248,{"tileFrame":"solidFloor2"}],["b",984,264,{"tileFrame":"solidFloor2"}],["b",984,280,{"tileFrame":"solidFloor2"}],["b",984,296,{"tileFrame":"solidFloor2"}],["b",984,312,{"tileFrame":"solidFloor2"}],["b",984,328,{"tileFrame":"solidFloor2"}],["b",984,344,{"tileFrame":"solidFloor2"}],["b",1016,328,{"tileFrame":"solidFloor2"}],["b",1032,312,{"tileFrame":"solidFloor2"}],["b",1016,312,{"tileFrame":"solidFloor2"}],["b",1000,328,{"tileFrame":"solidFloor2"}],["b",1016,296,{"tileFrame":"solidFloor2"}],["b",1016,264,{"tileFrame":"solidFloor2"}],["b",1016,280,{"tileFrame":"solidFloor2"}],["b",1000,312,{"tileFrame":"solidFloor2"}],["b",1000,296,{"tileFrame":"solidFloor2"}],["b",1000,280,{"tileFrame":"solidFloor2"}],["b",1000,264,{"tileFrame":"solidFloor2"}],["b",1016,248,{"tileFrame":"solidFloor2"}],["b",1016,232,{"tileFrame":"solidFloor2"}],["b",1016,200,{"tileFrame":"solidFloor2"}],["b",1016,184,{"tileFrame":"solidFloor2"}],["b",1000,248,{"tileFrame":"solidFloor2"}],["b",1000,232,{"tileFrame":"solidFloor2"}],["b",1000,216,{"tileFrame":"solidFloor2"}],["b",1000,200,{"tileFrame":"solidFloor2"}],["b",1000,184,{"tileFrame":"solidFloor2"}],["b",1016,168,{"tileFrame":"solidFloor2"}],["b",1032,168,{"tileFrame":"solidFloor2"}],["b",1048,168,{"tileFrame":"solidFloor2"}],["b",1080,168,{"tileFrame":"solidFloor2"}],["b",1064,168,{"tileFrame":"solidFloor2"}],["b",1064,184,{"tileFrame":"solidFloor2"}],["b",1048,184,{"tileFrame":"solidFloor2"}],["b",1016,216,{"tileFrame":"solidFloor2"}],["b",1032,184,{"tileFrame":"solidFloor2"}],["b",1032,200,{"tileFrame":"solidFloor2"}],["b",1064,200,{"tileFrame":"solidFloor2"}],["b",1048,200,{"tileFrame":"solidFloor2"}],["b",1048,216,{"tileFrame":"solidFloor2"}],["b",1032,216,{"tileFrame":"solidFloor2"}],["b",1032,232,{"tileFrame":"solidFloor2"}],["b",1064,248,{"tileFrame":"solidFloor2"}],["b",1064,232,{"tileFrame":"solidFloor2"}],["b",1080,232,{"tileFrame":"solidFloor2"}],["b",1064,216,{"tileFrame":"solidFloor2"}],["b",1048,232,{"tileFrame":"solidFloor2"}],["b",1032,248,{"tileFrame":"solidFloor2"}],["b",1048,248,{"tileFrame":"solidFloor2"}],["b",1048,264,{"tileFrame":"solidFloor2"}],["b",1032,264,{"tileFrame":"solidFloor2"}],["b",1032,280,{"tileFrame":"solidFloor2"}],["b",1032,296,{"tileFrame":"solidFloor2"}],["b",1048,296,{"tileFrame":"solidFloor2"}],["b",1048,280,{"tileFrame":"solidFloor2"}],["b",1080,264,{"tileFrame":"solidFloor2"}],["b",1064,264,{"tileFrame":"solidFloor2"}],["b",1064,280,{"tileFrame":"solidFloor2"}],["b",1080,280,{"tileFrame":"solidFloor2"}],["b",1096,280,{"tileFrame":"solidFloor2"}],["b",1080,248,{"tileFrame":"solidFloor2"}],["b",1080,216,{"tileFrame":"solidFloor2"}],["b",1080,184,{"tileFrame":"solidFloor2"}],["b",1080,200,{"tileFrame":"solidFloor2"}],["b",1112,200,{"tileFrame":"solidFloor2"}],["b",1128,200,{"tileFrame":"solidFloor2"}],["b",1128,184,{"tileFrame":"solidFloor2"}],["b",1112,184,{"tileFrame":"solidFloor2"}],["b",1096,184,{"tileFrame":"solidFloor2"}],["b",1096,200,{"tileFrame":"solidFloor2"}],["b",1096,216,{"tileFrame":"solidFloor2"}],["b",1112,232,{"tileFrame":"solidFloor2"}],["b",1128,232,{"tileFrame":"solidFloor2"}],["b",1144,232,{"tileFrame":"solidFloor2"}],["b",1128,216,{"tileFrame":"solidFloor2"}],["b",1112,216,{"tileFrame":"solidFloor2"}],["b",1096,232,{"tileFrame":"solidFloor2"}],["b",1096,264,{"tileFrame":"solidFloor2"}],["b",1112,280,{"tileFrame":"solidFloor2"}],["b",1112,264,{"tileFrame":"solidFloor2"}],["b",1128,264,{"tileFrame":"solidFloor2"}],["b",1096,248,{"tileFrame":"solidFloor2"}],["b",1112,248,{"tileFrame":"solidFloor2"}],["b",1160,248,{"tileFrame":"solidFloor2"}],["b",1176,248,{"tileFrame":"solidFloor2"}],["b",1128,248,{"tileFrame":"solidFloor2"}],["b",1144,248,{"tileFrame":"solidFloor2"}],["b",1160,232,{"tileFrame":"solidFloor2"}],["b",1176,232,{"tileFrame":"solidFloor2"}],["b",1144,216,{"tileFrame":"solidFloor2"}],["b",1160,216,{"tileFrame":"solidFloor2"}],["b",1160,168,{"tileFrame":"solidFloor2"}],["b",1144,168,{"tileFrame":"solidFloor2"}],["b",1144,200,{"tileFrame":"solidFloor2"}],["b",1144,184,{"tileFrame":"solidFloor2"}],["b",1160,184,{"tileFrame":"solidFloor2"}],["b",1208,184,{"tileFrame":"solidFloor2"}],["b",1192,184,{"tileFrame":"solidFloor2"}],["b",1176,184,{"tileFrame":"solidFloor2"}],["b",1208,200,{"tileFrame":"solidFloor2"}],["b",1160,200,{"tileFrame":"solidFloor2"}],["b",1176,200,{"tileFrame":"solidFloor2"}],["b",1192,200,{"tileFrame":"solidFloor2"}],["b",1192,232,{"tileFrame":"solidFloor2"}],["b",1208,232,{"tileFrame":"solidFloor2"}],["b",1224,232,{"tileFrame":"solidFloor2"}],["b",1240,232,{"tileFrame":"solidFloor2"}],["b",1256,232,{"tileFrame":"solidFloor2"}],["b",1272,232,{"tileFrame":"solidFloor2"}],["b",1288,232,{"tileFrame":"solidFloor2"}],["b",1304,232,{"tileFrame":"solidFloor2"}],["b",1320,232,{"tileFrame":"solidFloor2"}],["b",1336,232,{"tileFrame":"solidFloor2"}],["b",1352,232,{"tileFrame":"solidFloor2"}],["b",1672,232,{"tileFrame":"solidFloor2"}],["b",1640,232,{"tileFrame":"solidFloor2"}],["b",1624,232,{"tileFrame":"solidFloor2"}],["b",1608,232,{"tileFrame":"solidFloor2"}],["b",1592,232,{"tileFrame":"solidFloor2"}],["b",1576,232,{"tileFrame":"solidFloor2"}],["b",1560,232,{"tileFrame":"solidFloor2"}],["b",1544,232,{"tileFrame":"solidFloor2"}],["b",1528,232,{"tileFrame":"solidFloor2"}],["b",1512,232,{"tileFrame":"solidFloor2"}],["b",1496,232,{"tileFrame":"solidFloor2"}],["b",1480,232,{"tileFrame":"solidFloor2"}],["b",1464,232,{"tileFrame":"solidFloor2"}],["b",1448,232,{"tileFrame":"solidFloor2"}],["b",1432,232,{"tileFrame":"solidFloor2"}],["b",1416,232,{"tileFrame":"solidFloor2"}],["b",1400,232,{"tileFrame":"solidFloor2"}],["b",1384,232,{"tileFrame":"solidFloor2"}],["b",1368,232,{"tileFrame":"solidFloor2"}],["b",1176,216,{"tileFrame":"solidFloor2"}],["b",1192,216,{"tileFrame":"solidFloor2"}],["b",1208,216,{"tileFrame":"solidFloor2"}],["b",1224,216,{"tileFrame":"solidFloor2"}],["b",1240,216,{"tileFrame":"solidFloor2"}],["b",1256,216,{"tileFrame":"solidFloor2"}],["b",1272,216,{"tileFrame":"solidFloor2"}],["b",1416,216,{"tileFrame":"solidFloor2"}],["b",1432,216,{"tileFrame":"solidFloor2"}],["b",1448,216,{"tileFrame":"solidFloor2"}],["b",1464,216,{"tileFrame":"solidFloor2"}],["b",1480,216,{"tileFrame":"solidFloor2"}],["b",1496,216,{"tileFrame":"solidFloor2"}],["b",1512,216,{"tileFrame":"solidFloor2"}],["b",1528,216,{"tileFrame":"solidFloor2"}],["b",1544,216,{"tileFrame":"solidFloor2"}],["b",1656,232,{"tileFrame":"solidFloor2"}],["b",1672,216,{"tileFrame":"solidFloor2"}],["b",1656,216,{"tileFrame":"solidFloor2"}],["b",1640,216,{"tileFrame":"solidFloor2"}],["b",1624,216,{"tileFrame":"solidFloor2"}],["b",1608,216,{"tileFrame":"solidFloor2"}],["b",1576,216,{"tileFrame":"solidFloor2"}],["b",1400,200,{"tileFrame":"solidFloor2"}],["b",1384,200,{"tileFrame":"solidFloor2"}],["b",1368,200,{"tileFrame":"solidFloor2"}],["b",1352,200,{"tileFrame":"solidFloor2"}],["b",1400,216,{"tileFrame":"solidFloor2"}],["b",1384,216,{"tileFrame":"solidFloor2"}],["b",1368,216,{"tileFrame":"solidFloor2"}],["b",1352,216,{"tileFrame":"solidFloor2"}],["b",1336,216,{"tileFrame":"solidFloor2"}],["b",1320,216,{"tileFrame":"solidFloor2"}],["b",1304,216,{"tileFrame":"solidFloor2"}],["b",1288,216,{"tileFrame":"solidFloor2"}],["b",1240,200,{"tileFrame":"solidFloor2"}],["b",1224,200,{"tileFrame":"solidFloor2"}],["b",1224,184,{"tileFrame":"solidFloor2"}],["b",1240,184,{"tileFrame":"solidFloor2"}],["b",1288,184,{"tileFrame":"solidFloor2"}],["b",1272,184,{"tileFrame":"solidFloor2"}],["b",1256,184,{"tileFrame":"solidFloor2"}],["b",1256,200,{"tileFrame":"solidFloor2"}],["b",1272,200,{"tileFrame":"solidFloor2"}],["b",1288,200,{"tileFrame":"solidFloor2"}],["b",1304,200,{"tileFrame":"solidFloor2"}],["b",1320,200,{"tileFrame":"solidFloor2"}],["b",1336,200,{"tileFrame":"solidFloor2"}],["b",1304,184,{"tileFrame":"solidFloor2"}],["b",1320,184,{"tileFrame":"solidFloor2"}],["b",1336,184,{"tileFrame":"solidFloor2"}],["b",1352,184,{"tileFrame":"solidFloor2"}],["b",1368,184,{"tileFrame":"solidFloor2"}],["b",1384,184,{"tileFrame":"solidFloor2"}],["b",1400,184,{"tileFrame":"solidFloor2"}],["b",1416,184,{"tileFrame":"solidFloor2"}],["b",1432,184,{"tileFrame":"solidFloor2"}],["b",1480,184,{"tileFrame":"solidFloor2"}],["b",1496,184,{"tileFrame":"solidFloor2"}],["b",1464,184,{"tileFrame":"solidFloor2"}],["b",1448,184,{"tileFrame":"solidFloor2"}],["b",1416,200,{"tileFrame":"solidFloor2"}],["b",1432,200,{"tileFrame":"solidFloor2"}],["b",1448,200,{"tileFrame":"solidFloor2"}],["b",1464,200,{"tileFrame":"solidFloor2"}],["b",1480,200,{"tileFrame":"solidFloor2"}],["b",1496,200,{"tileFrame":"solidFloor2"}],["b",1512,200,{"tileFrame":"solidFloor2"}],["b",1528,200,{"tileFrame":"solidFloor2"}],["b",1544,200,{"tileFrame":"solidFloor2"}],["b",1576,200,{"tileFrame":"solidFloor2"}],["b",1656,184,{"tileFrame":"solidFloor2"}],["b",1640,184,{"tileFrame":"solidFloor2"}],["b",1512,184,{"tileFrame":"solidFloor2"}],["b",1528,184,{"tileFrame":"solidFloor2"}],["b",1544,184,{"tileFrame":"solidFloor2"}],["b",1560,184,{"tileFrame":"solidFloor2"}],["b",1528,168,{"tileFrame":"solidFloor2"}],["b",1544,168,{"tileFrame":"solidFloor2"}],["b",1560,168,{"tileFrame":"solidFloor2"}],["b",1576,168,{"tileFrame":"solidFloor2"}],["b",1592,168,{"tileFrame":"solidFloor2"}],["b",1608,168,{"tileFrame":"solidFloor2"}],["b",1624,168,{"tileFrame":"solidFloor2"}],["b",1624,184,{"tileFrame":"solidFloor2"}],["b",1608,184,{"tileFrame":"solidFloor2"}],["b",1592,184,{"tileFrame":"solidFloor2"}],["b",1576,184,{"tileFrame":"solidFloor2"}],["b",1560,200,{"tileFrame":"solidFloor2"}],["b",1560,216,{"tileFrame":"solidFloor2"}],["b",1592,216,{"tileFrame":"solidFloor2"}],["b",1592,200,{"tileFrame":"solidFloor2"}],["b",1608,200,{"tileFrame":"solidFloor2"}],["b",1624,200,{"tileFrame":"solidFloor2"}],["b",1640,200,{"tileFrame":"solidFloor2"}],["b",1656,200,{"tileFrame":"solidFloor2"}],["b",1672,200,{"tileFrame":"solidFloor2"}],["b",1672,184,{"tileFrame":"solidFloor2"}],["b",1688,184,{"tileFrame":"solidFloor2"}],["b",1704,184,{"tileFrame":"solidFloor2"}],["b",1720,184,{"tileFrame":"solidFloor2"}],["b",1736,184,{"tileFrame":"solidFloor2"}],["b",1816,200,{"tileFrame":"solidFloor2"}],["b",1832,200,{"tileFrame":"solidFloor2"}],["b",1864,184,{"tileFrame":"solidFloor2"}],["b",1848,184,{"tileFrame":"solidFloor2"}],["b",1832,184,{"tileFrame":"solidFloor2"}],["b",1816,184,{"tileFrame":"solidFloor2"}],["b",1800,184,{"tileFrame":"solidFloor2"}],["b",1784,184,{"tileFrame":"solidFloor2"}],["b",1768,184,{"tileFrame":"solidFloor2"}],["b",1752,184,{"tileFrame":"solidFloor2"}],["b",1720,200,{"tileFrame":"solidFloor2"}],["b",1704,200,{"tileFrame":"solidFloor2"}],["b",1688,200,{"tileFrame":"solidFloor2"}],["b",1688,232,{"tileFrame":"solidFloor2"}],["b",1704,232,{"tileFrame":"solidFloor2"}],["b",1688,248,{"tileFrame":"solidFloor2"}],["b",1704,248,{"tileFrame":"solidFloor2"}],["b",1720,248,{"tileFrame":"solidFloor2"}],["b",1704,264,{"tileFrame":"solidFloor2"}],["b",1720,264,{"tileFrame":"solidFloor2"}],["b",1736,264,{"tileFrame":"solidFloor2"}],["b",1736,280,{"tileFrame":"solidFloor2"}],["b",1752,280,{"tileFrame":"solidFloor2"}],["b",1768,280,{"tileFrame":"solidFloor2"}],["b",1784,280,{"tileFrame":"solidFloor2"}],["b",1816,280,{"tileFrame":"solidFloor2"}],["b",1800,280,{"tileFrame":"solidFloor2"}],["b",1800,296,{"tileFrame":"solidFloor2"}],["b",1816,296,{"tileFrame":"solidFloor2"}],["b",1832,296,{"tileFrame":"solidFloor2"}],["b",1848,296,{"tileFrame":"solidFloor2"}],["b",1848,312,{"tileFrame":"solidFloor2"}],["b",1864,312,{"tileFrame":"solidFloor2"}],["b",1864,296,{"tileFrame":"solidFloor2"}],["b",1864,280,{"tileFrame":"solidFloor2"}],["b",1864,264,{"tileFrame":"solidFloor2"}],["b",1864,248,{"tileFrame":"solidFloor2"}],["b",1864,232,{"tileFrame":"solidFloor2"}],["b",1864,216,{"tileFrame":"solidFloor2"}],["b",1864,200,{"tileFrame":"solidFloor2"}],["b",1848,200,{"tileFrame":"solidFloor2"}],["b",1848,216,{"tileFrame":"solidFloor2"}],["b",1688,216,{"tileFrame":"solidFloor2"}],["b",1704,216,{"tileFrame":"solidFloor2"}],["b",1768,216,{"tileFrame":"solidFloor2"}],["b",1784,216,{"tileFrame":"solidFloor2"}],["b",1800,216,{"tileFrame":"solidFloor2"}],["b",1832,216,{"tileFrame":"solidFloor2"}],["b",1816,216,{"tileFrame":"solidFloor2"}],["b",1800,200,{"tileFrame":"solidFloor2"}],["b",1784,200,{"tileFrame":"solidFloor2"}],["b",1768,200,{"tileFrame":"solidFloor2"}],["b",1752,200,{"tileFrame":"solidFloor2"}],["b",1736,200,{"tileFrame":"solidFloor2"}],["b",1736,216,{"tileFrame":"solidFloor2"}],["b",1720,216,{"tileFrame":"solidFloor2"}],["b",1720,232,{"tileFrame":"solidFloor2"}],["b",1736,232,{"tileFrame":"solidFloor2"}],["b",1736,248,{"tileFrame":"solidFloor2"}],["b",1752,264,{"tileFrame":"solidFloor2"}],["b",1752,248,{"tileFrame":"solidFloor2"}],["b",1752,216,{"tileFrame":"solidFloor2"}],["b",1752,232,{"tileFrame":"solidFloor2"}],["b",1768,232,{"tileFrame":"solidFloor2"}],["b",1784,232,{"tileFrame":"solidFloor2"}],["b",1800,232,{"tileFrame":"solidFloor2"}],["b",1816,232,{"tileFrame":"solidFloor2"}],["b",1832,232,{"tileFrame":"solidFloor2"}],["b",1848,232,{"tileFrame":"solidFloor2"}],["b",1848,264,{"tileFrame":"solidFloor2"}],["b",1848,280,{"tileFrame":"solidFloor2"}],["b",1832,280,{"tileFrame":"solidFloor2"}],["b",1832,264,{"tileFrame":"solidFloor2"}],["b",1816,264,{"tileFrame":"solidFloor2"}],["b",1800,264,{"tileFrame":"solidFloor2"}],["b",1784,264,{"tileFrame":"solidFloor2"}],["b",1768,264,{"tileFrame":"solidFloor2"}],["b",1768,248,{"tileFrame":"solidFloor2"}],["b",1784,248,{"tileFrame":"solidFloor2"}],["b",1800,248,{"tileFrame":"solidFloor2"}],["b",1816,248,{"tileFrame":"solidFloor2"}],["b",1832,248,{"tileFrame":"solidFloor2"}],["b",1848,248,{"tileFrame":"solidFloor2"}],["b",440,200,{"tileFrame":"solidFloor2"}],["b",648,200,{"tileFrame":"solidFloor2"}],["b",664,200,{"tileFrame":"solidFloor2"}],["b",696,200,{"tileFrame":"solidFloor2"}],["b",712,200,{"tileFrame":"solidFloor2"}],["b",744,200,{"tileFrame":"solidFloor2"}],["b",792,200,{"tileFrame":"solidFloor2"}],["b",776,200,{"tileFrame":"solidFloor2"}],["b",760,200,{"tileFrame":"solidFloor2"}],["b",728,200,{"tileFrame":"solidFloor2"}],["b",680,200,{"tileFrame":"solidFloor2"}],["b",456,200,{"tileFrame":"solidFloor2"}],["b",504,200,{"tileFrame":"solidFloor2"}],["b",488,200,{"tileFrame":"solidFloor2"}],["b",488,232,{"tileFrame":"solidFloor2"}],["b",504,216,{"tileFrame":"solidFloor2"}],["b",488,216,{"tileFrame":"solidFloor2"}],["b",472,200,{"tileFrame":"solidFloor2"}],["b",456,216,{"tileFrame":"solidFloor2"}],["b",472,216,{"tileFrame":"solidFloor2"}],["b",472,232,{"tileFrame":"solidFloor2"}],["b",488,248,{"tileFrame":"solidFloor2"}],["b",504,232,{"tileFrame":"solidFloor2"}],["b",504,248,{"tileFrame":"solidFloor2"}],["b",520,248,{"tileFrame":"solidFloor2"}],["b",520,216,{"tileFrame":"solidFloor2"}],["b",520,232,{"tileFrame":"solidFloor2"}],["b",536,232,{"tileFrame":"solidFloor2"}],["b",536,264,{"tileFrame":"solidFloor2"}],["b",536,248,{"tileFrame":"solidFloor2"}],["b",552,264,{"tileFrame":"solidFloor2"}],["b",568,264,{"tileFrame":"solidFloor2"}],["b",584,264,{"tileFrame":"solidFloor2"}],["b",536,200,{"tileFrame":"solidFloor2"}],["b",552,200,{"tileFrame":"solidFloor2"}],["b",568,200,{"tileFrame":"solidFloor2"}],["b",552,184,{"tileFrame":"solidFloor2"}],["b",536,184,{"tileFrame":"solidFloor2"}],["b",520,184,{"tileFrame":"solidFloor2"}],["b",520,200,{"tileFrame":"solidFloor2"}],["b",536,216,{"tileFrame":"solidFloor2"}],["b",584,200,{"tileFrame":"solidFloor2"}],["b",552,248,{"tileFrame":"solidFloor2"}],["b",568,216,{"tileFrame":"solidFloor2"}],["b",552,216,{"tileFrame":"solidFloor2"}],["b",552,232,{"tileFrame":"solidFloor2"}],["b",568,248,{"tileFrame":"solidFloor2"}],["b",600,200,{"tileFrame":"solidFloor2"}],["b",568,232,{"tileFrame":"solidFloor2"}],["b",584,232,{"tileFrame":"solidFloor2"}],["b",584,216,{"tileFrame":"solidFloor2"}],["b",632,184,{"tileFrame":"solidFloor2"}],["b",632,200,{"tileFrame":"solidFloor2"}],["b",616,200,{"tileFrame":"solidFloor2"}],["b",600,216,{"tileFrame":"solidFloor2"}],["b",600,264,{"tileFrame":"solidFloor2"}],["b",648,232,{"tileFrame":"solidFloor2"}],["b",616,232,{"tileFrame":"solidFloor2"}],["b",664,232,{"tileFrame":"solidFloor2"}],["b",632,232,{"tileFrame":"solidFloor2"}],["b",600,232,{"tileFrame":"solidFloor2"}],["b",584,248,{"tileFrame":"solidFloor2"}],["b",600,248,{"tileFrame":"solidFloor2"}],["b",648,248,{"tileFrame":"solidFloor2"}],["b",616,248,{"tileFrame":"solidFloor2"}],["b",664,280,{"tileFrame":"solidFloor2"}],["b",632,248,{"tileFrame":"solidFloor2"}],["b",632,264,{"tileFrame":"solidFloor2"}],["b",616,264,{"tileFrame":"solidFloor2"}],["b",632,280,{"tileFrame":"solidFloor2"}],["b",648,280,{"tileFrame":"solidFloor2"}],["b",680,280,{"tileFrame":"solidFloor2"}],["b",696,248,{"tileFrame":"solidFloor2"}],["b",664,248,{"tileFrame":"solidFloor2"}],["b",648,264,{"tileFrame":"solidFloor2"}],["b",664,264,{"tileFrame":"solidFloor2"}],["b",728,232,{"tileFrame":"solidFloor2"}],["b",696,232,{"tileFrame":"solidFloor2"}],["b",680,232,{"tileFrame":"solidFloor2"}],["b",680,248,{"tileFrame":"solidFloor2"}],["b",680,264,{"tileFrame":"solidFloor2"}],["b",696,264,{"tileFrame":"solidFloor2"}],["b",712,280,{"tileFrame":"solidFloor2"}],["b",776,232,{"tileFrame":"solidFloor2"}],["b",712,232,{"tileFrame":"solidFloor2"}],["b",808,248,{"tileFrame":"solidFloor2"}],["b",760,232,{"tileFrame":"solidFloor2"}],["b",728,248,{"tileFrame":"solidFloor2"}],["b",712,248,{"tileFrame":"solidFloor2"}],["b",712,264,{"tileFrame":"solidFloor2"}],["b",728,264,{"tileFrame":"solidFloor2"}],["b",744,264,{"tileFrame":"solidFloor2"}],["b",760,264,{"tileFrame":"solidFloor2"}],["b",776,248,{"tileFrame":"solidFloor2"}],["b",744,232,{"tileFrame":"solidFloor2"}],["b",744,248,{"tileFrame":"solidFloor2"}],["b",760,248,{"tileFrame":"solidFloor2"}],["b",792,248,{"tileFrame":"solidFloor2"}],["b",840,216,{"tileFrame":"solidFloor2"}],["b",792,232,{"tileFrame":"solidFloor2"}],["b",808,232,{"tileFrame":"solidFloor2"}],["b",824,232,{"tileFrame":"solidFloor2"}],["b",840,232,{"tileFrame":"solidFloor2"}],["b",888,216,{"tileFrame":"solidFloor2"}],["b",920,168,{"tileFrame":"solidFloor2"}],["b",920,184,{"tileFrame":"solidFloor2"}],["b",920,200,{"tileFrame":"solidFloor2"}],["b",920,216,{"tileFrame":"solidFloor2"}],["b",904,216,{"tileFrame":"solidFloor2"}],["b",904,184,{"tileFrame":"solidFloor2"}],["b",904,168,{"tileFrame":"solidFloor2"}],["b",888,168,{"tileFrame":"solidFloor2"}],["b",856,184,{"tileFrame":"solidFloor2"}],["b",856,216,{"tileFrame":"solidFloor2"}],["b",872,216,{"tileFrame":"solidFloor2"}],["b",808,216,{"tileFrame":"solidFloor2"}],["b",824,216,{"tileFrame":"solidFloor2"}],["b",872,200,{"tileFrame":"solidFloor2"}],["b",904,200,{"tileFrame":"solidFloor2"}],["b",888,200,{"tileFrame":"solidFloor2"}],["b",888,184,{"tileFrame":"solidFloor2"}],["b",872,184,{"tileFrame":"solidFloor2"}],["b",856,200,{"tileFrame":"solidFloor2"}],["b",840,200,{"tileFrame":"solidFloor2"}],["b",824,200,{"tileFrame":"solidFloor2"}],["b",808,200,{"tileFrame":"solidFloor2"}],["b",792,216,{"tileFrame":"solidFloor2"}],["b",776,216,{"tileFrame":"solidFloor2"}],["b",760,216,{"tileFrame":"solidFloor2"}],["b",744,216,{"tileFrame":"solidFloor2"}],["b",728,216,{"tileFrame":"solidFloor2"}],["b",712,216,{"tileFrame":"solidFloor2"}],["b",696,216,{"tileFrame":"solidFloor2"}],["b",680,216,{"tileFrame":"solidFloor2"}],["b",664,216,{"tileFrame":"solidFloor2"}],["b",616,216,{"tileFrame":"solidFloor2"}],["b",632,216,{"tileFrame":"solidFloor2"}],["b",648,216,{"tileFrame":"solidFloor2"}],["b",680,168,{"tileFrame":"solidFloor2"}],["b",696,168,{"tileFrame":"solidFloor2"}],["b",648,184,{"tileFrame":"solidFloor2"}],["b",664,184,{"tileFrame":"solidFloor2"}],["b",680,184,{"tileFrame":"solidFloor2"}],["b",696,184,{"tileFrame":"solidFloor2"}],["b",712,184,{"tileFrame":"solidFloor2"}],["b",728,184,{"tileFrame":"solidFloor2"}],["b",744,184,{"tileFrame":"solidFloor2"}],["b",760,184,{"tileFrame":"solidFloor2"}],["b",776,184,{"tileFrame":"solidFloor2"}],["b",712,168,{"tileFrame":"solidFloor2"}],["d",2184,88,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,104,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,120,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,136,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,152,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,168,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,184,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,200,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,216,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,232,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,248,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,264,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2184,280,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",2440,40,{"tileFrame":"clutterBrownCastleSmall"}],["d",2488,40,{"tileFrame":"clutterTreebark"}],["d",2456,40,{"tileFrame":"clutterTreebark"}],["d",2456,24,{"tileFrame":"clutterTree"}],["d",2488,24,{"tileFrame":"clutterTreebottom"}],["d",2488,8,{"tileFrame":"clutterTreetop"}],["d",2504,40,{"tileFrame":"clutterFence"}],["d",2520,40,{"tileFrame":"clutterFence"}],["d",2536,40,{"tileFrame":"clutterFence"}],["d",2552,40,{"tileFrame":"clutterFence"}],["r",2504,-8,{"tileFrame":"brick1"}],["r",2536,-8,{"tileFrame":"brick1"}],["q",2520,-8,{"tileFrame":"blockBrick1Powerup"}],["d",2728,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",2968,-120,{"tileFrame":"clutterBgCloudSmall"}],["d",2872,40,{"tileFrame":"clutterFence"}],["d",2888,40,{"tileFrame":"clutterFence"}],["d",2920,40,{"tileFrame":"clutterFence"}],["d",2904,24,{"tileFrame":"clutterTree"}],["d",2952,24,{"tileFrame":"clutterTreebottom"}],["d",2952,8,{"tileFrame":"clutterTreetop"}],["d",3400,40,{"tileFrame":"clutterTreebark"}],["d",3416,40,{"tileFrame":"clutterTreebark"}],["d",3400,24,{"tileFrame":"clutterTree"}],["d",3416,24,{"tileFrame":"clutterTree"}],["d",3368,24,{"tileFrame":"clutterTreebottom"}],["d",3368,8,{"tileFrame":"clutterTreetop"}],["d",3304,40,{"tileFrame":"clutterFence"}],["d",3288,40,{"tileFrame":"clutterFence"}],["d",3272,40,{"tileFrame":"clutterFence"}],["d",3256,40,{"tileFrame":"clutterFence"}],["d",3240,40,{"tileFrame":"clutterTreebark"}],["d",3240,24,{"tileFrame":"clutterTreebottom"}],["d",3240,8,{"tileFrame":"clutterTreetop"}],["d",3208,24,{"tileFrame":"clutterTree"}],["d",2904,40,{"tileFrame":"clutterFence"}],["d",3672,24,{"tileFrame":"clutterTreebottom"}],["d",3672,8,{"tileFrame":"clutterTreetop"}],["d",3624,40,{"tileFrame":"clutterTreebark"}],["d",3624,24,{"tileFrame":"clutterTree"}],["d",3640,40,{"tileFrame":"clutterFence"}],["d",3608,40,{"tileFrame":"clutterFence"}],["d",3592,40,{"tileFrame":"clutterFence"}],["d",4056,40,{"tileFrame":"clutterTreebark"}],["d",4056,24,{"tileFrame":"clutterTreebottom"}],["d",4056,8,{"tileFrame":"clutterTreetop"}],["d",4136,40,{"tileFrame":"clutterTreebark"}],["d",4168,40,{"tileFrame":"clutterTreebark"}],["d",4200,40,{"tileFrame":"clutterTreebark"}],["d",4168,24,{"tileFrame":"clutterTree"}],["d",4200,24,{"tileFrame":"clutterTree"}],["d",4136,24,{"tileFrame":"clutterTreebottom"}],["d",4136,8,{"tileFrame":"clutterTreetop"}],["d",4440,40,{"tileFrame":"clutterFence"}],["d",4424,40,{"tileFrame":"clutterFence"}],["d",4408,40,{"tileFrame":"clutterFence"}],["d",4424,24,{"tileFrame":"clutterTree"}],["d",4792,40,{"tileFrame":"clutterFence"}],["d",4808,40,{"tileFrame":"clutterFence"}],["d",4824,40,{"tileFrame":"clutterFence"}],["d",4840,40,{"tileFrame":"clutterFence"}],["d",4776,40,{"tileFrame":"clutterTreebark"}],["d",4776,24,{"tileFrame":"clutterTreebottom"}],["d",4776,8,{"tileFrame":"clutterTreetop"}],["d",4904,40,{"tileFrame":"clutterTreebark"}],["d",4904,24,{"tileFrame":"clutterTreebottom"}],["d",4904,8,{"tileFrame":"clutterTreetop"}],["d",4952,40,{"tileFrame":"clutterTreebark"}],["d",4984,40,{"tileFrame":"clutterTreebark"}],["d",4952,24,{"tileFrame":"clutterTree"}],["d",4984,24,{"tileFrame":"clutterTree"}],["d",5224,40,{"tileFrame":"clutterFence"}],["d",5192,40,{"tileFrame":"clutterFence"}],["d",5176,40,{"tileFrame":"clutterFence"}],["d",5208,40,{"tileFrame":"clutterTreebark"}],["d",5208,24,{"tileFrame":"clutterTree"}],["d",5256,24,{"tileFrame":"clutterTreebottom"}],["d",5256,8,{"tileFrame":"clutterTreetop"}],["d",5256,40,{"tileFrame":"clutterTreebark"}],["d",3176,-104,{"tileFrame":"clutterBgCloud"}],["d",3400,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",3704,-120,{"tileFrame":"clutterBgCloudSmall"}],["d",3912,-104,{"tileFrame":"clutterBgCloud"}],["d",4360,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",4680,-120,{"tileFrame":"clutterBgCloudSmall"}],["d",4904,-104,{"tileFrame":"clutterBgCloud"}],["d",5224,-104,{"tileFrame":"clutterBgCloudSmall"}],["r",4008,120,{"tileFrame":"brickBottom2"}],["r",4024,120,{"tileFrame":"brickBottom2"}],["r",3944,120,{"tileFrame":"brickBottom2"}],["r",3928,120,{"tileFrame":"brickBottom2"}],["r",3960,120,{"tileFrame":"brickBottom2"}],["r",3976,120,{"tileFrame":"brickBottom2"}],["r",3992,120,{"tileFrame":"brickBottom2"}],["r",3864,120,{"tileFrame":"brickBottom2"}],["b",3848,88],["b",3848,104],["r",3864,136,{"tileFrame":"brickBottom2"}],["r",3864,152,{"tileFrame":"brickBottom2"}],["r",3864,184,{"tileFrame":"brickBottom2"}],["r",3864,168,{"tileFrame":"brickBottom2"}],["r",3864,200,{"tileFrame":"brickBottom2"}],["r",3864,216,{"tileFrame":"brickBottom2"}],["r",3864,232,{"tileFrame":"brickBottom2"}],["r",3864,248,{"tileFrame":"brickBottom2"}],["r",3864,264,{"tileFrame":"brickBottom2"}],["r",3864,280,{"tileFrame":"brickBottom2"}],["r",3928,248,{"tileFrame":"brickBottom2"}],["r",3928,264,{"tileFrame":"brickBottom2"}],["r",3928,280,{"tileFrame":"brickBottom2"}],["r",3944,248,{"tileFrame":"brickBottom2"}],["r",3960,248,{"tileFrame":"brickBottom2"}],["r",3976,248,{"tileFrame":"brickBottom2"}],["r",3992,248,{"tileFrame":"brickBottom2"}],["r",4008,248,{"tileFrame":"brickBottom2"}],["r",4024,248,{"tileFrame":"brickBottom2"}],["r",4024,264,{"tileFrame":"brickBottom2"}],["r",4024,280,{"tileFrame":"brickBottom2"}],["r",4008,280,{"tileFrame":"brickBottom2"}],["r",3992,280,{"tileFrame":"brickBottom2"}],["r",3976,280,{"tileFrame":"brickBottom2"}],["r",3960,280,{"tileFrame":"brickBottom2"}],["r",3944,280,{"tileFrame":"brickBottom2"}],["r",3944,264,{"tileFrame":"brickBottom2"}],["r",3960,264,{"tileFrame":"brickBottom2"}],["r",3976,264,{"tileFrame":"brickBottom2"}],["r",3992,264,{"tileFrame":"brickBottom2"}],["r",4008,264,{"tileFrame":"brickBottom2"}],["b",3864,296,{"tileFrame":"solidFloor2"}],["b",3880,296,{"tileFrame":"solidFloor2"}],["b",3896,296,{"tileFrame":"solidFloor2"}],["b",3912,296,{"tileFrame":"solidFloor2"}],["b",3928,296,{"tileFrame":"solidFloor2"}],["b",3944,296,{"tileFrame":"solidFloor2"}],["b",3960,296,{"tileFrame":"solidFloor2"}],["b",3976,296,{"tileFrame":"solidFloor2"}],["b",3992,296,{"tileFrame":"solidFloor2"}],["b",4008,296,{"tileFrame":"solidFloor2"}],["b",4024,296,{"tileFrame":"solidFloor2"}],["b",4040,296,{"tileFrame":"solidFloor2"}],["b",4056,296,{"tileFrame":"solidFloor2"}],["b",3864,312,{"tileFrame":"solidFloor2"}],["b",3880,312,{"tileFrame":"solidFloor2"}],["b",3896,312,{"tileFrame":"solidFloor2"}],["b",3912,312,{"tileFrame":"solidFloor2"}],["b",3928,312,{"tileFrame":"solidFloor2"}],["b",3944,312,{"tileFrame":"solidFloor2"}],["b",3960,312,{"tileFrame":"solidFloor2"}],["b",3976,312,{"tileFrame":"solidFloor2"}],["b",3992,312,{"tileFrame":"solidFloor2"}],["b",4008,312,{"tileFrame":"solidFloor2"}],["b",4024,312,{"tileFrame":"solidFloor2"}],["b",4040,312,{"tileFrame":"solidFloor2"}],["b",4056,312,{"tileFrame":"solidFloor2"}],["b",4072,312,{"tileFrame":"solidFloor2"}],["b",4088,312,{"tileFrame":"solidFloor2"}],["b",4104,312,{"tileFrame":"solidFloor2"}],["b",4120,312,{"tileFrame":"solidFloor2"}],["b",4072,280,{"tileFrame":"solidGreenPipeLeftmostExitS"}],["b",4072,264,{"tileFrame":"solidGreenPipeLeftmostExitN"}],["b",4088,264,{"tileFrame":"solidGreenPipeHorizontalBodyN"}],["b",4088,280,{"tileFrame":"solidGreenPipeHorizontalBodyS"}],["b",4104,264,{"tileFrame":"solidGreenPipeConnectorNW"}],["b",4104,280,{"tileFrame":"solidGreenPipeConnectorSW"}],["b",4104,248,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,232,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,216,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,200,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,184,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,168,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,152,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,136,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,120,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,104,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4104,88,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",4072,296,{"tileFrame":"solidFloor2"}],["b",4088,296,{"tileFrame":"solidFloor2"}],["b",4104,296,{"tileFrame":"solidFloor2"}],["b",4120,296,{"tileFrame":"solidFloor2"}],["b",4120,280,{"tileFrame":"solidFloor2"}],["b",4120,264,{"tileFrame":"solidFloor2"}],["b",4120,248,{"tileFrame":"solidFloor2"}],["b",4120,232,{"tileFrame":"solidFloor2"}],["b",4120,216,{"tileFrame":"solidFloor2"}],["b",4120,200,{"tileFrame":"solidFloor2"}],["b",4120,184,{"tileFrame":"solidFloor2"}],["b",4120,168,{"tileFrame":"solidFloor2"}],["b",4120,152,{"tileFrame":"solidFloor2"}],["b",4120,136,{"tileFrame":"solidFloor2"}],["b",4120,120],["b",4120,104],["b",4120,88],["b",4136,120],["b",4152,120],["b",4168,120],["b",4184,120],["b",4200,136],["b",4216,136],["b",4232,136],["b",4248,136],["b",4264,136],["b",4264,120],["b",4280,120],["b",4296,120],["b",4312,120],["b",4328,120],["b",4344,104],["b",4360,104],["b",4360,88],["b",4376,88],["b",4344,88],["b",4328,88],["b",4312,88],["b",4296,88],["b",4280,88],["b",4264,88],["b",4248,88],["b",4232,88],["b",4216,88],["b",4200,88],["b",4184,88],["b",4168,88],["b",4152,88],["b",4136,88],["b",4136,104],["b",4152,104],["b",4168,104],["b",4184,104],["b",4200,104],["b",4216,104],["b",4232,104],["b",4248,104],["b",4264,104],["b",4280,104],["b",4296,104],["b",4312,104],["b",4328,104],["b",4232,120],["b",4216,120],["b",4248,120],["b",4200,120],["b",3800,88],["b",3800,104],["b",3800,120],["b",3800,136],["b",3816,120],["b",3832,104],["b",3832,88],["b",3816,88],["b",3816,104],["b",3848,120,{"tileFrame":"solidFloor2"}],["b",3848,136,{"tileFrame":"solidFloor2"}],["b",3848,152,{"tileFrame":"solidFloor2"}],["b",3848,168,{"tileFrame":"solidFloor2"}],["b",3848,184,{"tileFrame":"solidFloor2"}],["b",3848,200,{"tileFrame":"solidFloor2"}],["b",3848,216,{"tileFrame":"solidFloor2"}],["b",3848,232,{"tileFrame":"solidFloor2"}],["b",3848,248,{"tileFrame":"solidFloor2"}],["b",3848,264,{"tileFrame":"solidFloor2"}],["b",3848,280,{"tileFrame":"solidFloor2"}],["b",3848,296,{"tileFrame":"solidFloor2"}],["b",3848,312,{"tileFrame":"solidFloor2"}],["b",3832,312,{"tileFrame":"solidFloor2"}],["b",3816,312,{"tileFrame":"solidFloor2"}],["b",3800,312,{"tileFrame":"solidFloor2"}],["b",3800,296,{"tileFrame":"solidFloor2"}],["b",3800,280,{"tileFrame":"solidFloor2"}],["b",3800,264,{"tileFrame":"solidFloor2"}],["b",3800,248,{"tileFrame":"solidFloor2"}],["b",3800,232,{"tileFrame":"solidFloor2"}],["b",3800,216,{"tileFrame":"solidFloor2"}],["b",3800,200,{"tileFrame":"solidFloor2"}],["b",3800,184,{"tileFrame":"solidFloor2"}],["b",3800,168,{"tileFrame":"solidFloor2"}],["b",3800,152,{"tileFrame":"solidFloor2"}],["b",3816,152,{"tileFrame":"solidFloor2"}],["b",3832,152,{"tileFrame":"solidFloor2"}],["b",3832,136,{"tileFrame":"solidFloor2"}],["b",3832,120,{"tileFrame":"solidFloor2"}],["b",3816,136,{"tileFrame":"solidFloor2"}],["b",3816,168,{"tileFrame":"solidFloor2"}],["b",3816,184,{"tileFrame":"solidFloor2"}],["b",3816,200,{"tileFrame":"solidFloor2"}],["b",3816,216,{"tileFrame":"solidFloor2"}],["b",3816,232,{"tileFrame":"solidFloor2"}],["b",3816,248,{"tileFrame":"solidFloor2"}],["b",3816,264,{"tileFrame":"solidFloor2"}],["b",3816,280,{"tileFrame":"solidFloor2"}],["b",3816,296,{"tileFrame":"solidFloor2"}],["b",3832,296,{"tileFrame":"solidFloor2"}],["b",3832,280,{"tileFrame":"solidFloor2"}],["b",3832,264,{"tileFrame":"solidFloor2"}],["b",3832,248,{"tileFrame":"solidFloor2"}],["b",3832,232,{"tileFrame":"solidFloor2"}],["b",3832,216,{"tileFrame":"solidFloor2"}],["b",3832,200,{"tileFrame":"solidFloor2"}],["b",3832,184,{"tileFrame":"solidFloor2"}],["b",3832,168,{"tileFrame":"solidFloor2"}],["b",3720,152,{"tileFrame":"solidFloor2"}],["b",3704,136,{"tileFrame":"solidFloor2"}],["b",3688,120,{"tileFrame":"solidFloor2"}],["b",3672,120,{"tileFrame":"solidFloor2"}],["b",3656,120,{"tileFrame":"solidFloor2"}],["b",3720,168,{"tileFrame":"solidFloor2"}],["b",3720,184,{"tileFrame":"solidFloor2"}],["b",3720,200,{"tileFrame":"solidFloor2"}],["b",3720,216,{"tileFrame":"solidFloor2"}],["b",3720,232,{"tileFrame":"solidFloor2"}],["b",3720,248,{"tileFrame":"solidFloor2"}],["b",3720,264,{"tileFrame":"solidFloor2"}],["b",3720,280,{"tileFrame":"solidFloor2"}],["b",3720,296,{"tileFrame":"solidFloor2"}],["b",3720,312,{"tileFrame":"solidFloor2"}],["b",3704,312,{"tileFrame":"solidFloor2"}],["b",4136,312,{"tileFrame":"solidFloor2"}],["b",4152,312,{"tileFrame":"solidFloor2"}],["b",4152,296,{"tileFrame":"solidFloor2"}],["b",4168,296,{"tileFrame":"solidFloor2"}],["b",4184,280,{"tileFrame":"solidFloor2"}],["b",4200,280,{"tileFrame":"solidFloor2"}],["b",4216,264,{"tileFrame":"solidFloor2"}],["b",4232,264,{"tileFrame":"solidFloor2"}],["b",4232,248,{"tileFrame":"solidFloor2"}],["b",4248,248,{"tileFrame":"solidFloor2"}],["b",4248,232,{"tileFrame":"solidFloor2"}],["b",4264,216,{"tileFrame":"solidFloor2"}],["b",4280,200,{"tileFrame":"solidFloor2"}],["b",4280,184,{"tileFrame":"solidFloor2"}],["b",4280,168,{"tileFrame":"solidFloor2"}],["b",4296,168,{"tileFrame":"solidFloor2"}],["b",4296,152,{"tileFrame":"solidFloor2"}],["b",4296,136,{"tileFrame":"solidFloor2"}],["b",4168,312,{"tileFrame":"solidFloor2"}],["b",4184,312,{"tileFrame":"solidFloor2"}],["b",4200,296,{"tileFrame":"solidFloor2"}],["b",4184,296,{"tileFrame":"solidFloor2"}],["b",4200,312,{"tileFrame":"solidFloor2"}],["b",4216,296,{"tileFrame":"solidFloor2"}],["b",4216,280,{"tileFrame":"solidFloor2"}],["b",4232,280,{"tileFrame":"solidFloor2"}],["b",4136,296,{"tileFrame":"solidFloor2"}],["b",4136,280,{"tileFrame":"solidFloor2"}],["b",4136,264,{"tileFrame":"solidFloor2"}],["b",4136,248,{"tileFrame":"solidFloor2"}],["b",4136,232,{"tileFrame":"solidFloor2"}],["b",4136,216,{"tileFrame":"solidFloor2"}],["b",4136,200,{"tileFrame":"solidFloor2"}],["b",4136,184,{"tileFrame":"solidFloor2"}],["b",4136,168,{"tileFrame":"solidFloor2"}],["b",4136,152,{"tileFrame":"solidFloor2"}],["b",4136,136,{"tileFrame":"solidFloor2"}],["b",4152,136,{"tileFrame":"solidFloor2"}],["b",4168,136,{"tileFrame":"solidFloor2"}],["b",4184,136,{"tileFrame":"solidFloor2"}],["b",4280,136,{"tileFrame":"solidFloor2"}],["b",4280,152,{"tileFrame":"solidFloor2"}],["b",4264,152,{"tileFrame":"solidFloor2"}],["b",4248,152,{"tileFrame":"solidFloor2"}],["b",4232,152,{"tileFrame":"solidFloor2"}],["b",4216,152,{"tileFrame":"solidFloor2"}],["b",4200,152,{"tileFrame":"solidFloor2"}],["b",4184,152,{"tileFrame":"solidFloor2"}],["b",4168,152,{"tileFrame":"solidFloor2"}],["b",4152,152,{"tileFrame":"solidFloor2"}],["b",4152,168,{"tileFrame":"solidFloor2"}],["b",4152,184,{"tileFrame":"solidFloor2"}],["b",4152,200,{"tileFrame":"solidFloor2"}],["b",4152,216,{"tileFrame":"solidFloor2"}],["b",4152,232,{"tileFrame":"solidFloor2"}],["b",4152,248,{"tileFrame":"solidFloor2"}],["b",4152,264,{"tileFrame":"solidFloor2"}],["b",4152,280,{"tileFrame":"solidFloor2"}],["b",4168,280,{"tileFrame":"solidFloor2"}],["b",4216,248,{"tileFrame":"solidFloor2"}],["b",4232,232,{"tileFrame":"solidFloor2"}],["b",4248,216,{"tileFrame":"solidFloor2"}],["b",4264,200,{"tileFrame":"solidFloor2"}],["b",4264,168,{"tileFrame":"solidFloor2"}],["b",4248,168,{"tileFrame":"solidFloor2"}],["b",4232,168,{"tileFrame":"solidFloor2"}],["b",4216,168,{"tileFrame":"solidFloor2"}],["b",4200,168,{"tileFrame":"solidFloor2"}],["b",4184,168,{"tileFrame":"solidFloor2"}],["b",4168,168,{"tileFrame":"solidFloor2"}],["b",4168,184,{"tileFrame":"solidFloor2"}],["b",4168,200,{"tileFrame":"solidFloor2"}],["b",4168,216,{"tileFrame":"solidFloor2"}],["b",4168,232,{"tileFrame":"solidFloor2"}],["b",4168,248,{"tileFrame":"solidFloor2"}],["b",4168,264,{"tileFrame":"solidFloor2"}],["b",4184,264,{"tileFrame":"solidFloor2"}],["b",4200,264,{"tileFrame":"solidFloor2"}],["b",4200,248,{"tileFrame":"solidFloor2"}],["b",4216,232,{"tileFrame":"solidFloor2"}],["b",4248,200,{"tileFrame":"solidFloor2"}],["b",4264,184,{"tileFrame":"solidFloor2"}],["b",4248,184,{"tileFrame":"solidFloor2"}],["b",4232,184,{"tileFrame":"solidFloor2"}],["b",4216,184,{"tileFrame":"solidFloor2"}],["b",4200,184,{"tileFrame":"solidFloor2"}],["b",4184,184,{"tileFrame":"solidFloor2"}],["b",4184,200,{"tileFrame":"solidFloor2"}],["b",4184,216,{"tileFrame":"solidFloor2"}],["b",4184,232,{"tileFrame":"solidFloor2"}],["b",4184,248,{"tileFrame":"solidFloor2"}],["b",4200,232,{"tileFrame":"solidFloor2"}],["b",4216,216,{"tileFrame":"solidFloor2"}],["b",4232,200,{"tileFrame":"solidFloor2"}],["b",4216,200,{"tileFrame":"solidFloor2"}],["b",4232,216,{"tileFrame":"solidFloor2"}],["b",4200,200,{"tileFrame":"solidFloor2"}],["b",4200,216,{"tileFrame":"solidFloor2"}],["b",3720,136],["b",3720,120],["b",3720,104],["b",3720,88],["b",3704,88],["b",3688,88],["b",3672,88],["b",3704,104],["b",3704,120],["b",3688,104],["b",3672,104],["b",3656,104],["b",3656,88],["b",3640,88],["b",3688,312,{"tileFrame":"solidFloor2"}],["b",3688,296,{"tileFrame":"solidFloor2"}],["b",3688,280,{"tileFrame":"solidFloor2"}],["b",3688,264,{"tileFrame":"solidFloor2"}],["b",3672,248,{"tileFrame":"solidFloor2"}],["b",3672,232,{"tileFrame":"solidFloor2"}],["b",3672,216,{"tileFrame":"solidFloor2"}],["b",3672,200,{"tileFrame":"solidFloor2"}],["b",3672,184,{"tileFrame":"solidFloor2"}],["b",3656,184,{"tileFrame":"solidFloor2"}],["b",3656,168,{"tileFrame":"solidFloor2"}],["b",3656,152,{"tileFrame":"solidFloor2"}],["b",3656,136,{"tileFrame":"solidFloor2"}],["b",3672,136,{"tileFrame":"solidFloor2"}],["b",3688,136,{"tileFrame":"solidFloor2"}],["b",3688,152,{"tileFrame":"solidFloor2"}],["b",3688,168,{"tileFrame":"solidFloor2"}],["b",3688,184,{"tileFrame":"solidFloor2"}],["b",3688,200,{"tileFrame":"solidFloor2"}],["b",3704,216,{"tileFrame":"solidFloor2"}],["b",3704,232,{"tileFrame":"solidFloor2"}],["b",3704,248,{"tileFrame":"solidFloor2"}],["b",3704,264,{"tileFrame":"solidFloor2"}],["b",3704,280,{"tileFrame":"solidFloor2"}],["b",3704,296,{"tileFrame":"solidFloor2"}],["b",3704,200,{"tileFrame":"solidFloor2"}],["b",3704,184,{"tileFrame":"solidFloor2"}],["b",3704,168,{"tileFrame":"solidFloor2"}],["b",3704,152,{"tileFrame":"solidFloor2"}],["b",3672,152,{"tileFrame":"solidFloor2"}],["b",3672,168,{"tileFrame":"solidFloor2"}],["b",3688,216,{"tileFrame":"solidFloor2"}],["b",3688,232,{"tileFrame":"solidFloor2"}],["b",3688,248,{"tileFrame":"solidFloor2"}],["b",3672,312,{"tileFrame":"solidFloor2"}],["b",3656,312,{"tileFrame":"solidFloor2"}],["b",3640,312,{"tileFrame":"solidFloor2"}],["b",3672,296,{"tileFrame":"solidFloor2"}],["b",3672,280,{"tileFrame":"solidFloor2"}],["b",3656,280,{"tileFrame":"solidFloor2"}],["b",3656,296,{"tileFrame":"solidFloor2"}],["b",3656,264,{"tileFrame":"solidFloor2"}],["b",3656,248,{"tileFrame":"solidFloor2"}],["b",3656,232,{"tileFrame":"solidFloor2"}],["b",3672,264,{"tileFrame":"solidFloor2"}],["b",3640,296,{"tileFrame":"solidFloor2"}],["b",3640,280,{"tileFrame":"solidFloor2"}],["b",3640,264,{"tileFrame":"solidFloor2"}],["b",3640,248,{"tileFrame":"solidFloor2"}],["b",3640,232,{"tileFrame":"solidFloor2"}],["b",3656,216,{"tileFrame":"solidFloor2"}],["b",3656,200,{"tileFrame":"solidFloor2"}],["b",3640,216,{"tileFrame":"solidFloor2"}],["b",3640,200,{"tileFrame":"solidFloor2"}],["b",3640,184,{"tileFrame":"solidFloor2"}],["b",3640,168,{"tileFrame":"solidFloor2"}],["b",3640,152,{"tileFrame":"solidFloor2"}],["b",3640,136,{"tileFrame":"solidFloor2"}],["b",3640,120,{"tileFrame":"solidFloor2"}],["b",3624,136,{"tileFrame":"solidFloor2"}],["b",3624,152,{"tileFrame":"solidFloor2"}],["b",3624,168,{"tileFrame":"solidFloor2"}],["b",3624,184,{"tileFrame":"solidFloor2"}],["b",3624,200,{"tileFrame":"solidFloor2"}],["b",3624,216,{"tileFrame":"solidFloor2"}],["b",3624,232,{"tileFrame":"solidFloor2"}],["b",3624,248,{"tileFrame":"solidFloor2"}],["b",3624,264,{"tileFrame":"solidFloor2"}],["b",3624,280,{"tileFrame":"solidFloor2"}],["b",3624,120],["b",3624,104],["b",3640,104],["b",3624,88],["b",3608,88],["b",3608,104],["b",3608,120],["b",3880,120,{"tileFrame":"solidGreenPipeLowerExitW"}],["b",3896,120,{"tileFrame":"solidGreenPipeLowerExitE"}],["b",3880,104,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3880,88,{"tileFrame":"solidGreenPipeVerticalBodyW"}],["b",3896,88,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["b",3896,104,{"tileFrame":"solidGreenPipeVerticalBodyE"}],["r",3864,104,{"tileFrame":"brickBottom2"}],["r",3864,88,{"tileFrame":"brickBottom2"}],["e",3224,40,{"enemyAnim":"goomba"}],["c",3928,216],["c",3944,232],["c",3960,216],["c",3976,232],["c",3992,216],["c",4008,232],["c",4024,216],["c",3944,200],["c",3976,200],["c",4008,200],["c",3960,184],["c",3992,184],["c",3976,168],["q",3976,184,{"tileFrame":"blockInvisibleLife"}],["q",4072,200,{"tileFrame":"blockInvisibleCoin"}],["q",4056,136,{"tileFrame":"blockInvisibleCoin"}],["b",5336,56],["b",5352,56],["b",5368,56],["b",5384,56],["b",5400,56],["b",5416,56],["b",5432,56],["b",5336,72],["b",5352,72],["b",5384,72],["b",5400,72],["b",5416,72],["b",5432,72],["b",5368,72],["b",5448,56],["b",5448,72],["b",5464,56],["b",5480,56],["b",5496,56],["b",5480,72],["b",5464,72],["b",5496,72],["b",5512,72],["b",5512,56],["b",5528,56],["b",5528,72],["d",5464,40,{"tileFrame":"clutterBrownCastleSmall"}],["d",5544,40,{"tileFrame":"clutterTreebark"}],["d",5576,40,{"tileFrame":"clutterTreebark"}],["d",5544,24,{"tileFrame":"clutterSnowTree"}],["d",5576,24,{"tileFrame":"clutterSnowTreebottom"}],["d",5576,8,{"tileFrame":"clutterSnowTreetop"}],["d",5592,40,{"tileFrame":"clutterFence"}],["d",5608,40,{"tileFrame":"clutterFence"}],["d",5624,40,{"tileFrame":"clutterFence"}],["d",5640,40,{"tileFrame":"clutterFence"}],["b",5544,56],["b",5560,56],["b",5576,56],["b",5592,56],["b",5608,56],["b",5624,56],["b",5640,56],["b",5640,72],["b",5624,72],["b",5608,72],["b",5592,72],["b",5576,72],["b",5560,72],["b",5544,72],["q",5624,-8,{"tileFrame":"blockCoin"}],["q",5672,-24,{"tileFrame":"blockCoin"}],["q",5720,-24,{"tileFrame":"blockPowerup"}],["d",5704,40,{"tileFrame":"clutterTreebark"}],["d",5704,24,{"tileFrame":"clutterSnowTreebottom"}],["d",5704,8,{"tileFrame":"clutterSnowTreetop"}],["d",5736,24,{"tileFrame":"clutterSnowTree"}],["d",5752,24,{"tileFrame":"clutterSnowTree"}],["d",5736,40,{"tileFrame":"clutterTreebark"}],["d",5752,40,{"tileFrame":"clutterTreebark"}],["b",5656,56],["b",5672,56],["b",5688,56],["b",5704,56],["b",5720,56],["b",5736,56],["b",5752,56],["b",5752,72],["b",5736,72],["b",5720,72],["b",5704,72],["b",5688,72],["b",5672,72],["b",5656,72],["b",5768,56],["b",5784,56],["b",5800,56],["b",5816,72],["b",5832,72],["b",5848,72],["b",5864,72],["b",5768,72],["b",5784,72],["b",5800,72],["b",5816,56],["b",5832,56],["b",5848,56],["b",5864,56],["b",5880,40,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",5880,24,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",5896,40,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",5896,24,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",5880,8,{"tileFrame":"solidSilverPipeUpperExitW"}],["b",5896,8,{"tileFrame":"solidSilverPipeUpperExitE"}],["b",5880,56],["b",5896,56],["b",5896,72],["b",5880,72],["r",5784,-8,{"tileFrame":"brick1"}],["r",5800,-8,{"tileFrame":"brick1"}],["r",5816,-8,{"tileFrame":"brick1"}],["b",5912,72],["b",5928,72],["b",5944,72],["b",5960,72],["b",5912,56],["b",5928,56],["b",5944,56],["b",5960,56],["b",5976,40,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",5976,24,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",5976,8,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",5992,40,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",5992,24,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",5992,8,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",5976,-8,{"tileFrame":"solidSilverPipeUpperExitW"}],["b",5992,-8,{"tileFrame":"solidSilverPipeUpperExitE"}],["b",5976,56],["b",5992,56],["b",5992,72],["b",5976,72],["b",6008,56],["b",6024,56],["b",6040,56],["b",6056,56],["b",6072,56],["b",6072,72],["b",6056,72],["b",6040,72],["b",6024,72],["b",6008,72],["d",6008,40,{"tileFrame":"clutterTreebark"}],["d",6008,24,{"tileFrame":"clutterSnowTree"}],["d",6024,40,{"tileFrame":"clutterFence"}],["d",6056,40,{"tileFrame":"clutterFence"}],["d",6040,40,{"tileFrame":"clutterFence"}],["e",5768,8,{"enemyAnim":"greenParakoopa"}],["e",5816,24,{"enemyAnim":"greenParakoopa"}],["e",5960,40,{"enemyAnim":"goomba"}],["e",5880,-8,{"enemyAnim":"greenPiranhaPlant"}],["e",5976,-24,{"enemyAnim":"greenPiranhaPlant"}],["b",6136,56],["b",6136,72],["b",6152,56],["b",6168,56],["b",6184,56],["b",6200,72],["b",6216,72],["b",6232,72],["b",6248,56],["b",6264,56],["b",6264,72],["b",6248,72],["b",6216,56],["b",6232,56],["b",6200,56],["b",6184,72],["b",6168,72],["b",6152,72],["b",6280,40,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6280,24,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6296,40,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",6296,24,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",6280,8,{"tileFrame":"solidSilverPipeUpperExitW"}],["b",6296,8,{"tileFrame":"solidSilverPipeUpperExitE"}],["e",6280,-8,{"enemyAnim":"greenPiranhaPlant"}],["b",6280,56],["b",6296,56],["b",6296,72],["b",6280,72],["b",6312,56],["b",6328,56],["b",6344,56],["b",6360,72],["b",6376,72],["b",6392,72],["b",6408,56],["b",6424,56],["b",6424,72],["b",6408,72],["b",6344,72],["b",6328,72],["b",6312,72],["b",6360,56],["b",6376,56],["b",6392,56],["d",6408,40,{"tileFrame":"clutterFence"}],["d",6392,40,{"tileFrame":"clutterFence"}],["d",6376,40,{"tileFrame":"clutterFence"}],["d",6360,40,{"tileFrame":"clutterFence"}],["d",6344,40,{"tileFrame":"clutterTreebark"}],["d",6312,40,{"tileFrame":"clutterTreebark"}],["d",6312,24,{"tileFrame":"clutterSnowTree"}],["d",6344,24,{"tileFrame":"clutterSnowTreebottom"}],["d",6344,8,{"tileFrame":"clutterSnowTreetop"}],["b",6440,56],["b",6440,72],["b",6456,72],["b",6456,56],["e",6440,8,{"enemyAnim":"greenPiranhaPlant"}],["b",6440,24,{"tileFrame":"solidSilverPipeUpperExitW"}],["b",6456,24,{"tileFrame":"solidSilverPipeUpperExitE"}],["b",6440,40,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6456,40,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["d",6472,40,{"tileFrame":"clutterTreebark"}],["d",6504,40,{"tileFrame":"clutterTreebark"}],["d",6520,40,{"tileFrame":"clutterTreebark"}],["d",6504,24,{"tileFrame":"clutterSnowTree"}],["d",6520,24,{"tileFrame":"clutterSnowTree"}],["d",6472,24,{"tileFrame":"clutterSnowTreebottom"}],["d",6472,8,{"tileFrame":"clutterSnowTreetop"}],["b",6472,56],["b",6488,56],["b",6504,56],["b",6520,56],["b",6520,72],["b",6504,72],["b",6488,72],["b",6472,72],["b",6536,40,{"tileFrame":"solidBlock1"}],["b",6552,24,{"tileFrame":"solidBlock1"}],["b",6568,8,{"tileFrame":"solidBlock1"}],["b",6584,8,{"tileFrame":"solidBlock1"}],["b",6584,-8,{"tileFrame":"solidBlock1"}],["b",6584,24,{"tileFrame":"solidBlock1"}],["b",6584,40,{"tileFrame":"solidBlock1"}],["b",6552,40,{"tileFrame":"solidBlock1"}],["b",6568,40,{"tileFrame":"solidBlock1"}],["b",6568,24,{"tileFrame":"solidBlock1"}],["b",6536,56],["b",6536,72],["b",6552,72],["b",6568,72],["b",6584,72],["b",6584,56],["b",6568,56],["b",6552,56],["b",6600,-8,{"tileFrame":"solidBridge"}],["b",6616,-8,{"tileFrame":"solidBridge"}],["b",6632,-8,{"tileFrame":"solidBridge"}],["b",6648,-8,{"tileFrame":"solidBridge"}],["b",6664,-8,{"tileFrame":"solidBridge"}],["b",6696,-8,{"tileFrame":"solidBridge"}],["b",6680,-8,{"tileFrame":"solidBridge"}],["b",6712,-8,{"tileFrame":"solidBridge"}],["b",6728,-8,{"tileFrame":"solidBlock1"}],["b",6728,8,{"tileFrame":"solidBlock1"}],["b",6728,24,{"tileFrame":"solidBlock1"}],["b",6728,40,{"tileFrame":"solidBlock1"}],["b",6728,56],["b",6728,72],["d",6600,40,{"tileFrame":"clutterWaterSurface"}],["d",6616,40,{"tileFrame":"clutterWaterSurface"}],["d",6632,40,{"tileFrame":"clutterWaterSurface"}],["d",6648,40,{"tileFrame":"clutterWaterSurface"}],["d",6664,40,{"tileFrame":"clutterWaterSurface"}],["d",6680,40,{"tileFrame":"clutterWaterSurface"}],["d",6696,40,{"tileFrame":"clutterWaterSurface"}],["d",6712,40,{"tileFrame":"clutterWaterSurface"}],["d",6600,56,{"tileFrame":"clutterWater"}],["d",6600,72,{"tileFrame":"clutterWater"}],["d",6616,72,{"tileFrame":"clutterWater"}],["d",6632,72,{"tileFrame":"clutterWater"}],["d",6648,72,{"tileFrame":"clutterWater"}],["d",6664,72,{"tileFrame":"clutterWater"}],["d",6680,72,{"tileFrame":"clutterWater"}],["d",6696,72,{"tileFrame":"clutterWater"}],["d",6712,72,{"tileFrame":"clutterWater"}],["d",6712,56,{"tileFrame":"clutterWater"}],["d",6696,56,{"tileFrame":"clutterWater"}],["d",6680,56,{"tileFrame":"clutterWater"}],["d",6664,56,{"tileFrame":"clutterWater"}],["d",6648,56,{"tileFrame":"clutterWater"}],["d",6632,56,{"tileFrame":"clutterWater"}],["d",6616,56,{"tileFrame":"clutterWater"}],["d",6744,56,{"tileFrame":"clutterWater"}],["d",6744,72,{"tileFrame":"clutterWater"}],["d",6760,72,{"tileFrame":"clutterWater"}],["d",6760,56,{"tileFrame":"clutterWater"}],["d",6744,40,{"tileFrame":"clutterWaterSurface"}],["d",6760,40,{"tileFrame":"clutterWaterSurface"}],["b",6776,-8,{"tileFrame":"solidBlock1"}],["b",6776,8,{"tileFrame":"solidBlock1"}],["b",6776,24,{"tileFrame":"solidBlock1"}],["b",6776,40,{"tileFrame":"solidBlock1"}],["b",6792,24,{"tileFrame":"solidBlock1"}],["b",6792,40,{"tileFrame":"solidBlock1"}],["b",6792,56],["b",6776,56],["b",6776,72],["b",6792,72],["d",6600,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["d",6616,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["d",6632,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["d",6648,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["d",6664,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["d",6680,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["d",6696,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["d",6712,-24,{"tileFrame":"clutterBridgeHandleSnow"}],["q",6680,-72,{"tileFrame":"blockInvisibleLife"}],["q",6808,-72,{"tileFrame":"blockBrick1Star"}],["r",6824,-72,{"tileFrame":"brick1"}],["r",6840,-72,{"tileFrame":"brick1"}],["b",6808,56],["b",6824,56],["b",6840,56],["b",6856,56],["b",6872,56],["b",6888,56],["b",6888,72],["b",6872,72],["b",6856,72],["b",6840,72],["b",6824,72],["b",6808,72],["d",6824,40,{"tileFrame":"clutterTreebark"}],["d",6824,24,{"tileFrame":"clutterSnowTreebottom"}],["d",6824,8,{"tileFrame":"clutterSnowTreetop"}],["b",6904,56],["b",6920,56],["b",6936,56],["b",6952,56],["b",6968,56],["b",6984,56],["b",7000,56],["b",7000,72],["b",6984,72],["b",6968,72],["b",6952,72],["b",6936,72],["b",6920,72],["b",6904,72],["e",6872,40,{"enemyAnim":"goomba"}],["e",6888,40,{"enemyAnim":"goomba"}],["e",6984,40,{"enemyAnim":"greenKoopa"}],["b",7016,56],["b",7016,72],["b",7032,72],["b",7032,56],["b",7016,40,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",7016,24,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",7016,8,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",7032,40,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",7032,24,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",7032,8,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",7016,-8,{"tileFrame":"solidSilverPipeUpperExitW"}],["b",7032,-8,{"tileFrame":"solidSilverPipeUpperExitE"}],["e",7016,-24,{"enemyAnim":"greenPiranhaPlant"}],["b",7048,56],["b",7048,72],["b",7064,72],["b",7064,56],["d",7112,8,{"tileFrame":"clutterSnowTreetop"}],["d",7112,24,{"tileFrame":"clutterSnowTreebottom"}],["d",7080,24,{"tileFrame":"clutterSnowTree"}],["d",7080,40,{"tileFrame":"clutterTreebark"}],["d",7112,40,{"tileFrame":"clutterTreebark"}],["d",7128,40,{"tileFrame":"clutterFence"}],["d",7144,40,{"tileFrame":"clutterFence"}],["d",7160,40,{"tileFrame":"clutterFence"}],["d",7176,40,{"tileFrame":"clutterFence"}],["d",7240,40,{"tileFrame":"clutterTreebark"}],["b",7080,56],["b",7096,56],["b",7112,56],["b",7128,56],["b",7144,56],["b",7160,56],["b",7176,56],["b",7192,56],["b",7208,56],["b",7224,56],["b",7240,56],["b",7240,72],["b",7224,72],["b",7208,72],["b",7192,72],["b",7176,72],["b",7160,72],["b",7144,72],["b",7128,72],["b",7112,72],["b",7096,72],["b",7080,72],["r",7144,-8,{"tileFrame":"brick1"}],["r",7160,-8,{"tileFrame":"brick1"}],["r",7176,-8,{"tileFrame":"brick1"}],["r",7192,-8,{"tileFrame":"brick1"}],["r",7208,-8,{"tileFrame":"brick1"}],["r",7224,-8,{"tileFrame":"brick1"}],["r",7240,-8,{"tileFrame":"brick1"}],["d",7240,24,{"tileFrame":"clutterSnowTreebottom"}],["d",7240,8,{"tileFrame":"clutterSnowTreetop"}],["r",7256,-8,{"tileFrame":"brick1"}],["r",7272,-8,{"tileFrame":"brick1"}],["r",7288,-8,{"tileFrame":"brick1"}],["r",7304,-8,{"tileFrame":"brick1"}],["r",7144,-72,{"tileFrame":"brick1"}],["r",7160,-72,{"tileFrame":"brick1"}],["r",7192,-72,{"tileFrame":"brick1"}],["r",7208,-72,{"tileFrame":"brick1"}],["r",7224,-72,{"tileFrame":"brick1"}],["r",7256,-72,{"tileFrame":"brick1"}],["r",7272,-72,{"tileFrame":"brick1"}],["r",7288,-72,{"tileFrame":"brick1"}],["q",7240,-72,{"tileFrame":"blockPowerup"}],["q",7176,-72,{"tileFrame":"blockCoin"}],["b",7256,56],["b",7272,56],["b",7288,56],["b",7304,56],["b",7304,72],["b",7288,72],["b",7272,72],["b",7256,72],["d",7288,40,{"tileFrame":"clutterTreebark"}],["d",7320,40,{"tileFrame":"clutterTreebark"}],["d",7288,24,{"tileFrame":"clutterSnowTree"}],["d",7320,24,{"tileFrame":"clutterSnowTree"}],["b",7320,56],["b",7336,56],["b",7352,56],["b",7368,72],["b",7384,72],["b",7400,72],["b",7320,72],["b",7336,72],["b",7352,72],["b",7368,56],["b",7384,56],["b",7400,56],["e",7224,40,{"enemyAnim":"hammerbro"}],["e",7176,-24,{"enemyAnim":"hammerbro"}],["b",7480,56],["b",7480,72],["b",7496,56],["b",7496,72],["b",7512,56],["b",7512,72],["r",7464,-24,{"tileFrame":"brick1"}],["r",7448,-24,{"tileFrame":"brick1"}],["r",7432,-24,{"tileFrame":"brick1"}],["r",7432,-72,{"tileFrame":"brick1"}],["r",7448,-72,{"tileFrame":"brick1"}],["r",7464,-72,{"tileFrame":"brick1"}],["b",7528,56],["b",7528,72],["d",7512,40,{"tileFrame":"clutterFence"}],["d",7528,40,{"tileFrame":"clutterFence"}],["d",7544,24,{"tileFrame":"clutterSnowTree"}],["b",7544,40,{"tileFrame":"solidBlock1"}],["b",7560,40,{"tileFrame":"solidBlock1"}],["b",7560,24,{"tileFrame":"solidBlock1"}],["b",7576,40,{"tileFrame":"solidBlock1"}],["b",7576,24,{"tileFrame":"solidBlock1"}],["b",7576,8,{"tileFrame":"solidBlock1"}],["b",7592,-8,{"tileFrame":"solidBlock1"}],["b",7608,-24,{"tileFrame":"solidBlock1"}],["b",7624,-40,{"tileFrame":"solidBlock1"}],["b",7624,-24,{"tileFrame":"solidBlock1"}],["b",7624,-8,{"tileFrame":"solidBlock1"}],["b",7624,8,{"tileFrame":"solidBlock1"}],["b",7624,24,{"tileFrame":"solidBlock1"}],["b",7624,40,{"tileFrame":"solidBlock1"}],["b",7608,40,{"tileFrame":"solidBlock1"}],["b",7592,40,{"tileFrame":"solidBlock1"}],["b",7592,24,{"tileFrame":"solidBlock1"}],["b",7608,24,{"tileFrame":"solidBlock1"}],["b",7608,8,{"tileFrame":"solidBlock1"}],["b",7592,8,{"tileFrame":"solidBlock1"}],["b",7608,-8,{"tileFrame":"solidBlock1"}],["b",7544,56],["b",7544,72],["b",7560,72],["b",7576,56],["b",7592,56],["b",7592,72],["b",7608,72],["b",7624,72],["b",7624,56],["b",7608,56],["b",7576,72],["b",7560,56],["b",7672,56],["b",7672,72],["b",7688,72],["b",7704,72],["b",7704,56],["b",7688,56],["e",7608,-40,{"enemyAnim":"goomba"}],["e",7592,-24,{"enemyAnim":"goomba"}],["b",7720,56],["b",7736,56],["b",7752,56],["b",7752,72],["b",7736,72],["b",7720,72],["e",7752,40,{"enemyAnim":"greenKoopa"}],["r",7768,-8,{"tileFrame":"brick1"}],["r",7768,-72,{"tileFrame":"brick1"}],["r",7800,-8,{"tileFrame":"brick1"}],["r",7800,-72,{"tileFrame":"brick1"}],["r",7848,-8,{"tileFrame":"brick1"}],["r",7848,-72,{"tileFrame":"brick1"}],["r",7880,-72,{"tileFrame":"brick1"}],["r",7880,-8,{"tileFrame":"brick1"}],["q",7784,-8,{"tileFrame":"blockCoin"}],["q",7864,-72,{"tileFrame":"blockCoin"}],["q",7784,-72,{"tileFrame":"blockCoins"}],["q",7864,-8,{"tileFrame":"blockPowerup"}],["b",7768,56],["b",7784,56],["b",7800,56],["b",7816,56],["b",7832,56],["b",7848,56],["b",7864,56],["b",7880,56],["b",7880,72],["b",7864,72],["b",7848,72],["b",7832,72],["b",7816,72],["b",7800,72],["b",7784,72],["b",7768,72],["d",7848,24,{"tileFrame":"clutterSnowTree"}],["d",7880,24,{"tileFrame":"clutterSnowTreebottom"}],["d",7880,8,{"tileFrame":"clutterSnowTreetop"}],["d",7848,40,{"tileFrame":"clutterTreebark"}],["d",7880,40,{"tileFrame":"clutterTreebark"}],["d",7896,40,{"tileFrame":"clutterFence"}],["d",7912,40,{"tileFrame":"clutterFence"}],["d",7928,40,{"tileFrame":"clutterFence"}],["d",7944,40,{"tileFrame":"clutterFence"}],["b",7896,56],["b",7912,56],["b",7928,56],["b",7944,56],["b",7944,72],["b",7928,72],["b",7912,72],["b",7896,72],["b",7960,56],["b",7976,56],["b",7992,56],["b",7992,72],["b",7976,72],["b",7960,72],["d",8008,40,{"tileFrame":"clutterTreebark"}],["d",8008,24,{"tileFrame":"clutterSnowTreebottom"}],["d",8008,8,{"tileFrame":"clutterSnowTreetop"}],["d",8040,24,{"tileFrame":"clutterSnowTree"}],["d",8056,24,{"tileFrame":"clutterSnowTree"}],["d",8040,40,{"tileFrame":"clutterTreebark"}],["d",8056,40,{"tileFrame":"clutterTreebark"}],["b",8008,56],["b",8024,56],["b",8040,56],["b",8056,56],["b",8056,72],["b",8040,72],["b",8024,72],["b",8008,72],["r",8024,-8,{"tileFrame":"brick1"}],["r",8056,-8,{"tileFrame":"brick1"}],["r",8072,-8,{"tileFrame":"brick1"}],["r",8088,-8,{"tileFrame":"brick1"}],["q",8040,-8,{"tileFrame":"blockBrick1Coin"}],["b",8072,56],["b",8088,56],["b",8088,72],["b",8072,72],["b",8104,56],["b",8120,56],["b",8136,56],["b",8136,72],["b",8120,72],["b",8104,72],["b",8152,56],["b",8168,56],["b",8184,56],["b",8184,72],["b",8168,72],["b",8152,72],["b",8152,40,{"tileFrame":"solidBlock1"}],["b",8168,40,{"tileFrame":"solidBlock1"}],["b",8168,24,{"tileFrame":"solidBlock1"}],["b",8152,8,{"tileFrame":"solidBlock1"}],["b",8152,24,{"tileFrame":"solidBlock1"}],["b",8168,8,{"tileFrame":"solidBlock1"}],["b",8168,-8,{"tileFrame":"solidBlock1"}],["b",8168,-24,{"tileFrame":"solidBlock1"}],["b",8168,-40,{"tileFrame":"solidBlock1"}],["e",8088,-24,{"enemyAnim":"greenKoopa"}],["e",7832,40,{"enemyAnim":"goomba"}],["e",7864,40,{"enemyAnim":"goomba"}],["b",8248,56],["b",8248,72],["b",8264,72],["b",8264,56],["b",8280,56],["b",8280,72],["d",8280,40,{"tileFrame":"clutterFence"}],["b",8296,40,{"tileFrame":"solidBlock1"}],["b",8312,24,{"tileFrame":"solidBlock1"}],["b",8312,40,{"tileFrame":"solidBlock1"}],["b",8296,56],["b",8312,56],["b",8312,72],["b",8296,72],["b",8328,40,{"tileFrame":"solidBlock1"}],["b",8328,56],["b",8328,72],["b",8344,56],["b",8344,72],["b",6440,88,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,104,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,136,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,152,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,168,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,184,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,200,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,216,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,120,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,232,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,248,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",6440,264,{"tileFrame":"solidSilverPipeConnectorNW"}],["b",6440,280,{"tileFrame":"solidSilverPipeConnectorSW"}],["b",6424,264,{"tileFrame":"solidSilverPipeHorizontalBodyN"}],["b",6424,280,{"tileFrame":"solidSilverPipeHorizontalBodyS"}],["b",6408,280,{"tileFrame":"solidSilverPipeLeftmostExitS"}],["b",6408,264,{"tileFrame":"solidSilverPipeLeftmostExitN"}],["b",6456,296,{"tileFrame":"solidFloor2"}],["b",6456,312,{"tileFrame":"solidFloor2"}],["b",6440,296,{"tileFrame":"solidFloor2"}],["b",6424,296,{"tileFrame":"solidFloor2"}],["b",6408,296,{"tileFrame":"solidFloor2"}],["b",6392,296,{"tileFrame":"solidFloor2"}],["b",6424,312,{"tileFrame":"solidFloor2"}],["b",6440,312,{"tileFrame":"solidFloor2"}],["b",6408,312,{"tileFrame":"solidFloor2"}],["b",6392,312,{"tileFrame":"solidFloor2"}],["r",6376,232,{"tileFrame":"brickBottom2"}],["r",6392,216,{"tileFrame":"brickBottom2"}],["r",6392,200,{"tileFrame":"brickBottom2"}],["r",6392,184,{"tileFrame":"brickBottom2"}],["r",6392,168,{"tileFrame":"brickBottom2"}],["r",6376,184,{"tileFrame":"brickBottom2"}],["r",6376,168,{"tileFrame":"brickBottom2"}],["r",6360,168,{"tileFrame":"brickBottom2"}],["r",6360,216,{"tileFrame":"brickBottom2"}],["r",6344,200,{"tileFrame":"brickBottom2"}],["r",6328,184,{"tileFrame":"brickBottom2"}],["r",6312,184,{"tileFrame":"brickBottom2"}],["r",6296,200,{"tileFrame":"brickBottom2"}],["r",6280,216,{"tileFrame":"brickBottom2"}],["r",6264,232,{"tileFrame":"brickBottom2"}],["r",6248,216,{"tileFrame":"brickBottom2"}],["r",6248,200,{"tileFrame":"brickBottom2"}],["r",6248,184,{"tileFrame":"brickBottom2"}],["r",6264,184,{"tileFrame":"brickBottom2"}],["r",6264,168,{"tileFrame":"brickBottom2"}],["r",6248,168,{"tileFrame":"brickBottom2"}],["q",6280,168,{"tileFrame":"blockBrick2BottomPowerup"}],["r",6312,168,{"tileFrame":"brickBottom2"}],["r",6328,168,{"tileFrame":"brickBottom2"}],["c",6264,216],["c",6280,200],["c",6296,184],["c",6344,184],["c",6360,200],["c",6376,216],["c",6296,152],["c",6312,152],["c",6328,152],["c",6344,152],["c",6328,136],["c",6312,136],["b",6376,296,{"tileFrame":"solidFloor2"}],["b",6360,296,{"tileFrame":"solidFloor2"}],["b",6344,296,{"tileFrame":"solidFloor2"}],["b",6328,296,{"tileFrame":"solidFloor2"}],["b",6312,296,{"tileFrame":"solidFloor2"}],["b",6296,296,{"tileFrame":"solidFloor2"}],["b",6280,296,{"tileFrame":"solidFloor2"}],["b",6264,296,{"tileFrame":"solidFloor2"}],["b",6248,296,{"tileFrame":"solidFloor2"}],["b",6248,312,{"tileFrame":"solidFloor2"}],["b",6376,312,{"tileFrame":"solidFloor2"}],["b",6360,312,{"tileFrame":"solidFloor2"}],["b",6344,312,{"tileFrame":"solidFloor2"}],["b",6328,312,{"tileFrame":"solidFloor2"}],["b",6312,312,{"tileFrame":"solidFloor2"}],["b",6296,312,{"tileFrame":"solidFloor2"}],["b",6280,312,{"tileFrame":"solidFloor2"}],["b",6264,312,{"tileFrame":"solidFloor2"}],["b",6232,296,{"tileFrame":"solidFloor2"}],["b",6216,296,{"tileFrame":"solidFloor2"}],["b",6216,312,{"tileFrame":"solidFloor2"}],["b",6232,312,{"tileFrame":"solidFloor2"}],["b",6200,296,{"tileFrame":"solidFloor2"}],["b",6200,312,{"tileFrame":"solidFloor2"}],["r",6200,280,{"tileFrame":"brickBottom2"}],["r",6200,264,{"tileFrame":"brickBottom2"}],["r",6200,248,{"tileFrame":"brickBottom2"}],["r",6200,232,{"tileFrame":"brickBottom2"}],["r",6200,216,{"tileFrame":"brickBottom2"}],["r",6200,200,{"tileFrame":"brickBottom2"}],["r",6200,184,{"tileFrame":"brickBottom2"}],["r",6200,168,{"tileFrame":"brickBottom2"}],["r",6200,152,{"tileFrame":"brickBottom2"}],["r",6200,136,{"tileFrame":"brickBottom2"}],["r",6200,120,{"tileFrame":"brickBottom2"}],["b",6200,104,{"tileFrame":"solidSilverPipeRightmostExitS"}],["b",6200,88,{"tileFrame":"solidSilverPipeRightmostExitN"}],["b",6184,312,{"tileFrame":"solidFloor2"}],["b",6184,296,{"tileFrame":"solidFloor2"}],["b",6472,296,{"tileFrame":"solidFloor2"}],["b",6472,312,{"tileFrame":"solidFloor2"}],["b",6456,280,{"tileFrame":"solidFloor2"}],["b",6456,264,{"tileFrame":"solidFloor2"}],["b",6456,248,{"tileFrame":"solidFloor2"}],["b",6456,232,{"tileFrame":"solidFloor2"}],["b",6456,216,{"tileFrame":"solidFloor2"}],["b",6456,200,{"tileFrame":"solidFloor2"}],["b",6456,184,{"tileFrame":"solidFloor2"}],["b",6456,168,{"tileFrame":"solidFloor2"}],["b",6456,152,{"tileFrame":"solidFloor2"}],["b",6472,152,{"tileFrame":"solidFloor2"}],["b",6472,136,{"tileFrame":"solidFloor2"}],["b",6488,136,{"tileFrame":"solidFloor2"}],["b",6504,136,{"tileFrame":"solidFloor2"}],["b",6504,152,{"tileFrame":"solidFloor2"}],["b",6520,152,{"tileFrame":"solidFloor2"}],["b",6536,152,{"tileFrame":"solidFloor2"}],["b",6552,152,{"tileFrame":"solidFloor2"}],["b",6552,136,{"tileFrame":"solidFloor2"}],["b",6568,136,{"tileFrame":"solidFloor2"}],["b",6568,152,{"tileFrame":"solidFloor2"}],["b",6584,152,{"tileFrame":"solidFloor2"}],["b",6488,312,{"tileFrame":"solidFloor2"}],["b",6504,312,{"tileFrame":"solidFloor2"}],["b",6504,296,{"tileFrame":"solidFloor2"}],["b",6520,296,{"tileFrame":"solidFloor2"}],["b",6520,280,{"tileFrame":"solidFloor2"}],["b",6536,280,{"tileFrame":"solidFloor2"}],["b",6536,296,{"tileFrame":"solidFloor2"}],["b",6520,312,{"tileFrame":"solidFloor2"}],["b",6536,312,{"tileFrame":"solidFloor2"}],["b",6552,312,{"tileFrame":"solidFloor2"}],["b",6552,296,{"tileFrame":"solidFloor2"}],["b",6552,280,{"tileFrame":"solidFloor2"}],["b",6568,280,{"tileFrame":"solidFloor2"}],["b",6568,264,{"tileFrame":"solidFloor2"}],["b",6584,264,{"tileFrame":"solidFloor2"}],["b",6584,248,{"tileFrame":"solidFloor2"}],["b",6584,232,{"tileFrame":"solidFloor2"}],["b",6584,216,{"tileFrame":"solidFloor2"}],["b",6584,200,{"tileFrame":"solidFloor2"}],["b",6584,184,{"tileFrame":"solidFloor2"}],["b",6584,168,{"tileFrame":"solidFloor2"}],["b",6568,200,{"tileFrame":"solidFloor2"}],["b",6568,216,{"tileFrame":"solidFloor2"}],["b",6568,232,{"tileFrame":"solidFloor2"}],["b",6568,248,{"tileFrame":"solidFloor2"}],["b",6552,248,{"tileFrame":"solidFloor2"}],["b",6552,264,{"tileFrame":"solidFloor2"}],["b",6568,296,{"tileFrame":"solidFloor2"}],["b",6584,280,{"tileFrame":"solidFloor2"}],["b",6568,312,{"tileFrame":"solidFloor2"}],["b",6584,312,{"tileFrame":"solidFloor2"}],["b",6584,296,{"tileFrame":"solidFloor2"}],["b",6488,296,{"tileFrame":"solidFloor2"}],["b",6488,280,{"tileFrame":"solidFloor2"}],["b",6472,280,{"tileFrame":"solidFloor2"}],["b",6472,264,{"tileFrame":"solidFloor2"}],["b",6472,248,{"tileFrame":"solidFloor2"}],["b",6472,232,{"tileFrame":"solidFloor2"}],["b",6472,216,{"tileFrame":"solidFloor2"}],["b",6472,200,{"tileFrame":"solidFloor2"}],["b",6472,184,{"tileFrame":"solidFloor2"}],["b",6472,168,{"tileFrame":"solidFloor2"}],["b",6488,152,{"tileFrame":"solidFloor2"}],["b",6488,168,{"tileFrame":"solidFloor2"}],["b",6488,184,{"tileFrame":"solidFloor2"}],["b",6488,200,{"tileFrame":"solidFloor2"}],["b",6488,216,{"tileFrame":"solidFloor2"}],["b",6488,232,{"tileFrame":"solidFloor2"}],["b",6488,248,{"tileFrame":"solidFloor2"}],["b",6488,264,{"tileFrame":"solidFloor2"}],["b",6504,280,{"tileFrame":"solidFloor2"}],["b",6520,264,{"tileFrame":"solidFloor2"}],["b",6536,248,{"tileFrame":"solidFloor2"}],["b",6552,232,{"tileFrame":"solidFloor2"}],["b",6536,264,{"tileFrame":"solidFloor2"}],["b",6552,216,{"tileFrame":"solidFloor2"}],["b",6568,184,{"tileFrame":"solidFloor2"}],["b",6568,168,{"tileFrame":"solidFloor2"}],["b",6552,168,{"tileFrame":"solidFloor2"}],["b",6536,168,{"tileFrame":"solidFloor2"}],["b",6520,168,{"tileFrame":"solidFloor2"}],["b",6504,168,{"tileFrame":"solidFloor2"}],["b",6504,184,{"tileFrame":"solidFloor2"}],["b",6504,200,{"tileFrame":"solidFloor2"}],["b",6504,216,{"tileFrame":"solidFloor2"}],["b",6504,232,{"tileFrame":"solidFloor2"}],["b",6504,248,{"tileFrame":"solidFloor2"}],["b",6504,264,{"tileFrame":"solidFloor2"}],["b",6552,184,{"tileFrame":"solidFloor2"}],["b",6536,184,{"tileFrame":"solidFloor2"}],["b",6520,184,{"tileFrame":"solidFloor2"}],["b",6520,200,{"tileFrame":"solidFloor2"}],["b",6520,216,{"tileFrame":"solidFloor2"}],["b",6520,232,{"tileFrame":"solidFloor2"}],["b",6520,248,{"tileFrame":"solidFloor2"}],["b",6536,232,{"tileFrame":"solidFloor2"}],["b",6552,200,{"tileFrame":"solidFloor2"}],["b",6536,200,{"tileFrame":"solidFloor2"}],["b",6536,216,{"tileFrame":"solidFloor2"}],["b",6584,136],["b",6584,120],["b",6584,104],["b",6584,88],["b",6568,88],["b",6552,88],["b",6536,88],["b",6536,104],["b",6520,88],["b",6504,88],["b",6488,88],["b",6488,104],["b",6472,104],["b",6472,88],["b",6456,88],["b",6456,104],["b",6456,120],["b",6456,136],["b",6472,120],["b",6488,120],["b",6504,120],["b",6520,120],["b",6536,120],["b",6552,120],["b",6568,120],["b",6568,104],["b",6552,104],["b",6520,104],["b",6504,104],["b",6520,136],["b",6536,136],["b",6184,280,{"tileFrame":"solidFloor2"}],["b",6184,264,{"tileFrame":"solidFloor2"}],["b",6184,248,{"tileFrame":"solidFloor2"}],["b",6184,232,{"tileFrame":"solidFloor2"}],["b",6184,216,{"tileFrame":"solidFloor2"}],["b",6184,200,{"tileFrame":"solidFloor2"}],["b",6184,184,{"tileFrame":"solidFloor2"}],["b",6184,168,{"tileFrame":"solidFloor2"}],["b",6184,152,{"tileFrame":"solidFloor2"}],["b",6184,136,{"tileFrame":"solidFloor2"}],["b",6184,120,{"tileFrame":"solidFloor2"}],["b",6168,312,{"tileFrame":"solidFloor2"}],["b",6152,312,{"tileFrame":"solidFloor2"}],["b",6136,312,{"tileFrame":"solidFloor2"}],["b",6136,296,{"tileFrame":"solidFloor2"}],["b",6136,280,{"tileFrame":"solidFloor2"}],["b",6136,264,{"tileFrame":"solidFloor2"}],["b",6136,248,{"tileFrame":"solidFloor2"}],["b",6136,232,{"tileFrame":"solidFloor2"}],["b",6136,216,{"tileFrame":"solidFloor2"}],["b",6136,200,{"tileFrame":"solidFloor2"}],["b",6136,184,{"tileFrame":"solidFloor2"}],["b",6136,168,{"tileFrame":"solidFloor2"}],["b",6136,152,{"tileFrame":"solidFloor2"}],["b",6152,152,{"tileFrame":"solidFloor2"}],["b",6168,152,{"tileFrame":"solidFloor2"}],["b",6168,136,{"tileFrame":"solidFloor2"}],["b",6152,168,{"tileFrame":"solidFloor2"}],["b",6152,184,{"tileFrame":"solidFloor2"}],["b",6152,200,{"tileFrame":"solidFloor2"}],["b",6152,216,{"tileFrame":"solidFloor2"}],["b",6152,232,{"tileFrame":"solidFloor2"}],["b",6152,248,{"tileFrame":"solidFloor2"}],["b",6152,264,{"tileFrame":"solidFloor2"}],["b",6152,280,{"tileFrame":"solidFloor2"}],["b",6152,296,{"tileFrame":"solidFloor2"}],["b",6168,296,{"tileFrame":"solidFloor2"}],["b",6168,280,{"tileFrame":"solidFloor2"}],["b",6168,264,{"tileFrame":"solidFloor2"}],["b",6168,248,{"tileFrame":"solidFloor2"}],["b",6168,232,{"tileFrame":"solidFloor2"}],["b",6168,216,{"tileFrame":"solidFloor2"}],["b",6168,200,{"tileFrame":"solidFloor2"}],["b",6168,184,{"tileFrame":"solidFloor2"}],["b",6168,168,{"tileFrame":"solidFloor2"}],["b",6136,88],["b",6136,104],["b",6136,120],["b",6136,136],["b",6152,136],["b",6152,120],["b",6168,120],["b",6168,104],["b",6184,104],["b",6184,88],["b",6168,88],["b",6152,88],["b",6152,104],["b",6072,88],["b",6072,104],["b",6072,120],["b",6056,120],["b",6040,120],["b",6024,120],["b",6024,104],["b",6008,104],["b",5992,104],["b",5976,104],["b",5960,104],["b",5944,104],["b",5944,88],["b",5928,88],["b",5960,88],["b",5976,88],["b",5992,88],["b",6008,88],["b",6024,88],["b",6040,88],["b",6056,88],["b",6056,104],["b",6040,104],["b",5928,104],["b",6072,136,{"tileFrame":"solidFloor2"}],["b",6072,152,{"tileFrame":"solidFloor2"}],["b",6072,168,{"tileFrame":"solidFloor2"}],["b",6072,184,{"tileFrame":"solidFloor2"}],["b",6072,200,{"tileFrame":"solidFloor2"}],["b",6072,216,{"tileFrame":"solidFloor2"}],["b",6072,232,{"tileFrame":"solidFloor2"}],["b",6072,248,{"tileFrame":"solidFloor2"}],["b",6072,264,{"tileFrame":"solidFloor2"}],["b",6072,280,{"tileFrame":"solidFloor2"}],["b",6072,296,{"tileFrame":"solidFloor2"}],["b",6072,312,{"tileFrame":"solidFloor2"}],["b",6056,312,{"tileFrame":"solidFloor2"}],["b",6040,312,{"tileFrame":"solidFloor2"}],["b",6024,312,{"tileFrame":"solidFloor2"}],["b",6008,312,{"tileFrame":"solidFloor2"}],["b",5992,312,{"tileFrame":"solidFloor2"}],["b",5976,312,{"tileFrame":"solidFloor2"}],["b",5960,312,{"tileFrame":"solidFloor2"}],["b",5944,312,{"tileFrame":"solidFloor2"}],["b",5928,312,{"tileFrame":"solidFloor2"}],["b",5928,296,{"tileFrame":"solidFloor2"}],["b",5928,280,{"tileFrame":"solidFloor2"}],["b",5928,264,{"tileFrame":"solidFloor2"}],["b",5928,248,{"tileFrame":"solidFloor2"}],["b",5928,232,{"tileFrame":"solidFloor2"}],["b",5928,216,{"tileFrame":"solidFloor2"}],["b",5928,200,{"tileFrame":"solidFloor2"}],["b",5928,184,{"tileFrame":"solidFloor2"}],["b",5944,184,{"tileFrame":"solidFloor2"}],["b",5944,168,{"tileFrame":"solidFloor2"}],["b",5944,152,{"tileFrame":"solidFloor2"}],["b",5944,136,{"tileFrame":"solidFloor2"}],["b",5944,120,{"tileFrame":"solidFloor2"}],["b",5928,136,{"tileFrame":"solidFloor2"}],["b",5928,152,{"tileFrame":"solidFloor2"}],["b",5928,168,{"tileFrame":"solidFloor2"}],["b",5928,120,{"tileFrame":"solidFloor2"}],["b",5960,120,{"tileFrame":"solidFloor2"}],["b",5976,120,{"tileFrame":"solidFloor2"}],["b",5992,120,{"tileFrame":"solidFloor2"}],["b",6008,120,{"tileFrame":"solidFloor2"}],["b",6040,136,{"tileFrame":"solidFloor2"}],["b",6056,136,{"tileFrame":"solidFloor2"}],["b",6024,136,{"tileFrame":"solidFloor2"}],["b",6008,136,{"tileFrame":"solidFloor2"}],["b",5992,136,{"tileFrame":"solidFloor2"}],["b",5976,136,{"tileFrame":"solidFloor2"}],["b",5960,136,{"tileFrame":"solidFloor2"}],["b",5960,152,{"tileFrame":"solidFloor2"}],["b",5976,152,{"tileFrame":"solidFloor2"}],["b",5992,168,{"tileFrame":"solidFloor2"}],["b",6008,168,{"tileFrame":"solidFloor2"}],["b",6040,152,{"tileFrame":"solidFloor2"}],["b",6056,152,{"tileFrame":"solidFloor2"}],["b",6024,152,{"tileFrame":"solidFloor2"}],["b",6008,152,{"tileFrame":"solidFloor2"}],["b",5992,152,{"tileFrame":"solidFloor2"}],["b",5976,168,{"tileFrame":"solidFloor2"}],["b",5960,168,{"tileFrame":"solidFloor2"}],["b",5960,184,{"tileFrame":"solidFloor2"}],["b",5960,200,{"tileFrame":"solidFloor2"}],["b",5976,200,{"tileFrame":"solidFloor2"}],["b",5976,184,{"tileFrame":"solidFloor2"}],["b",5992,184,{"tileFrame":"solidFloor2"}],["b",5960,216,{"tileFrame":"solidFloor2"}],["b",5960,232,{"tileFrame":"solidFloor2"}],["b",5976,232,{"tileFrame":"solidFloor2"}],["b",5992,216,{"tileFrame":"solidFloor2"}],["b",5992,200,{"tileFrame":"solidFloor2"}],["b",5944,216,{"tileFrame":"solidFloor2"}],["b",5944,232,{"tileFrame":"solidFloor2"}],["b",5944,200,{"tileFrame":"solidFloor2"}],["b",5944,248,{"tileFrame":"solidFloor2"}],["b",5944,264,{"tileFrame":"solidFloor2"}],["b",5960,264,{"tileFrame":"solidFloor2"}],["b",5960,248,{"tileFrame":"solidFloor2"}],["b",5944,280,{"tileFrame":"solidFloor2"}],["b",5944,296,{"tileFrame":"solidFloor2"}],["b",5960,296,{"tileFrame":"solidFloor2"}],["b",5976,296,{"tileFrame":"solidFloor2"}],["b",5976,280,{"tileFrame":"solidFloor2"}],["b",5976,264,{"tileFrame":"solidFloor2"}],["b",5976,248,{"tileFrame":"solidFloor2"}],["b",5960,280,{"tileFrame":"solidFloor2"}],["b",5992,264,{"tileFrame":"solidFloor2"}],["b",5992,248,{"tileFrame":"solidFloor2"}],["b",5992,232,{"tileFrame":"solidFloor2"}],["b",5976,216,{"tileFrame":"solidFloor2"}],["b",5992,280,{"tileFrame":"solidFloor2"}],["b",6008,280,{"tileFrame":"solidFloor2"}],["b",6008,264,{"tileFrame":"solidFloor2"}],["b",5992,296,{"tileFrame":"solidFloor2"}],["b",6008,296,{"tileFrame":"solidFloor2"}],["b",6024,296,{"tileFrame":"solidFloor2"}],["b",6024,280,{"tileFrame":"solidFloor2"}],["b",6040,296,{"tileFrame":"solidFloor2"}],["b",6056,296,{"tileFrame":"solidFloor2"}],["b",6056,280,{"tileFrame":"solidFloor2"}],["b",6040,280,{"tileFrame":"solidFloor2"}],["b",6040,264,{"tileFrame":"solidFloor2"}],["b",6024,264,{"tileFrame":"solidFloor2"}],["b",6056,264,{"tileFrame":"solidFloor2"}],["b",6040,248,{"tileFrame":"solidFloor2"}],["b",6024,248,{"tileFrame":"solidFloor2"}],["b",6056,248,{"tileFrame":"solidFloor2"}],["b",6056,232,{"tileFrame":"solidFloor2"}],["b",6040,232,{"tileFrame":"solidFloor2"}],["b",6024,216,{"tileFrame":"solidFloor2"}],["b",6024,232,{"tileFrame":"solidFloor2"}],["b",6008,232,{"tileFrame":"solidFloor2"}],["b",6008,248,{"tileFrame":"solidFloor2"}],["b",6056,216,{"tileFrame":"solidFloor2"}],["b",6040,216,{"tileFrame":"solidFloor2"}],["b",6040,200,{"tileFrame":"solidFloor2"}],["b",6024,200,{"tileFrame":"solidFloor2"}],["b",6008,200,{"tileFrame":"solidFloor2"}],["b",6008,216,{"tileFrame":"solidFloor2"}],["b",6040,184,{"tileFrame":"solidFloor2"}],["b",6024,184,{"tileFrame":"solidFloor2"}],["b",6056,200,{"tileFrame":"solidFloor2"}],["b",6056,184,{"tileFrame":"solidFloor2"}],["b",6040,168,{"tileFrame":"solidFloor2"}],["b",6024,168,{"tileFrame":"solidFloor2"}],["b",6008,184,{"tileFrame":"solidFloor2"}],["b",6056,168,{"tileFrame":"solidFloor2"}],["b",5912,104],["b",5896,104],["b",5880,104],["b",5864,104],["b",5848,104],["b",5832,104],["b",5816,104],["b",5800,104],["b",5784,104],["b",5768,104],["b",5752,104],["b",5736,104],["b",5720,104],["b",5704,104],["b",5688,104],["b",5672,104],["b",5656,104],["b",5640,104],["b",5624,104],["b",5608,104],["b",5592,104],["b",5592,88],["b",5576,88],["b",5576,104],["b",5608,88],["b",5624,88],["b",5640,88],["b",5656,88],["b",5672,88],["b",5688,88],["b",5704,88],["b",5720,88],["b",5736,88],["b",5752,88],["b",5768,88],["b",5800,88],["b",5816,88],["b",5832,88],["b",5848,88],["b",5864,88],["b",5880,88],["b",5896,88],["b",5912,88],["b",5784,88],["b",5816,184,{"tileFrame":"solidFloor2"}],["b",5816,200,{"tileFrame":"solidFloor2"}],["b",5832,200,{"tileFrame":"solidFloor2"}],["b",5848,200,{"tileFrame":"solidFloor2"}],["b",5864,200,{"tileFrame":"solidFloor2"}],["b",5880,200,{"tileFrame":"solidFloor2"}],["b",5896,200,{"tileFrame":"solidFloor2"}],["b",5912,200,{"tileFrame":"solidFloor2"}],["b",5816,168,{"tileFrame":"solidFloor2"}],["b",5816,152,{"tileFrame":"solidFloor2"}],["b",5816,136,{"tileFrame":"solidFloor2"}],["b",5816,120,{"tileFrame":"solidFloor2"}],["b",5832,120,{"tileFrame":"solidFloor2"}],["b",5848,120,{"tileFrame":"solidFloor2"}],["b",5864,120,{"tileFrame":"solidFloor2"}],["b",5880,120,{"tileFrame":"solidFloor2"}],["b",5896,120,{"tileFrame":"solidFloor2"}],["b",5912,120,{"tileFrame":"solidFloor2"}],["b",5912,136,{"tileFrame":"solidFloor2"}],["b",5912,152,{"tileFrame":"solidFloor2"}],["b",5912,168,{"tileFrame":"solidFloor2"}],["b",5912,184,{"tileFrame":"solidFloor2"}],["b",5896,184,{"tileFrame":"solidFloor2"}],["b",5880,184,{"tileFrame":"solidFloor2"}],["b",5864,184,{"tileFrame":"solidFloor2"}],["b",5848,184,{"tileFrame":"solidFloor2"}],["b",5832,184,{"tileFrame":"solidFloor2"}],["b",5832,168,{"tileFrame":"solidFloor2"}],["b",5832,152,{"tileFrame":"solidFloor2"}],["b",5832,136,{"tileFrame":"solidFloor2"}],["b",5848,136,{"tileFrame":"solidFloor2"}],["b",5864,136,{"tileFrame":"solidFloor2"}],["b",5880,136,{"tileFrame":"solidFloor2"}],["b",5896,136,{"tileFrame":"solidFloor2"}],["b",5896,168,{"tileFrame":"solidFloor2"}],["b",5880,168,{"tileFrame":"solidFloor2"}],["b",5864,168,{"tileFrame":"solidFloor2"}],["b",5848,168,{"tileFrame":"solidFloor2"}],["b",5848,152,{"tileFrame":"solidFloor2"}],["b",5864,152,{"tileFrame":"solidFloor2"}],["b",5880,152,{"tileFrame":"solidFloor2"}],["b",5896,152,{"tileFrame":"solidFloor2"}],["b",5800,120,{"tileFrame":"solidFloor2"}],["b",5800,136,{"tileFrame":"solidFloor2"}],["b",5800,152,{"tileFrame":"solidFloor2"}],["b",5800,168,{"tileFrame":"solidFloor2"}],["b",5800,184,{"tileFrame":"solidFloor2"}],["b",5800,200,{"tileFrame":"solidFloor2"}],["b",5784,200,{"tileFrame":"solidFloor2"}],["b",5784,184,{"tileFrame":"solidFloor2"}],["b",5784,168,{"tileFrame":"solidFloor2"}],["b",5784,152,{"tileFrame":"solidFloor2"}],["b",5784,136,{"tileFrame":"solidFloor2"}],["b",5784,120,{"tileFrame":"solidFloor2"}],["b",7384,-216,{"tileFrame":"solidCloud"}],["b",7400,-216,{"tileFrame":"solidCloud"}],["b",7416,-216,{"tileFrame":"solidCloud"}],["b",7480,-216,{"tileFrame":"solidCloud"}],["b",7496,-216,{"tileFrame":"solidCloud"}],["b",7512,-216,{"tileFrame":"solidCloud"}],["b",7528,-216,{"tileFrame":"solidCloud"}],["b",7544,-216,{"tileFrame":"solidCloud"}],["b",7560,-216,{"tileFrame":"solidCloud"}],["b",7592,-216,{"tileFrame":"solidCloud"}],["b",7624,-216,{"tileFrame":"solidCloud"}],["b",7672,-216,{"tileFrame":"solidCloud"}],["b",7704,-216,{"tileFrame":"solidCloud"}],["b",7736,-216,{"tileFrame":"solidCloud"}],["b",7768,-216,{"tileFrame":"solidCloud"}],["b",7800,-216,{"tileFrame":"solidCloud"}],["b",7816,-216,{"tileFrame":"solidCloud"}],["b",7832,-216,{"tileFrame":"solidCloud"}],["b",7848,-216,{"tileFrame":"solidCloud"}],["b",7864,-216,{"tileFrame":"solidCloud"}],["b",7880,-216,{"tileFrame":"solidCloud"}],["b",7576,-216,{"tileFrame":"solidCloud"}],["b",7608,-216,{"tileFrame":"solidCloud"}],["b",7640,-216,{"tileFrame":"solidCloud"}],["b",7656,-216,{"tileFrame":"solidCloud"}],["b",7688,-216,{"tileFrame":"solidCloud"}],["b",7720,-216,{"tileFrame":"solidCloud"}],["b",7752,-216,{"tileFrame":"solidCloud"}],["b",7784,-216,{"tileFrame":"solidCloud"}],["b",7944,-216,{"tileFrame":"solidCloud"}],["b",7928,-216,{"tileFrame":"solidCloud"}],["b",7912,-216,{"tileFrame":"solidCloud"}],["b",7896,-216,{"tileFrame":"solidCloud"}],["p",7672,-264,{"objectFrame":"cloudBig"}],["c",7640,-328],["c",7656,-328],["c",7672,-328],["c",7688,-328],["c",7704,-328],["c",7720,-328],["c",7736,-328],["c",7752,-328],["c",7768,-328],["c",7784,-328],["c",7800,-328],["c",7816,-328],["c",7832,-328],["c",7848,-328],["c",7864,-328],["c",7880,-328],["b",7912,-296,{"tileFrame":"solidCloud"}],["c",7944,-328],["c",7960,-328],["c",7976,-328],["c",7992,-328],["c",8008,-328],["c",8040,-328],["c",8056,-328],["c",8072,-328],["c",8088,-328],["c",8104,-328],["c",8120,-328],["c",8136,-328],["c",8024,-328],["c",8152,-328],["c",8168,-328],["b",8216,-296,{"tileFrame":"solidCloud"}],["b",8216,-312,{"tileFrame":"solidCloud"}],["c",8184,-328],["c",8248,-344],["c",8264,-344],["c",8280,-344],["c",8296,-344],["c",8312,-344],["c",8328,-344],["c",8344,-344],["b",8376,-312,{"tileFrame":"solidCloud"}],["b",8376,-296,{"tileFrame":"solidCloud"}],["b",8472,-328,{"tileFrame":"solidCloud"}],["b",8488,-328,{"tileFrame":"solidCloud"}],["b",8536,-328,{"tileFrame":"solidCloud"}],["b",8568,-328,{"tileFrame":"solidCloud"}],["b",8600,-328,{"tileFrame":"solidCloud"}],["b",8632,-328,{"tileFrame":"solidCloud"}],["b",8664,-328,{"tileFrame":"solidCloud"}],["c",8536,-344],["c",8552,-344],["c",8568,-344],["c",8584,-344],["c",8600,-344],["c",8616,-344],["c",8632,-344],["c",8648,-344],["c",8664,-344],["c",8680,-344],["c",8744,-248],["c",8760,-248],["c",8776,-248],["d",5528,-88,{"tileFrame":"clutterBgCloudSmall"}],["d",5912,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",6168,-88,{"tileFrame":"clutterBgCloud"}],["d",6584,-104,{"tileFrame":"clutterBgCloud"}],["d",6920,-88,{"tileFrame":"clutterBgCloudBig"}],["d",7192,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",7560,-88,{"tileFrame":"clutterBgCloudSmall"}],["d",7960,-104,{"tileFrame":"clutterBgCloudBig"}],["d",8264,-72,{"tileFrame":"clutterBgCloudSmall"}],["e",7800,-88,{"enemyAnim":"greenKoopa"}],["e",8312,8,{"enemyAnim":"greenKoopa"}],["r",6344,-8,{"tileFrame":"brick1"}],["b",8360,72],["b",8376,72],["b",8392,72],["b",8408,56],["b",8424,56],["b",8440,56],["b",8456,72],["b",8472,72],["b",8488,72],["b",8504,56],["b",8520,56],["b",8536,56],["d",8536,40,{"tileFrame":"clutterTreebark"}],["d",8536,24,{"tileFrame":"clutterSnowTree"}],["d",8568,24,{"tileFrame":"clutterSnowTreebottom"}],["d",8568,8,{"tileFrame":"clutterSnowTreetop"}],["d",8568,40,{"tileFrame":"clutterTreebark"}],["b",8568,56],["b",8552,56],["b",8488,56],["b",8472,56],["b",8456,56],["b",8392,56],["b",8376,56],["b",8360,56],["b",8408,72],["b",8424,72],["b",8440,72],["b",8504,72],["b",8520,72],["b",8536,72],["b",8552,72],["b",8568,72],["d",8408,40,{"tileFrame":"clutterBrownCastleSmall"}],["e",8104,8,{"enemyAnim":"greenParakoopa"}],["d",8584,40,{"tileFrame":"clutterFence"}],["d",8600,40,{"tileFrame":"clutterFence"}],["d",8616,40,{"tileFrame":"clutterFence"}],["d",8632,40,{"tileFrame":"clutterFence"}],["d",8696,40,{"tileFrame":"clutterTreebark"}],["d",8696,24,{"tileFrame":"clutterSnowTreebottom"}],["d",8696,8,{"tileFrame":"clutterSnowTreetop"}],["d",8728,40,{"tileFrame":"clutterTreebark"}],["d",8744,40,{"tileFrame":"clutterTreebark"}],["d",8744,24,{"tileFrame":"clutterSnowTree"}],["d",8728,24,{"tileFrame":"clutterSnowTree"}],["d",8968,40,{"tileFrame":"clutterFence"}],["d",8984,40,{"tileFrame":"clutterFence"}],["d",9000,40,{"tileFrame":"clutterFence"}],["d",9016,40,{"tileFrame":"clutterFence"}],["d",9000,24,{"tileFrame":"clutterSnowTree"}],["d",9048,40,{"tileFrame":"clutterTreebark"}],["d",9048,24,{"tileFrame":"clutterSnowTreebottom"}],["d",9048,8,{"tileFrame":"clutterSnowTreetop"}],["b",9144,40,{"tileFrame":"solidBlock1"}],["b",9320,40,{"tileFrame":"solidBlock1"}],["b",9320,24,{"tileFrame":"solidBlock1"}],["b",9320,8,{"tileFrame":"solidBlock1"}],["d",9304,40,{"tileFrame":"clutterTreebark"}],["d",9336,40,{"tileFrame":"clutterTreebark"}],["d",9304,24,{"tileFrame":"clutterSnowTree"}],["d",9336,24,{"tileFrame":"clutterSnowTreebottom"}],["d",9336,8,{"tileFrame":"clutterSnowTreetop"}],["d",9352,40,{"tileFrame":"clutterFence"}],["d",9368,40,{"tileFrame":"clutterFence"}],["d",9384,40,{"tileFrame":"clutterFence"}],["d",9400,40,{"tileFrame":"clutterFence"}],["d",9464,40,{"tileFrame":"clutterTreebark"}],["d",9464,24,{"tileFrame":"clutterSnowTreebottom"}],["d",9464,8,{"tileFrame":"clutterSnowTreetop"}],["d",9496,40,{"tileFrame":"clutterTreebark"}],["d",9512,40,{"tileFrame":"clutterTreebark"}],["d",9496,24,{"tileFrame":"clutterSnowTree"}],["d",9512,24,{"tileFrame":"clutterSnowTree"}],["b",9560,24,{"tileFrame":"solidBlock1"}],["b",9560,40,{"tileFrame":"solidBlock1"}],["b",9624,24,{"tileFrame":"solidBlock1"}],["b",9624,40,{"tileFrame":"solidBlock1"}],["q",9592,-8,{"tileFrame":"blockBrick1Coins"}],["q",9592,-72,{"tileFrame":"blockBrick1Star"}],["q",9320,-56,{"tileFrame":"blockPowerup"}],["b",8584,72],["b",8600,72],["b",8616,72],["b",8632,72],["b",8648,72],["b",8664,72],["b",8680,72],["b",8696,72],["b",8712,72],["b",8728,72],["b",8744,72],["b",8760,72],["b",8776,72],["b",8792,72],["b",8808,72],["b",8824,72],["b",8840,72],["b",8856,72],["b",8872,72],["b",8888,72],["b",8904,72],["b",8920,72],["b",8936,72],["b",8952,72],["b",8968,72],["b",8984,72],["b",9000,72],["b",9016,72],["b",9032,72],["b",9048,72],["b",9064,72],["b",9080,72],["b",9096,72],["b",9112,72],["b",9128,72],["b",9144,72],["b",9160,72],["b",9176,72],["b",9192,72],["b",9208,72],["b",9224,72],["b",9240,72],["b",9256,72],["b",9272,72],["b",9288,72],["b",9304,72],["b",9320,72],["b",9336,72],["b",9352,72],["b",9368,72],["b",9384,72],["b",9400,72],["b",9416,72],["b",9432,72],["b",9448,72],["b",9464,72],["b",9480,72],["b",9496,72],["b",9512,72],["b",9528,72],["b",9544,72],["b",9560,72],["b",9576,72],["b",9592,72],["b",9608,72],["b",9624,72],["b",9624,56],["b",9608,56],["b",9592,56],["b",9576,56],["b",9560,56],["b",9544,56],["b",9528,56],["b",9512,56],["b",9496,56],["b",9480,56],["b",9464,56],["b",9448,56],["b",9432,56],["b",9416,56],["b",9400,56],["b",9384,56],["b",9368,56],["b",9352,56],["b",9336,56],["b",9320,56],["b",9304,56],["b",9288,56],["b",9272,56],["b",9256,56],["b",9240,56],["b",9224,56],["b",9208,56],["b",9192,56],["b",9176,56],["b",9160,56],["b",9144,56],["b",9128,56],["b",9112,56],["b",9096,56],["b",9080,56],["b",9064,56],["b",9048,56],["b",9032,56],["b",9016,56],["b",9000,56],["b",8984,56],["b",8968,56],["b",8952,56],["b",8936,56],["b",8920,56],["b",8904,56],["b",8888,56],["b",8872,56],["b",8856,56],["b",8840,56],["b",8824,56],["b",8808,56],["b",8792,56],["b",8776,56],["b",8760,56],["b",8744,56],["b",8728,56],["b",8712,56],["b",8696,56],["b",8680,56],["b",8664,56],["b",8648,56],["b",8632,56],["b",8616,56],["b",8600,56],["b",8584,56],["c",9272,-8],["c",9256,-8],["c",9240,-8],["b",9672,72],["b",9672,56],["b",9688,56],["b",9704,56],["b",9720,56],["b",9720,72],["b",9704,72],["b",9688,72],["d",9736,40,{"tileFrame":"clutterFence"}],["d",9752,40,{"tileFrame":"clutterFence"}],["d",9784,40,{"tileFrame":"clutterFence"}],["d",9768,40,{"tileFrame":"clutterTreebark"}],["d",9816,40,{"tileFrame":"clutterTreebark"}],["d",9768,24,{"tileFrame":"clutterSnowTree"}],["d",9816,24,{"tileFrame":"clutterSnowTreebottom"}],["d",9816,8,{"tileFrame":"clutterSnowTreetop"}],["d",10072,40,{"tileFrame":"clutterTreebark"}],["d",10072,24,{"tileFrame":"clutterSnowTree"}],["d",10104,40,{"tileFrame":"clutterTreebark"}],["d",10104,24,{"tileFrame":"clutterSnowTreebottom"}],["d",10104,8,{"tileFrame":"clutterSnowTreetop"}],["d",10120,40,{"tileFrame":"clutterFence"}],["d",10136,40,{"tileFrame":"clutterFence"}],["d",10152,40,{"tileFrame":"clutterFence"}],["d",10168,40,{"tileFrame":"clutterFence"}],["d",10232,40,{"tileFrame":"clutterTreebark"}],["d",10232,24,{"tileFrame":"clutterSnowTreebottom"}],["d",10232,8,{"tileFrame":"clutterSnowTreetop"}],["d",10264,40,{"tileFrame":"clutterTreebark"}],["d",10264,24,{"tileFrame":"clutterTreebark"}],["d",10264,8,{"tileFrame":"clutterSnowTree"}],["b",9736,72],["b",9752,72],["b",9768,72],["b",9784,72],["b",9800,72],["b",9816,72],["b",9832,72],["b",9848,72],["b",9864,72],["b",9880,72],["b",9896,72],["b",9912,72],["b",9928,72],["b",9944,72],["b",9960,72],["b",9976,72],["b",9992,72],["b",10008,72],["b",10024,72],["b",10040,72],["b",10056,72],["b",10072,72],["b",10088,72],["b",10104,72],["b",10120,72],["b",10136,72],["b",10152,72],["b",10168,72],["b",10184,72],["b",10200,72],["b",10216,72],["b",10232,72],["b",10248,72],["b",10264,72],["b",10280,72],["b",10296,72],["b",10312,72],["b",10312,56],["b",10296,56],["b",10280,56],["b",10264,56],["b",10248,56],["b",10232,56],["b",10216,56],["b",10200,56],["b",10184,56],["b",10168,56],["b",10152,56],["b",10136,56],["b",10120,56],["b",10104,56],["b",10088,56],["b",10072,56],["b",10056,56],["b",10040,56],["b",10024,56],["b",10008,56],["b",9992,56],["b",9976,56],["b",9960,56],["b",9944,56],["b",9928,56],["b",9912,56],["b",9896,56],["b",9880,56],["b",9864,56],["b",9848,56],["b",9832,56],["b",9816,56],["b",9800,56],["b",9784,56],["b",9768,56],["b",9752,56],["b",9736,56],["b",10360,56],["b",10360,72],["b",10376,72],["b",10392,72],["b",10392,56],["b",10376,56],["b",10376,40,{"tileFrame":"solidBlock1"}],["b",10376,24,{"tileFrame":"solidBlock1"}],["r",10376,-56,{"tileFrame":"brick1"}],["b",10440,56],["b",10440,72],["b",10456,56],["b",10472,56],["b",10488,56],["b",10488,72],["b",10472,72],["b",10456,72],["d",10504,40,{"tileFrame":"clutterFence"}],["d",10520,40,{"tileFrame":"clutterFence"}],["d",10536,40,{"tileFrame":"clutterFence"}],["d",10552,40,{"tileFrame":"clutterFence"}],["d",10536,24,{"tileFrame":"clutterSnowTree"}],["d",10584,40,{"tileFrame":"clutterTreebark"}],["d",10584,24,{"tileFrame":"clutterSnowTreebottom"}],["d",10584,8,{"tileFrame":"clutterSnowTreetop"}],["b",10504,56],["b",10520,56],["b",10536,56],["b",10552,56],["b",10568,56],["b",10584,56],["b",10584,72],["b",10568,72],["b",10552,72],["b",10536,72],["b",10520,72],["b",10504,72],["d",10840,40,{"tileFrame":"clutterTreebark"}],["d",10872,40,{"tileFrame":"clutterTreebark"}],["d",10840,24,{"tileFrame":"clutterSnowTree"}],["d",10872,24,{"tileFrame":"clutterSnowTreebottom"}],["d",10872,8,{"tileFrame":"clutterSnowTreetop"}],["b",10600,56],["b",10616,56],["b",10632,56],["b",10648,56],["b",10664,56],["b",10680,56],["b",10696,56],["b",10712,56],["b",10728,56],["b",10744,56],["b",10760,56],["b",10776,56],["b",10792,56],["b",10808,56],["b",10824,56],["b",10840,56],["b",10856,56],["b",10872,56],["b",10872,72],["b",10856,72],["b",10840,72],["b",10824,72],["b",10808,72],["b",10792,72],["b",10776,72],["b",10760,72],["b",10744,72],["b",10728,72],["b",10712,72],["b",10696,72],["b",10680,72],["b",10664,72],["b",10648,72],["b",10632,72],["b",10616,72],["b",10600,72],["d",10888,40,{"tileFrame":"clutterFence"}],["d",10904,40,{"tileFrame":"clutterFence"}],["d",10920,40,{"tileFrame":"clutterFence"}],["d",10936,40,{"tileFrame":"clutterFence"}],["d",11000,40,{"tileFrame":"clutterTreebark"}],["d",11000,24,{"tileFrame":"clutterSnowTreebottom"}],["d",11000,8,{"tileFrame":"clutterSnowTreetop"}],["d",11016,40,{"tileFrame":"clutterTreebark"}],["d",11048,40,{"tileFrame":"clutterTreebark"}],["d",11016,24,{"tileFrame":"clutterSnowTree"}],["d",11048,24,{"tileFrame":"clutterSnowTree"}],["b",11064,8,{"tileFrame":"solidSilverPipeUpperExitW"}],["b",11080,8,{"tileFrame":"solidSilverPipeUpperExitE"}],["b",11064,24,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",11064,40,{"tileFrame":"solidSilverPipeVerticalBodyW"}],["b",11080,24,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",11080,40,{"tileFrame":"solidSilverPipeVerticalBodyE"}],["b",10888,56],["b",10904,56],["b",10920,56],["b",10936,56],["b",10952,56],["b",10968,56],["b",10984,56],["b",11000,56],["b",11016,56],["b",11032,56],["b",11048,56],["b",11064,56],["b",11080,56],["b",11080,72],["b",11064,72],["b",11048,72],["b",11032,72],["b",11016,72],["b",11000,72],["b",10984,72],["b",10968,72],["b",10952,72],["b",10936,72],["b",10920,72],["b",10904,72],["b",10888,72],["c",11048,-56],["c",11064,-56],["c",11080,-56],["c",11096,-56],["b",11096,72],["b",11112,72],["b",11128,72],["b",11144,72],["b",11160,72],["b",11176,56],["b",11192,56],["b",11208,56],["b",11224,72],["b",11240,72],["b",11256,72],["d",11272,40,{"tileFrame":"clutterFence"}],["d",11288,40,{"tileFrame":"clutterFence"}],["d",11320,40,{"tileFrame":"clutterFence"}],["d",11304,40,{"tileFrame":"clutterTreebark"}],["d",11304,24,{"tileFrame":"clutterSnowTree"}],["d",11352,40,{"tileFrame":"clutterTreebark"}],["d",11352,24,{"tileFrame":"clutterSnowTreebottom"}],["d",11352,8,{"tileFrame":"clutterSnowTreetop"}],["b",11096,56],["b",11112,56],["b",11128,56],["b",11144,56],["b",11160,56],["b",11224,56],["b",11240,56],["b",11256,56],["b",11272,56],["b",11288,56],["b",11304,56],["b",11320,56],["b",11336,56],["b",11352,56],["b",11352,72],["b",11336,72],["b",11320,72],["b",11304,72],["b",11288,72],["b",11272,72],["b",11208,72],["b",11192,72],["b",11176,72],["b",11368,56],["b",11384,56],["b",11400,56],["b",11416,56],["b",11368,72],["b",11384,72],["b",11400,72],["b",11416,72],["b",11432,72],["b",11448,72],["b",11464,72],["e",9416,40,{"enemyAnim":"greenKoopa"}],["e",9528,40,{"enemyAnim":"goomba"}],["e",9608,40,{"enemyAnim":"greenKoopa"}],["e",9830.864119288413,1.0331074909585425,{"enemyAnim":"greenParakoopa"}],["e",10312,40,{"enemyAnim":"goomba"}],["e",10292.05841537717,40,{"enemyAnim":"goomba"}],["e",10600,40,{"enemyAnim":"greenKoopa"}],["e",10624.767774637005,40,{"enemyAnim":"greenKoopa"}],["e",10648,40,{"enemyAnim":"greenKoopa"}],["e",10785.046573729845,40,{"enemyAnim":"greenKoopa"}],["e",10760,40,{"enemyAnim":"greenKoopa"}],["e",10952,40,{"enemyAnim":"greenKoopa"}],["e",10968,40,{"enemyAnim":"greenKoopa"}],["e",10984,40,{"enemyAnim":"greenKoopa"}],["e",11064,-8,{"enemyAnim":"greenPiranhaPlant"}],["e",11160,40,{"enemyAnim":"greenKoopa"}],["e",11224,40,{"enemyAnim":"goomba"}],["e",11240,40,{"enemyAnim":"goomba"}],["e",11256,40,{"enemyAnim":"goomba"}],["e",11416,40,{"enemyAnim":"goomba"}],["e",11368,40,{"enemyAnim":"goomba"}],["e",11390.632424104979,40,{"enemyAnim":"goomba"}],["d",8399.356953299262,-94.14681071603714,{"tileFrame":"clutterBgCloud"}],["d",8664,-88,{"tileFrame":"clutterBgCloudSmall"}],["d",8808,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",8861.553618265463,-88,{"tileFrame":"clutterBgCloud"}],["d",9096,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",9160,-88,{"tileFrame":"clutterBgCloud"}],["d",9432,-88,{"tileFrame":"clutterBgCloudSmall"}],["d",9576,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",9632.753152204115,-94.93010396829561,{"tileFrame":"clutterBgCloud"}],["d",9864,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",9918.409727284206,-88,{"tileFrame":"clutterBgCloud"}],["d",10200,-88,{"tileFrame":"clutterBgCloudSmall"}],["d",10344,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",10408,-88,{"tileFrame":"clutterBgCloud"}],["d",10616,-120,{"tileFrame":"clutterBgCloudSmall"}],["d",10664,-104,{"tileFrame":"clutterBgCloud"}],["d",10968,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",11112,-104,{"tileFrame":"clutterBgCloudSmall"}],["d",11168.757725573523,-88,{"tileFrame":"clutterBgCloud"}],["d",11400,-104,{"tileFrame":"clutterBgCloudSmall"}],["m",-382.14767276756777,40]],"entities2":[["b",1880,104],["b",1896,104],["b",1912,104],["b",1912,88],["b",1896,88],["b",1880,88],["d",600,152,{"tileFrame":"clutterFence"}],["d",616,152,{"tileFrame":"clutterFence"}],["d",632,152,{"tileFrame":"clutterFence"}],["d",648,152,{"tileFrame":"clutterFence"}],["d",664,152,{"tileFrame":"clutterFence"}],["d",680,152,{"tileFrame":"clutterFence"}],["d",696,152,{"tileFrame":"clutterFence"}],["d",712,152,{"tileFrame":"clutterFence"}],["d",728,152,{"tileFrame":"clutterFence"}],["d",744,152,{"tileFrame":"clutterFence"}],["d",-520,-8,{"tileFrame":"clutterBigTreebark"}],["d",-520,8,{"tileFrame":"clutterBigTreebark"}],["d",-520,24,{"tileFrame":"clutterBigTreebark"}],["d",-520,40,{"tileFrame":"clutterBigTreebark"}],["d",-504,40,{"tileFrame":"clutterBigTreebark"}],["d",-488,40,{"tileFrame":"clutterBigTreebark"}],["d",-488,24,{"tileFrame":"clutterBigTreebark"}],["d",-488,8,{"tileFrame":"clutterBigTreebark"}],["d",-488,-8,{"tileFrame":"clutterBigTreebark"}],["d",-488,-24,{"tileFrame":"clutterBigTreebark"}],["d",-472,-24,{"tileFrame":"clutterBigTreebark"}],["d",-456,-24,{"tileFrame":"clutterBigTreebark"}],["d",-456,-8,{"tileFrame":"clutterBigTreebark"}],["d",-456,8,{"tileFrame":"clutterBigTreebark"}],["d",-456,24,{"tileFrame":"clutterBigTreebark"}],["d",-456,40,{"tileFrame":"clutterBigTreebark"}],["d",-440,40,{"tileFrame":"clutterBigTreebark"}],["d",-440,24,{"tileFrame":"clutterBigTreebark"}],["d",-440,8,{"tileFrame":"clutterBigTreebark"}],["d",-472,24,{"tileFrame":"clutterBigTreebark"}],["d",-504,24,{"tileFrame":"clutterBigTreebark"}],["d",-472,40,{"tileFrame":"clutterBigTreebark"}],["d",-472,-8,{"tileFrame":"clutterBigTreebark"}],["d",-504,-8,{"tileFrame":"clutterBigTreebark"}],["d",-504,-24,{"tileFrame":"clutterBigTreebark"}],["d",2088,40,{"tileFrame":"clutterBushSmall"}],["d",488,88,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,104,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,120,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,136,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,152,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,168,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,184,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,200,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",504,88,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",504,104,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",504,120,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",504,136,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",504,152,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",504,168,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",504,184,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",520,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",536,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",552,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",568,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",584,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",600,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",616,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",632,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",648,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",680,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",696,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",712,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",728,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",744,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",760,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",776,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",664,216,{"tileFrame":"clutterGreenPipeHorizontalBodyS"}],["d",520,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",536,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",552,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",568,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",584,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",600,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",616,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",632,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",648,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",664,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",680,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",696,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",712,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",728,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",744,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",760,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",776,200,{"tileFrame":"clutterGreenPipeHorizontalBodyN"}],["d",792,184,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",792,168,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",792,152,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",792,136,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",792,120,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",808,120,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",808,136,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",808,152,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",808,168,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",808,184,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",808,200,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",504,200,{"tileFrame":"clutterGreenPipeConnectorNE"}],["d",504,216,{"tileFrame":"clutterGreenPipeConnectorSE"}],["d",488,216,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",488,232,{"tileFrame":"clutterGreenPipeLowerExitW"}],["d",504,232,{"tileFrame":"clutterGreenPipeLowerExitE"}],["d",792,200,{"tileFrame":"clutterGreenPipeConnectorNW"}],["d",792,216,{"tileFrame":"clutterGreenPipeConnectorSW"}],["d",808,216,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",792,232,{"tileFrame":"clutterGreenPipeLowerExitW"}],["d",808,232,{"tileFrame":"clutterGreenPipeLowerExitE"}],["d",792,88,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["d",792,104,{"tileFrame":"clutterGreenPipeVerticalBodyW"}],["b",984,88],["b",984,104],["b",1000,104],["b",1016,104],["b",1032,104],["b",1048,104],["b",1064,104],["b",1080,104],["b",1096,104],["b",1112,104],["b",1128,104],["b",1144,104],["b",1160,104],["b",1176,104],["b",1192,104],["b",1208,104],["b",1224,104],["b",1240,104],["b",1256,104],["b",1272,104],["b",1288,104],["b",1304,104],["b",1320,104],["b",1336,104],["b",1352,104],["b",1368,104],["b",1384,104],["b",1400,104],["b",1416,104],["b",1432,104],["b",1448,104],["b",1464,104],["b",1480,104],["b",1496,104],["b",1512,104],["b",1528,104],["b",1544,104],["b",1560,104],["b",1576,104],["b",1592,104],["b",1608,104],["b",1624,104],["b",1640,104],["b",1656,104],["b",1672,104],["b",1688,104],["b",1704,104],["b",1720,104],["b",1736,104],["b",1752,104],["b",1768,104],["b",1784,104],["b",1800,104],["b",1816,104],["b",1832,104],["b",1848,104],["b",1864,104],["b",1864,88],["b",1848,88],["b",1832,88],["b",1816,88],["b",1800,88],["b",1784,88],["b",1768,88],["b",1752,88],["b",1736,88],["b",1720,88],["b",1576,88],["b",1592,88],["b",1608,88],["b",1624,88],["b",1640,88],["b",1656,88],["b",1672,88],["b",1688,88],["b",1704,88],["b",1560,88],["b",1544,88],["b",1528,88],["b",1512,88],["b",1496,88],["b",1480,88],["b",1464,88],["b",1448,88],["b",1432,88],["b",1416,88],["b",1400,88],["b",1384,88],["b",1368,88],["b",1352,88],["b",1336,88],["b",1320,88],["b",1304,88],["b",1288,88],["b",1272,88],["b",1256,88],["b",1240,88],["b",1224,88],["b",1208,88],["b",1192,88],["b",1176,88],["b",1160,88],["b",1144,88],["b",1128,88],["b",1112,88],["b",1096,88],["b",1080,88],["b",1064,88],["b",1048,88],["b",1032,88],["b",1016,88],["b",1000,88],["b",808,88],["b",808,104],["b",824,104],["b",840,104],["b",856,104],["b",872,104],["b",888,104],["b",904,104],["b",920,104],["b",920,88],["b",904,88],["b",888,88],["b",872,88],["b",856,88],["b",840,88],["b",824,88],["b",2184,280,{"tileFrame":"solidFloor2"}],["b",2184,264,{"tileFrame":"solidFloor2"}],["b",2184,248,{"tileFrame":"solidFloor2"}],["b",2184,232,{"tileFrame":"solidFloor2"}],["b",2184,216,{"tileFrame":"solidFloor2"}],["b",2184,200,{"tileFrame":"solidFloor2"}],["b",2184,184,{"tileFrame":"solidFloor2"}],["b",2184,168,{"tileFrame":"solidFloor2"}],["b",2184,152,{"tileFrame":"solidFloor2"}],["b",2184,136,{"tileFrame":"solidFloor2"}],["b",2184,120],["b",2184,104],["b",2184,88],["d",2600,40,{"tileFrame":"clutterTreebark"}],["d",2600,24,{"tileFrame":"clutterTreebottom"}],["d",2600,8,{"tileFrame":"clutterTreetop"}],["d",2904,40,{"tileFrame":"clutterTreebark"}],["d",2952,40,{"tileFrame":"clutterTreebark"}],["d",3368,40,{"tileFrame":"clutterTreebark"}],["d",3208,40,{"tileFrame":"clutterTreebark"}],["d",3672,40,{"tileFrame":"clutterTreebark"}],["d",4040,40,{"tileFrame":"clutterFence"}],["d",4056,40,{"tileFrame":"clutterFence"}],["d",4072,40,{"tileFrame":"clutterFence"}],["d",4088,40,{"tileFrame":"clutterFence"}],["d",4456,40,{"tileFrame":"clutterFence"}],["d",4424,40,{"tileFrame":"clutterTreebark"}],["d",4120,280,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,264,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,248,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,232,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,216,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,200,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,184,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,168,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,152,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,136,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,120,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,104,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",4120,88,{"tileFrame":"clutterGreenPipeVerticalBodyE"}],["d",7544,40,{"tileFrame":"clutterTreebark"}],["e",8056,24,{"enemyAnim":"greenParakoopa"}],["e",7887.139223883594,40,{"enemyAnim":"goomba"}],["e",6680,-24,{"enemyAnim":"goomba"}],["e",6696,-24,{"enemyAnim":"goomba"}],["e",6712,-24,{"enemyAnim":"goomba"}],["d",6456,280,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,264,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,248,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,232,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,216,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,200,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,184,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,168,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,152,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,136,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,120,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,104,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["d",6456,88,{"tileFrame":"clutterSilverPipeVerticalBodyE"}],["b",6200,88],["b",6200,104],["d",6184,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6168,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6152,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6136,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6120,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6104,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6088,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6072,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6056,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6040,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6024,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6008,88,{"tileFrame":"clutterSilverPipeHorizontalBodyN"}],["d",6184,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6168,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6152,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6136,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6120,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6104,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6088,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6072,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6056,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6040,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6024,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",6008,104,{"tileFrame":"clutterSilverPipeHorizontalBodyS"}],["d",5992,88,{"tileFrame":"clutterSilverPipeConnectorNE"}],["d",5992,104,{"tileFrame":"clutterSilverPipeConnectorSE"}],["d",5976,104,{"tileFrame":"clutterSilverPipeVerticalBodyW"}],["d",5976,88,{"tileFrame":"clutterSilverPipeVerticalBodyW"}],["e",6408,40,{"enemyAnim":"greenKoopa"}],["e",8008,8,{"enemyAnim":"greenParakoopa"}],["d",9000,40,{"tileFrame":"clutterTreebark"}],["d",10536,40,{"tileFrame":"clutterTreebark"}],["e",8632,40,{"enemyAnim":"greenKoopa"}],["e",8744,40,{"enemyAnim":"goomba"}],["e",8760,40,{"enemyAnim":"goomba"}],["e",8776,40,{"enemyAnim":"goomba"}],["e",8888,40,{"enemyAnim":"greenKoopa"}],["e",8904,40,{"enemyAnim":"greenKoopa"}],["e",8920,40,{"enemyAnim":"greenKoopa"}],["e",9048,40,{"enemyAnim":"greenKoopa"}],["e",9080,40,{"enemyAnim":"greenKoopa"}],["e",9496,40,{"enemyAnim":"goomba"}],["e",9512,40,{"enemyAnim":"goomba"}],["e",10136,40,{"enemyAnim":"greenKoopa"}],["e",10272.756063278553,40,{"enemyAnim":"goomba"}],["e",10504,40,{"enemyAnim":"greenKoopa"}]],"camZones":[{"x":576,"y":64,"w":192,"h":112},{"x":-656,"y":-48,"w":224,"h":128},{"x":1904,"y":80,"w":304,"h":240},{"x":3840,"y":80,"w":304,"h":240},{"x":6176,"y":80,"w":304,"h":240},{"x":-432,"y":-144,"w":11952,"h":224}],"camPreserveZones":[{"x":-656,"y":64,"w":224,"h":80},{"x":-432,"y":-256,"w":3952,"h":112},{"x":3520,"y":-192,"w":32,"h":48},{"x":3632,"y":-192,"w":1200,"h":48},{"x":928,"y":64,"w":48,"h":128},{"x":3728,"y":64,"w":64,"h":64},{"x":4432,"y":64,"w":336,"h":80},{"x":4832,"y":-256,"w":2544,"h":112},{"x":7376,"y":-192,"w":32,"h":48},{"x":7488,"y":-192,"w":1312,"h":48},{"x":6064,"y":64,"w":80,"h":128},{"x":6672,"y":64,"w":160,"h":112},{"x":7360,"y":64,"w":352,"h":112},{"x":8128,"y":64,"w":176,"h":128},{"x":8800,"y":-256,"w":2720,"h":112},{"x":9584,"y":64,"w":128,"h":112},{"x":10272,"y":64,"w":208,"h":96}],"deathZones":[{"x":-656,"y":96,"w":224,"h":48},{"x":928,"y":144,"w":48,"h":96},{"x":3728,"y":112,"w":64,"h":80},{"x":4432,"y":112,"w":336,"h":64},{"x":6064,"y":112,"w":80,"h":80},{"x":6640,"y":112,"w":224,"h":80},{"x":7296,"y":112,"w":480,"h":80},{"x":9584,"y":96,"w":128,"h":80},{"x":10288,"y":96,"w":176,"h":48},{"x":8080,"y":112,"w":272,"h":448}],"underwaterZones":[],"whirlpoolZones":[],"surfaceZones":[],"noMarioInputZones":[],"descendingPlatformZones":[],"jumpCheepZones":[],"cheepZones":[],"lakituZones":[],"billZones":[],"fireZones":[],"maskZones":[],"angrySunZones":[],"medusaHeadZones":[],"loopZones":[],"unloadZones":[{"x":5280,"y":-192,"w":96,"h":352}],"darkbgZones":[],"pipes":[[[496,-16],[496,16],[560,208],[784,208],[800,192],[800,96],[1904,96],[1936,96]],[[2128,272],[2160,272],[2176,272],[2176,48],[2176,16]],[[3920,-16],[3920,16],[3920,64],[3888,64],[3888,96],[3888,128]],[[4064,272],[4096,272],[4112,272],[4112,48],[4112,16]],[[5984,-16],[5984,16],[5984,96],[6176,96],[6208,96]],[[6400,272],[6432,272],[6448,272],[6448,48],[6448,16]]],"vines":[{"x":680,"y":120,"h":88},{"x":3592,"y":-72,"h":216},{"x":3976,"y":120,"h":136},{"x":7448,"y":-72,"h":168},{"x":6824,"y":-72,"h":56},{"x":6840,"y":-72,"h":24},{"x":7448,"y":-24,"h":24},{"x":7464,"y":-24,"h":24},{"x":7432,"y":-24,"h":24}],"trampolines":[{"x":5272,"y":40,"h":184},{"x":7400,"y":40,"h":152}],"oscillations":[],"platformRoutes":[{"p1":{"x":3800,"y":-264},"p2":{"x":4792,"y":-264}},{"p1":{"x":7672,"y":-264},"p2":{"x":8712,"y":-264}}],"platformConnections":[]}'),Td=[],Ed=[],Ad=[],Pd=[],Cd=[];function kd(e,t,i,r){for(var o;t.length!==i;)if(t.length>i)null===(o=t.pop())||void 0===o||o.container.removeFromParent();else{const i=zh.new();e.addChild(i.container),t.push(i),r(i)}}function Bd(e,t,i){for(let r=0;r<e.length;r++){const o=e[r],s=t[r];o&&s&&i(o,s)}}function Md(e,t,i){"billZones"===t?(kd(e,Td,i.length,(e=>e.setAnimation("bulletbill"))),Bd(i,Td,((e,t)=>t.container.position.set(e.x+e.w-16,e.y+16)))):"cheepZones"===t?(kd(e,Ed,i.length,(e=>e.setAnimation("greenCheep"))),Bd(i,Ed,((e,t)=>t.container.position.set(e.x+e.w-16,e.y+16)))):"jumpCheepZones"===t?(kd(e,Ad,i.length,(e=>e.setAnimation("redCheep"))),Bd(i,Ad,((e,t)=>(t.container.angle=45,t.container.position.set(e.x+e.w-16,e.y+16))))):"fireZones"===t?(kd(e,Pd,i.length,(e=>e.setAnimation("bowserfire"))),Bd(i,Pd,((e,t)=>t.container.position.set(e.x+e.w-16,e.y+16)))):"lakituZones"===t&&(kd(e,Cd,i.length,(e=>e.setAnimation("lakitu"))),Bd(i,Cd,((e,t)=>t.container.position.set(e.x+e.w-16,e.y+16))))}const Rd=(e,t,i)=>{const r=Al.getScale();e.lineStyle(4/r,0).beginFill(0,0).moveTo(t.x,t.y).lineTo(t.x,t.y-t.h).endFill(),e.lineStyle(0,0).beginFill(0,1).drawCircle(t.x,t.y,4/r).endFill(),e.lineStyle(0,0).beginFill(0,1).drawRect(t.x-10/r,t.y-t.h-2/r,20/r,4/r).endFill(),e.lineStyle(2/r,i).beginFill(0,0).moveTo(t.x,t.y).lineTo(t.x,t.y-t.h).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(t.x,t.y,3/r).endFill(),e.lineStyle(0,0).beginFill(i,1).drawRect(t.x-9/r,t.y-t.h-1/r,18/r,2/r).endFill()},Id=(e,t,i)=>{const r=Al.getScale();e.lineStyle(0,0).beginFill(16777215,1).drawCircle(t.pstart.x,t.pstart.y,4/r).endFill(),e.lineStyle(4/r,16777215).beginFill(0,0).moveTo(t.pstart.x,t.pstart.y).lineTo(t.p1.x,t.p1.y).moveTo(t.p1.x,t.p1.y).lineTo(t.p2.x,t.p2.y).endFill(),e.lineStyle(0,0).beginFill(16777215,1).drawCircle(t.p2.x,t.p2.y,4/r).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(t.pstart.x,t.pstart.y,3/r).endFill(),e.lineStyle(2/r,i).beginFill(0,0).moveTo(t.pstart.x,t.pstart.y).lineTo(t.p1.x,t.p1.y).moveTo(t.p1.x,t.p1.y).lineTo(t.p2.x,t.p2.y).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(t.p2.x,t.p2.y,3/r).endFill()},Dd=(e,t,i)=>{const r=Al.getScale();e.lineStyle(0,0).beginFill(16777215,1).drawCircle(t.p1.x,t.p1.y,4/r).endFill(),e.lineStyle(4/r,16777215).beginFill(0,0).moveTo(t.p1.x,t.p1.y).lineTo(t.p2.x,t.p2.y).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(t.p1.x,t.p1.y,3/r).endFill(),e.lineStyle(2/r,i).beginFill(0,0).moveTo(t.p1.x,t.p1.y).lineTo(t.p2.x,t.p2.y).endFill()},Od=(e,t,i)=>{const r=Al.getScale();e.lineStyle(4/r,16777215).beginFill(0,0).moveTo(t.pin.x,t.pin.y+t.h1).lineTo(t.pin.x,t.pin.y).lineTo(t.pin.x+t.w,t.pin.y).lineTo(t.pin.x+t.w,t.pin.y+t.h2).endFill(),e.lineStyle(0,0).beginFill(16777215,1).drawCircle(t.pin.x,t.pin.y+t.h1,4/r).endFill(),e.lineStyle(0,0).beginFill(16777215,1).drawCircle(t.pin.x+.5*t.w,t.pin.y,4/r).endFill(),e.lineStyle(0,0).beginFill(16777215,1).drawCircle(t.pin.x+t.w,t.pin.y+t.h2,4/r).endFill(),e.lineStyle(2/r,i).beginFill(0,0).moveTo(t.pin.x,t.pin.y+t.h1).lineTo(t.pin.x,t.pin.y).lineTo(t.pin.x+t.w,t.pin.y).lineTo(t.pin.x+t.w,t.pin.y+t.h2).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(t.pin.x,t.pin.y+t.h1,3/r).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(t.pin.x+.5*t.w,t.pin.y,3/r).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(t.pin.x+t.w,t.pin.y+t.h2,3/r).endFill()},Nd=(e,t,i)=>{const r=Al.getScale(),o=e.lineStyle(4/r,0).beginFill(0,0);for(let e=1;e<t.length;e++){const i=t[e-1],r=t[e];i&&r&&(o.moveTo(i[0],i[1]),o.lineTo(r[0],r[1]))}o.endFill();const s=t[1],n=t.at(-2);s&&(e.lineStyle(0,0).beginFill(0,1).drawCircle(s[0],s[1],4/r).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(s[0],s[1],3/r).endFill()),n&&(e.lineStyle(0,0).beginFill(0,1).drawCircle(n[0],n[1],4/r).endFill(),e.lineStyle(0,0).beginFill(i,1).drawCircle(n[0],n[1],3/r).endFill());const l=e.lineStyle(2/r,i).beginFill(0,0);for(let e=1;e<t.length;e++){const i=t[e-1],r=t[e];i&&r&&(o.moveTo(i[0],i[1]),o.lineTo(r[0],r[1]))}l.endFill()},Ld={dynamics:new Ml(32),kinematics:new Ml(32),statics:new Ml(32),sensors:new Ml(32),grid:new Ml(32)},zd={pos:new yl(0,0),size:new yl(0,0),dr:new yl(0,0)},Gd={pos:new yl(0,0),size:new yl(0,0)},Ud={touchingDown:"touchingUp",touchingUp:"touchingDown",touchingRight:"touchingLeft",touchingLeft:"touchingRight"},Hd=e=>{zd.dr.x="touchingLeft"===e?-.1:"touchingRight"===e?.1:0,zd.dr.y="touchingUp"===e?-.1:"touchingDown"===e?.1:0;for(const t of ga.view([e])){const i=t[e];if(i){zd.pos.x=t.position.x-.5*t.size.x,zd.pos.y=t.position.y-.5*t.size.y,zd.size.x=t.size.x,zd.size.y=t.size.y;for(const r of Ld.statics.findNear(zd.pos.x+zd.dr.x,zd.pos.y+zd.dr.y,zd.size.x,zd.size.y)){if(r.userData===t)continue;Gd.pos.x=r.l,Gd.pos.y=r.t,Gd.size.x=r.w,Gd.size.y=r.h;const[o]=wl(zd,Gd);if(o){i.push(r.userData);const o=r.userData[Ud[e]];o&&o.push(t)}}for(const r of Ld.kinematics.findNear(zd.pos.x+zd.dr.x,zd.pos.y+zd.dr.y,zd.size.x,zd.size.y)){if(r.userData===t)continue;Gd.pos.x=r.userData.position.x-.5*r.userData.size.x,Gd.pos.y=r.userData.position.y-.5*r.userData.size.y,Gd.size.x=r.w,Gd.size.y=r.h;const[o]=wl(zd,Gd);if(o){i.push(r.userData);const o=r.userData[Ud[e]];o&&o.push(t)}}}}};class Vd{constructor(){this.l=0,this.t=0,this.w=0,this.h=0,this.bb={l:0,t:0,w:0,h:0},this.pos=new yl(0,0),this.size=new yl(0,0),this.dr=new yl(0,0)}inferPosAndSize(){this.pos.x=this.l,this.pos.y=this.t,this.size.x=this.w,this.size.y=this.h}set(e,t,i,r){const o=r&&e.ostensibleSize?e.ostensibleSize.x:e.size.x,s=r&&e.ostensibleSize?e.ostensibleSize.y:e.size.y;i?(this.l=e.positionPrev.x-.5*o,this.t=e.positionPrev.y-.5*s):(this.l=e.position.x-.5*o,this.t=e.position.y-.5*s),this.w=o,this.h=s,this.inferPosAndSize(),t&&e.dynamic&&(this.dr.x=e.dynamic.velocity.x*t,this.dr.y=e.dynamic.velocity.y*t)}setToZone(e){return this.l=e.x,this.t=e.y,this.w=e.w,this.h=e.h,this.inferPosAndSize(),this.dr.x=0,this.dr.y=0,this}computeBoundingBox(){return this.bb.l=this.dr.x<0?this.l+this.dr.x:this.l,this.bb.t=this.dr.y<0?this.t+this.dr.y:this.t,this.bb.w=this.dr.x<0?this.w-this.dr.x:this.w+this.dr.x,this.bb.h=this.dr.y<0?this.h-this.dr.y:this.h+this.dr.y,this.bb}get boundingBox(){return this.bb}}const jd={camera:[],preserveCamera:[],death:[],whirlpool:[],underwater:[],surface:[],noInput:[],jumpCheep:[],cheep:[],lakitu:[],bill:[],fire:[],angrySun:[],medusaHead:[],mask:[],loop:[],unload:[],darkbg:[]},Wd=new Vd,Xd=new Vd,$d=new Vd;function Yd(e,t){const i=e.x;e.x+=t;const r=vd.speedLimiter(e);return r?Math.sign(t)*Math.abs(i-r.x):t}const qd={pos:new yl(0,0),size:new yl(0,0),dr:new yl(0,0)},Zd={pos:new yl(0,0),size:new yl(0,0),dr:new yl(0,0)};function Kd(e){const t="dynamic"===e?"dynamics":"static"===e?"statics":"sensor"===e?"sensors":"kinematic"===e?"kinematics":"grid",i="dynamic"===e?"dynamicIndex":"static"===e?"staticIndex":"sensor"===e?"sensorIndex":"kinematic"===e?"kinematicIndex":"gridIndex",r=[];return ga.onAdding([e],(e=>{const o=Ld[t].create(e.position.x-.5*e.size.x,e.position.y-.5*e.size.y,e.size.x,e.size.y,e),s=r.push(o);e[i]=s-1})),ga.onRemoving([e],(e=>{const o=r[e[i]];if((null==o?void 0:o.userData)!==e)throw Error("what");Ld[t].remove(o);const s=r.at(-1);r.pop(),s&&s!==o&&(r[e[i]]=s,s.userData[i]=e[i]),e[i]=-1})),r}const Jd=Kd("dynamic");Kd("static"),Kd("grid");const Qd=Kd("kinematic"),ec=Kd("sensor");ga.onAdding([],(e=>{e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.positionStart.x=e.position.x,e.positionStart.y=e.position.y}));const tc={pos:new yl(0,0),size:new yl(0,0),dr:new yl(0,-15)},ic={pos:new yl(0,0),size:new yl(0,0)};function rc(e,t,i,r,o){const s=Uh.getFactory("tiles").new();return s.setFrame(null!=i?i:"brokenBrick1"),s.container.zIndex=1,1===(r=r||1)&&(s.container.scale.x=-1),ga.createEntity(ba({position:new yl(e,t),size:new yl(8,8),brokenBrick:{side:r,velocity:new yl(50*r,o||-266)},smb1TilesSprites:s}))}function oc(e,t,i){const r=Uh.getFactory("animObjects").new();return r.setAnimation("coin"),r.container.zIndex=-1,r.container.visible=!1,setTimeout((()=>r.container.visible=!0)),r.loopsPerSecond=3,ga.createEntity(ba({position:new yl(e,t),size:new yl(8,16),dynamic:{velocity:new yl(0,0),acceleration:new yl(0,0)},smb1ObjectsAnimations:r,collectedCoin:{lifetime:0},coinGotCollected:!0}))}function sc(e,t){const i=Uh.getFactory("objects").new();return i.setFrame("flower"),i.container.zIndex=-5,i.container.visible=!1,setTimeout((()=>i.container.visible=!0)),ga.createEntity(ba({position:new yl(e,t),size:new yl(14,16),smb1ObjectsSprites:i,grow:0,dynamic:{velocity:new yl(0,0),acceleration:new yl(0,0)},powerup:!0,hits:[]}))}function nc(e,t){const i=Uh.getFactory("objects").new();return i.setFrame("mushroom"),i.container.zIndex=-5,i.container.visible=!1,setTimeout((()=>i.container.visible=!0)),ga.createEntity(ba({position:new yl(e,t),size:new yl(14,16),smb1ObjectsSprites:i,grow:0,dynamic:{velocity:new yl(0,0),acceleration:new yl(0,0)},mushroom:!0,powerup:!0,hits:[],touchingDown:[]}))}function lc(e,t){const i=Uh.getFactory("objects").new();return i.setFrame("star"),i.container.zIndex=-1,i.container.visible=!1,setTimeout((()=>i.container.visible=!0)),ga.createEntity(ba({position:new yl(e,t),size:new yl(14,16),smb1ObjectsSprites:i,grow:0,dynamic:{velocity:new yl(0,0),acceleration:new yl(0,0)},star:!0,hits:[]}))}function ac(e){const t=e.hits,i=e.prevHits;if(t&&i){const e=t.find((e=>e.normal.y>0));if(e&&!i.find((t=>t.e===e.e))&&e.normal.y>0)return!0}return!1}const hc={pos:new yl(0,0),size:new yl(0,0),dr:new yl(0,-1)},dc=new Vd,cc={l:0,t:0,w:0,h:0},uc=ua();ga.onAdding(["grow"],(()=>{uc.sounds.get("vine").forEach((e=>e.stop())),uc.sounds.play("powerup_appears")}));const mc=new Vd,pc=new Vd,bc=ua();function*fc(e){yield*Ld.statics.findNear(e.l,e.t,e.w,e.h),yield*Ld.kinematics.findNear(e.l,e.t,e.w,e.h)}const gc={pos:new yl(0,0),size:new yl(0,0),dr:new yl(0,0)},Fc={pos:new yl(0,0),size:new yl(0,0),dr:new yl(0,0)},yc={l:0,t:0,w:0,h:0};function vc(e,t,i,r){const o=Uh.getFactory("animObjects").new();return o.setAnimation("fireball"),o.loopsPerSecond=3,o.container.zIndex=10,ga.createEntity(ba({position:new yl(e,t),size:new yl(8,8),dynamic:{acceleration:new yl(0,0),velocity:new yl(r,0)},touchingLeft:[],touchingRight:[],touchingDown:[],smb1ObjectsAnimations:o,fireball:{parent:i,startVelocity:r},gravity:777}))}const xc={pos:new yl(0,0),size:new yl(8,8)},_c=ua(),wc=new Vd,Sc=new Vd;let Tc=null;const Ec=new Vd,Ac=[];function Pc(e){var t,i;const r=e[0],o=e[1],s=e.at(-1),n=e.at(-2),l=null!==(t=null==r?void 0:r[0])&&void 0!==t?t:0,a=null!==(i=null==r?void 0:r[1])&&void 0!==i?i:0,h=r&&o?r[0]<o[0]?"r":r[0]>o[0]?"l":r[1]<o[1]?"d":"u":"u",d=s&&n?n[0]<s[0]?"r":n[0]>s[0]?"l":n[1]<s[1]?"d":"u":"u";return ga.createEntity(ba({position:new yl(l,a),size:new yl(16,16),dynamic:{velocity:new yl(0,0),acceleration:new yl(0,0)},pipe:{path:e,from:h,to:d}}))}const Cc=new Vd,kc=new Vd,Bc=new Vd,Mc=new Vd;ga.onPropChange("bonked",(e=>{if(!e.bonked)return;Bc.set(e),Bc.pos.y-=16,Bc.t-=16,Bc.w--,Bc.h--,Bc.size.x--,Bc.size.y--;const t=Bc.computeBoundingBox();for(const i of Ld.sensors.findNear(t.l,t.t,t.w,t.h)){const t=i.userData;t.coin&&(Mc.set(t),Tl.rectVsRect(Bc,Mc)&&(delete t.coin,ga.remove(t),e.player&&e.player.coins++,oc(t.position.x,t.position.y)))}}));const Rc=new Vd,Ic=new Vd,Dc=1.5*Math.PI;ga.onAdding(["spring"],(e=>{e.smb1ObjectsAnimations&&(e.smb1ObjectsAnimations.loopsPerSecond=0)}));const Oc=new Vd,Nc=new Vd;const Lc={enemySpeed:40,enemyGravity:600},zc=new Vd,Gc=Lc.enemyGravity,Uc=ua(),Hc=new Vd,Vc=new Vd,jc=new Vd,Wc=new Vd,Xc=new kn("8000",{fontFamily:"Mario",fill:"white"}),$c=Xc.width/Xc.height;Xc.width=18,Xc.height=Xc.width/$c,Xc.updateText(!1);const Yc=[];function*qc(e){yield*Ld.dynamics.findNear(e.l,e.t,e.w,e.h),yield*Ld.sensors.findNear(e.l,e.t,e.w,e.h)}function*Zc(e){yield*Ld.statics.findNear(e.l,e.t,e.w,e.h),yield*Ld.kinematics.findNear(e.l,e.t,e.w,e.h)}function Kc(){return 2*Math.random()-1}function Jc(e,t){const i=Uh.getFactory("mario").new();return i.setAnimation("smallDie"),i.container.zIndex=10,ga.createEntity(ba({position:new yl(e,t),size:new yl(12,15),dynamic:{velocity:new yl(66*Kc(),-150*Math.random()-50),acceleration:new yl(0,0)},goThrougWalls:!0,gravity:600,angVel:360*Kc(),smb1MarioAnimations:i,deleteOutOfCam:!0}))}const Qc=ua(),eu=ua(),tu=new Vd;let iu=0;function ru(e,t,i){const r=fd(e,t,"bulletbill");r.enemy={star:!0,stomp:!0,shell:!0,fireball:!1};const o=ga.view(["mario"]).reduce(((e,t)=>e?Math.abs(t.position.x-r.position.x)<Math.abs(t.position.x-r.position.x)?t:e:t),void 0);return r.bill={speed:111,direction:o&&o.position.x-r.position.x<0?-1:1,parent:i},r.sensor=!0,r.moving=!0,r.smb1EnemiesAnimations&&(r.smb1EnemiesAnimations.container.scale.x=-r.bill.direction),r}ga.onAdding(["bill"],(()=>{eu.sounds.play("fireworks")}));let ou=0;ga.onAdding(["fire"],(()=>{eu.sounds.play("bowserfire")}));let su=0,nu=0;function lu(e,t){const i=fd(e,t,"spinyEgg");return i.ostensibleSize=new yl(20,20),i.enemy={star:!0,stomp:!1,shell:!0,fireball:!0,lookTowards:"direction"},i.dynamic={velocity:new yl(Lc.enemySpeed*(2*Math.random()-1),-30),acceleration:new yl(0,0)},i.hits=[],i.prevHits=[],i.touchingDown=[],i.movement={horizontal:-Lc.enemySpeed,flipEachOther:!0},i.gravity=Lc.enemyGravity,i.maxSpeed=300,i.deleteOutOfCam=!0,i.spiny=!0,i}let au=0;const hu=new Vd,du=new Vd,cu=new Vd,uu=new Vd,mu=new Vd;class pu{constructor(){this.active=!0}stop(){this.active=!1}unload(){if(this.active)for(const e of ga.view(["mario"])){cu.set(e),uu.set(e,void 0,!0);for(const t of jd.unload)if(Tl.rectVsRect(mu.setToZone(t),uu)&&!Tl.rectVsRect(mu,cu)&&e.position.x>t.x+t.w){this.scanAndDestroy(t),e.mario&&(e.mario.respawnPoint=Object.assign({},e.position));const i=new Set(jd.unload);i.delete(t),jd.unload.length=0,jd.unload.push(...i);break}}}scanAndDestroy(e){if(!this.active)return;const t=Object.assign({},e);t.x-=e.w;let i=0;for(const e of function*(e,t,i,r){yield*Ld.dynamics.findNear(e,t,i,r),yield*Ld.statics.findNear(e,t,i,r),yield*Ld.grid.findNear(e,t,i,r),yield*Ld.sensors.findNear(e,t,i,r),yield*Ld.kinematics.findNear(e,t,i,r)}(t.x,t.y,t.w,t.h))i++,ga.remove(e.userData);i?setTimeout((()=>this.scanAndDestroy(t)),100):console.log("unload done")}}class bu{constructor(){this.prev=new Set,this.enabled=!0}toggle(e){if(this.enabled=void 0===e?!this.enabled:e,!this.enabled)for(const e of ga.view(["distanceModifiers"])){const t=e.smb1TilesSprites;t&&(t.container.position.x=e.position.x,t.container.position.y=e.position.y)}}update(e){if(!this.enabled)return;const t=e.getCenterX(),i=e.getCenterY(),{l:r,t:o,w:s,h:n}=e.getBoundingBox();for(const e of this.prev){const t=e.smb1TilesSprites;t&&(t.container.position.x=e.position.x,t.container.position.y=e.position.y)}this.prev.clear();for(const e of Ld.grid.findNear(r-.5*s,o,2*s,n)){const r=e.userData;this.prev.add(r);const o=r.smb1TilesSprites,s=r.distanceModifiers;if(!o||!s)continue;const n=t-r.position.x,l=i-r.position.y;o.container.position.x=r.position.x+n*s.x,o.container.position.y=r.position.y+l*s.y}}}const fu=ua(),gu=[0,0];function Fu(e,t,i,r){return[(1-e)*i[0]+e*r[0]-t[0],(1-e)*i[1]+e*r[1]-t[1]]}function yu(e){return e[0]**2+e[1]**2}function vu(e,t,i){const r=[i[0]-t[0],i[1]-t[1]],o=[t[0]-e[0],t[1]-e[1]],s=-(r[0]*o[0]+r[1]*o[1])/(r[0]**2+r[1]**2);return s>=0&&s<=1?Fu(s,gu,t,i):yu(Fu(0,e,t,i))<=yu(Fu(1,e,t,i))?t:i}window.getViewPopulation=()=>ga.getViewPopulation();Al.setBGColor("#9290FF"),Al.countFps(),Al.showFps();const xu=ua(),_u=new class extends zl{constructor(){super(...arguments),this.g=null}onStart(e){this.g=e}onUpdate(e){return 1!==xu.controller.getloadingProgress()}onEnd(){var e,t;return[this.g?{graphics:null===(e=this.g)||void 0===e?void 0:e.graphics,input:null===(t=this.g)||void 0===t?void 0:t.input}:null,"edit"]}},wu=new class extends zl{constructor(){super(...arguments),this.unloader=new pu,this.mouseX=0,this.mouseY=0,this.mousePrevX=0,this.mousePrevY=0,this.spanVel=new yl(0,0),this.scale=1,this.parallax=new bu,this.lowestY=1/0,this.paused=!1}onStart(e){if(this.paused=!1,this.lowestY=ga.view().reduce(((e,t)=>{const i=t.position.y;return i>e?i:e}),-1/0),!e)return;this.graphics=e.graphics,this.input=e.input;for(const e of Object.values(jd))e.length=0;for(const t of Object.keys(jd))switch(t){case"angrySun":jd.angrySun.push(...e.zones.angrySunZones);break;case"bill":jd.bill.push(...e.zones.billZones);break;case"camera":jd.camera.push(...e.zones.camZones);break;case"cheep":jd.cheep.push(...e.zones.cheepZones);break;case"darkbg":jd.darkbg.push(...e.zones.darkbgZones);break;case"death":jd.death.push(...e.zones.deathZones);break;case"fire":jd.fire.push(...e.zones.fireZones);break;case"jumpCheep":jd.jumpCheep.push(...e.zones.jumpCheepZones);break;case"lakitu":jd.lakitu.push(...e.zones.lakituZones);break;case"loop":jd.loop.push(...e.zones.loopZones);break;case"mask":jd.mask.push(...e.zones.maskZones);break;case"medusaHead":jd.medusaHead.push(...e.zones.medusaHeadZones);break;case"noInput":jd.noInput.push(...e.zones.noMarioInputZones);break;case"preserveCamera":jd.preserveCamera.push(...e.zones.camPreserveZones);break;case"unload":jd.unload.push(...e.zones.unloadZones);break;case"surface":jd.surface.push(...e.zones.surfaceZones);break;case"underwater":jd.underwater.push(...e.zones.underwaterZones);break;case"whirlpool":jd.whirlpool.push(...e.zones.whirlpoolZones)}e.pipes.forEach((e=>{Pc(e),Pc([...e].reverse())}));const t={l:0,t:0,w:2,h:2},i={pos:{x:0,y:0},size:{x:2,y:2}},r=new Vd;e.vines.forEach((e=>{t.l=e.x-1,t.t=e.y-1,i.pos.x=t.l,i.pos.y=t.t;for(const o of Ld.statics.findNear(t.l,t.t,t.w,t.h)){const t=o.userData;r.set(t),Tl.rectVsRect(i,r)&&(t.brick=!1,t.coinblock="vine",t.vineCreator=e)}})),e.trampolines.forEach((e=>{!function(e,t,i){const r=Uh.getFactory("animObjects").new();r.setAnimation("spring"),ga.createEntity(ba({position:new yl(e,t-8),size:new yl(16,32),static:!0,smb1ObjectsAnimations:r,spring:{h:i},touchingUp:[],hits:[]}))}(e.x,e.y,e.h)})),e.oscillations.forEach((e=>{t.l=e.pstart.x-1,t.t=e.pstart.y-1,i.pos.x=t.l,i.pos.y=t.t;let o=!1;for(const s of function*(e,t,i,r){yield*Ld.kinematics.findNear(e,t,i,r),yield*Ld.dynamics.findNear(e,t,i,r)}(t.l,t.t,t.w,t.h)){const t=s.userData;if(r.set(t),Tl.rectVsRect(i,r)){o=!0,t.platform={};const i=new yl(e.p1.x,e.p1.y).add(new yl(e.p2.x,e.p2.y).sub(e.p1).mul(.5)),r=vu([e.pstart.x,e.pstart.y],[e.p1.x,e.p1.y],[e.p2.x,e.p2.y]),s=new yl(r[0],r[1]),n=Math.sign(i.sub(s).unit().dot(i.sub(e.p1).unit()))*i.sub(s).length(),l=.5*new yl(e.p1.x,e.p1.y).sub(e.p2).length();let a=-Math.acos(n/l)||0;t.position.x=s.x,t.position.y=s.y,t.positionStart.x=s.x,t.positionStart.y=s.y,t.positionPrev.x=s.x,t.positionPrev.y=s.y,t.platform.oscillate={from:new yl(e.p1.x,e.p1.y),to:new yl(e.p2.x,e.p2.y),middle:i,freq:1,t:0,phase:a}}}if(!o){const t=new yl(e.p2.x,e.p2.y).sub(e.p1),i=t.scaledTo1().length();let r=t.length()/i;Number.isNaN(r)&&(r=16),r/=2,r*=6;const o=t.toPolar(),s=(e.pstart.x-e.p1.x)/16*Math.PI/2;!function(e,t,i,r,o){const s=ga.createEntity(ba({position:new yl(e,t),size:new yl(0,0),firebar:{angle:r,angvel:o}}));for(let e=0;e<i;e+=8){const t=Uh.getFactory("animObjects").new();t.setAnimation("fireball"),t.loopsPerSecond=3,ga.createEntity(ba({size:new yl(4,4),firebarFireball:{parent:s,length:e},smb1ObjectsAnimations:t,moving:!0,sensor:!0,enemy:{fireball:!1,stomp:!1,shell:!1,star:!1,fireballGoesThrough:!0}}))}}(e.pstart.x,e.pstart.y,r,o.y,s),console.log(e.pstart.x,e.pstart.y,r,o.y,s)}})),e.platformRoutes.forEach((e=>{t.l=e.p1.x-1,t.t=e.p1.y-1,i.pos.x=t.l,i.pos.y=t.t;for(const o of Ld.kinematics.findNear(t.l,t.t,t.w,t.h)){const t=o.userData;r.set(t),Tl.rectVsRect(i,r)&&(t.platform={moveTo:{location:new yl(e.p2.x,e.p2.y)}})}})),e.platformConnections.forEach((e=>{const r=Object.assign({},e.pin);r.y+=e.h1;const o=Object.assign({},e.pin);o.x+=e.w,o.y+=e.h2;let s=null,n=null;t.l=r.x-1,t.t=r.y-1,i.pos.x=t.l,i.pos.y=t.t;for(const e of Ld.kinematics.findNear(t.l,t.t,t.w,t.h)){const t=e.userData;if(Tl.pointVsRect(t.position,i)){t.platform={},s=t;break}}t.l=o.x-1,t.t=o.y-1,i.pos.x=t.l,i.pos.y=t.t;for(const e of Ld.kinematics.findNear(t.l,t.t,t.w,t.h)){const t=e.userData;if(Tl.pointVsRect(t.position,i)){t.platform={},n=t;break}}s&&n&&function(e,t,i,r,o,s){dd(e,t,{type:"tile",frame:"clutterSuspenderLeft"});const n=dd(.5*(r.position.x+e),t,{type:"tile",frame:"clutterSuspenderRope"});n.smb1TilesSprites&&(n.smb1TilesSprites.container.scale.x=(r.position.x-(e+16))/16),dd(r.position.x,t,{type:"tile",frame:"clutterSuspenderRight"});const l=dd(e,t+8,{type:"tile",frame:"clutterSuspenderRopeVertical"}),a=dd(r.position.x,t+8,{type:"tile",frame:"clutterSuspenderRopeVertical"});ga.createEntity(ba({position:new yl(e,t),size:new yl(0,0),platformConnection:{p1:i,p2:r,p1H:o,p2H:s-o,rope1:l,rope2:a},platformConnectionIsConnected:!0}))}(e.pin.x,e.pin.y,s,n,e.h1,e.h1+e.h2)})),e.zones.descendingPlatformZones.forEach((r=>{t.l=r.x,t.t=r.y,t.w=r.w,t.h=r.h,i.pos.x=t.l,i.pos.y=t.t,i.size.x=t.w,i.size.y=t.h;const o=e.oscillations.find((e=>Tl.pointVsRect(e.pstart,i)))?8:0,s=!!e.platformRoutes.find((e=>Tl.pointVsRect(e.p1,i)&&e.p2.y<e.p1.y));for(const e of Ld.kinematics.findNear(t.l,t.t,t.w,t.h)){const t=e.userData;Tl.pointVsRect(t.position,i)&&(t.platform={bounded:{top:r.y,bottom:r.y+r.h}},t.kinematic||(t.kinematic={velocity:new yl(0,0),acceleration:new yl(0,0)}),t.kinematic.velocity.y=25*(s?-1:1),t.position.x+=o)}if(e.platformConnections.find((e=>Tl.pointVsRect(e.pin,i)))){const e=dd(i.pos.x+.5*i.size.x+o,i.pos.y+.5*i.size.y,{type:"tile",frame:"clutterSuspenderRopeVertical"});e.smb1TilesSprites&&(e.smb1TilesSprites.container.scale.y=i.size.y/16,e.smb1TilesSprites.container.zIndex-=1)}})),this.unloader=new pu}onEnd(){this.paused=!1,this.respawnTimer=void 0,Al.stopMoveTo(),this.unloader.stop();for(const e of Object.values(jd))e.length=0;return this.graphics&&this.input?[{graphics:this.graphics,input:this.input},"editor"]:[null,"editor"]}onUpdate(e){if(!this.graphics||!this.input)return!1;if(this.input.isPressed("Space"))return!1;const t=this.paused;this.input.isPressed("KeyP")&&(this.paused=!this.paused),this.input.isPressed("KeyT")&&this.parallax.toggle(),this.paused!==t&&fu.sounds.play("pause"),function(e,t){for(const t of function*(){yield*ga.view(["dynamic"]),yield*ga.view(["enemy","sensor"])}()){Nc.set(t);const i=jd.death.some((e=>Tl.rectVsRect(Nc,{pos:{x:e.x,y:e.y},size:{x:e.w,y:e.h}})));(t.position.y>e||i)&&(t.mario?(t.mario.dead=!0,t.mario.big=!1,t.star=!1,delete t.mario.powerup):i||ga.remove(t))}for(const e of ga.view(["deleteOutOfCam"]))Nc.set(e,void 0,void 0,!0),t.overlapsRectBroad(Nc)||ga.remove(e)}(this.lowestY,Al),ga.update();for(const e of ga.view(["mario"]))this.input.isPressed("KeyH")&&e.mario&&(e.mario.big=!e.mario.big,e.mario.changedSize=!0),this.input.isPressed("KeyF")&&e.mario&&(e.mario.powerup="fire"!==e.mario.powerup?"fire":void 0),this.input.isPressed("KeyU")&&e.mario&&(e.underwater=!e.underwater);for(const e of ga.view(["displace"]))e.displace&&(e.position.x+=e.displace.x,e.position.y+=e.displace.y,e.positionStart.x=e.position.x,e.positionStart.y=e.position.y,e.smb1EnemiesAnimations&&(e.smb1EnemiesAnimations.container.position.x=e.position.x,e.smb1EnemiesAnimations.container.position.y=e.position.y),delete e.displace);if(this.graphics.clear(),this.paused||(Hd("touchingUp"),Hd("touchingRight"),Hd("touchingDown"),Hd("touchingLeft"),function(e){var t,i,r,o;for(const o of ga.view(["platform"])){const s=o.platform;if(!s)continue;const n=s.oscillate;if(n){for(n.t+=e;n.t>2*Math.PI/n.freq;)n.t-=2*Math.PI/n.freq;const t=.5*new yl(n.from.x,n.from.y).sub(n.to).length(),i=Math.cos(n.freq*n.t+n.phase)*t,r=n.middle.add(n.from.sub(n.middle).unit().mul(i)),s=o.kinematic?o.kinematic:o.dynamic;if(s){const t=r.x-o.position.x,i=r.y-o.position.y;s.velocity.x=t/e,s.velocity.y=i/e}}else if(s.moveTo){if((null===(t=o.touchingUp)||void 0===t?void 0:t.find((e=>e.mario)))&&(delete o.touchingUp,o.kinematic)){const e=s.moveTo.location.sub(o.position).unit().mul(75);o.kinematic.velocity.x=e.x,o.kinematic.velocity.y=e.y}if(o.kinematic)if(s.moveTo.stop)o.kinematic.velocity.x=0,o.kinematic.velocity.y=0,delete s.moveTo;else{if(s.moveTo.location.sub(o.position).length()<=o.kinematic.velocity.mul(e).length()){const t=s.moveTo.location.sub(o.position);o.kinematic.velocity.x=t.x/e,o.kinematic.velocity.y=t.y/e,s.moveTo.stop=!0}s.moveTo.location.sub(o.positionStart).dot(s.moveTo.location.sub(o.position))<-1&&(o.position=s.moveTo.location,o.kinematic.velocity.x=0,o.kinematic.velocity.y=0,delete s.moveTo)}}else if(s.crumble){const e=null===(i=o.touchingUp)||void 0===i?void 0:i.find((e=>e.mario));e?o.kinematic&&(o.kinematic.acceleration.y=null!==(r=e.gravity)&&void 0!==r?r:0,o.kinematic.velocity.y>100&&(o.kinematic.acceleration.y=0,o.kinematic.velocity.y=100)):o.kinematic&&(o.kinematic.acceleration.y=0,o.kinematic.velocity.y=0)}else if(s.bounded){if(o.kinematic)if(o.kinematic.velocity.y>0)for(;o.position.y>s.bounded.bottom;){const e=s.bounded.bottom-s.bounded.top;o.position.y-=e}else for(;o.position.y<s.bounded.top;){const e=s.bounded.bottom-s.bounded.top;o.position.y+=e}}else s.fall&&o.kinematic&&(o.kinematic.acceleration.y=200,o.kinematic.velocity.y>200&&(o.kinematic.acceleration.y=0,o.kinematic.velocity.y=200),Oc.set(o),Al.overlapsRectBroad(Oc)||ga.remove(o))}for(const t of ga.view(["platformConnection","platformConnectionIsConnected"])){const i=t.platformConnection;if(!i)continue;const r=i.p1.kinematic,s=i.p2.kinematic;if(!r||!s)continue;let n=!1;for(const e of["p1","p2"]){const t="p1"===e?r:s,l="p1"===e?s:r;(null===(o=i[e].touchingUp)||void 0===o?void 0:o.find((e=>e.mario)))&&(n=!0,t.acceleration.y=25,t.velocity.y>100?(t.acceleration.y=0,t.velocity.y=100,l.velocity.y=-t.velocity.y):(l.acceleration.y=-t.acceleration.y,l.velocity.y=-t.velocity.y))}if(!n&&r.velocity.y){const t=Math.sign(r.velocity.y);r.acceleration.y=-25*t,Math.sign(r.velocity.y+r.acceleration.y*e)!==t?(r.acceleration.y=0,r.velocity.y=0,s.velocity.y=0,s.acceleration.y=0):s.acceleration.y=-r.acceleration.y}}}(e),function(){for(const e of["floorSpeed","floorSpeedY"])for(const t of ga.view(["touchingDown","dynamic",e])){const i=t.dynamic,r=t.touchingDown;void 0!==t[e]&&(i&&r?(t[e]=r.reduce(((e,t)=>{var i,r,o,s;return Math.abs(e)>Math.abs(null!==(r=null===(i=t.kinematic)||void 0===i?void 0:i.velocity.x)&&void 0!==r?r:0)?null!==(s=null===(o=t.kinematic)||void 0===o?void 0:o.velocity.x)&&void 0!==s?s:0:e}),1/0),Number.isFinite(t[e])||(t[e]=0)):t[e]=0)}}(),function(e,t){for(const i of ga.view(["marioInput","player"])){const r=i.marioInput;if(r){r.anyPressed=!1;const o=r.inputs;for(const e in o)"number"==typeof o[e]?(o[e]-=t,o[e]<0&&(o[e]=0)):o[e]=!1;if(jd.noInput.some((e=>Tl.pointVsRect(i.position,Wd.setToZone(e)))))continue;e.isPressed("ArrowLeft")&&(r.anyPressed=!0,o.left=!0,o.leftPress=!0),e.isHeld("ArrowLeft")&&(o.left=!0),e.isPressed("ArrowRight")&&(r.anyPressed=!0,o.right=!0,o.rightPress=!0),e.isHeld("ArrowRight")&&(o.right=!0),o.right&&o.left&&(o.right=!1,o.left=!1,o.leftPress=!0,o.rightPress=!0),e.isPressed("ArrowDown")&&(r.anyPressed=!0,o.ducking=!0),e.isHeld("ArrowDown")&&(o.ducking=!0),e.isHeld("KeyC")&&(o.run=1/6),e.isPressed("KeyC")&&(o.attack=!0,r.anyPressed=!0,o.run=1/6),e.isPressed("KeyX")&&(o.jump=!0,o.jumping=!0,r.anyPressed=!0),e.isHeld("KeyX")&&(o.jumping=!0),e.isPressed("ArrowUp")&&(r.anyPressed=!0,o.climbUp=!0),e.isHeld("ArrowUp")&&(o.climbUp=!0),e.isPressed("ArrowDown")&&(r.anyPressed=!0,o.climbDown=!0),e.isHeld("ArrowDown")&&(o.climbDown=!0)}}}(this.input,e),function(e,t){var i,r,o,s,n,l,a,h,d,c,u,m,p;for(const t of ga.view(["pipe"])){if(!t.pipe)continue;Cc.set(t),Cc.computeBoundingBox();const a=Cc.boundingBox;for(const h of Ld.dynamics.findNear(a.l,a.t,a.w,a.h)){const a=h.userData;a.mario&&(kc.set(h.userData),Tl.rectVsRect(Cc,kc)&&("u"===t.pipe.from&&(null===(i=a.touchingDown)||void 0===i?void 0:i.length)&&(e.isPressed("ArrowDown")||e.isHeld("ArrowDown"))||"l"===t.pipe.from&&(null===(r=a.touchingLeft)||void 0===r?void 0:r.length)&&(e.isPressed("ArrowLeft")||e.isHeld("ArrowLeft"))||"r"===t.pipe.from&&(null===(o=a.touchingRight)||void 0===o?void 0:o.length)&&(e.isPressed("ArrowRight")||e.isHeld("ArrowRight"))||"d"===t.pipe.from&&(null===(s=a.touchingDown)||void 0===s?void 0:s.length)&&(e.isPressed("ArrowDown")||e.isHeld("ArrowDown")))&&(delete a.dynamic,a.mario.inPipe={path:t.pipe.path,from:t.pipe.from,to:t.pipe.to,zIndex:null!==(l=null===(n=t.smb1MarioAnimations)||void 0===n?void 0:n.container.zIndex)&&void 0!==l?l:1},a.smb1MarioAnimations&&(a.smb1MarioAnimations.container.zIndex=-10)))}}for(const e of ga.view(["mario"])){const i=null===(a=e.mario)||void 0===a?void 0:a.inPipe;if(i){void 0===i.iTarget?(i.iTarget=0,i.started=!0):i.started=!1;const r=i.path[0],o=r?{x:r[0],y:r[1]}:null,s=i.path.at(-1),n=s?{x:s[0],y:s[1]}:null;if(e.smb1MarioAnimations&&e.mario){const t=o&&i.iTarget<2&&e.position.sub(o).length()<32||n&&i.iTarget>i.path.length-2&&e.position.sub(n).length()<32;e.smb1MarioAnimations.container.visible=null!=t&&t,t||("d"===i.to||"u"===i.to?e.mario.jumping=!0:"l"!==i.to&&"r"!==i.to||(e.mario.jumping=!1,e.mario.inPipe&&(e.mario.inPipe.nonIdle=!0),"l"===i.to?e.mario.facing=-1:e.mario.facing=1))}const l=i.path[i.iTarget],a=l?{x:l[0],y:l[1]}:null;if(a){const r=e.position.sub(a);if(r.length()<1)i.iTarget++;else{const o=0===i.iTarget?200:1===i.iTarget||i.iTarget===i.path.length-1?100:444,s=e.position.sub(a).unit().mul(-o*t);e.position.x+=s.x,e.position.y+=s.y,e.position.sub(a).dot(r)<0&&i.iTarget++,e.smb1MarioAnimations&&(e.smb1MarioAnimations.container.x=e.position.x,e.smb1MarioAnimations.container.y=e.position.y)}}else{i.exiting=null!==(h=i.exiting)&&void 0!==h?h:{x:null!==(c=null===(d=i.path.at(-1))||void 0===d?void 0:d[0])&&void 0!==c?c:e.position.x,y:null!==(m=null===(u=i.path.at(-1))||void 0===u?void 0:u[1])&&void 0!==m?m:e.position.y};const r="d"===i.to?{x:0,y:100*t}:"u"===i.to?{x:0,y:-100*t}:"r"===i.to?{x:100*t,y:0}:{x:-100*t,y:0};e.position.x+=r.x,e.position.y+=r.y,e.smb1MarioAnimations&&(e.smb1MarioAnimations.container.x=e.position.x,e.smb1MarioAnimations.container.y=e.position.y);let o="d"===i.to||"u"===i.to?.55*e.size.y:.55*e.size.x;e.position.sub(i.exiting).length()>o&&(e.smb1MarioAnimations&&(void 0!==i.zIndex&&(e.smb1MarioAnimations.container.zIndex=i.zIndex),e.smb1MarioAnimations.container.visible=!0),null===(p=e.mario)||void 0===p||delete p.inPipe,e.dynamic={velocity:new yl(0,0),acceleration:new yl(0,0)})}}}}(this.input,e),function(){for(const e of ga.view(["dynamic","gravity"])){const t=e.dynamic,i=e.gravity;t&&i&&(t.acceleration.y+=i)}}(),function(e,t){var i,r,o,s,n,l,a,h,d;for(const t of ga.view(["marioInput","marioMovementConfig","dynamic","mario"])){const c=t.marioMovementConfig,u=t.marioInput,m=t.dynamic,p=t.mario,b=!!(null===(i=t.touchingLeft)||void 0===i?void 0:i.length),f=!!(null===(r=t.touchingRight)||void 0===r?void 0:r.length),g=!!(null===(o=t.touchingDown)||void 0===o?void 0:o.length);if(c&&u&&m&&p){t.underwater=jd.underwater.some((e=>Tl.pointVsRect(t.position,$d.setToZone(e)))),p.surface=jd.surface.some((e=>Tl.pointVsRect(t.position,$d.setToZone(e))));const i=jd.whirlpool.find((e=>Tl.pointVsRect(t.position,$d.setToZone(e))));if(i){p.whirlpool=!0;let e=i.x+.5*i.w-t.position.x;Math.abs(e)<10&&(e=0),p.wind=30*Math.sign(e)}else delete p.whirlpool,delete p.wind;const r=!!t.underwater,o=u.inputs,F=(r||g||p.climbing)&&o.jump&&!p.jumpCooldown,y=g&&!F&&!p.jumpCooldown;t.gravity=t.gravity||c.initFallGravity,p.jumped=!1,p.jumpCooldown&&(p.jumpCooldown-=e,p.jumpCooldown<=0&&(p.jumpCooldown=0));const v=Math.sign(m.velocity.x);let x=Math.abs(m.velocity.x);const _=o.left?-1:o.right?1:0;p.prevGrounded=p.grounded;const w=p.ducking,S=p.forcedDucking||p.ducking||w;if(p.onSpring)if(void 0===(null===(s=p.onSpring.spring.spring)||void 0===s?void 0:s.progress)){p.jumpCooldown=5/60;let t=null!==(l=null===(n=p.onSpring.spring.spring)||void 0===n?void 0:n.h)&&void 0!==l?l:0;t-=24,t<0&&(t=0);const i=(null!==(a=p.jumpSpeed)&&void 0!==a?a:0)+m.velocity.y,r=Math.max(i,Math.sqrt(2*t*c.walkJumpGravity));m.acceleration.y=o.jumping?-r/e:-i/e,m.acceleration.x=.25*p.onSpring.vx/e,delete p.onSpring}else m.velocity.x=0,m.velocity.y=0,m.acceleration.x=0,m.acceleration.y=0;else if(p.climbing){const i=p.facing;if(o.leftPress&&-1===p.facing&&(p.facing=1),o.rightPress&&1===p.facing&&(p.facing=-1),m.velocity.x=0,m.velocity.y=0,m.acceleration.x=0,m.acceleration.y=0,o.climbUp&&(m.acceleration.y=-50/e),o.climbDown&&(m.acceleration.y=50/e),i!==p.facing){m.velocity.x=t.size.x*p.facing*2/e,m.velocity.y=m.acceleration.y*e,Xd.set(t,e),Xd.computeBoundingBox();const r=Xd.boundingBox;for(const e of Ld.statics.findNear(r.l,r.t,r.w,r.h)){$d.set(e.userData);const[t]=Tl.dynamicRectVsRect(Xd,$d);t&&(p.facing=i)}m.velocity.x=0,m.velocity.y=0}t.position.x=p.climbing.position.x-p.facing*t.size.x/2,t.gravity=0,F&&(delete p.climbing,p.climbingCooldown=.2,m.acceleration.x=50*-p.facing/e,o.climbDown||(p.jumped=!0,p.jumping=!0,p.jumpCooldown=5/60,p.facing=-1===p.facing?1:-1,m.acceleration.y=-((null!==(h=p.jumpSpeed)&&void 0!==h?h:0)+m.velocity.y)/e))}else if(y){p.ducking=o.ducking&&p.big,p.maxAirSpeed=void 0,p.jumping=!!p.jumpCooldown,p.grounded=!p.jumpCooldown;const t=!!o.run,i=x<1;if(p.running=!1,S||!_||!i&&_!==v){const t=p.skidDecel&&!u.anyPressed;p.skidDecel=!i&&t;const r=p.skidding;if(p.skidding=p.skidding&&!i,!(1===v&&f||-1===v&&b)){let t=0;if(S)p.skidDecel=!1,p.skidding=!1,_&&i&&(p.facing=_);else if(_)p.skidDecel=!0,p.skidding=!0,x<=c.skidTurnaround&&(p.facing=_,p.skidding=!1);else if(x>c.skidTurnaround){const e=p.facing;p.facing=p.skidding||!v?p.facing:v<0?-1:1,v&&v!==e&&(p.skidding=!0)}else r&&i&&(p.facing=1===p.facing?-1:1);t=p.skidDecel?c.skidDecel:c.releaseDecel,x<=t*e&&(t=x/e),m.acceleration.x+=-t*v}}else if(p.skidDecel=!1,p.skidding=!1,p.facing=_,!(1===_&&f||-1===_&&b)){let i=0;i=x<c.minWalkSpeed?c.minWalkSpeed/e:t?c.runAccel:c.walkAccel;const o=r?c.maxWalkSpeedUnderwater:t?c.maxRunSpeed:c.maxWalkSpeed;o===c.maxRunSpeed&&(p.running=!0),x+i*e>=o&&(i=(o-x)/e),m.acceleration.x+=i*_}}else if(p.skidding&&!F&&(p.facing=1===p.facing?-1:1),p.grounded=!1,p.skidding=!1,p.skidDecel=!1,!F&&p.maxAirSpeed||(p.maxAirSpeed=x>c.maxWalkSpeed+Number.EPSILON?c.maxRunSpeed:c.maxWalkSpeed,r?(p.jumpSpeed=p.whirlpool?c.whirlpoolJump:p.surface?c.surfaceJump:c.swimJump,p.jumpGravity=p.whirlpool?c.whirlpoolJumpGravity:c.swimJumpGravity,p.fallGravity=p.whirlpool?c.whirlpoolFallGravity:c.swimFallGravity):(p.jumpSpeed=x<c.walkGravitySpeed?c.walkJump:x<c.midGravitySpeed?c.midJump:c.runJump,p.jumpGravity=x<c.walkGravitySpeed?c.walkJumpGravity:x<c.midGravitySpeed?c.midJumpGravity:c.runJumpGravity,p.fallGravity=x<c.walkGravitySpeed?c.walkFallGravity:x<c.midGravitySpeed?c.midFallGravity:c.runFallGravity)),t.gravity=o.jumping&&m.velocity.y<=0?p.jumpGravity:p.fallGravity,r&&(p.ducking=!1,p.surface&&(t.gravity=o.jumping&&m.velocity.y<=0?c.surfaceJumpGravity:c.surfaceFallGravity),t.gravity&&(t.gravity+=225),_&&_!==p.facing&&x<=c.skidTurnaround&&(p.facing=_)),F?(p.jumped=!0,p.jumping=!0,p.jumpCooldown=5/60,m.acceleration.y=-((null!==(d=p.jumpSpeed)&&void 0!==d?d:0)+m.velocity.y)/e):(p.jumping||(p.ducking=!1),p.prevGrounded&&x>.98*c.maxRunSpeed&&(m.acceleration.y=-(10+m.velocity.y)/e)),_){let t=0;t=_===p.facing?x>=c.maxWalkSpeed?c.jumpFastAccel:c.jumpSlowAccel:x>=c.maxWalkSpeed?c.jumpFastDecel:x>=c.jumpBackwardsDecelThreshold?c.jumpNormalDecel:c.jumpSlowDecel,v===_&&x+t*e>=p.maxAirSpeed&&(t=(p.maxAirSpeed-x)/e),m.acceleration.x+=t*_}p.shooting&&(p.shooting-=e,p.shooting<=0&&(p.shooting=0)),"fire"===p.powerup&&p.big&&!p.climbing&&(!o.attack||p.shooting||S||(p.shooting=.1,p.shot=!0))}}}(e),function(e){var t,i,r,o,s;for(const o of ga.view(["mario"]))if(null===(t=o.mario)||void 0===t?void 0:t.shot){const t=o.mario.skidding?-o.mario.facing:o.mario.facing;let s=o.position.x,n=o.position.y;o.smb1MarioAnimations&&(s=o.smb1MarioAnimations.container.position.x,n=o.smb1MarioAnimations.container.position.y);const l=vc(s+2*t,n,o,t*(150+Math.abs(null!==(r=null===(i=o.dynamic)||void 0===i?void 0:i.velocity.x)&&void 0!==r?r:0)*(o.mario.skidding?0:1)));wc.set(l,e),wc.dr.x+=6*t;const a=wc.computeBoundingBox();for(const e of Ld.statics.findNear(a.l,a.t,a.w,a.h)){if(l===e.userData)continue;Sc.set(e.userData);const[t,i]=Tl.dynamicRectVsRect(wc,Sc);if(t&&0!==i.normal.x){l.dynamic&&(l.dynamic.velocity.x=0);break}}for(const t of Ld.kinematics.findNear(a.l,a.t,a.w,a.h)){if(l===t.userData)continue;Sc.set(t.userData,e);const[i,r]=Tl.dynamicRectVsDynamicRect(wc,Sc);if(i&&0!==r.normal.x){l.dynamic&&(l.dynamic.velocity.x=0);break}}l.position.x+=6*t,l.smb1ObjectsAnimations&&(l.smb1ObjectsAnimations.container.scale.x=t)}for(const e of ga.view(["fireball"]))e.fireball&&(e.dynamic&&(null===(o=e.touchingDown)||void 0===o?void 0:o.length)&&e.dynamic.velocity.y>=0&&(e.dynamic.velocity.y=-170),xc.pos=e.position,Al.overlapsRectBroad(xc)||ga.remove(e),(!(null===(s=e.dynamic)||void 0===s?void 0:s.velocity.x)||Math.sign(e.dynamic.velocity.x)!==Math.sign(e.fireball.startVelocity)||Math.abs(e.dynamic.velocity.x)<.1*Math.abs(e.fireball.startVelocity))&&(delete e.fireball,delete e.dynamic,e.fireballHit=!0,e.smb1ObjectsAnimations&&(e.smb1ObjectsAnimations.setFrame(0),e.smb1ObjectsAnimations.loopsPerSecond=5,e.smb1ObjectsAnimations.setAnimation("firework"),e.fireballHitEnemy||_c.sounds.play("bump"))))}(e),function(e){var t,i,r;for(const t of ga.view(["dynamic"])){const i=t.dynamic;i&&(i.velocity=i.velocity.add(i.acceleration.mul(e)))}for(const e of ga.view(["smash"])){if(!e.smash)continue;const t=e.dynamic;t&&(t.velocity.y=Math.max(t.velocity.y,0))}for(const e of ga.view(["movement","touchingDown"])){if(!e.movement||e.movement.ignoreSoftHits)continue;const i=null===(t=e.touchingDown)||void 0===t?void 0:t.reduce(((t,i)=>void 0===i.hitAnim?t:t?Math.abs(i.position.x-e.position.x)>Math.abs(t.position.x-e.position.x)?i:t:i),void 0);if(i&&e.movement.horizontal){const t=Math.sign(e.position.x-i.position.x);e.movement.horizontal=Math.abs(e.movement.horizontal)*t,e.movement.horizontalNow=!0}}for(const e of ga.view(["mushroom","touchingDown"]))(null===(i=e.touchingDown)||void 0===i?void 0:i.find((e=>e.bonked)))&&e.movement&&(e.movement.bounce=-100,e.movement.bounceOnce=!0,e.movement.bounceNow=!0);for(const e of ga.view(["dynamic","movement"])){const t=e.dynamic,i=e.movement;t&&i&&(i.bounceNow&&(t.velocity.y="number"==typeof i.bounce?i.bounce:-t.velocity.y,i.bounceOnce&&(i.bounce=void 0)),i.horizontalNow&&(t.velocity.x=null!==(r=i.horizontal)&&void 0!==r?r:0))}for(const t of ga.view(["kinematic"])){const i=t.kinematic;i&&(i.velocity=i.velocity.add(i.acceleration.mul(e)))}}(e),function(){for(const e of ga.view(["mario","dynamic"])){const t=e.dynamic,i=e.mario;t&&i&&i.wind&&(i.wind=Yd(t.velocity,i.wind))}for(const e of ga.view(["dynamic","floorSpeed"])){const t=e.dynamic;t&&e.floorSpeed&&(e.floorSpeed=Yd(t.velocity,e.floorSpeed))}}(),function(){for(const e of ga.view(["dynamic"])){const t=e.dynamic;if(!t)continue;const i=vd.speedLimiter(t.velocity,e.maxSpeed);i&&t.velocity.set(i)}}(),function(e){!function(){for(const e of ga.view(["hits","prevHits"])){const t=e.prevHits,i=e.hits;t&&i&&(t.length=0,i.forEach((e=>t.push(e))))}for(const e of ga.view(["hits"]))e.hits&&(e.hits.length=0)}();for(const e of ga.view(["sensor","moving"])){const t=ec.at(e.sensorIndex);if(!t)continue;const i=e.position,r=e.size;t.l=i.x-.5*r.x,t.t=i.y-.5*r.y,t.w=r.x,t.h=r.y,Ld.sensors.update(t)}for(const t of Qd){if(!t.userData.kinematic)continue;const i=t.userData.position,r=t.userData.size,o=t.userData.kinematic.velocity.mul(e);t.l=i.x-.5*r.x,t.t=i.y-.5*r.y,t.w=r.x,t.h=r.y,t.l=o.x<0?t.l+o.x:t.l,t.t=o.y<0?t.t+o.y:t.t,t.w=o.x<0?t.w-o.x:t.w+o.x,t.h=o.y<0?t.h-o.y:t.h+o.y,Ld.kinematics.update(t)}for(const t of Jd){if(!t.userData.dynamic)continue;const i=t.userData.dynamic.velocity.mul(e);if(i.isNull)continue;const r=t.userData.position,o=t.userData.size,s=r.x-.5*o.x,n=r.y-.5*o.y,l=o.x,a=o.y;if(t.l=i.x<0?s+i.x:s,t.t=i.y<0?n+i.y:n,t.w=i.x<0?l-i.x:l+i.x,t.h=i.y<0?a-i.y:a+i.y,Ld.dynamics.update(t),t.userData.goThrougWalls)continue;qd.pos.x=s,qd.pos.y=n,qd.size.x=l,qd.size.y=a,qd.dr.x=i.x,qd.dr.y=i.y;const h=[];for(const e of Ld.statics.findNear(t.l,t.t,t.w,t.h)){if(e===t)continue;Zd.pos.x=e.l,Zd.pos.y=e.t,Zd.size.x=e.w,Zd.size.y=e.h;const[i,r]=wl(qd,Zd);i&&h.push([r.edginess,e,r.time])}for(const i of Ld.kinematics.findNear(t.l,t.t,t.w,t.h)){if(i===t||!i.userData.kinematic)continue;Zd.pos.x=i.userData.position.x-.5*i.userData.size.x,Zd.pos.y=i.userData.position.y-.5*i.userData.size.y,Zd.size.x=i.userData.size.x,Zd.size.y=i.userData.size.y,Zd.dr.x=i.userData.kinematic.velocity.x*e,Zd.dr.y=i.userData.kinematic.velocity.y*e;const[r,o]=Sl(qd,Zd);r&&h.push([o.edginess,i,o.time])}const d=h.sort(((e,t)=>e[2]-t[2])).sort(((e,t)=>t[0]-e[0]));let c=null,u=0;for(const[i,r]of d){const i=t.userData.dynamic.velocity.mul(e);if(qd.dr.x=i.x,qd.dr.y=i.y,r.userData.kinematic){Zd.pos.x=r.userData.position.x-.5*r.userData.size.x,Zd.pos.y=r.userData.position.y-.5*r.userData.size.y,Zd.size.x=r.userData.size.x,Zd.size.y=r.userData.size.y,Zd.dr.x=r.userData.kinematic.velocity.x*e,Zd.dr.y=r.userData.kinematic.velocity.y*e;const[i,o]=Sl(qd,Zd);if(i){const e=t.userData.dynamic.velocity.sub(r.userData.kinematic.velocity).abs().elementwiseMul(o.normal).mul(1-o.time);t.userData.dynamic.velocity.x+=e.x,t.userData.dynamic.velocity.y+=e.y,t.userData.hits&&t.userData.hits.push(Object.assign({e:r.userData},o)),r.userData.hits&&r.userData.hits.push(Object.assign({e:t.userData},o))}}else{if(Zd.pos.x=r.l,Zd.pos.y=r.t,Zd.size.x=r.w,Zd.size.y=r.h,u&&null!==c)if(u<0){if(Zd.pos.y>=c)continue}else if(Zd.pos.y+Zd.size.y<=c)continue;const[e,i]=wl(qd,Zd);if(e){if(r.userData.invisibleBlock&&!(i.normal.y>0))continue;u=Math.sign(i.normal.y),c=u<0?Zd.pos.y:u>0?Zd.pos.y+Zd.size.y:null;const e=t.userData.dynamic.velocity.abs().elementwiseMul(i.normal).mul(1-i.time);t.userData.dynamic.velocity.x+=e.x,t.userData.dynamic.velocity.y+=e.y,t.userData.hits&&t.userData.hits.push(Object.assign({e:r.userData},i)),r.userData.hits&&r.userData.hits.push(Object.assign({e:t.userData},i))}}}}}(e),function(){for(const e of ga.view(["moving"]))e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y;for(const e of ga.view(["dynamic"]))e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y;for(const e of ga.view(["kinematic"]))e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y}(),function(e){for(const t of ga.view(["dynamic"])){const i=t.dynamic;i&&(t.position=t.position.add(i.velocity.mul(e)))}for(const t of ga.view(["kinematic"])){const i=t.kinematic;i&&(t.position=t.position.add(i.velocity.mul(e)))}}(e),function(){for(const e of ga.view(["mario","dynamic"])){const t=e.mario,i=e.dynamic;if(t&&i)if(t.forcedDucking=!1,t.big&&!t.ducking){if(30===e.size.y)continue;tc.pos.x=e.position.x-.5*e.size.x,tc.pos.y=e.position.y-.5*e.size.y,tc.size.x=e.size.x,tc.size.y=e.size.y;const i=e.position.x-.5*e.size.x,r=e.position.y-.5*e.size.y-15,o=e.size.x,s=e.size.y;let n=!0;for(const t of Ld.statics.findNear(i,r,o,s)){if(t.userData===e)continue;ic.pos.x=t.userData.position.x-.5*t.userData.size.x,ic.pos.y=t.userData.position.y-.5*t.userData.size.y,ic.size.x=t.userData.size.x,ic.size.y=t.userData.size.y;const[i,r]=wl(tc,ic);n=n&&(!i||1!==r.normal.y)}for(const t of Ld.kinematics.findNear(i,r,o,s)){if(t.userData===e)continue;ic.pos.x=t.userData.position.x-.5*t.userData.size.x,ic.pos.y=t.userData.position.y-.5*t.userData.size.y,ic.size.x=t.userData.size.x,ic.size.y=t.userData.size.y;const[i,r]=wl(tc,ic);n=n&&(!i||1!==r.normal.y)}if(n){const t=e.size.y;e.size.y=30;const i=t-e.size.y;i&&(e.position.y+=i/2)}else t.forcedDucking=!0}else{if(15===e.size.y)continue;const t=e.size.y;e.size.y=15;const i=t-e.size.y;i&&(e.position.y+=i/2)}}}(),function(){for(const e of ga.view(["mario","dynamic"])){const t=e.dynamic,i=e.mario;t&&i&&i.wind&&(t.velocity.x-=i.wind,i.wind=0)}for(const e of ga.view(["dynamic","floorSpeed"])){const t=e.dynamic;t&&e.floorSpeed&&(t.velocity.x-=e.floorSpeed,e.floorSpeed=0)}}(),function(){for(const e of ga.view(["platformConnection","platformConnectionIsConnected"])){const t=e.platformConnection;if(t&&(t.p1H=t.p1.position.y-e.position.y,t.p2H=t.p2.position.y-e.position.y,t.p1H<=0||t.p2H<=0)){t.p1H<=0&&(t.p1H=0),t.p2H<=0&&(t.p2H=0);const i=t.p1.kinematic,r=t.p2.kinematic;i&&r&&(i.acceleration.y=0,i.velocity.y=0,r.velocity.y=0,r.acceleration.y=0),t.p1.platform&&(t.p1.platform.fall=!0),t.p2.platform&&(t.p2.platform.fall=!0),delete e.platformConnectionIsConnected}}}(),function(e){var t,i,r,o,s,n,l,a;!function(e){for(const t of["bonk","smash"]){const i="bonk"===t?"bonkCooldown":"smashCooldown";for(const t of ga.view([i])){let r=t[i];r&&(r-=e,t[i]=r,r<0&&(t[i]=0))}for(const e of ga.view([t]))e[t]&&!e[i]&&(e[i]=.1)}}(e);for(const e of ga.view(["bonked"]))delete e.bonked;for(const e of ga.view(["mario"])){if(e.bonk=!1,e.smash=!1,!ac(e))continue;if(!e.dynamic)continue;const n=hc.dr,h=e.position,d=e.size,c=h.x-.5*d.x,u=h.y-.5*d.y,m=d.x,p=d.y;cc.l=n.x<0?c+n.x:c,cc.t=n.y<0?u+n.y:u,cc.w=n.x<0?m-n.x:m+n.x,cc.h=n.y<0?p-n.y:p+n.y,hc.pos.x=c,hc.pos.y=u,hc.size.x=m,hc.size.y=p;for(const n of Ld.statics.findNear(cc.l,cc.t,cc.w,cc.h)){const h=n.userData;if(h===e)continue;dc.pos.x=n.l,dc.pos.y=n.t,dc.size.x=n.w,dc.size.y=n.h;const[d]=wl(hc,dc);if(d)if(h.invisibleBlock&&delete h.invisibleBlock,h.brick)if(null===(t=e.mario)||void 0===t?void 0:t.big){if(h.smashCooldown)continue;h.bonked=!0;const t=(null===(i=h.smb1TilesSprites)||void 0===i?void 0:i.getFrame().includes("2"))?"brokenBrick2":(null===(r=h.smb1TilesSprites)||void 0===r?void 0:r.getFrame().includes("3"))?"brokenBrick3":"brokenBrick1";ga.remove(h),e.smash=!0;const o=h.size.x/4,s=h.size.y/4;rc(h.position.x-o,h.position.y-s,t,-1),rc(h.position.x-o,h.position.y+s,t,-1,-66),rc(h.position.x+o,h.position.y-s,t,1),rc(h.position.x+o,h.position.y+s,t,1,-66)}else{if(h.bonkCooldown)continue;h.bonked=!0,void 0===h.hitAnim&&(h.hitAnim=0),e.bonk=!0}else if(h.coinblock){if(h.bonkCooldown)continue;if(h.bonked=!0,"coins"!==h.coinblock){if("pow"===h.coinblock)(null===(o=e.mario)||void 0===o?void 0:o.big)?sc(h.position.x,h.position.y):nc(h.position.x,h.position.y);else if("life"===h.coinblock){const e=nc(h.position.x,h.position.y);e.powerup=!1,e.oneUp=!0,null===(s=e.smb1ObjectsSprites)||void 0===s||s.setFrame("oneup")}else"star"===h.coinblock?lc(h.position.x,h.position.y):"vine"===h.coinblock?(h.vineCreator&&(l=h,a=h.vineCreator.h,ga.createEntity(ba({position:new yl(l.position.x,l.position.y),size:new yl(1,0),vine:{targetHeight:a,root:l,parts:[]},vineStart:!0,sensor:!0,moving:!0}))),delete h.vineCreator):(oc(h.position.x,h.position.y),h.player&&h.player.coins++);if(delete h.coinblock,h.smb1TilesAnimations){delete h.smb1TilesAnimations;const e=Uh.getFactory("tiles").new();h.smb1TilesSprites=e,e.setFrame("blockHit1")}if(h.smb1TilesSprites)switch(h.smb1TilesSprites.getFrame()){case"brick2":case"brickBottom2":h.smb1TilesSprites.setFrame("blockHit2");break;case"brick3":case"brickBottom3":h.smb1TilesSprites.setFrame("blockHit3");break;default:h.smb1TilesSprites.setFrame("blockHit1")}}else oc(h.position.x,h.position.y),h.player&&h.player.coins++,void 0===h.coinblockDeathTimer&&(h.coinblockDeathTimer=3.8);void 0===h.hitAnim&&(h.hitAnim=0),e.bonk=!0}else{if(h.bonkCooldown)continue;e.bonk=!0}}for(const t of Ld.kinematics.findNear(cc.l,cc.t,cc.w,cc.h)){const i=t.userData;if(i===e)continue;dc.set(i);const[r]=wl(hc,dc);if(r){if(i.bonkCooldown)continue;e.bonk=!0}}}for(const t of ga.view(["coinblockDeathTimer"]))void 0!==t.coinblockDeathTimer&&(t.coinblockDeathTimer-=e,t.coinblockDeathTimer<=0&&(delete t.coinblockDeathTimer,t.coinblock="coin"));for(const t of ga.view(["hitAnim"]))if(void 0!==t.hitAnim){const i=t.hitAnim/.4,r=8*Math.sin(i*Math.PI);t.smb1TilesSprites?t.smb1TilesSprites.container.position.y=t.positionStart.y-r:t.smb1TilesAnimations&&(t.smb1TilesAnimations.container.position.y=t.positionStart.y-r),t.hitAnim+=e,t.hitAnim>.4&&(delete t.hitAnim,t.smb1TilesSprites&&(t.smb1TilesSprites.container.position.y=t.positionStart.y))}const h=ga.view(["mario"]);for(const t of ga.view(["grow"]))if(void 0!==t.grow){if(t.grow>=0){const i=t.grow/.4,r=8*Math.sin(i*Math.PI);t.position.y=t.positionStart.y-r,t.grow+=e,t.grow>.2&&(t.grow=-1)}else if(t.position.y=t.position.y-16*e,t.position.y-t.positionStart.y<=-16){t.position.y=t.positionStart.y-16;const e=h.length?h.reduce(((e,i)=>Math.abs(e.position.x-t.position.x)>Math.abs(i.position.x-t.position.x)?i:e)):null,i=Math.sign((null!==(n=null==e?void 0:e.position.x)&&void 0!==n?n:0)-t.position.x);t.mushroom&&(t.movement={horizontal:48*i,horizontalNow:!0},t.gravity=333),t.star&&(t.movement={horizontal:48*i,bounce:-200,horizontalNow:!0},t.gravity=333),delete t.grow}t.smb1ObjectsSprites&&(t.smb1ObjectsSprites.container.position.x=t.position.x,t.smb1ObjectsSprites.container.position.y=t.position.y)}for(const t of ga.view(["brokenBrick"])){const i=t.brokenBrick;i&&(t.position.x+=i.velocity.x*e,t.position.y+=i.velocity.y*e,i.velocity.y+=700*e),t.smb1TilesSprites&&(t.smb1TilesSprites.container.position.x=t.position.x,t.smb1TilesSprites.container.position.y=t.position.y);const[r,o]=Al.fromViewport(0,Al.getViewportHeight());t.position.y-.5*t.size.y>o&&ga.remove(t)}}(e),function(e){for(const t of ga.view(["player"])){if(!t.player)continue;Bc.set(t,e);const i=Bc.computeBoundingBox();for(const e of Ld.sensors.findNear(i.l,i.t,i.w,i.h)){const i=e.userData;i.coin&&(Mc.set(i),Tl.rectVsRect(Bc,Mc)&&(i.coinGotCollected=!0,delete i.coin,ga.remove(i),t.player.coins++))}for(;t.player.coins>99;)t.player.coins-=100,t.player.gainedOneUp=!0,t.player.lives++}}(e),function(e){var t,i,r;for(const o of ga.view(["vine","moving"])){if(!o.vine)continue;o.size.y+=(o.vine.targetHeight-o.size.y)*e*.3*5,o.vine.targetHeight-o.size.y<.1&&(o.size.y=o.vine.targetHeight);const s=null!==(i=null===(t=o.vine.root.smb1TilesSprites)||void 0===t?void 0:t.container.position.y)&&void 0!==i?i:o.vine.root.position.y;for(o.position.y=s-.5*o.size.y;Math.ceil(o.size.y/16)>o.vine.parts.length;){const e=dd(0,0,{type:"object",frame:o.vine.parts.length?"vine":"vinetop"});if(null===(r=e.smb1ObjectsSprites)||void 0===r?void 0:r.container){const t=e.smb1ObjectsSprites.container;t.zIndex=-2,t.visible=!1,t.position.x=o.vine.root.position.x,setTimeout((()=>t.visible=!0))}o.vine.parts.push(e)}const n=s-o.size.y;for(let e=0;e<o.vine.parts.length;e++){const t=o.vine.parts[e];(null==t?void 0:t.smb1ObjectsSprites)&&(t.smb1ObjectsSprites.container.position.y=n+16*e)}o.size.y===o.vine.targetHeight&&delete o.moving}for(const t of ga.view(["mario"])){if(!t.mario)continue;if(delete t.mario.climbing,t.mario.climbingCooldown){t.mario.climbingCooldown-=e,t.mario.climbingCooldown<=0&&delete t.mario.climbingCooldown;continue}Rc.set(t,e);const i=Rc.computeBoundingBox();for(const e of Ld.sensors.findNear(i.l,i.t,i.w,i.h)){const i=e.userData;if(i.vine&&(Ic.set(i),Tl.rectVsRect(Rc,Ic))){t.mario.ducking=!1,t.mario.jumping=!0,t.mario.climbing=i,t.mario.facing=t.position.x-i.position.x<0?1:-1,t.dynamic&&(t.dynamic.velocity.x=0,t.dynamic.velocity.y=0,t.dynamic.acceleration.x=0,t.dynamic.acceleration.y=0);break}}}}(e),function(e){var t,i,r,o,s,n;for(const e of ga.view(["spring","touchingUp","hits"])){if(!e.spring)continue;if(void 0!==e.spring.progress)continue;const s=null===(t=e.touchingUp)||void 0===t?void 0:t.find((e=>e.mario));s&&(null===(i=e.hits)||void 0===i?void 0:i.find((e=>e.e===s&&e.normal.y<0)))&&(s.mario&&(s.mario.onSpring={spring:e,vx:null!==(o=null===(r=s.dynamic)||void 0===r?void 0:r.velocity.x)&&void 0!==o?o:0}),e.spring.progress=0)}for(const t of ga.view(["spring"]))void 0!==(null===(s=t.spring)||void 0===s?void 0:s.progress)&&(null===(n=t.smb1ObjectsAnimations)||void 0===n||n.setProgress(Math.sin(t.spring.progress)),t.spring.progress+=e*Dc,t.spring.progress>=Math.PI&&delete t.spring.progress)}(e),function(e,t){var i,r,o,s,n;for(const e of ga.view(["dynamic","movement","hits"])){if(!e.dynamic||!e.movement)continue;const l=e.movement.horizontal;if(e.movement.horizontalNow=!1,l){const s=null===(i=e.hits)||void 0===i?void 0:i.find((e=>Math.sign(e.normal.x)===-Math.sign(l)));let n=!!s;const a=!!(null===(r=e.touchingDown)||void 0===r?void 0:r.length);if(e.movement.dontFallOff&&!s&&a){n=!0;const t=Math.sign(l),i=3;mc.l=e.position.x+t*(.5*e.size.x+(1===t?0:i)),mc.t=e.position.y+.5*e.size.y,mc.w=i,mc.h=1,mc.pos.x=mc.l,mc.pos.y=mc.t,mc.size.x=mc.w,mc.size.y=mc.h,mc.dr.x=0,mc.dr.y=0;for(const t of fc(mc))t.userData!==e&&(pc.set(t.userData),Tl.rectVsRect(mc,pc)&&(n=!1))}if(n&&(e.movement.horizontal=-l,e.movement.horizontalNow=!0,s)){mc.set(e);const{l:i,r}=t.getBoundingBox(),s=r-i;mc.pos.x-=s,mc.size.x+=2*s,(null===(o=e.enemy)||void 0===o?void 0:o.isMovingShell)&&t.overlapsRectBroad(mc)&&bc.sounds.play("bump")}}const a=e.movement.bounce;e.movement.bounceNow=!1;const h=null===(s=e.hits)||void 0===s?void 0:s.find((e=>e.normal.y<0));a&&h&&(e.movement.bounceNow=!0,!0===a&&(e.movement.bounce=-Math.sqrt(Math.abs(2*(null!==(n=e.gravity)&&void 0!==n?n:0)*(e.position.y-e.positionStart.y))))),h&&e.movement.bounceStopHorizontal&&(delete e.movement.bounceStopHorizontal,e.movement.horizontal=0,e.movement.horizontalNow=!0)}for(const e of ga.view(["movement"]))if(e.movement&&e.movement.horizontal&&e.movement.flipEachOther){mc.set(e);for(const t of Ld.dynamics.findNear(mc.l,mc.t,mc.w,mc.h)){const i=t.userData;if(i.movement&&void 0!==i.movement.horizontal&&i.movement.flipEachOther&&i!==e&&(pc.set(i),Tl.rectVsRect(mc,pc))){const t=Math.sign(i.position.x-e.position.x);t&&(e.movement.horizontal=-t*Math.abs(e.movement.horizontal),e.movement.horizontalNow=!0,i.movement.horizontal=t*Math.abs(i.movement.horizontal),i.movement.horizontalNow=!0)}}}}(0,Al),function(e){var t;for(const e of ga.view(["firebarFireball"])){if(!(null===(t=e.firebarFireball)||void 0===t?void 0:t.parent.firebar))continue;e.position.x=e.firebarFireball.parent.position.x,e.position.y=e.firebarFireball.parent.position.y;const i=new yl(e.firebarFireball.length,e.firebarFireball.parent.firebar.angle).toCartesian();e.position.x+=i.x,e.position.y+=i.y}for(const t of ga.view(["firebar"]))if(t.firebar){for(t.firebar.angle+=e*t.firebar.angvel;t.firebar.angle>2*Math.PI;)t.firebar.angle-=2*Math.PI;for(;t.firebar.angle<0;)t.firebar.angle+=2*Math.PI}}(e),function(e,t){for(const e of ga.view(["nonspinningHammer"]))if(e.dynamic&&e.smb1EnemiesAnimations)if(Math.abs(e.dynamic.velocity.y)<20){const t=Math.sign(e.dynamic.velocity.x)===-e.smb1EnemiesAnimations.container.scale.x;e.smb1EnemiesAnimations.setFrame(t?1:3)}else e.dynamic.velocity.y>0?e.smb1EnemiesAnimations.setFrame(2):e.smb1EnemiesAnimations.setFrame(0);for(const i of ga.view(["hammerbro"]))if(hu.set(i),t.overlapsRectBroad(hu)){if(i.hammerbro&&i.dynamic&&i.smb1EnemiesAnimations&&i.touchingDown&&i.gravity){if(i.hammerbro.dirChangeTimer-=e,i.hammerbro.dirChangeTimer<0&&(i.hammerbro.dirChangeTimer=1+.2*Math.random(),i.hammerbro.direction=i.hammerbro.direction<0?1:-1),i.dynamic.velocity.x=20*i.hammerbro.direction,i.hammerbro.hammerTelegraphTimer<0&&i.hammerbro.hammertime<0){const e=Math.random();i.hammerbro.hammertime=e<.05?1.8:e<.25?1.2:.66}if(i.hammerbro.hammerTelegraphTimer>=0){if(i.smb1EnemiesAnimations.setAnimation("hammerbroAttack"),i.hammerbro.hammerTelegraphTimer-=e,i.hammerbro.hammerTelegraphTimer<0){const e=fd(i.position.x,i.position.y-12,"hammer"),t=-i.smb1EnemiesAnimations.container.scale.x;if(e.smb1EnemiesAnimations){e.smb1EnemiesAnimations.container.scale.x=-t;const i=Math.random();i<.1?e.smb1EnemiesAnimations.loopsPerSecond*=-.5:i<.15?(e.smb1EnemiesAnimations.loopsPerSecond=0,e.nonspinningHammer=!0):i<.7&&(e.smb1EnemiesAnimations.loopsPerSecond*=2)}e.gravity=300,e.goThrougWalls=!0,e.deleteOutOfCam=!0,e.dynamic={velocity:new yl(40*t+10*Math.random(),-150),acceleration:new yl(0,0)},e.enemy={fireball:!0,star:!0,shell:!0,stomp:!1},e.hammer=!0}}else i.smb1EnemiesAnimations.setAnimation("hammerbro"),i.hammerbro.hammertime-=e,i.hammerbro.hammertime<0&&(i.hammerbro.hammerTelegraphTimer=Math.random()>.75?1:.5);if(i.hammerbro.jumping)"up"===i.hammerbro.jumping.direction?i.dynamic.velocity.y>0&&(delete i.goThrougWalls,delete i.hammerbro.jumping):i.position.y>i.hammerbro.jumping.startHeight+48&&(delete i.goThrougWalls,delete i.hammerbro.jumping);else if(i.touchingDown.length){if(i.hammerbro.nextJumpTimer<0){const e=Math.random();i.hammerbro.nextJumpTimer=e<.05?.5:e<.5?5:3}if(i.hammerbro.nextJumpTimer-=e,i.hammerbro.nextJumpTimer<0){let e=!0,t=null;for(const i of Ld.statics.findNear(hu.l,hu.t+hu.h,hu.w,hu.h))if(du.set(i.userData),null===t)t=i.userData.position.y;else if(t!==i.userData.position.y){e=!1;break}i.hammerbro.jumping={startHeight:i.position.y,direction:e&&Math.random()<.5?"down":"up"},"up"===i.hammerbro.jumping.direction?i.dynamic.velocity.y=-Math.sqrt(2*i.gravity*72):i.dynamic.velocity.y=-Math.sqrt(2*i.gravity*8),i.goThrougWalls=!0}}}}else i.dynamic&&(i.dynamic.velocity.x=0)}(e,Al),function(e,t){const i=ga.view(["mario"]).some((e=>{var t;return null===(t=e.mario)||void 0===t?void 0:t.inPipe}));for(const t of ga.view(["piranhaPlant"])){const r=t.piranhaPlant;r&&(void 0!==r.inTime?(r.inTime-=e,r.inTime<=0&&delete r.inTime):r.emerging&&!i?(r.height+=30*e,r.height>=24&&(r.height=24,r.outTime=1,delete r.emerging)):void 0!==r.outTime?(r.outTime-=e,delete r.emerging,r.outTime<=0&&delete r.outTime):r.height?(r.height-=30*e,delete r.emerging,r.height<=0&&(r.height=0,r.inTime=1)):ga.view(["mario"]).find((e=>32>=Math.abs(e.position.x-t.position.x)))||(r.emerging=!0),t.position.y=t.positionStart.y-r.height)}for(const i of ga.view(["blooper"])){if(tu.set(i),!t.overlapsRectBroad(tu))continue;const r=i.blooper;if(!r)continue;const o=jd.underwater.find((e=>Tl.pointVsRect(i.position,tu.setToZone(e))));if(r.moving){const t=55;i.position.x+=e*t*("left"===r.moving.direction?-1:1),i.position.y-=e*t,r.moving.progress+=2*e,i.smb1EnemiesAnimations&&(r.moving.progress>.9?i.smb1EnemiesAnimations.setFrame(1):i.smb1EnemiesAnimations.setFrame(0)),r.moving.progress>1&&(delete r.moving,r.forcedSinking=.3)}else{const t=35;if(i.position.y+=e*t,i.smb1EnemiesAnimations&&i.smb1EnemiesAnimations.setFrame(1),void 0!==r.forcedSinking)r.forcedSinking-=e,r.forcedSinking<=0&&delete r.forcedSinking;else{const e=ga.view(["mario"]).reduce(((e,t)=>{if(!e)return t;const r=Math.abs(e.position.x-i.position.x);return Math.abs(t.position.x-i.position.x)<r?t:e}));if(e){const t=e.position.y-i.position.y;t<18?(r.moving={direction:1===Math.sign(e.position.x-i.position.x)?"right":"left",progress:0},i.smb1EnemiesAnimations&&i.smb1EnemiesAnimations.setFrame(0)):t<25&&i.smb1EnemiesAnimations&&i.smb1EnemiesAnimations.setFrame(0)}}}o&&(i.position.x<o.x+16&&(i.position.x=o.x+16),i.position.x>o.x+o.w-16&&(i.position.x=o.x+o.w-16),i.position.y<o.y+16&&(i.position.y=o.y+16),i.position.y>o.y+o.w-16&&(i.position.y=o.y+o.w-16))}!function(e,t){var i,r;if(ga.view(["cheep"]).length>9)return;const o=ga.view(["mario"]).some((e=>jd.cheep.some((t=>Tl.pointVsRect(e.position,tu.setToZone(t))))));if(iu-=e,iu<0&&(iu=Math.random(),o&&Math.random()<.3)){const{t:e,h:o,r:s}=t.getBoundingBox(),n=fd(s+8,e+32+(o-40-32)*Math.random()),l=Math.random()<.5;l?null===(i=n.smb1EnemiesAnimations)||void 0===i||i.setAnimation("redCheep"):null===(r=n.smb1EnemiesAnimations)||void 0===r||r.setAnimation("greenCheep"),n.cheep={speed:l?25+10*Math.random():7+10*Math.random(),direction:-1,amplitude:Math.random()<.5?16*Math.random():0,ySpeed:10*Math.random(),y:0,yDir:Math.random()<.5?1:-1},n.enemy={shell:!0,star:!0,fireball:!0,stomp:!1},n.sensor=!0,n.moving=!0,n.underwater=!0}}(e,t),function(e,t){for(const i of ga.view(["cheep"])){const r=i.cheep;if(!r)continue;i.position.x+=r.direction*r.speed*e,r.y+=r.ySpeed*r.yDir*e,Math.abs(r.y)>=r.amplitude&&(r.y=Math.sign(r.y)*r.amplitude,r.yDir=r.yDir<0?1:-1),i.position.y=i.positionStart.y+r.y;const{l:o,r:s}=t.getBoundingBox();i.position.x<o-16&&ga.remove(i),i.position.x>s+16&&ga.remove(i)}}(e,t),function(e,t){if(ga.view(["billSwarm"]).length)return;const i=ga.view(["mario"]).some((e=>{var i,r;return!(null===(i=e.mario)||void 0===i?void 0:i.dead)&&(!(null===(r=e.dynamic)||void 0===r?void 0:r.velocity)||e.dynamic.velocity.x>-80)&&t.containsBroad(e.position)&&jd.bill.some((t=>Tl.pointVsRect(e.position,tu.setToZone(t))))}));if(ou-=e,ou<0&&(ou=Math.random(),i&&Math.random()<.7)){const{t:e,h:i,r}=t.getBoundingBox();ru(r+8,e+32+(i-40-32)*Math.random()).billSwarm=!0}}(e,t),function(e,t){for(const i of ga.view(["billShooter"])){const r=i.billShooter;if(r&&t.containsBroad(i.position)&&ga.view(["mario"]).filter((e=>Math.abs(e.position.x-i.position.x)>20)).some((e=>e.position.y+.5*e.size.y>i.position.y-.5*i.size.y&&e.position.y-.5*e.size.y<i.position.y+.5*i.size.y))&&(void 0===r.cooldownCounter&&(r.cooldownCounter=2*Math.random()+1.5),r.cooldownCounter-=e,r.cooldownCounter<=0)){delete r.cooldownCounter;const e=ru(i.position.x,i.position.y,i);e.smb1EnemiesAnimations&&(e.smb1EnemiesAnimations.container.zIndex=-1)}}}(e,t),function(e,t){for(const i of ga.view(["bill"])){const r=i.bill;if(!r)continue;i.position.x+=r.direction*r.speed*e;const{l:o,r:s}=t.getBoundingBox();i.position.x<o-16&&ga.remove(i),i.position.x>s+16&&ga.remove(i),r.parent&&Math.abs(r.parent.position.x-i.position.x)>16&&i.smb1EnemiesAnimations&&(i.smb1EnemiesAnimations.container.zIndex=1)}}(e,t),function(e,t){if(ga.view(["fire"]).length)return;const i=ga.view(["mario"]).some((e=>{var i,r;return!(null===(i=e.mario)||void 0===i?void 0:i.dead)&&(!(null===(r=e.dynamic)||void 0===r?void 0:r.velocity)||e.dynamic.velocity.x>-80)&&t.containsBroad(e.position)&&jd.fire.some((t=>Tl.pointVsRect(e.position,tu.setToZone(t))))}));if(su-=e,su<0&&(su=1,i)){const{t:e,h:i,r}=t.getBoundingBox(),o=48;!function(e,t){const i=fd(e,t,"bowserfire");i.size.y=2,i.enemy={star:!1,stomp:!1,shell:!1,fireball:!1};const r=ga.view(["mario"]).reduce(((e,t)=>e?Math.abs(t.position.x-i.position.x)<Math.abs(t.position.x-i.position.x)?t:e:t),void 0);i.fire={direction:r&&r.position.x-i.position.x<0?-1:1},i.sensor=!0,i.moving=!0,i.smb1EnemiesAnimations&&(i.smb1EnemiesAnimations.container.scale.x=-i.fire.direction,i.smb1EnemiesAnimations.loopsPerSecond*=2)}(r+8,e+o+(i-72-o)*Math.random())}}(e,t),function(e,t){for(const i of ga.view(["fire"])){const r=i.fire;if(!r)continue;if(i.position.x+=80*r.direction*e,void 0!==r.targetY){const t=Math.sign(r.targetY-i.position.y);i.position.y+=t*e*22,t!==Math.sign(r.targetY-i.position.y)&&(i.position.y=r.targetY,delete r.targetY)}const{l:o,r:s}=t.getBoundingBox();i.position.x<o-16&&ga.remove(i),i.position.x>s+16&&ga.remove(i)}}(e,t),function(e,t){for(const e of ga.view(["jumpcheep"]))tu.set(e),!e.deleteOutOfCam&&t.overlapsRectBroad(tu)&&(e.deleteOutOfCam=!0);if(ga.view(["jumpcheep"]).length>2)return;const i=ga.view(["mario"]).some((e=>jd.jumpCheep.some((t=>Tl.pointVsRect(e.position,tu.setToZone(t))))));if(nu-=e,nu<0&&(nu=.2*Math.random(),i&&Math.random()<.5)){const{t:e,h:i,l:r,w:o}=t.getBoundingBox(),s=fd(r+Math.random()*o*.75,e+i+8,"redCheep");s.smb1EnemiesAnimations&&(s.smb1EnemiesAnimations.container.scale.x=-1),s.enemy={shell:!0,fireball:!0,star:!0,stomp:!0},s.gravity=400,s.jumpcheep=!0,s.goThrougWalls=!0,s.dynamic={velocity:new yl(30+122*Math.random(),-Math.sqrt(2*s.gravity*(i-8))),acceleration:new yl(0,0)}}}(e,t),function(e,t){const i=ga.view(["mario"]).some((e=>{var t;return!(null===(t=e.mario)||void 0===t?void 0:t.dead)&&jd.lakitu.some((t=>Tl.pointVsRect(e.position,tu.setToZone(t))))}));if(ga.view(["lakitu"]).length){for(const i of ga.view(["lakitu"])){const r=i.lakitu;if(r)if(i.smb1EnemiesAnimations&&(r.spawningSpiny>0?i.smb1EnemiesAnimations.setFrame(1):i.smb1EnemiesAnimations.setFrame(0)),r.move.view){const{l:o,t:s,w:n}=t.getBoundingBox();if(r.move.view.t+=3*e,"in"===r.move.view.state){let e=Math.sin(r.move.view.t);r.move.view.t>=.5*Math.PI&&(e=1),i.position.x=o+r.move.view.relativeX*n,i.position.y=s-16+32*e,1===e&&delete r.move.view}else{au=2,i.deleteOutOfCam=!0;let t=Math.cos(r.move.view.t);r.move.view.t>=.5*Math.PI?i.position.y-=100*e:i.position.y=s-16+32*t}}else{if(ga.view(["spiny"]).length<5){r.spinyCooldown<0&&(r.spinyCooldown=1.5*Math.random()+.5),r.spinyCooldown-=e,r.spinyCooldown<0&&(r.spawningSpiny=.3);const t=r.spawningSpiny;r.spawningSpiny-=e,r.spawningSpiny<0&&(r.spawningSpiny=-1,t>=0&&lu(i.position.x,i.position.y-8))}const t=ga.view(["mario"]).filter((e=>{var t;return!(null===(t=e.mario)||void 0===t?void 0:t.dead)})).reduce(((e,t)=>e?e.position.distance(i.position)>t.position.distance(i.position)?t:e:t),void 0),o=112;if(t)if(t.dynamic&&Math.abs(t.dynamic.velocity.x)>50){delete r.move.circle;const s=Math.sign(t.dynamic.velocity.x),n=Math.abs(t.position.x-i.position.x);r.vel=s*(Math.abs(t.dynamic.velocity.x)+70),i.position.x+=r.vel*e;const l=t.position.x-i.position.x;Math.abs(l)>o&&Math.sign(l)===-s&&(n>o?(i.position.x-=r.vel*e,r.vel=0):(r.vel=s*Math.abs(t.dynamic.velocity.x),i.position.x=t.position.x+s*o)),i.smb1EnemiesAnimations&&(i.smb1EnemiesAnimations.container.scale.x=1===s?1:-1)}else r.move.circle||(r.move.circle={direction:1===Math.sign(r.vel)?1:-1}),Math.abs(r.vel)>50?(r.vel-=1.5*r.vel*e,Math.abs(r.vel)<50&&(r.vel=50*r.move.circle.direction)):(r.vel=50*r.move.circle.direction,Math.abs(t.position.x-i.position.x)>o&&(r.move.circle.direction=t.position.x-i.position.x>0?1:-1)),i.position.x+=r.vel*e,i.smb1EnemiesAnimations&&(1===r.move.circle.direction?i.smb1EnemiesAnimations.container.scale.x=1:i.smb1EnemiesAnimations.container.scale.x=-1);else delete r.move.circle}}if(!i){const{l:e,w:i}=t.getBoundingBox();ga.view(["lakitu"]).forEach((t=>{t.lakitu&&!t.lakitu.move.view&&(t.lakitu.move.view={relativeX:(t.position.x-e)/i,t:0,state:"out"})}))}return}const r=ga.view(["mario"]).some((e=>{var t;return!(null===(t=e.mario)||void 0===t?void 0:t.dead)&&jd.lakitu.some((t=>Tl.pointVsRect(e.positionPrev,tu.setToZone(t))))}));if(i&&(r&&0!==au||(au=2),au-=e,au<=0)){au=7;const{t:e,l:i,w:r}=t.getBoundingBox(),o=fd(i+16+Math.random()*(r-32),e-16,"lakitu");o.size.y=10,o.ostensibleSize=new yl(16,24),o.enemy={shell:!0,fireball:!0,star:!0,stomp:!0},o.lakitu={spinyCooldown:-1,spawningSpiny:-1,vel:0,move:{view:{state:"in",t:0,relativeX:(o.position.x-i)/r}}},o.sensor=!0,o.moving=!0,o.smb1EnemiesAnimations&&(o.smb1EnemiesAnimations.loopsPerSecond=0)}}(e,t)}(e,Al),function(e,t){var i,r,o,s,n,l,a,h,d,c,u,m,p,b,f,g,F,y,v,x,_,w;for(let t=Yc.length-1;0===t;t--){const i=Yc[t];i&&(i.s.position.y-=15*e,i.life-=e,i.life<=0&&(Yc.splice(t,1),i.s.removeFromParent()))}for(const e of ga.view(["mario"])){const c=e.mario;if(!c||c.dead||c.inPipe)continue;Hc.set(e);let u=null;for(const m of qc(Hc)){const p=m.userData;if(p!==e&&p.enemy&&(jc.set(p),Tl.rectVsRect(Hc,jc)))if(c.star)p.enemy.star&&(p.gotHit={x:e.position.x,y:e.position.y,by:"star"});else if(Vc.set(e,void 0,!0),Wc.set(p,void 0,!0),!Tl.rectVsRect(Vc,Wc)){const m=p.enemy.isStillShell,b=p.enemy.isMovingShell;let f=!1,g=!1;if(p.enemy.stomp&&e.positionPrev.y+.5*e.size.y<=p.positionPrev.y-.5*p.size.y)if(delete p.platform,m)f=!0;else{g=!0;const t=p.position.y-.5*p.size.y;u=null===u?t:u<t?u:t,e.dynamic&&(e.dynamic.velocity.y=-150);const a=null===(i=p.smb1EnemiesAnimations)||void 0===i?void 0:i.getAnimation();switch(a){case"greenKoopashell":case"redKoopashell":case"buzzyShell":break;case"greenParakoopa":null===(r=p.smb1EnemiesAnimations)||void 0===r||r.setAnimation("greenKoopa");break;case"greenKoopa":p.smb1EnemiesAnimations&&(p.smb1EnemiesAnimations.setAnimation("greenKoopashell"),p.smb1EnemiesAnimations.loopsPerSecond=0,p.smb1EnemiesAnimations.setFrame(0));break;case"redParakoopa":null===(o=p.smb1EnemiesAnimations)||void 0===o||o.setAnimation("redKoopa");break;case"redKoopa":p.smb1EnemiesAnimations&&(p.smb1EnemiesAnimations.setAnimation("redKoopashell"),p.smb1EnemiesAnimations.loopsPerSecond=0,p.smb1EnemiesAnimations.setFrame(0));break;case"buzzy":null===(s=p.smb1EnemiesAnimations)||void 0===s||s.setAnimation("buzzyShell");break;case"goomba":p.smb1EnemiesAnimations&&(p.smb1EnemiesAnimations.setAnimation("goombaDead"),p.smb1EnemiesAnimations.container.zIndex-=1);break;default:p.smb1EnemiesAnimations&&(p.smb1EnemiesAnimations.container.angle=180,p.smb1EnemiesAnimations.container.scale.x*=-1)}switch(delete p.movement,p.dynamic&&(p.dynamic.velocity.x=0),a){case"greenKoopashell":case"redKoopashell":case"buzzyShell":break;case"redParakoopa":case"greenParakoopa":p.movement={horizontal:-Lc.enemySpeed*Math.sign(null!==(l=null===(n=p.smb1EnemiesAnimations)||void 0===n?void 0:n.container.scale.x)&&void 0!==l?l:1),horizontalNow:!0,flipEachOther:!0,dontFallOff:"redParakoopa"===a},p.dynamic={velocity:new yl(0,0),acceleration:new yl(0,0)},p.hits=[],p.gravity=Lc.enemyGravity,p.enemy={star:!0,stomp:!0,fireball:!0,shell:!0,lookTowards:"direction"},p.touchingDown=[];break;case"redKoopa":case"greenKoopa":case"buzzy":p.movement={horizontal:0,horizontalNow:!0,ignoreSoftHits:!0},p.enemy.isStillShell=!0,p.enemy.shellTimer=5;break;case"goomba":delete p.enemy,p.deleteOutOfCam=!0,p.deleteTimer=1;break;default:delete p.enemy,delete p.bill,delete p.lakitu,delete p.spiny,delete p.sensor,delete p.hammerbro,p.goThrougWalls=!0,p.deleteOutOfCam=!0,p.gravity=Lc.enemyGravity,p.dynamic={velocity:new yl(0,0),acceleration:new yl(0,0)}}switch(a){case"greenKoopashell":case"redKoopashell":case"buzzyShell":b&&Uc.sounds.play("stomp");break;default:Uc.sounds.play("stomp")}}else f=!0,e.iframesSecs||m||(null===(a=e.enemy)||void 0===a?void 0:a.harmless)||(e.iframesSecs=3,c.big?(c.big=!1,c.changedSize=!0):c.powerup?(delete c.powerup,c.changedSize=!0):c&&(delete e.iframesSecs,c.dead=!0));if(f&&m){if(!(null===(h=p.touchingDown)||void 0===h?void 0:h.length)||void 0!==(null===(d=p.enemy)||void 0===d?void 0:d.shellTimer)&&p.enemy.shellTimer<.05){const i=new so(Xc.texture);i.position.x=p.position.x,i.position.y=p.position.y,i.width=Xc.width,i.height=Xc.height,i.anchor.set(.5),t.add(i),Yc.push({s:i,life:.75}),e.player&&e.player.kicks8k++}p.enemy&&(p.smb1EnemiesAnimations&&(p.smb1EnemiesAnimations.loopsPerSecond=0,p.smb1EnemiesAnimations.setFrame(0)),p.enemy.isMovingShell=!0,p.enemy.isStillShell=!1,delete p.enemy.shellTimer,p.enemy.harmless=.05),p.movement={horizontalNow:!0,flipEachOther:!1,horizontal:222*(Math.sign(p.position.x-e.position.x)||1)},Uc.sounds.play("kick")}else g&&b&&(p.enemy&&(p.enemy.isMovingShell=!1,p.enemy.isStillShell=!0,p.enemy.shellTimer=5),p.movement={horizontalNow:!0,flipEachOther:!0,horizontal:0})}}if(null!==u){const t=u-e.size.y-Hc.t;Hc.dr.y=t;let i=e.position.y+t;for(const e of Zc(Hc)){jc.set(e.userData);const[t,r]=Tl.dynamicRectVsRect(Hc,jc);t&&(i=i<r.point.y?r.point.y:i)}e.position.y=i}}for(const e of ga.view(["enemy","gotHit"])){const t=e.smb1EnemiesAnimations;if(t&&e.gotHit){if("soft-bonk"===e.gotHit.by&&"greenParakoopa"===(null===(c=e.smb1EnemiesAnimations)||void 0===c?void 0:c.getAnimation())||"bonk"===e.gotHit.by&&((null===(u=e.enemy)||void 0===u?void 0:u.isMovingShell)||(null===(m=e.enemy)||void 0===m?void 0:m.isStillShell)||(null===(p=e.smb1EnemiesAnimations)||void 0===p?void 0:p.getAnimation().toLowerCase().includes("koopa"))||"buzzy"===(null===(b=e.smb1EnemiesAnimations)||void 0===b?void 0:b.getAnimation())))Uc.sounds.play("kick"),e.movement={horizontal:60*(Math.sign(e.position.x-e.gotHit.x)||1),horizontalNow:!0,bounce:-155,bounceOnce:!0,bounceNow:!0,bounceStopHorizontal:!0,ignoreSoftHits:!0},e.enemy&&(e.enemy.isStillShell=!0,e.enemy.shellTimer=5),e.smb1EnemiesAnimations&&(e.smb1EnemiesAnimations.getAnimation().toLowerCase().includes("red")?e.smb1EnemiesAnimations.setAnimation("redKoopashell"):e.smb1EnemiesAnimations.getAnimation().toLowerCase().includes("green")?e.smb1EnemiesAnimations.setAnimation("greenKoopashell"):e.smb1EnemiesAnimations.setAnimation("buzzyShell"),e.smb1EnemiesAnimations.container.angle=180),t.loopsPerSecond=0,t.setFrame(0);else if("bonk"===e.gotHit.by&&e.spiny)e.enemy&&(e.enemy.noDirChangeOnNextLanding=!0,(null===(f=e.movement)||void 0===f?void 0:f.horizontal)&&(e.movement.horizontal=Math.sign(e.position.x-e.gotHit.x)*Lc.enemySpeed,e.movement.horizontalNow=!0,e.movement.bounce=-133,e.movement.bounceNow=!0,e.movement.bounceOnce=!0));else if("soft-bonk"!==e.gotHit.by)if(Uc.sounds.play("kick"),e.piranhaPlant)ga.remove(e);else{if(delete e.movement,delete e.enemy,delete e.sensor,delete e.blooper,delete e.cheep,delete e.bill,delete e.lakitu,delete e.spiny,delete e.platform,delete e.hammerbro,e.hammer?e.nonspinningHammer=!0:(t.container.angle=180,t.container.scale.x=-t.container.scale.x),e.smb1EnemiesAnimations){const t=e.smb1EnemiesAnimations.getAnimation();e.smb1EnemiesAnimations.setFrame(0),"buzzy"===t?e.smb1EnemiesAnimations.setAnimation("buzzyShell"):t.toLowerCase().includes("koopa")&&(t.includes("red")?e.smb1EnemiesAnimations.setAnimation("redKoopashell"):e.smb1EnemiesAnimations.setAnimation("greenKoopashell"))}t.container.zIndex=15,t.loopsPerSecond=0,e.gravity=e.underwater?300:Lc.enemyGravity,e.goThrougWalls=!0,e.dynamic={velocity:new yl(e.underwater?0:50*Math.sign(e.position.x-e.gotHit.x),e.underwater?0:-133),acceleration:new yl(0,0)},e.maxSpeed=300}delete e.gotHit}}for(const e of ga.view(["enemy","hits","prevHits"])){if(!e.enemy||e.enemy.isMovingShell||!e.hits||!e.prevHits)continue;const t=ga.view(["mario"]).filter((e=>{var t;return!(null===(t=e.mario)||void 0===t?void 0:t.dead)})).reduce(((t,i)=>t?t.position.distance(e.position)>i.position.distance(e.position)?i:t:i),void 0),i=(null===(g=e.hits)||void 0===g?void 0:g.some((e=>e.normal.y<0)))&&!(null===(F=e.prevHits)||void 0===F?void 0:F.some((e=>e.normal.y<0)));if(e.movement&&"goomba"!==(null===(y=e.smb1EnemiesAnimations)||void 0===y?void 0:y.getAnimation()))if(t&&i&&e.position.y!==e.positionPrev.y){if(e.enemy.noDirChangeOnNextLanding){delete e.enemy.noDirChangeOnNextLanding;continue}e.movement.horizontal=Math.sign(t.position.x-e.position.x)*Math.abs(e.movement.horizontal||0),e.movement.horizontalNow=!0}else i&&(e.movement.horizontalNow=!0)}for(const e of ga.view(["spiny","hits"]))e.hits&&e.smb1EnemiesAnimations&&(null===(v=e.hits)||void 0===v?void 0:v.some((e=>e.normal.y<0)))&&e.smb1EnemiesAnimations.setAnimation("spiny");for(const t of ga.view(["enemy"])){if(!t.enemy)continue;t.movement&&(t.enemy.isStillShell?t.movement.flipEachOther=!0:t.enemy.isMovingShell&&(t.movement.flipEachOther=!1));const i=null===(x=t.touchingDown)||void 0===x?void 0:x.find((e=>e.bonked));if(i)t.gotHit={x:i.position.x,y:i.position.y,by:"bonk"};else{const e=null===(_=t.touchingDown)||void 0===_?void 0:_.reduce(((e,t)=>{var i,r;return e||"number"!=typeof t.hitAnim?(null!==(i=null==e?void 0:e.hitAnim)&&void 0!==i?i:0)>(null!==(r=t.hitAnim)&&void 0!==r?r:1/0)?t:e:t}),void 0);(null==e?void 0:e.hitAnim)&&e.hitAnim<.1&&(t.gotHit={x:e.position.x,y:e.position.y,by:"soft-bonk"})}void 0!==t.enemy.harmless&&(t.enemy.harmless-=e,t.enemy.harmless<=0&&delete t.enemy.harmless),Hc.set(t);for(const e of Ld.dynamics.findNear(Hc.l,Hc.t,Hc.w,Hc.h))if(e.userData.fireball)jc.set(e.userData),Tl.rectVsRect(Hc,jc)&&(e.userData.dynamic&&!t.enemy.fireballGoesThrough&&(e.userData.dynamic.velocity.x=0),t.enemy.fireball&&(e.userData.fireballHitEnemy=!0,t.gotHit={x:e.userData.position.x,y:e.userData.position.y,by:"fireball"}));else if(null===(w=e.userData.enemy)||void 0===w?void 0:w.isMovingShell){if(e.userData===t)continue;jc.set(e.userData),Tl.rectVsRect(Hc,jc)&&t.enemy.shell&&(e.userData.fireballHitEnemy=!0,t.gotHit={x:e.userData.position.x,y:e.userData.position.y,by:"shell"})}}}(e,Al),function(e){for(const t of ga.view(["iframesSecs"]))void 0!==t.iframesSecs&&(t.iframesSecs-=e,t.iframesSecs<=0&&delete t.iframesSecs)}(e),function(){for(const e of ga.view(["mario"])){if(!e.mario||e.mario.dead)continue;const t=e.position,i=e.positionPrev,r=e.size,o=i.x-.5*r.x,s=i.y-.5*r.y,n=r.x,l=r.y,a=t.sub(i);gc.pos.x=t.x-.5*r.x,gc.pos.y=t.y-.5*r.y,gc.size.x=n,gc.size.y=l,gc.dr=a,yc.l=a.x<0?o+a.x:o,yc.t=a.y<0?s+a.y:s,yc.w=a.x<0?n-a.x:n+a.x,yc.h=a.y<0?l-a.y:l+a.y;for(const t of Ld.dynamics.findNear(yc.l,yc.t,yc.w,yc.h)){const i=t.userData;(i.powerup||i.oneUp||i.star)&&(Fc.pos.x=i.position.x-.5*i.size.x,Fc.pos.y=i.position.y-.5*i.size.y,Fc.size.x=i.size.x,Fc.size.y=i.size.y,xl(gc,Fc)&&(ga.remove(i),i.powerup?e.mario.big?(e.mario.powerup="fire",e.player&&(e.player.gainedPow=!0)):(e.mario.big=!0,e.mario.changedSize=!0):i.oneUp?e.player&&(e.player.gainedOneUp=!0,e.player.lives++):i.star&&(e.mario.star=30)))}}}(),function(e){for(const t of ga.view(["mario"])){const i=t.mario;i&&void 0!==i.star&&(i.star-=e,i.star<=0&&delete i.star)}}(e),function(e){for(const t of ga.view(["deleteTimer"]))void 0!==t.deleteTimer&&(t.deleteTimer-=e,t.deleteTimer<=0&&ga.remove(t))}(e),function(e,t){var i,r,o,s,n,l,a,h;if(void 0!==t.respawnTimer){if(t.respawnTimer-=e,t.respawnTimer<=0){delete t.respawnTimer;for(const e of ga.view(["mario"]))null===(i=e.mario)||void 0===i||delete i.dead,window.setTimeout((()=>e.smb1MarioAnimations&&(e.smb1MarioAnimations.container.visible=!0))),e.iframesSecs=2,e.dynamic={acceleration:new yl(0,0),velocity:new yl(0,0)},e.position.x=null!==(s=null===(o=null===(r=e.mario)||void 0===r?void 0:r.respawnPoint)||void 0===o?void 0:o.x)&&void 0!==s?s:e.positionStart.x,e.position.y=null!==(a=null===(l=null===(n=e.mario)||void 0===n?void 0:n.respawnPoint)||void 0===l?void 0:l.y)&&void 0!==a?a:e.positionStart.y}}else for(const e of ga.view(["mario"]))(null===(h=e.mario)||void 0===h?void 0:h.dead)&&(e.player&&(e.player.lives-=1),e.smb1MarioAnimations&&(e.smb1MarioAnimations.container.visible=!1),delete e.dynamic,Jc(e.position.x,e.position.y),Qc.sounds.play("mariodiestart"),t.respawnTimer=1.5)}(e,this)),this.graphics,wd(e),id(e),this.paused||ld(),function(e){Ac.length=0;let t=null;for(const e of ga.view(["followCam"]))t=e;if(t){const i=t.position.x,r=t.position.y+.5*t.size.y-16;let o=!1;for(const e of jd.preserveCamera)if(Tl.pointVsRect(t.position,Ec.setToZone(e))){o=!0;break}if(e.moveToScale(3),e.moveToCenter(i,r),!o){Tc=null;for(const e of jd.camera)Tl.pointVsRect(t.position,Ec.setToZone(e))&&(Tc?Tc.w*Tc.h>e.w*e.h&&(Tc=e):Tc=e)}Tc&&e.moveToClamp(i,r,.1,Tc.x,Tc.y,Tc.w,Tc.h)}}(Al),function(e,t){var i,r,o;const[s,n]=t.fromViewport(0,0),[l,a]=t.fromViewport(t.getViewportWidth(),t.getViewportHeight());for(const e of Ld.grid.findNear(s,n,l-s,a-n)){const i=e.userData,r=i.enemActivateOnVisible;if(!r)continue;if(zc.set(i),zc.pos.x--,zc.pos.y--,zc.size.x+=2,zc.size.y+=2,!t.overlapsRectBroad(zc))continue;let o=!1;switch(r){case"bouncyKoop":i.smb1EnemiesAnimations&&(i.smb1EnemiesAnimations.loopsPerSecond=3),i.movement={horizontal:-33,horizontalNow:!0,flipEachOther:!0,bounce:!0},i.dynamic={velocity:new yl(0,0),acceleration:new yl(0,0)},i.hits=[],i.gravity=Gc,i.enemy={star:!0,stomp:!0,fireball:!0,shell:!0,lookTowards:"direction"},i.touchingDown=[];break;case"koopaG":case"koopaR":case"buzzy":case"koopaG":case"goomba":i.movement={horizontal:-Lc.enemySpeed,horizontalNow:!0,flipEachOther:!0,dontFallOff:"koopaR"===r},i.dynamic={velocity:new yl(0,0),acceleration:new yl(0,0)},i.hits=[],i.prevHits=[],i.gravity=Gc,i.enemy={star:!0,stomp:!0,fireball:"buzzy"!==r,shell:!0,lookTowards:"direction"},i.touchingDown=[];break;case"bowser":case"bruce":break;case"hammerbro":i.enemy={stomp:!0,fireball:!0,star:!0,shell:!0,lookTowards:"mario"},i.dynamic={acceleration:new yl(0,0),velocity:new yl(0,0)},i.hammerbro={nextJumpTimer:-1,hammerTelegraphTimer:-1,hammertime:-1,dirChangeTimer:-1,direction:Math.random()>.5?-1:1},i.gravity=Gc,i.touchingDown=[];break;case"blooper":i.enemy={stomp:!1,fireball:!0,star:!0,shell:!0},i.sensor=!0,i.moving=!0,i.blooper={},i.underwater=!0;break;case"plant":i.enemy={star:!0,stomp:!1,fireball:!0,shell:!0},i.sensor=!0,i.moving=!0,i.piranhaPlant={height:0};break;default:o=!0}o||delete i.enemActivateOnVisible}for(const t of ga.view(["enemy"]))if((null===(i=t.enemy)||void 0===i?void 0:i.isStillShell)&&void 0!==t.enemy.shellTimer&&(t.enemy.shellTimer-=e,t.smb1EnemiesAnimations&&t.enemy.shellTimer<=1&&(t.smb1EnemiesAnimations.loopsPerSecond=3),t.enemy.shellTimer<0)){const e=null===(r=t.smb1EnemiesAnimations)||void 0===r?void 0:r.getAnimation();null===(o=t.smb1EnemiesAnimations)||void 0===o||o.setAnimation("buzzyShell"===e?"buzzy":"redKoopashell"===e?"redKoopa":"greenKoopa"),t.smb1EnemiesAnimations&&(t.smb1EnemiesAnimations.loopsPerSecond=4,t.smb1EnemiesAnimations.container.angle=0),t.movement={horizontal:Lc.enemySpeed*Math.sign(Math.random()||1),horizontalNow:!0,flipEachOther:!0,dontFallOff:"redKoopashell"===e},t.dynamic={velocity:new yl(0,0),acceleration:new yl(0,0)},t.hits=[],t.gravity=Gc,t.enemy={star:!0,stomp:!0,fireball:"buzzyShell"!==e,shell:!0,lookTowards:"direction"},t.touchingDown=[]}}(e,Al),this.parallax.update(Al),!this.paused){!function(){for(const e of ga.view(["touchingUp"]))e.touchingUp&&(e.touchingUp.length=0);for(const e of ga.view(["touchingRight"]))e.touchingRight&&(e.touchingRight.length=0);for(const e of ga.view(["touchingDown"]))e.touchingDown&&(e.touchingDown.length=0);for(const e of ga.view(["touchingLeft"]))e.touchingLeft&&(e.touchingLeft.length=0);for(const e of ga.view(["dynamic"]))e.dynamic&&(e.dynamic.acceleration.x=0,e.dynamic.acceleration.y=0);for(const e of ga.view(["mario","player"]))e.mario&&e.player&&(e.mario.changedSize=!1,e.player.gainedPow=!1,e.mario.shot=!1,e.player.gainedOneUp=!1);for(const e of ga.view(["kinematic"]))e.kinematic&&(e.kinematic.acceleration.x=0,e.kinematic.acceleration.y=0)}();for(const e of ga.view(["justAdded"]))delete e.justAdded}return this.unloader.unload(),!0}},Su=new class extends zl{getGrid(e){return 2===(null!=e?e:this.layer)?this.grid2:this.grid}remove(e,t,i,r){const o=this.getGrid(r),s=16*Math.floor(e/16)+"."+16*Math.floor(t/16),n=o[s];if(n&&(!i||i===n.gameObj))return delete o[s],(null==n?void 0:n.gameObj)&&ga.remove(n.gameObj),n}add(...e){const{grid:t}=gd({entities:e,entities2:[]}),i=this.getGrid(),r={layer:this.layer,entObs:[],ents:e};for(const[e,o]of Object.entries(t)){const t=i[e];delete i[e],(null==t?void 0:t.gameObj)&&ga.remove(t.gameObj),i[e]=o,this.applyAlphaFromLayer(o.gameObj,i===this.grid?1:2),r.entObs.push(o.gameObj)}return r}historyPush(e){this.history.length=this.historyIndex,this.history.push(e),this.history.length>25&&this.history.shift(),this.historyIndex=this.history.length}historyUndo(){const e=this.historyIndex;if(this.historyIndex=this.historyIndex-1,this.historyIndex<0&&(this.historyIndex=0),e===this.historyIndex)return;const t=this.history[this.historyIndex];if(t){const e=this.layer;this.layer=t.layer,"add"===t.type?t.ents.forEach((e=>{this.remove(e[1],e[2])})):this.add(...t.ents),this.layer=e}}historyRestore(){if(this.history.length<=this.historyIndex)return;const e=this.history[this.historyIndex];if(!e)return;this.historyIndex+=1;const t=this.layer;this.layer=e.layer,"add"===e.type?this.add(...e.ents):e.ents.forEach((e=>{this.remove(e[1],e[2])})),this.layer=t}toggleLayer(){this.layer=1===this.layer?2:1}applyAlphaFromLayer(e,t){const i=this.layer===t?1:.5;e.smb1MarioAnimations&&(e.smb1MarioAnimations.container.alpha=i),e.smb1TilesSprites&&(e.smb1TilesSprites.container.alpha=i),e.smb1ObjectsSprites&&(e.smb1ObjectsSprites.container.alpha=i),e.smb1ObjectsAnimations&&(e.smb1ObjectsAnimations.container.alpha=i),e.smb1TilesAnimations&&(e.smb1TilesAnimations.container.alpha=i),e.smb1TilesSpritesEditMode&&(e.smb1TilesSpritesEditMode.container.alpha=i),e.smb1EnemiesAnimations&&(e.smb1EnemiesAnimations.container.alpha=i)}toggleTransparency(e){if("none"===e)ga.view().forEach((e=>this.applyAlphaFromLayer(e,this.layer)));else if("layer"===e){const e=this.getGrid(),t=e===this.grid?this.grid2:this.grid;Object.values(e).forEach((t=>this.applyAlphaFromLayer(t.gameObj,e===this.grid?1:2))),Object.values(t).forEach((e=>this.applyAlphaFromLayer(e.gameObj,t===this.grid?1:2)))}}constructor(){super(),this.container=new io,this.zones={camZones:[],camPreserveZones:[],deathZones:[],underwaterZones:[],whirlpoolZones:[],surfaceZones:[],noMarioInputZones:[],descendingPlatformZones:[],jumpCheepZones:[],cheepZones:[],lakituZones:[],billZones:[],fireZones:[],maskZones:[],angrySunZones:[],medusaHeadZones:[],loopZones:[],unloadZones:[],darkbgZones:[]},this.vines=[],this.vineSelected=!1,this.pipes=[],this.pipeSelected=!1,this.trampolines=[],this.trampolineSelected=!1,this.platformRouteIndex="oscillation",this.oscillations=[],this.oscillationSelected=!1,this.platformRoutes=[],this.platformRouteSelected=!1,this.platformConnections=[],this.platformConnectionSelected=!1,this.mouseX=0,this.mouseY=0,this.mousePrevX=0,this.mousePrevY=0,this.spanVel=new yl(0,0),this.grid={},this.grid2={},this.scale=1,this.prevSelected=null,this.selected=null,this.selectedZone="cam",this.zoneSelected=!1,this.solidFrame=void 0,this.brickFrame=void 0,this.blockFrame=void 0,this.clutterFrame=void 0,this.platformFrame=void 0,this.enemyFrame=void 0,this.npcFrame=void 0,this.layer=1,this.history=[],this.historyIndex=0,this.graphicsOverlay=new hn,this.graphicsOverlay.zIndex=100;const e=document.createElement("div");this.entityCount=document.createElement("div"),this.parallaxCount=document.createElement("div"),e.style.display="flex",e.style.alignItems="center";const t=document.createElement("div");t.innerHTML="Entities:";const i=document.createElement("div");i.innerHTML="|Parallax:",e.append(t,this.entityCount,i,this.parallaxCount),this.tileSelectors=document.createElement("div"),this.tileSelectors.style.padding="20px",this.tileSelectors.style.display="flex",this.tileSelectors.style.flexWrap="wrap",this.tileSelectors.style.gap="10px",this.marioSelect=document.createElement("button"),this.marioSelect.innerHTML="mario",this.marioSelect.onclick=()=>this.selected=ud.mario;const r=Ah.new();null==r||r.whenReady().then((()=>{this.marioSelect.innerHTML="";const e=document.createElement("img");e.style.width="48px",e.style.height="48px",e.alt="mario";const t=document.createElement("div");t.innerHTML=e.alt,this.marioSelect.append(e,t);const i=r.getDataUrl();i&&(e.src=i)})),this.solidSelect=document.createElement("button"),this.solidSelect.innerHTML="solid",this.solidSelect.onclick=()=>this.selected=ud.block;const o=Bh.new();null==o||o.whenReady().then((()=>{this.solidSelect.innerHTML="";const e=document.createElement("img");e.style.width="48px",e.style.height="48px",e.alt="solid";const t=document.createElement("div");t.innerHTML=e.alt,this.solidSelect.append(e,t);const i=o.getDataUrl();i&&(e.src=i,this.solidSelect.addEventListener("wheel",(t=>{var i;const r=o.getFrames();let s=r.findIndex((e=>e===o.getFrame())),n=!1;for(;!1===n;)s=(s+Math.sign(t.deltaY))%r.length,this.solidFrame=r.at(s),n=null===(i=this.solidFrame)||void 0===i?void 0:i.includes("solid");this.solidFrame&&o.setFrame(this.solidFrame);const l=o.getDataUrl();l&&(e.src=l)})))})),this.brickSelect=document.createElement("button"),this.brickSelect.innerHTML="brick",this.brickSelect.onclick=()=>this.selected=ud.brick;const s=Bh.new();this.brickFrame="brick1",s.setFrame(this.brickFrame),null==s||s.whenReady().then((()=>{this.brickSelect.innerHTML="";const e=document.createElement("img");e.style.width="48px",e.style.height="48px",e.alt="brick";const t=document.createElement("div");t.innerHTML=e.alt,this.brickSelect.append(e,t);const i=s.getDataUrl();i&&(e.src=i,this.brickSelect.addEventListener("wheel",(t=>{var i;const r=s.getFrames();let o=r.findIndex((e=>e===s.getFrame())),n=!1;for(;!1===n;)o=(o+Math.sign(t.deltaY))%r.length,this.brickFrame=r.at(o),n=null===(i=this.brickFrame)||void 0===i?void 0:i.includes("brick");this.brickFrame&&s.setFrame(this.brickFrame);const l=s.getDataUrl();l&&(e.src=l)})))})),this.clutterSelect=document.createElement("button"),this.clutterSelect.innerHTML="clutter",this.clutterSelect.onclick=()=>this.selected=ud.clutter;const n=Bh.new();this.clutterFrame="clutterFence",n.setFrame(this.clutterFrame),null==n||n.whenReady().then((()=>{this.clutterSelect.innerHTML="";const e=document.createElement("img");e.style.width="48px",e.style.height="48px",e.alt="clutter";const t=document.createElement("div");t.innerHTML=e.alt,this.clutterSelect.append(e,t);const i=n.getDataUrl();i&&(e.src=i,this.clutterSelect.addEventListener("wheel",(t=>{var i;const r=n.getFrames();let o=r.findIndex((e=>e===n.getFrame())),s=!1;for(;!1===s;)o=(o+Math.sign(t.deltaY))%r.length,this.clutterFrame=r.at(o),s=null===(i=this.clutterFrame)||void 0===i?void 0:i.includes("clutter");this.clutterFrame&&n.setFrame(this.clutterFrame);const l=n.getDataUrl();l&&(e.src=l)})))})),this.blockSelect=document.createElement("button"),this.blockSelect.innerHTML="block",this.blockSelect.onclick=()=>this.selected=ud.coinblock;const l=Bh.new();this.blockFrame="block1",l.setFrame(this.blockFrame),null==l||l.whenReady().then((()=>{this.blockSelect.innerHTML="";const e=document.createElement("img");e.style.width="48px",e.style.height="48px",e.alt="block";const t=document.createElement("div");t.innerHTML=e.alt,this.blockSelect.append(e,t);const i=l.getDataUrl();i&&(e.src=i,this.blockSelect.addEventListener("wheel",(t=>{var i;const r=l.getFrames();let o=r.findIndex((e=>e===l.getFrame())),s=!1;for(;!1===s;)o=(o+Math.sign(t.deltaY))%r.length,this.blockFrame=r.at(o),s=null===(i=this.blockFrame)||void 0===i?void 0:i.includes("block");this.blockFrame&&l.setFrame(this.blockFrame);const n=l.getDataUrl();n&&(e.src=n)})))})),this.coinSelect=document.createElement("button"),this.coinSelect.innerHTML="coin",this.coinSelect.onclick=()=>this.selected=ud.coin;const a=Bh.new();a.setFrame("coin1"),null==a||a.whenReady().then((()=>{this.coinSelect.innerHTML="";const e=document.createElement("img");e.style.width="48px",e.style.height="48px",e.alt="coin";const t=document.createElement("div");t.innerHTML=e.alt,this.coinSelect.append(e,t);const i=a.getDataUrl();i&&(e.src=i)})),this.platformSelect=document.createElement("button"),this.platformSelect.innerHTML="platforms",this.platformSelect.onclick=()=>this.selected=ud.platform;const h=Dh.new();this.platformFrame="platformBig",h.setFrame(this.platformFrame),null==h||h.whenReady().then((()=>{var e;this.platformSelect.innerHTML="";const t=document.createElement("img");t.style.width="48px",t.style.height="48px",t.alt="platform";const i=document.createElement("div");i.innerHTML=null!==(e=this.platformFrame)&&void 0!==e?e:t.alt,this.platformSelect.append(t,i);const r=h.getDataUrl();r&&(t.src=r,this.platformSelect.addEventListener("wheel",(e=>{var i,r;const o=h.getFrames();let s=o.findIndex((e=>e===h.getFrame())),n=!1;for(;!1===n;)s=(s+Math.sign(e.deltaY))%o.length,this.platformFrame=o.at(s),n=(null===(i=this.platformFrame)||void 0===i?void 0:i.includes("platform"))||(null===(r=this.platformFrame)||void 0===r?void 0:r.includes("cloud"));this.platformFrame&&h.setFrame(this.platformFrame);const l=h.getDataUrl();l&&(t.src=l)})))})),this.enemySelect=document.createElement("button"),this.enemySelect.innerHTML="enemies",this.enemySelect.onclick=()=>this.selected=ud.enemy;const d=zh.new();function c(e){const t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}this.enemyFrame="goomba",d.setAnimation(this.enemyFrame),null==d||d.whenReady().then((()=>{var e,t;this.enemySelect.innerHTML="";const i=document.createElement("img");i.style.width="48px",i.style.height="48px",i.alt=this.enemyFrame||"enemy";const r=document.createElement("div");r.innerHTML=c(null!==(t=null===(e=this.enemyFrame)||void 0===e?void 0:e.replace("OpenMouth",""))&&void 0!==t?t:i.alt),this.enemySelect.append(i,r);const o=d.getDataUrl();o&&(i.src=o,this.enemySelect.addEventListener("wheel",(e=>{var t,o,s,n,l,a;const h=d.getAnimations();let u=h.findIndex((e=>e===d.getAnimation())),m=!1;for(;!1===m;)u=(u+Math.sign(e.deltaY))%h.length,this.enemyFrame=h.at(u),m=!((null===(t=this.enemyFrame)||void 0===t?void 0:t.includes("Dead"))||(null===(o=this.enemyFrame)||void 0===o?void 0:o.includes("shell"))||(null===(s=this.enemyFrame)||void 0===s?void 0:s.includes("Attack"))||(null===(n=this.enemyFrame)||void 0===n?void 0:n.includes("bulletbill"))||(null===(l=this.enemyFrame)||void 0===l?void 0:l.includes("spiny"))||"lavaBubble"===this.enemyFrame||"buzzyShell"===this.enemyFrame||"lakitu"===this.enemyFrame||"hammer"===this.enemyFrame||"bowserfire"===this.enemyFrame||(null===(a=this.enemyFrame)||void 0===a?void 0:a.includes("ClosedMouth")));this.enemyFrame&&(d.setAnimation(this.enemyFrame),i.alt=this.enemyFrame,r.innerHTML=c(this.enemyFrame.replace("OpenMouth","")));const p=d.getDataUrl();p&&(i.src=p)})))})),this.npcSelect=document.createElement("button"),this.npcSelect.onclick=()=>this.selected=ud.npc;const u=Dh.new();this.npcFrame="toad",u.setFrame(this.npcFrame),null==u||u.whenReady().then((()=>{const e=document.createElement("img");e.style.width="48px",e.style.height="48px",e.alt=this.npcFrame||"npc";const t=document.createElement("div");t.innerHTML="npcs",this.npcSelect.append(e,t);const i=u.getDataUrl();i&&(e.src=i,this.npcSelect.addEventListener("wheel",(t=>{const i=u.getFrames();let r=i.findIndex((e=>e===u.getFrame())),o=!1;for(;!1===o;)r=(r+Math.sign(t.deltaY))%i.length,this.npcFrame=i.at(r),o=!0;this.npcFrame&&(u.setFrame(this.npcFrame),e.alt=this.npcFrame);const s=u.getDataUrl();s&&(e.src=s)})))})),this.zoneSelect=document.createElement("button"),this.zoneSelect.innerHTML="camera<br>zone",this.zoneSelect.onclick=()=>{this.selected=null,this.pipeSelected=!1,this.vineSelected=!1,this.zoneSelected=!0,this.trampolineSelected=!1,this.platformRouteSelected=!1,this.platformConnectionSelected=!1,this.oscillationSelected=!1};const m=()=>{switch(this.selectedZone){case"cam":this.zoneSelect.innerHTML="camera<br>zone";break;case"campreserve":this.zoneSelect.innerHTML="camera preserve<br>zone";break;case"noMInput":this.zoneSelect.innerHTML="no mario input<br>zone";break;case"underwater":this.zoneSelect.innerHTML="underwater<br>zone";break;case"surface":this.zoneSelect.innerHTML="surface<br>zone";break;case"whirlpool":this.zoneSelect.innerHTML="whirlpool<br>zone";break;case"descPlatform":this.zoneSelect.innerHTML="desc. platform<br>zone";break;case"bill":this.zoneSelect.innerHTML="bill<br>zone";break;case"cheep":this.zoneSelect.innerHTML="cheep<br>zone";break;case"jumpCheep":this.zoneSelect.innerHTML="jumping cheep<br>zone";break;case"fire":this.zoneSelect.innerHTML="bowser fire<br>zone";break;case"lakitu":this.zoneSelect.innerHTML="lakitu<br>zone";break;case"loop":this.zoneSelect.innerHTML="loop<br>zone";break;case"unload":this.zoneSelect.innerHTML="unloader<br>zone";break;case"darkbg":this.zoneSelect.innerHTML="dark background<br>zone";break;case"medusaHead":this.zoneSelect.innerHTML="medusa head<br>zone";break;case"angrySun":this.zoneSelect.innerHTML="angry sun<br>zone";break;case"mask":this.zoneSelect.innerHTML="mask<br>zone";break;default:this.zoneSelect.innerHTML="death<br>zone"}};m(),this.zoneSelect.addEventListener("wheel",(e=>{const t=["cam","campreserve","death","underwater","surface","whirlpool","noMInput","descPlatform","lakitu","cheep","fire","jumpCheep","bill","mask","angrySun","medusaHead","loop","unload","darkbg"];let i=t.findIndex((e=>e===this.selectedZone));Math.sign(e.deltaY)>0?this.selectedZone=t[++i]||t[0]||this.selectedZone:this.selectedZone=t[--i]||t.at(-1)||this.selectedZone,m()})),this.pipeSelect=document.createElement("button"),this.pipeSelect.innerHTML="pipe<br>path",this.pipeSelect.onclick=()=>{this.selected=null,this.zoneSelected=!1,this.vineSelected=!1,this.pipeSelected=!0,this.trampolineSelected=!1,this.platformRouteSelected=!1,this.platformConnectionSelected=!1,this.oscillationSelected=!1},this.vineSelect=document.createElement("button"),this.vineSelect.innerHTML="vine<br>marker",this.vineSelect.onclick=()=>{this.selected=null,this.zoneSelected=!1,this.pipeSelected=!1,this.vineSelected=!0,this.trampolineSelected=!1,this.platformRouteSelected=!1,this.platformConnectionSelected=!1,this.oscillationSelected=!1},this.trampolineSelect=document.createElement("button"),this.trampolineSelect.innerHTML="trampoline",this.trampolineSelect.onclick=()=>{this.selected=null,this.zoneSelected=!1,this.pipeSelected=!1,this.vineSelected=!1,this.trampolineSelected=!0,this.platformRouteSelected=!1,this.platformConnectionSelected=!1,this.oscillationSelected=!1},this.platformRouteSelect=document.createElement("button");const p=()=>{"connection"===this.platformRouteIndex?this.platformRouteSelect.innerHTML="platform<br>connection":"oscillation"===this.platformRouteIndex?this.platformRouteSelect.innerHTML="oscillation/<br>firebar":this.platformRouteSelect.innerHTML="platform<br>route"};p();const b=()=>{this.selected=null,this.zoneSelected=!1,this.vineSelected=!1,this.pipeSelected=!1,this.trampolineSelected=!1,this.platformRouteSelected=!1,this.platformConnectionSelected=!1,this.oscillationSelected=!1,"connection"===this.platformRouteIndex?this.platformConnectionSelected=!0:"oscillation"===this.platformRouteIndex?this.oscillationSelected=!0:this.platformRouteSelected=!0};this.platformRouteSelect.onclick=b,this.platformRouteSelect.addEventListener("wheel",(e=>{if(Math.sign(e.deltaY)>0)switch(this.platformRouteIndex){case"oscillation":this.platformRouteIndex="route";break;case"route":this.platformRouteIndex="connection";break;default:this.platformRouteIndex="oscillation"}else switch(this.platformRouteIndex){case"oscillation":this.platformRouteIndex="connection";break;case"connection":this.platformRouteIndex="route";break;default:this.platformRouteIndex="oscillation"}p(),(this.platformRouteSelected||this.platformConnectionSelected||this.oscillationSelected)&&b()})),this.dlg=document.createElement("textarea"),this.dlg.addEventListener("input",(e=>{var t;const i=e.target;i instanceof HTMLTextAreaElement&&(null===(t=this.selectedNpc)||void 0===t?void 0:t.npc)&&(this.selectedNpc.npc.text=i.value)})),this.tileSelectors.append(this.zoneSelect,this.pipeSelect,this.vineSelect,this.trampolineSelect,this.platformRouteSelect,this.marioSelect,this.solidSelect,this.brickSelect,this.blockSelect,this.coinSelect,this.platformSelect,this.clutterSelect,this.enemySelect,this.npcSelect,this.dlg),this.mousePosDisplay=document.createElement("div");const f=document.createElement("div");f.style.display="flex",f.append(this.mousePosDisplay,e,this.tileSelectors);const g=document.createElement("div"),F=document.createElement("button");F.innerHTML=`Layer: [${this.layer}]`,F.onclick=()=>{this.toggleLayer(),this.toggleTransparency("layer"),F.innerHTML=`Layer: [${this.layer}]`},g.append(F),this.toolsCont=document.createElement("div"),this.toolsCont.style.width="100%",this.toolsCont.style.backgroundColor="white",this.toolsCont.style.display="flex",this.toolsCont.style.justifyContent="space-between",this.toolsCont.append(f,g)}onStart(e){if(!e)return;if(Al.add(this.graphicsOverlay),Al.add(this.container),ga.clear(),this.scale=Al.getScale(),this.graphics=e.graphics,this.input=e.input,this.levelDataInit=e.levelDataInit||this.levelDataInit||Sd,this.levelDataInit){const e=gd(this.levelDataInit);this.grid=e.grid,this.grid2=e.grid2;for(const[t,i]of Object.entries(this.zones))i.length=0,i.push(...e.parsed[t]||[]);e.parsed.pipes&&(this.pipes=e.parsed.pipes),e.parsed.vines&&(this.vines=e.parsed.vines),e.parsed.trampolines&&(this.trampolines=e.parsed.trampolines),e.parsed.oscillations&&(this.oscillations=e.parsed.oscillations),e.parsed.platformRoutes&&(this.platformRoutes=e.parsed.platformRoutes),e.parsed.platformConnections&&(this.platformConnections=e.parsed.platformConnections)}this.toggleTransparency("layer");const t=document.getElementById("tools"),i=document.createElement("div");null==t||t.append(i),i.style.backgroundColor="white",i.append(this.toolsCont),this.disableSave=(()=>{const e=e=>{if(e.ctrlKey&&"KeyS"===e.code){e.preventDefault();const t=Object.assign(Object.assign({entities:[],entities2:[]},this.zones),{pipes:this.pipes,vines:this.vines,trampolines:this.trampolines,oscillations:this.oscillations,platformRoutes:this.platformRoutes,platformConnections:this.platformConnections});for(const e of Object.values(this.grid))t.entities.push(e.init);t.entities2||(t.entities2=[]);for(const e of Object.values(this.grid2))t.entities2.push(e.init);const i=new File([JSON.stringify(t)],"level.json"),r=window.document.createElement("a");r.href=window.URL.createObjectURL(i),r.download="level.json",document.body.appendChild(r),r.click(),document.body.removeChild(r)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)})()}onEnd(){var e;this.toggleTransparency("none"),this.container.removeFromParent(),this.graphicsOverlay.removeFromParent(),null===(e=this.disableSave)||void 0===e||e.call(this);const t=document.getElementById("tools");return t&&(t.innerHTML=""),this.levelDataInit=JSON.stringify(Object.assign({entities:Object.values(this.grid).map((e=>e.init)),entities2:Object.values(this.grid2).map((e=>e.init))},this.zones)),this.graphics&&this.input?[{graphics:this.graphics,input:this.input,zones:this.zones,pipes:this.pipes,vines:this.vines,trampolines:this.trampolines,oscillations:this.oscillations,platformRoutes:this.platformRoutes,platformConnections:this.platformConnections},"gameplay"]:[null,"gameplay"]}onUpdate(e){var t;if(this.graphicsOverlay.clear(),(null===(t=this.selectedNpc)||void 0===t?void 0:t.npc)?(this.dlg.disabled=!1,this.dlg.value!==this.selectedNpc.npc.text&&(this.dlg.value=this.selectedNpc.npc.text)):(this.dlg.disabled=!0,this.dlg.value=""),this.selected&&(this.zoneSelected=!1,this.pipeSelected=!1,this.vineSelected=!1,this.trampolineSelected=!1,this.platformRouteSelected=!1,this.platformConnectionSelected=!1,this.oscillationSelected=!1,this.currentZone=void 0,this.currentPipe=void 0,this.currentVine=void 0,this.currentTrampoline=void 0,this.currentOscillation=void 0,this.currentPlatformConnection=void 0,this.currentPlatformRoute=void 0),this.zoneSelected?this.zoneSelect.classList.add("selected"):this.zoneSelect.classList.remove("selected"),this.pipeSelected?this.pipeSelect.classList.add("selected"):this.pipeSelect.classList.remove("selected"),this.vineSelected?this.vineSelect.classList.add("selected"):this.vineSelect.classList.remove("selected"),this.trampolineSelected?this.trampolineSelect.classList.add("selected"):this.trampolineSelect.classList.remove("selected"),this.platformRouteSelected||this.platformConnectionSelected||this.oscillationSelected?this.platformRouteSelect.classList.add("selected"):this.platformRouteSelect.classList.remove("selected"),this.selected!==this.prevSelected){this.selectedNpc=void 0,this.prevSelected=this.selected;for(const e of this.tileSelectors.children)e.classList.remove("selected");switch(this.selected){case ud.mario:this.marioSelect.classList.add("selected");break;case ud.block:this.solidSelect.classList.add("selected");break;case ud.brick:this.brickSelect.classList.add("selected");break;case ud.clutter:this.clutterSelect.classList.add("selected");break;case ud.coinblock:this.blockSelect.classList.add("selected");break;case ud.coin:this.coinSelect.classList.add("selected");break;case ud.platform:this.platformSelect.classList.add("selected");break;case ud.enemy:this.enemySelect.classList.add("selected");break;case ud.npc:this.npcSelect.classList.add("selected")}}if(!this.graphics||!this.input)return!1;if(this.input.isPressed("Space")&&this.dlg!==document.activeElement)return!1;this.input.isPressed("KeyZ")&&(this.input.isHeld("ControlLeft")||this.input.isHeld("ControlRight"))&&(this.input.isHeld("ShiftLeft")||this.input.isHeld("ShiftRight")?this.selected?this.historyRestore():this.currentVine&&(this.currentVine=void 0):this.selected?this.historyUndo():this.pipeSelected?this.currentPipe?(this.currentPipe.pop(),this.currentPipe.length<=1&&(this.currentPipe=void 0)):this.pipes.pop():this.vineSelected?this.vines.pop():this.trampolineSelect&&this.trampolines.pop());const[i,r]=Al.getMousePos(),o=16*Math.floor(i/16),s=16*Math.floor(r/16);if(this.mousePosDisplay.innerHTML=`x: ${Math.floor(i)} | y: ${Math.floor(r)}<br>gx: ${o} | gy: ${s}`,ga.update(),this.entityCount.innerHTML=ga.number().toString(),this.parallaxCount.innerHTML=ga.view(["distanceModifiers","moving"]).length.toString(),this.graphics.clear(),this.input.isHeld("MouseMain")){const e=this.input.isHeld("ControlLeft"),t=this.input.isHeld("ControlRight");if((e||t)&&this.selected){const e=this.remove(i,r);e&&(e.gameObj===this.selectedNpc&&(this.selectedNpc=void 0),this.historyPush({type:"remove",ents:[e.init],layer:this.layer}))}if(!e){const e=o,t=s,n=e+"."+t,l=this.getGrid()[n];if((null==l?void 0:l.gameObj.npc)&&(this.selectedNpc=l.gameObj),!l&&this.selected){const o=this.input.isHeld("ShiftRight"),s=!this.input.isHeld("ShiftLeft");let n=s?e+8:i,l=s?t+8:r;o&&(n=i);let a=null;switch(this.selected){case ud.block:a=this.solidFrame&&"solidFloor1"!==this.solidFrame?this.add([this.selected,n,l,{tileFrame:this.solidFrame}]):this.add([this.selected,n,l]);break;case ud.brick:a=this.add([this.selected,n,l,{tileFrame:this.brickFrame}]);break;case ud.clutter:a=this.add([this.selected,n,l,{tileFrame:this.clutterFrame}]);break;case ud.coinblock:a=this.add([this.selected,n,l,{tileFrame:this.blockFrame}]);break;case ud.coin:a=this.add([this.selected,n,l]);break;case ud.platform:a=this.add([this.selected,n,l,{objectFrame:this.platformFrame}]);break;case ud.enemy:a=this.add([this.selected,n,l,{enemyAnim:this.enemyFrame}]);break;case ud.mario:ga.view(["mario"]).forEach((e=>{const t=this.remove(e.position.x,e.position.y,e,1),i=this.remove(e.position.x,e.position.y,e,2),r=t||i;r&&this.historyPush({type:"remove",ents:[r.init],layer:t?1:2})})),a=this.add([this.selected,n,l]);break;case ud.npc:a=this.add([this.selected,n,l,{objectFrame:this.npcFrame}]),this.selectedNpc=a.entObs[0];break;default:a=this.add([this.selected,n,l])}this.historyPush(Object.assign({type:"add"},a))}}}if(this.zoneSelected){const e=!this.input.isHeld("ShiftLeft"),t=this.input.isHeld("ControlLeft"),n=e?o:i,l=e?s:r;if(this.input.isPressed("MouseMain"))if(t){this.currentZone=void 0;const e=Object.entries(this.zones).flatMap((e=>e[1].map((t=>({type:e[0],zone:t}))))).sort(((e,t)=>e.zone.w*e.zone.h-t.zone.w*t.zone.h)).find((e=>Tl.pointVsRect(new yl(i,r),{pos:new yl(e.zone.x,e.zone.y),size:new yl(e.zone.w,e.zone.h)})));if(e){const t=new Set(this.zones[e.type]);t.delete(e.zone),this.zones[e.type]=[...t]}}else this.currentZone={x:n,y:l,w:16,h:16};if(this.input.isHeld("MouseMain")&&this.currentZone){const t=Math.sign(n+8-this.currentZone.x);if(e)this.currentZone.w=n+16-this.currentZone.x,t<0&&(this.currentZone.w=this.currentZone.w-16);else{const e=n-this.currentZone.x;this.currentZone.w=Math.abs(e)>16?e:16*Math.sign(e)||16}const i=Math.sign(l+8-this.currentZone.y);if(e)this.currentZone.h=l+16-this.currentZone.y,i<0&&(this.currentZone.h=this.currentZone.h-16);else{const e=l-this.currentZone.y;this.currentZone.h=Math.abs(e)>16?e:16*Math.sign(e)||16}}if(this.input.isReleased("MouseMain")&&this.currentZone){let e=0,t=0,i=0,r=0;switch(this.currentZone.w>0?(e=this.currentZone.x,i=this.currentZone.w):(e=this.currentZone.x+this.currentZone.w,i=-this.currentZone.w),this.currentZone.h>0?(t=this.currentZone.y,r=this.currentZone.h):(t=this.currentZone.y+this.currentZone.h,r=-this.currentZone.h),this.selectedZone){case"cam":this.zones.camZones.push({x:e,y:t,w:i,h:r});break;case"campreserve":this.zones.camPreserveZones.push({x:e,y:t,w:i,h:r});break;case"death":this.zones.deathZones.push({x:e,y:t,w:i,h:r});break;case"noMInput":this.zones.noMarioInputZones.push({x:e,y:t,w:i,h:r});break;case"surface":this.zones.surfaceZones.push({x:e,y:t,w:i,h:r});break;case"underwater":this.zones.underwaterZones.push({x:e,y:t,w:i,h:r});break;case"whirlpool":this.zones.whirlpoolZones.push({x:e,y:t,w:i,h:r});break;case"descPlatform":this.zones.descendingPlatformZones.push({x:e,y:t,w:i,h:r});break;case"angrySun":this.zones.angrySunZones.push({x:e,y:t,w:i,h:r});break;case"mask":this.zones.maskZones.push({x:e,y:t,w:i,h:r});break;case"bill":this.zones.billZones.push({x:e,y:t,w:i,h:r});break;case"cheep":this.zones.cheepZones.push({x:e,y:t,w:i,h:r});break;case"darkbg":this.zones.darkbgZones.push({x:e,y:t,w:i,h:r});break;case"fire":this.zones.fireZones.push({x:e,y:t,w:i,h:r});break;case"jumpCheep":this.zones.jumpCheepZones.push({x:e,y:t,w:i,h:r});break;case"lakitu":this.zones.lakituZones.push({x:e,y:t,w:i,h:r});break;case"loop":this.zones.loopZones.push({x:e,y:t,w:i,h:r});break;case"medusaHead":this.zones.medusaHeadZones.push({x:e,y:t,w:i,h:r});break;case"unload":this.zones.unloadZones.push({x:e,y:t,w:i,h:r})}this.currentZone=void 0}}if(this.pipeSelected){if((this.input.isPressed("Delete")||this.input.isPressed("Backspace"))&&(this.currentPipe=void 0),this.input.isPressed("MouseMain"))if(this.input.isHeld("ControlLeft")){const e=this.pipes.find((e=>e.find((e=>e[0]===o&&e[1]===s))));if(e){const t=new Set(this.pipes);t.delete(e),this.pipes=[...t]}}else if(this.currentPipe){const e=this.currentPipe.at(-1);e&&e[0]===o&&e[1]===s?(this.pipes.push(this.currentPipe),this.currentPipe=void 0):this.currentPipe.push([o,s])}else this.currentPipe=[[o,s]];this.input.isPressed("Enter")&&this.currentPipe&&(this.pipes.push(this.currentPipe),this.currentPipe=void 0)}if(this.vineSelected){if((this.input.isPressed("Delete")||this.input.isPressed("Backspace"))&&(this.currentVine=void 0),this.input.isPressed("MouseMain"))if(this.input.isHeld("ControlLeft")){const e=this.vines.find((e=>Math.abs(e.x-o)<16&&Math.abs(e.y-s)<16));if(e){const t=new Set(this.vines);t.delete(e),this.vines=[...t]}}else this.currentVine?(this.vines.push(this.currentVine),this.currentVine=void 0):this.currentVine={x:o+8,y:s+8,h:0};this.currentVine&&(this.currentVine.h=Math.abs(s-this.currentVine.y))}if(this.trampolineSelected){if((this.input.isPressed("Delete")||this.input.isPressed("Backspace"))&&(this.currentTrampoline=void 0),this.input.isPressed("MouseMain"))if(this.input.isHeld("ControlLeft")){const e=this.trampolines.find((e=>Math.abs(e.x-o)<16&&Math.abs(e.y-s)<16));if(e){const t=new Set(this.trampolines);t.delete(e),this.trampolines=[...t]}}else this.currentTrampoline?(this.trampolines.push(this.currentTrampoline),this.currentTrampoline=void 0):this.currentTrampoline={x:o+8,y:s+8,h:0};this.currentTrampoline&&(this.currentTrampoline.h=Math.abs(s-this.currentTrampoline.y))}if(this.oscillationSelected){if((this.input.isPressed("Delete")||this.input.isPressed("Backspace"))&&(this.currentOscillation=void 0),this.input.isPressed("MouseMain"))if(this.input.isHeld("ControlLeft")){const e=this.oscillations.find((e=>Math.abs(e.p1.x-o)<16&&Math.abs(e.p1.y-s)<16||Math.abs(e.p2.x-o)<16&&Math.abs(e.p2.y-s)<16||Math.abs(e.pstart.x-o)<16&&Math.abs(e.pstart.y-s)<16));if(e){const t=new Set(this.oscillations);t.delete(e),this.oscillations=[...t]}}else this.currentOscillation?"p1"===this.currentOscillation.setting?this.currentOscillation.setting="p2":(this.oscillations.push(this.currentOscillation),this.currentOscillation=void 0):this.currentOscillation={pstart:new yl(o+8,s+8),p1:new yl(o+8,s+8),p2:new yl(o+8,s+8),setting:"p1"};this.currentOscillation&&("p1"===this.currentOscillation.setting?(this.currentOscillation.p1.x=o+8,this.currentOscillation.p1.y=s+8):"p2"===this.currentOscillation.setting&&(this.currentOscillation.p2.x=o+8,this.currentOscillation.p2.y=s+8))}if(this.platformRouteSelected){if((this.input.isPressed("Delete")||this.input.isPressed("Backspace"))&&(this.currentPlatformRoute=void 0),this.input.isPressed("MouseMain"))if(this.input.isHeld("ControlLeft")){const e=this.platformRoutes.find((e=>Math.abs(e.p1.x-o)<16&&Math.abs(e.p1.y-s)<16||Math.abs(e.p2.x-o)<16&&Math.abs(e.p2.y-s)<16));if(e){const t=new Set(this.platformRoutes);t.delete(e),this.platformRoutes=[...t]}}else this.currentPlatformRoute?(this.platformRoutes.push(this.currentPlatformRoute),this.currentPlatformRoute=void 0):this.currentPlatformRoute={p1:new yl(o+8,s+8),p2:new yl(o+8,s+8)};this.currentPlatformRoute&&(this.currentPlatformRoute.p2.x=o+8,this.currentPlatformRoute.p2.y=s+8)}if(this.platformConnectionSelected){if((this.input.isPressed("Delete")||this.input.isPressed("Backspace"))&&(this.currentPlatformConnection=void 0),this.input.isPressed("MouseMain"))if(this.input.isHeld("ControlLeft")){const e=this.platformConnections.find((e=>Math.abs(e.pin.x+.5*e.w-o-8)<16&&Math.abs(e.pin.y-s)<16));if(e){const t=new Set(this.platformConnections);t.delete(e),this.platformConnections=[...t]}}else this.currentPlatformConnection?"w"===this.currentPlatformConnection.setting?this.currentPlatformConnection.setting="h1":"h1"===this.currentPlatformConnection.setting?this.currentPlatformConnection.setting="h2":"h2"===this.currentPlatformConnection.setting&&(this.platformConnections.push(this.currentPlatformConnection),this.currentPlatformConnection=void 0):this.currentPlatformConnection={pin:new yl(o+8,s+8),h1:0,h2:0,w:0,setting:"w"};this.currentPlatformConnection&&("w"===this.currentPlatformConnection.setting?this.currentPlatformConnection.w=Math.abs(o+8-this.currentPlatformConnection.pin.x):"h1"===this.currentPlatformConnection.setting?this.currentPlatformConnection.h1=Math.abs(s+8-this.currentPlatformConnection.pin.y):"h2"===this.currentPlatformConnection.setting&&(this.currentPlatformConnection.h2=Math.abs(s+8-this.currentPlatformConnection.pin.y)))}if(function(e,t,i,r){const o=r.scale;if(r.mousePrevX=r.mouseX,r.mousePrevY=r.mouseY,[r.mouseX,r.mouseY]=t.getMouseViewportPos(),i.isHeld("MouseSecondary")||i.isHeld("MouseAuxiliary")){const[i,o]=t.fromViewport(r.mousePrevX,r.mousePrevY),[s,n]=t.fromViewport(r.mouseX,r.mouseY);r.spanVel.x=(i-s)/e,r.spanVel.y=(o-n)/e}else r.spanVel=r.spanVel.sub(r.spanVel.mul(.1));const s=t.getCenterX(),n=t.getCenterY();t.setCenter(s+r.spanVel.x*e,n+r.spanVel.y*e);const l=i.getWheel();if(l&&(l.deltaY<0?r.scale*=1.1:r.scale/=1.1,r.scale<.1&&(r.scale=.1)),o!==r.scale){const[e,i]=t.getMousePos();t.setScale(r.scale);const[o,s]=t.getMousePos();t.setCenter(t.getCenterX()+e-o,t.getCenterY()+i-s)}}(e,Al,this.input,this),this.graphics,id(e),wd(e,!0),function(e,t,i,r,o,s,n,l,a,h,d,c,u,m,p,b,f){const[g,F]=Al.fromViewport(0,0),[y,v]=Al.fromViewport(Al.getViewportWidth(),Al.getViewportHeight()),x=Al.getScale(),_=x<1&&x>=.499?"medium":x<.499&&x>.2?"far":x<=.2?"farther":"close",w="medium"===_?32:"far"===_?0:"close"===_?16:0;if(!w)return;for(let e=g;e<y+w;e+=w){const i=Math.floor(e/w)*w;t.lineStyle(2/x,4456465).beginFill(0,0).moveTo(i,F).lineTo(i,v).endFill()}for(let e=F;e<v+w;e+=w){const i=Math.floor(e/w)*w;t.lineStyle(2/x,4456465).beginFill(0,0).moveTo(g,i).lineTo(y,i).endFill()}const[S,T]=Al.getMousePos(),E=16*Math.floor(S/16),A=16*Math.floor(T/16);i.lineStyle(3/x,16776960).beginFill(0,0).drawRect(E,A,16,16).endFill();for(const[t,o]of Object.entries(r)){Md(e,t,o);const r="camZones"===t?16776960:"camPreserveZones"===t?16755353:"deathZones"===t?16711680:"underwaterZones"===t?255:"whirlpoolZones"===t?65280:"surfaceZones"===t?65535:"descendingPlatformZones"===t?255:16711935;o.forEach((e=>{i.lineStyle(4/x,"descendingPlatformZones"===t?0:16777215).beginFill(0,0).drawRect(e.x,e.y,e.w,e.h).endFill(),i.lineStyle(2/x,r).beginFill(0,0).drawRect(e.x,e.y,e.w,e.h).endFill(),"descendingPlatformZones"===t&&(i.lineStyle(4/x,0).beginFill(0,0).moveTo(e.x+8,e.y+8).lineTo(e.x+8,e.y+e.h-8).endFill(),i.lineStyle(4/x,0).beginFill(0,0).drawPolygon(e.x+8-2,e.y+e.h-8,e.x+8+2,e.y+e.h-8,e.x+8,e.y+e.h-8+2).endFill(),i.lineStyle(2/x,r).beginFill(0,0).moveTo(e.x+8,e.y+8).lineTo(e.x+8,e.y+e.h-8).endFill(),i.lineStyle(2/x,r).beginFill(0,0).drawPolygon(e.x+8-2,e.y+e.h-8,e.x+8+2,e.y+e.h-8,e.x+8,e.y+e.h-8+2).endFill(),i.lineStyle(4/x,0).beginFill(0,0).moveTo(e.x+e.w-8,e.y+8).lineTo(e.x+e.w-8,e.y+e.h-8).endFill(),i.lineStyle(4/x,0).beginFill(0,0).drawPolygon(e.x+e.w-8-2,e.y+8,e.x+e.w-8+2,e.y+8,e.x+e.w-8,e.y+8-2).endFill(),i.lineStyle(2/x,r).beginFill(0,0).moveTo(e.x+e.w-8,e.y+8).lineTo(e.x+e.w-8,e.y+e.h-8).endFill(),i.lineStyle(2/x,r).beginFill(0,0).drawPolygon(e.x+e.w-8-2,e.y+8,e.x+e.w-8+2,e.y+8,e.x+e.w-8,e.y+8-2).endFill())}))}if(d){let e=0,t=0,r=0,o=0;d.w>0?(e=d.x,r=d.w):(e=d.x+d.w,r=-d.w),d.h>0?(t=d.y,o=d.h):(t=d.y+d.h,o=-d.h),i.lineStyle(4/x,16777215).beginFill(0,0).drawRect(e,t,r,o).endFill(),i.lineStyle(2/x,0).beginFill(0,0).drawRect(e,t,r,o).endFill()}for(const e of o)e&&Nd(i,e,16776960);c&&Nd(i,c,16777215);for(const e of s)Rd(i,e,65280);u&&Rd(i,u,65535);for(const e of n)Rd(i,e,16711680);m&&Rd(i,m,16750899);for(const e of l)Id(i,e,255);p&&Id(i,p,11141375);for(const e of a)Dd(i,e,255);b&&Dd(i,b,11141375);for(const e of h)Od(i,e,255);f&&Od(i,f,11141375)}(this.container,this.graphics,this.graphicsOverlay,this.zones,this.pipes,this.vines,this.trampolines,this.oscillations,this.platformRoutes,this.platformConnections,this.currentZone,this.currentPipe,this.currentVine,this.currentTrampoline,this.currentOscillation,this.currentPlatformRoute,this.currentPlatformConnection),this.selectedNpc&&this.selectedNpc.smb1ObjectsSprites){const e=this.selectedNpc.smb1ObjectsSprites.container.position.x,t=this.selectedNpc.smb1ObjectsSprites.container.position.y,i=this.selectedNpc.smb1ObjectsSprites.container.width,r=this.selectedNpc.smb1ObjectsSprites.container.height;this.graphicsOverlay.lineStyle(0,0).beginFill(43775,.5).drawRect(e-.5*i,t-.5*r-4,i,r).endFill()}return ld(),!0}};_u.connect(Su,"edit"),Su.connect(wu,"gameplay"),wu.connect(Su,"editor"),(new class extends Pl{constructor(){super(...arguments),this.state="loading",this.input=new Cl(Al.getCanvas()),this.graphics=new hn,this.smUpdate=_u.start(this),this.loading=0}load(){return function(e,t,i,r){return new(i||(i=Promise))((function(o,s){function n(e){try{a(r.next(e))}catch(e){s(e)}}function l(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,l)}a((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){this.loading=1}))}onStart(){this.load(),Al.add(this.graphics),this.graphics.zIndex=-1}onFrameDraw(){this.input.update();const e=Math.min(1/24,Math.max(this.dt,1/120));this.smUpdate(e),Al.update(e),Al.render()}}).start()})()})();